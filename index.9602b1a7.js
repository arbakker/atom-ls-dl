function t(t){return t&&t.__esModule?t.default:t}var e,i,n={},r={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(i){try{return e.call(null,t,0)}catch(i){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var h,l=[],u=!1,c=-1;function p(){u&&h&&(u=!1,h.length?l=h.concat(l):c=-1,l.length&&f())}function f(){if(!u){var t=a(p);u=!0;for(var e=l.length;e;){for(h=l,l=[];++c<e;)h&&h[c].run();c=-1,e=l.length}h=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{return i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new d(t,e)),1!==l.length||u||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0},function(t){var e=6371008.8,i={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*e,kilometers:6371.0088,kilometres:6371.0088,meters:e,metres:e,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:e/1852,radians:1,yards:6967335.223679999},n={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e,yards:1.0936133},r={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function o(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function s(t,e,i){switch(t){case"Point":return a(e).geometry;case"LineString":return c(e).geometry;case"Polygon":return l(e).geometry;case"MultiPoint":return g(e).geometry;case"MultiLineString":return d(e).geometry;case"MultiPolygon":return y(e).geometry;default:throw new Error(t+" is invalid")}}function a(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!S(t[0])||!S(t[1]))throw new Error("coordinates must contain numbers");return o({type:"Point",coordinates:t},e,i)}function h(t,e,i){return void 0===i&&(i={}),f(t.map((function(t){return a(t,e)})),i)}function l(t,e,i){void 0===i&&(i={});for(var n=0,r=t;n<r.length;n++){var s=r[n];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return o({type:"Polygon",coordinates:t},e,i)}function u(t,e,i){return void 0===i&&(i={}),f(t.map((function(t){return l(t,e)})),i)}function c(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return o({type:"LineString",coordinates:t},e,i)}function p(t,e,i){return void 0===i&&(i={}),f(t.map((function(t){return c(t,e)})),i)}function f(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function d(t,e,i){return void 0===i&&(i={}),o({type:"MultiLineString",coordinates:t},e,i)}function g(t,e,i){return void 0===i&&(i={}),o({type:"MultiPoint",coordinates:t},e,i)}function y(t,e,i){return void 0===i&&(i={}),o({type:"MultiPolygon",coordinates:t},e,i)}function _(t,e,i){return void 0===i&&(i={}),o({type:"GeometryCollection",geometries:t},e,i)}function m(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i}function v(t,e){void 0===e&&(e="kilometers");var n=i[e];if(!n)throw new Error(e+" units is invalid");return t*n}function x(t,e){void 0===e&&(e="kilometers");var n=i[e];if(!n)throw new Error(e+" units is invalid");return t/n}function E(t,e){return b(x(t,e))}function w(t){var e=t%360;return e<0&&(e+=360),e}function b(t){return t%(2*Math.PI)*180/Math.PI}function M(t){return t%360*Math.PI/180}function C(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("length must be a positive number");return v(x(t,e),i)}function I(t,e,i){if(void 0===e&&(e="meters"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("area must be a positive number");var n=r[e];if(!n)throw new Error("invalid original units");var o=r[i];if(!o)throw new Error("invalid final units");return t/n*o}function S(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function P(t){return!!t&&t.constructor===Object}function N(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!S(t))throw new Error("bbox must only contain numbers")}))}function R(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var T=Object.freeze({__proto__:null,earthRadius:e,factors:i,unitsFactors:n,areaFactors:r,feature:o,geometry:s,point:a,points:h,polygon:l,polygons:u,lineString:c,lineStrings:p,featureCollection:f,multiLineString:d,multiPoint:g,multiPolygon:y,geometryCollection:_,round:m,radiansToLength:v,lengthToRadians:x,lengthToDegrees:E,bearingToAzimuth:w,radiansToDegrees:b,degreesToRadians:M,convertLength:C,convertArea:I,isNumber:S,isObject:P,validateBBox:N,validateId:R});function L(t,e,i){if(null!==t)for(var n,r,o,s,a,h,l,u,c=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,y=d?t.features.length:1,_=0;_<y;_++){a=(u=!!(l=d?t.features[_].geometry:g?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var m=0;m<a;m++){var v=0,x=0;if(null!==(s=u?l.geometries[m]:l)){h=s.coordinates;var E=s.type;switch(c=!i||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case"Point":if(!1===e(h,p,_,v,x))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<h.length;n++){if(!1===e(h[n],p,_,v,x))return!1;p++,"MultiPoint"===E&&v++}"LineString"===E&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<h.length;n++){for(r=0;r<h[n].length-c;r++){if(!1===e(h[n][r],p,_,v,x))return!1;p++}"MultiLineString"===E&&v++,"Polygon"===E&&x++}"Polygon"===E&&v++;break;case"MultiPolygon":for(n=0;n<h.length;n++){for(x=0,r=0;r<h[n].length;r++){for(o=0;o<h[n][r].length-c;o++){if(!1===e(h[n][r][o],p,_,v,x))return!1;p++}x++}v++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===L(s.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function O(t,e,i,n){var r=i;return L(t,(function(t,n,o,s,a){r=0===n&&void 0===i?t:e(r,t,n,o,s,a)}),n),r}function A(t,e){var i;switch(t.type){case"FeatureCollection":for(i=0;i<t.features.length&&!1!==e(t.features[i].properties,i);i++);break;case"Feature":e(t.properties,0)}}function D(t,e,i){var n=i;return A(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n}function F(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function k(t,e,i){var n=i;return F(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n}function G(t){var e=[];return L(t,(function(t){e.push(t)})),e}function z(t,e){var i,n,r,o,s,a,h,l,u,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(i=0;i<g;i++){for(a=f?t.features[i].geometry:d?t.geometry:t,l=f?t.features[i].properties:d?t.properties:{},u=f?t.features[i].bbox:d?t.bbox:void 0,c=f?t.features[i].id:d?t.id:void 0,s=(h=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=h?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,l,u,c))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],p,l,u,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,l,u,c))return!1;p++}}function j(t,e,i){var n=i;return z(t,(function(t,r,o,s,a){n=0===r&&void 0===i?t:e(n,t,r,o,s,a)})),n}function q(t,e){z(t,(function(t,i,n,r,s){var a,h=null===t?null:t.type;switch(h){case null:case"Point":case"LineString":case"Polygon":return!1!==e(o(t,n,{bbox:r,id:s}),i,0)&&void 0}switch(h){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(o({type:a,coordinates:u},n),i,l))return!1}}))}function B(t,e,i){var n=i;return q(t,(function(t,r,o){n=0===r&&0===o&&void 0===i?t:e(n,t,r,o)})),n}function U(t,e){q(t,(function(t,i,n){var r=0;if(t.geometry){var o=t.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var s,a=0,h=0,l=0;return!1!==L(t,(function(o,u,p,f,d){if(void 0===s||i>a||f>h||d>l)return s=o,a=i,h=f,l=d,void(r=0);var g=c([s,o],t.properties);if(!1===e(g,i,n,d,r))return!1;r++,s=o}))&&void 0}}}))}function X(t,e,i){var n=i,r=!1;return U(t,(function(t,o,s,a,h){n=!1===r&&void 0===i?t:e(n,t,o,s,a,h),r=!0})),n}function Y(t,e){if(!t)throw new Error("geojson is required");q(t,(function(t,i,n){if(null!==t.geometry){var r=t.geometry.type,o=t.geometry.coordinates;switch(r){case"LineString":if(!1===e(t,i,n,0,0))return!1;break;case"Polygon":for(var s=0;s<o.length;s++)if(!1===e(c(o[s],t.properties),i,n,s))return!1}}}))}function V(t,e,i){var n=i;return Y(t,(function(t,r,o,s){n=0===r&&void 0===i?t:e(n,t,r,o,s)})),n}function W(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i,n=e.featureIndex||0,r=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.segmentIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),a=a||t.features[n].properties,i=t.features[n].geometry;break;case"Feature":a=a||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var h=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=h.length+s-1),c([h[s],h[s+1]],a,e);case"Polygon":return o<0&&(o=h.length+o),s<0&&(s=h[o].length+s-1),c([h[o][s],h[o][s+1]],a,e);case"MultiLineString":return r<0&&(r=h.length+r),s<0&&(s=h[r].length+s-1),c([h[r][s],h[r][s+1]],a,e);case"MultiPolygon":return r<0&&(r=h.length+r),o<0&&(o=h[r].length+o),s<0&&(s=h[r][o].length-s-1),c([h[r][o][s],h[r][o][s+1]],a,e)}throw new Error("geojson is invalid")}function K(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i,n=e.featureIndex||0,r=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.coordIndex||0,h=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),h=h||t.features[n].properties,i=t.features[n].geometry;break;case"Feature":h=h||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var l=i.coordinates;switch(i.type){case"Point":return a(l,h,e);case"MultiPoint":return r<0&&(r=l.length+r),a(l[r],h,e);case"LineString":return s<0&&(s=l.length+s),a(l[s],h,e);case"Polygon":return o<0&&(o=l.length+o),s<0&&(s=l[o].length+s),a(l[o][s],h,e);case"MultiLineString":return r<0&&(r=l.length+r),s<0&&(s=l[r].length+s),a(l[r][s],h,e);case"MultiPolygon":return r<0&&(r=l.length+r),o<0&&(o=l[r].length+o),s<0&&(s=l[r][o].length-s),a(l[r][o][s],h,e)}throw new Error("geojson is invalid")}var H=Object.freeze({__proto__:null,coordAll:G,coordEach:L,coordReduce:O,featureEach:F,featureReduce:k,findPoint:K,findSegment:W,flattenEach:q,flattenReduce:B,geomEach:z,geomReduce:j,lineEach:Y,lineReduce:V,propEach:A,propReduce:D,segmentEach:U,segmentReduce:X});function Z(t){var e=[1/0,1/0,-1/0,-1/0];return L(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}function J(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Q(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function $(t){if(t.length>1&&S(t[0])&&S(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return $(t[0]);throw new Error("coordinates must only contain numbers")}function tt(t,e,i){if(!e||!i)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+t.type)}function et(t,e,i){if(!t)throw new Error("No feature passed");if(!i)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+t.geometry.type)}function it(t,e,i){if(!t)throw new Error("No featureCollection passed");if(!i)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+i+", FeatureCollection required");for(var n=0,r=t.features;n<r.length;n++){var o=r[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+o.geometry.type)}}function nt(t){return"Feature"===t.type?t.geometry:t}function rt(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}Z.default=Z;var ot=Object.freeze({__proto__:null,getCoord:J,getCoords:Q,containsNumber:$,geojsonType:tt,featureOf:et,collectionOf:it,getGeom:nt,getType:rt}),st=Object.getOwnPropertySymbols,at=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable;
/*
    object-assign
    (c) Sindre Sorhus
    @license MIT
    */function lt(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var ut=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,n,r=lt(t),o=1;o<arguments.length;o++){for(var s in i=Object(arguments[o]))at.call(i,s)&&(r[s]=i[s]);if(st){n=st(i);for(var a=0;a<n.length;a++)ht.call(i,n[a])&&(r[n[a]]=i[n[a]])}}return r},ct={successCallback:null,verbose:!1},pt={};
/**
     * @license GNU Affero General Public License.
     * Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
     * v. 1.2.0
     * https://github.com/RaumZeit/MarchingSquares.js
     *
     * MarchingSquaresJS is free software: you can redistribute it and/or modify
     * it under the terms of the GNU Affero General Public License as published by
     * the Free Software Foundation, either version 3 of the License, or
     * (at your option) any later version.
     *
     * MarchingSquaresJS is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     * GNU Affero General Public License for more details.
     *
     * As additional permission under GNU Affero General Public License version 3
     * section 7, third-party projects (personal or commercial) may distribute,
     * include, or link against UNMODIFIED VERSIONS of MarchingSquaresJS without the
     * requirement that said third-party project for that reason alone becomes
     * subject to any requirement of the GNU Affero General Public License version 3.
     * Any modifications to MarchingSquaresJS, however, must be shared with the public
     * and made available.
     *
     * In summary this:
     * - allows you to use MarchingSquaresJS at no cost
     * - allows you to use MarchingSquaresJS for both personal and commercial purposes
     * - allows you to distribute UNMODIFIED VERSIONS of MarchingSquaresJS under any
     *   license as long as this license notice is included
     * - enables you to keep the source code of your program that uses MarchingSquaresJS
     *   undisclosed
     * - forces you to share any modifications you have made to MarchingSquaresJS,
     *   e.g. bug-fixes
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with MarchingSquaresJS.  If not, see <http://www.gnu.org/licenses/>.
     */function ft(t,e,i){i=i||{};for(var n=Object.keys(ct),r=0;r<n.length;r++){var o=n[r],s=i[o];s=null!=s?s:ct[o],pt[o]=s}pt.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+e);var a=function(t){var e=[],i=0,n=1e-7;return t.cells.forEach((function(r,o){r.forEach((function(r,s){if(void 0!==r&&5!==(f=r).cval&&10!==f.cval&&!gt(r)){var a=function(t,e,i){var n,r,o=t.length,s=[],a=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],h=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],l=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"],u=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],c=t[e][i],p=c.cval,f=l[p],d=_t(c,f);s.push([i+d[0],e+d[1]]),d=_t(c,f=u[p]),s.push([i+d[0],e+d[1]]),yt(c);for(var g=i+a[p],y=e+h[p],_=p;g>=0&&y>=0&&y<o&&(g!=i||y!=e)&&void 0!==(c=t[y][g]);){if(0===(p=c.cval)||15===p)return{path:s,info:"mergeable"};f=u[p],n=a[p],r=h[p],5!==p&&10!==p||(5===p?c.flipped?-1===h[_]?(f="left",n=-1,r=0):(f="right",n=1,r=0):-1===a[_]&&(f="bottom",n=0,r=-1):10===p&&(c.flipped?-1===a[_]?(f="top",n=0,r=1):(f="bottom",n=0,r=-1):1===h[_]&&(f="left",n=-1,r=0))),d=_t(c,f),s.push([g+d[0],y+d[1]]),yt(c),g+=n,y+=r,_=p}return{path:s,info:"closed"}}(t.cells,o,s),h=!1;if("mergeable"===a.info)for(var l=a.path[a.path.length-1][0],u=a.path[a.path.length-1][1],c=i-1;c>=0;c--)if(Math.abs(e[c][0][0]-l)<=n&&Math.abs(e[c][0][1]-u)<=n){for(var p=a.path.length-2;p>=0;--p)e[c].unshift(a.path[p]);h=!0;break}h||(e[i++]=a.path)}var f}))})),e}(function(t,e){for(var i=t.length-1,n=t[0].length-1,r={rows:i,cols:n,cells:[]},o=0;o<i;++o){r.cells[o]=[];for(var s=0;s<n;++s){var a=0,h=t[o+1][s],l=t[o+1][s+1],u=t[o][s+1],c=t[o][s];if(!(isNaN(h)||isNaN(l)||isNaN(u)||isNaN(c))){a|=h>=e?8:0,a|=l>=e?4:0,a|=u>=e?2:0;var p,f,d,g,y=!1;if(5==(a|=c>=e?1:0)||10===a){var _=(h+l+u+c)/4;5===a&&_<e?(a=10,y=!0):10===a&&_<e&&(a=5,y=!0)}0!==a&&15!==a&&(p=f=d=g=.5,1===a?(d=1-dt(e,h,c),f=1-dt(e,u,c)):2===a?(f=dt(e,c,u),g=1-dt(e,l,u)):3===a?(d=1-dt(e,h,c),g=1-dt(e,l,u)):4===a?(p=dt(e,h,l),g=dt(e,u,l)):5===a?(p=dt(e,h,l),g=dt(e,u,l),f=1-dt(e,u,c),d=1-dt(e,h,c)):6===a?(f=dt(e,c,u),p=dt(e,h,l)):7===a?(d=1-dt(e,h,c),p=dt(e,h,l)):8===a?(d=dt(e,c,h),p=1-dt(e,l,h)):9===a?(f=1-dt(e,u,c),p=1-dt(e,l,h)):10===a?(p=1-dt(e,l,h),g=1-dt(e,l,u),f=dt(e,c,u),d=dt(e,c,h)):11===a?(p=1-dt(e,l,h),g=1-dt(e,l,u)):12===a?(d=dt(e,c,h),g=dt(e,u,l)):13===a?(f=1-dt(e,u,c),g=dt(e,u,l)):14===a?(d=dt(e,c,h),f=dt(e,c,u)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+a),r.cells[o][s]={cval:a,flipped:y,top:p,right:g,bottom:f,left:d})}}}return r}(t,e));return"function"==typeof pt.successCallback&&pt.successCallback(a),a}function dt(t,e,i){return(t-e)/(i-e)}function gt(t){return 0===t.cval||15===t.cval}function yt(t){gt(t)||5===t.cval||10===t.cval||(t.cval=15)}function _t(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}function mt(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.zProperty||"elevation",n=e.flip,r=e.flags;it(t,"Point","input must contain Points");for(var o=function(t,e){var i={};return F(t,(function(t){var e=Q(t)[1];i[e]||(i[e]=[]),i[e].push(t)})),Object.keys(i).map((function(t){return i[t].sort((function(t,e){return Q(t)[0]-Q(e)[0]}))})).sort((function(t,i){return e?Q(t[0])[1]-Q(i[0])[1]:Q(i[0])[1]-Q(t[0])[1]}))}(t,n),s=[],a=0;a<o.length;a++){for(var h=o[a],l=[],u=0;u<h.length;u++){var c=h[u];c.properties[i]?l.push(c.properties[i]):l.push(0),!0===r&&(c.properties.matrixPosition=[a,u])}s.push(l)}return s}var vt=Et,xt=Et;function Et(t,e,i,n,r){wt(t,e,i||0,n||t.length-1,r||Mt)}function wt(t,e,i,n,r){for(;n>i;){if(n-i>600){var o=n-i+1,s=e-i+1,a=Math.log(o),h=.5*Math.exp(2*a/3),l=.5*Math.sqrt(a*h*(o-h)/o)*(s-o/2<0?-1:1);wt(t,e,Math.max(i,Math.floor(e-s*h/o+l)),Math.min(n,Math.floor(e+(o-s)*h/o+l)),r)}var u=t[e],c=i,p=n;for(bt(t,i,e),r(t[n],u)>0&&bt(t,i,n);c<p;){for(bt(t,c,p),c++,p--;r(t[c],u)<0;)c++;for(;r(t[p],u)>0;)p--}0===r(t[i],u)?bt(t,i,p):bt(t,++p,n),p<=e&&(i=p+1),e<=p&&(n=p-1)}}function bt(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function Mt(t,e){return t<e?-1:t>e?1:0}vt.default=xt;var Ct=St,It=St;function St(t,e){if(!(this instanceof St))return new St(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Pt(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function Nt(t,e){Rt(t,0,t.children.length,e,t)}function Rt(t,e,i,n,r){r||(r=Gt(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],Tt(r,t.leaf?n(o):o);return r}function Tt(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Lt(t,e){return t.minX-e.minX}function Ot(t,e){return t.minY-e.minY}function At(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Dt(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Ft(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function kt(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Gt(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function zt(t,e,i,n,r){for(var o,s=[e,i];s.length;)(i=s.pop())-(e=s.pop())<=n||(o=e+Math.ceil((i-e)/n/2)*n,vt(t,o,e,i,r),s.push(e,o,o,i))}function jt(t){var e={exports:{}};return t(e,e.exports),e.exports}St.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!kt(t,e))return i;for(var r,o,s,a,h=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],kt(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):Ft(t,a)?this._all(s,i):h.push(s));e=h.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!kt(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],kt(t,s=e.leaf?i(o):o)){if(e.leaf||Ft(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Gt([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,o,s=this.data,a=this.toBBox(t),h=[],l=[];s||h.length;){if(s||(s=h.pop(),n=h[h.length-1],i=l.pop(),o=!0),s.leaf&&-1!==(r=Pt(t,s.children,e)))return s.children.splice(r,1),h.push(s),this._condense(h),this;o||s.leaf||!Ft(s,a)?n?(i++,s=n.children[i],o=!1):s=null:(h.push(s),l.push(i),i=0,n=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:Lt,compareMinY:Ot,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,s=this._maxEntries;if(o<=s)return Nt(r=Gt(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,n-1))),(r=Gt([])).leaf=!1,r.height=n;var a,h,l,u,c=Math.ceil(o/s),p=c*Math.ceil(Math.sqrt(s));for(zt(t,e,i,p,this.compareMinX),a=e;a<=i;a+=p)for(zt(t,a,l=Math.min(a+p-1,i),c,this.compareMinY),h=a;h<=l;h+=c)u=Math.min(h+c-1,l),r.children.push(this._build(t,h,u,n-1));return Nt(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,h,l,u,c,p,f;n.push(e),!e.leaf&&n.length-1!==i;){for(u=c=1/0,r=0,o=e.children.length;r<o;r++)h=At(s=e.children[r]),p=t,f=s,(l=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-h)<c?(c=l,u=h<u?h:u,a=s):l===c&&h<u&&(u=h,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),Tt(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),s=Gt(i.children.splice(o,i.children.length-o));s.height=i.height,s.leaf=i.leaf,Nt(i,this.toBBox),Nt(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(t,e){this.data=Gt([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Nt(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,a,h,l,u,c,p,f,d,g,y;for(h=l=1/0,n=e;n<=i-e;n++)c=r=Rt(t,0,n,this.toBBox),p=o=Rt(t,n,i,this.toBBox),f=void 0,d=void 0,g=void 0,y=void 0,f=Math.max(c.minX,p.minX),d=Math.max(c.minY,p.minY),g=Math.min(c.maxX,p.maxX),y=Math.min(c.maxY,p.maxY),s=Math.max(0,g-f)*Math.max(0,y-d),a=At(r)+At(o),s<h?(h=s,u=n,l=a<l?a:l):s===h&&a<l&&(l=a,u=n);return u},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:Lt,r=t.leaf?this.compareMinY:Ot;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,a=Rt(t,0,e,s),h=Rt(t,i-e,i,s),l=Dt(a)+Dt(h);for(r=e;r<i-e;r++)o=t.children[r],Tt(a,t.leaf?s(o):o),l+=Dt(a);for(r=i-e-1;r>=e;r--)o=t.children[r],Tt(h,t.leaf?s(o):o),l+=Dt(h);return l},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)Tt(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():Nt(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}},Ct.default=It;var qt=function(t,e,i){var n=t*e,r=Bt*t,o=r-(r-t),s=t-o,a=Bt*e,h=a-(a-e),l=e-h,u=s*l-(n-o*h-s*h-o*l);return i?(i[0]=u,i[1]=n,i):[u,n]},Bt=+(Math.pow(2,27)+1),Ut=function(t,e){var i=0|t.length,n=0|e.length;if(1===i&&1===n)return function(t,e){var i=t+e,n=i-t,r=t-(i-n)+(e-n);return r?[r,i]:[i]}(t[0],e[0]);var r,o,s=new Array(i+n),a=0,h=0,l=0,u=Math.abs,c=t[h],p=u(c),f=e[l],d=u(f);p<d?(o=c,(h+=1)<i&&(p=u(c=t[h]))):(o=f,(l+=1)<n&&(d=u(f=e[l]))),h<i&&p<d||l>=n?(r=c,(h+=1)<i&&(p=u(c=t[h]))):(r=f,(l+=1)<n&&(d=u(f=e[l])));for(var g,y,_=r+o,m=_-r,v=o-m,x=v,E=_;h<i&&l<n;)p<d?(r=c,(h+=1)<i&&(p=u(c=t[h]))):(r=f,(l+=1)<n&&(d=u(f=e[l]))),(v=(o=x)-(m=(_=r+o)-r))&&(s[a++]=v),x=E-((g=E+_)-(y=g-E))+(_-y),E=g;for(;h<i;)(v=(o=x)-(m=(_=(r=c)+o)-r))&&(s[a++]=v),x=E-((g=E+_)-(y=g-E))+(_-y),E=g,(h+=1)<i&&(c=t[h]);for(;l<n;)(v=(o=x)-(m=(_=(r=f)+o)-r))&&(s[a++]=v),x=E-((g=E+_)-(y=g-E))+(_-y),E=g,(l+=1)<n&&(f=e[l]);return x&&(s[a++]=x),E&&(s[a++]=E),a||(s[a++]=0),s.length=a,s},Xt=function(t,e,i){var n=t+e,r=n-t,o=e-r,s=t-(n-r);return i?(i[0]=s+o,i[1]=n,i):[s+o,n]},Yt=function(t,e){var i=t.length;if(1===i){var n=qt(t[0],e);return n[0]?n:[n[1]]}var r=new Array(2*i),o=[.1,.1],s=[.1,.1],a=0;qt(t[0],e,o),o[0]&&(r[a++]=o[0]);for(var h=1;h<i;++h){qt(t[h],e,s);var l=o[1];Xt(l,s[0],o),o[0]&&(r[a++]=o[0]);var u=s[1],c=o[1],p=u+c,f=c-(p-u);o[1]=p,f&&(r[a++]=f)}return o[1]&&(r[a++]=o[1]),0===a&&(r[a++]=0),r.length=a,r},Vt=function(t,e){var i=0|t.length,n=0|e.length;if(1===i&&1===n)return function(t,e){var i=t+e,n=i-t,r=t-(i-n)+(e-n);return r?[r,i]:[i]}(t[0],-e[0]);var r,o,s=new Array(i+n),a=0,h=0,l=0,u=Math.abs,c=t[h],p=u(c),f=-e[l],d=u(f);p<d?(o=c,(h+=1)<i&&(p=u(c=t[h]))):(o=f,(l+=1)<n&&(d=u(f=-e[l]))),h<i&&p<d||l>=n?(r=c,(h+=1)<i&&(p=u(c=t[h]))):(r=f,(l+=1)<n&&(d=u(f=-e[l])));for(var g,y,_=r+o,m=_-r,v=o-m,x=v,E=_;h<i&&l<n;)p<d?(r=c,(h+=1)<i&&(p=u(c=t[h]))):(r=f,(l+=1)<n&&(d=u(f=-e[l]))),(v=(o=x)-(m=(_=r+o)-r))&&(s[a++]=v),x=E-((g=E+_)-(y=g-E))+(_-y),E=g;for(;h<i;)(v=(o=x)-(m=(_=(r=c)+o)-r))&&(s[a++]=v),x=E-((g=E+_)-(y=g-E))+(_-y),E=g,(h+=1)<i&&(c=t[h]);for(;l<n;)(v=(o=x)-(m=(_=(r=f)+o)-r))&&(s[a++]=v),x=E-((g=E+_)-(y=g-E))+(_-y),E=g,(l+=1)<n&&(f=-e[l]);return x&&(s[a++]=x),E&&(s[a++]=E),a||(s[a++]=0),s.length=a,s},Wt=jt((function(t){function e(t,e){for(var i=new Array(t.length-1),n=1;n<t.length;++n)for(var r=i[n-1]=new Array(t.length-1),o=0,s=0;o<t.length;++o)o!==e&&(r[s++]=t[n][o]);return i}function i(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",i(t.slice(0,e)),",",i(t.slice(e)),")"].join("")}function n(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var r=[],o=0;o<t.length;++o)r.push(["scale(",i(n(e(t,o))),",",(s=o,1&s?"-":""),t[0][o],")"].join(""));var s;return r}function r(t){for(var r=[],o=[],s=function(t){for(var e=new Array(t),i=0;i<t;++i){e[i]=new Array(t);for(var n=0;n<t;++n)e[i][n]=["m",n,"[",t-i-1,"]"].join("")}return e}(t),a=[],h=0;h<t;++h)0==(1&h)?r.push.apply(r,n(e(s,h))):o.push.apply(o,n(e(s,h))),a.push("m"+h);var l=i(r),u=i(o),c="orientation"+t+"Exact",p=["function ",c,"(",a.join(),"){var p=",l,",n=",u,",d=sub(p,n);return d[d.length-1];};return ",c].join("");return new Function("sum","prod","scale","sub",p)(Ut,qt,Yt,Vt)}var o=r(3),s=r(4),a=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,i){var n,r=(t[1]-i[1])*(e[0]-i[0]),s=(t[0]-i[0])*(e[1]-i[1]),a=r-s;if(r>0){if(s<=0)return a;n=r+s}else{if(!(r<0))return a;if(s>=0)return a;n=-(r+s)}var h=33306690738754716e-32*n;return a>=h||a<=-h?a:o(t,e,i)},function(t,e,i,n){var r=t[0]-n[0],o=e[0]-n[0],a=i[0]-n[0],h=t[1]-n[1],l=e[1]-n[1],u=i[1]-n[1],c=t[2]-n[2],p=e[2]-n[2],f=i[2]-n[2],d=o*u,g=a*l,y=a*h,_=r*u,m=r*l,v=o*h,x=c*(d-g)+p*(y-_)+f*(m-v),E=7771561172376103e-31*((Math.abs(d)+Math.abs(g))*Math.abs(c)+(Math.abs(y)+Math.abs(_))*Math.abs(p)+(Math.abs(m)+Math.abs(v))*Math.abs(f));return x>E||-x>E?x:s(t,e,i,n)}];function h(t){var e=a[t.length];return e||(e=a[t.length]=r(t.length)),e.apply(void 0,t)}!function(){for(;a.length<=5;)a.push(r(a.length));for(var e=[],i=["slow"],n=0;n<=5;++n)e.push("a"+n),i.push("o"+n);var o=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(n=2;n<=5;++n)o.push("case ",n,":return o",n,"(",e.slice(0,n).join(),");");o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),i.push(o.join(""));var s=Function.apply(void 0,i);for(t.exports=s.apply(void 0,[h].concat(a)),n=0;n<=5;++n)t.exports[n]=a[n]}()})),Kt=function(t){var e=t.length;if(e<3){for(var i=new Array(e),n=0;n<e;++n)i[n]=n;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:i}var r=new Array(e);for(n=0;n<e;++n)r[n]=n;r.sort((function(e,i){return t[e][0]-t[i][0]||t[e][1]-t[i][1]}));var o=[r[0],r[1]],s=[r[0],r[1]];for(n=2;n<e;++n){for(var a=r[n],h=t[a],l=o.length;l>1&&Ht(t[o[l-2]],t[o[l-1]],h)<=0;)l-=1,o.pop();for(o.push(a),l=s.length;l>1&&Ht(t[s[l-2]],t[s[l-1]],h)>=0;)l-=1,s.pop();s.push(a)}i=new Array(s.length+o.length-2);for(var u=0,c=(n=0,o.length);n<c;++n)i[u++]=o[n];for(var p=s.length-2;p>0;--p)i[u++]=s[p];return i},Ht=Wt[3],Zt=Qt,Jt=Qt;function Qt(t,e){if(!(this instanceof Qt))return new Qt(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||$t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}function $t(t,e){return t<e?-1:t>e?1:0}Qt.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,i=this.compare,n=e[t];t>0;){var r=t-1>>1,o=e[r];if(i(n,o)>=0)break;e[t]=o,t=r}e[t]=n},_down:function(t){for(var e=this.data,i=this.compare,n=this.length>>1,r=e[t];t<n;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&i(e[s],a)<0&&(o=s,a=e[s]),i(a,r)>=0)break;e[t]=a,t=o}e[t]=r}},Zt.default=Jt;var te=function(t,e){for(var i=t[0],n=t[1],r=!1,o=0,s=e.length-1;o<e.length;s=o++){var a=e[o][0],h=e[o][1],l=e[s][0],u=e[s][1];h>n!=u>n&&i<(l-a)*(n-h)/(u-h)+a&&(r=!r)}return r},ee=Wt[3],ie=re,ne=re;function re(t,e,i){e=Math.max(0,void 0===e?2:e),i=i||0;for(var n,r=function(t){for(var e=t[0],i=t[0],n=t[0],r=t[0],o=0;o<t.length;o++){var s=t[o];s[0]<e[0]&&(e=s),s[0]>n[0]&&(n=s),s[1]<i[1]&&(i=s),s[1]>r[1]&&(r=s)}var a=[e,i,n,r],h=a.slice();for(o=0;o<t.length;o++)te(t[o],a)||h.push(t[o]);var l=Kt(h),u=[];for(o=0;o<l.length;o++)u.push(h[l[o]]);return u}(t),o=Ct(16,["[0]","[1]","[0]","[1]"]).load(t),s=[],a=0;a<r.length;a++){var h=r[a];o.remove(h),n=ce(h,n),s.push(n)}var l=Ct(16);for(a=0;a<s.length;a++)l.insert(ue(s[a]));for(var u=e*e,c=i*i;s.length;){var p=s.shift(),f=p.p,d=p.next.p,g=pe(f,d);if(!(g<c)){var y=g/u;(h=oe(o,p.prev.p,f,d,p.next.next.p,y,l))&&Math.min(pe(h,f),pe(h,d))<=y&&(s.push(p),s.push(ce(h,p)),o.remove(h),l.remove(p),l.insert(ue(p)),l.insert(ue(p.next)))}}p=n;var _=[];do{_.push(p.p),p=p.next}while(p!==n);return _.push(p.p),_}function oe(t,e,i,n,r,o,s){for(var a=new Zt(null,se),h=t.data;h;){for(var l=0;l<h.children.length;l++){var u=h.children[l],c=h.leaf?fe(u,i,n):ae(i,n,u);c>o||a.push({node:u,dist:c})}for(;a.length&&!a.peek().node.children;){var p=a.pop(),f=p.node,d=fe(f,e,i),g=fe(f,n,r);if(p.dist<d&&p.dist<g&&le(i,f,s)&&le(n,f,s))return f}(h=a.pop())&&(h=h.node)}return null}function se(t,e){return t.dist-e.dist}function ae(t,e,i){if(he(t,i)||he(e,i))return 0;var n=de(t[0],t[1],e[0],e[1],i.minX,i.minY,i.maxX,i.minY);if(0===n)return 0;var r=de(t[0],t[1],e[0],e[1],i.minX,i.minY,i.minX,i.maxY);if(0===r)return 0;var o=de(t[0],t[1],e[0],e[1],i.maxX,i.minY,i.maxX,i.maxY);if(0===o)return 0;var s=de(t[0],t[1],e[0],e[1],i.minX,i.maxY,i.maxX,i.maxY);return 0===s?0:Math.min(n,r,o,s)}function he(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function le(t,e,i){for(var n,r,o,s,a=Math.min(t[0],e[0]),h=Math.min(t[1],e[1]),l=Math.max(t[0],e[0]),u=Math.max(t[1],e[1]),c=i.search({minX:a,minY:h,maxX:l,maxY:u}),p=0;p<c.length;p++)if(n=c[p].p,r=c[p].next.p,o=t,n!==(s=e)&&r!==o&&ee(n,r,o)>0!=ee(n,r,s)>0&&ee(o,s,n)>0!=ee(o,s,r)>0)return!1;return!0}function ue(t){var e=t.p,i=t.next.p;return t.minX=Math.min(e[0],i[0]),t.minY=Math.min(e[1],i[1]),t.maxX=Math.max(e[0],i[0]),t.maxY=Math.max(e[1],i[1]),t}function ce(t,e){var i={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(i.next=e.next,i.prev=e,e.next.prev=i,e.next=i):(i.prev=i,i.next=i),i}function pe(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function fe(t,e,i){var n=e[0],r=e[1],o=i[0]-n,s=i[1]-r;if(0!==o||0!==s){var a=((t[0]-n)*o+(t[1]-r)*s)/(o*o+s*s);a>1?(n=i[0],r=i[1]):a>0&&(n+=o*a,r+=s*a)}return(o=t[0]-n)*o+(s=t[1]-r)*s}function de(t,e,i,n,r,o,s,a){var h,l,u,c,p=i-t,f=n-e,d=s-r,g=a-o,y=t-r,_=e-o,m=p*p+f*f,v=p*d+f*g,x=d*d+g*g,E=p*y+f*_,w=d*y+g*_,b=m*x-v*v,M=b,C=b;0===b?(l=0,M=1,c=w,C=x):(c=m*w-v*E,(l=v*w-x*E)<0?(l=0,c=w,C=x):l>M&&(l=M,c=w+v,C=x)),c<0?(c=0,-E<0?l=0:-E>m?l=M:(l=-E,M=m)):c>C&&(c=C,-E+v<0?l=0:-E+v>m?l=M:(l=-E+v,M=m));var I=(1-(u=0===c?0:c/C))*r+u*s-((1-(h=0===l?0:l/M))*t+h*i),S=(1-u)*o+u*a-((1-h)*e+h*n);return I*I+S*S}function ge(t,e){void 0===e&&(e={}),e.concavity=e.concavity||1/0;var i=[];if(L(t,(function(t){i.push([t[0],t[1]])})),!i.length)return null;var n=ie(i,e.concavity);return n.length>3?l([n]):null}function ye(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=J(t),r=nt(e),o=r.type,s=e.bbox,a=r.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(n,s))return!1;"Polygon"===o&&(a=[a]);for(var h=!1,l=0;l<a.length&&!h;l++)if(_e(n,a[l][0],i.ignoreBoundary)){for(var u=!1,c=1;c<a[l].length&&!u;)_e(n,a[l][c],!i.ignoreBoundary)&&(u=!0),c++;u||(h=!0)}return h}function _e(t,e,i){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],h=e[o][0],l=e[o][1];if(t[1]*(s-h)+a*(h-t[0])+l*(t[0]-s)==0&&(s-t[0])*(h-t[0])<=0&&(a-t[1])*(l-t[1])<=0)return!i;a>t[1]!=l>t[1]&&t[0]<(h-s)*(t[1]-a)/(l-a)+s&&(n=!n)}return n}function me(t,e){var i=[];return F(t,(function(t){var n=!1;if("Point"===t.geometry.type)z(e,(function(e){ye(t,e)&&(n=!0)})),n&&i.push(t);else{if("MultiPoint"!==t.geometry.type)throw new Error("Input geometry must be a Point or MultiPoint");var r=[];z(e,(function(e){L(t,(function(t){ye(t,e)&&(n=!0,r.push(t))}))})),n&&i.push(g(r))}})),f(i)}function ve(t,e,i){void 0===i&&(i={});var n=J(t),r=J(e),o=M(r[1]-n[1]),s=M(r[0]-n[0]),a=M(n[1]),h=M(r[1]),l=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(h);return v(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),i.units)}function xe(t,e){var i=!1;return f(function(t){if(t.length<3)return[];t.sort(we);for(var e,i,n,r,o,s,a=t.length-1,h=t[a].x,l=t[0].x,u=t[a].y,c=u,p=1e-12;a--;)t[a].y<u&&(u=t[a].y),t[a].y>c&&(c=t[a].y);var f,d=l-h,g=c-u,y=d>g?d:g,_=.5*(l+h),m=.5*(c+u),v=[new Ee({__sentinel:!0,x:_-20*y,y:m-y},{__sentinel:!0,x:_,y:m+20*y},{__sentinel:!0,x:_+20*y,y:m-y})],x=[],E=[];for(a=t.length;a--;){for(E.length=0,f=v.length;f--;)(d=t[a].x-v[f].x)>0&&d*d>v[f].r?(x.push(v[f]),v.splice(f,1)):d*d+(g=t[a].y-v[f].y)*g>v[f].r||(E.push(v[f].a,v[f].b,v[f].b,v[f].c,v[f].c,v[f].a),v.splice(f,1));for(be(E),f=E.length;f;)i=E[--f],e=E[--f],n=t[a],r=i.x-e.x,o=i.y-e.y,s=2*(r*(n.y-i.y)-o*(n.x-i.x)),Math.abs(s)>p&&v.push(new Ee(e,i,n))}for(Array.prototype.push.apply(x,v),a=x.length;a--;)(x[a].a.__sentinel||x[a].b.__sentinel||x[a].c.__sentinel)&&x.splice(a,1);return x}(t.features.map((function(t){var n={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e?n.z=t.properties[e]:3===t.geometry.coordinates.length&&(i=!0,n.z=t.geometry.coordinates[2]),n}))).map((function(t){var e=[t.a.x,t.a.y],n=[t.b.x,t.b.y],r=[t.c.x,t.c.y],o={};return i?(e.push(t.a.z),n.push(t.b.z),r.push(t.c.z)):o={a:t.a.z,b:t.b.z,c:t.c.z},l([[e,n,r,e]],o)})))}ie.default=ne;var Ee=function(t,e,i){this.a=t,this.b=e,this.c=i;var n,r,o=e.x-t.x,s=e.y-t.y,a=i.x-t.x,h=i.y-t.y,l=o*(t.x+e.x)+s*(t.y+e.y),u=a*(t.x+i.x)+h*(t.y+i.y),c=2*(o*(i.y-e.y)-s*(i.x-e.x));this.x=(h*l-s*u)/c,this.y=(o*u-a*l)/c,n=this.x-t.x,r=this.y-t.y,this.r=n*n+r*r};function we(t,e){return e.x-t.x}function be(t){var e,i,n,r,o,s=t.length;t:for(;s;)for(i=t[--s],e=t[--s],n=s;n;)if(o=t[--n],e===(r=t[--n])&&i===o||e===o&&i===r){t.splice(s,2),t.splice(n,2),s-=2;continue t}}function Me(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return Ce(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"features":return;default:e[i]=t[i]}})),e.features=t.features.map((function(t){return Ce(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Se(t);default:throw new Error("unknown GeoJSON type")}}function Ce(t){var e={type:"Feature"};return Object.keys(t).forEach((function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=t[i]}})),e.properties=Ie(t.properties),e.geometry=Se(t.geometry),e}function Ie(t){var e={};return t?(Object.keys(t).forEach((function(i){var n=t[i];"object"==typeof n?null===n?e[i]=null:Array.isArray(n)?e[i]=n.map((function(t){return t})):e[i]=Ie(n):e[i]=n})),e):e}function Se(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Se(t)})),e):(e.coordinates=Pe(t.coordinates),e)}function Pe(t){var e=t;return"object"!=typeof e[0]?e.slice():e.map((function(t){return Pe(t)}))}function Ne(t,e){if(void 0===e&&(e={}),!P(e=e||{}))throw new Error("options is invalid");var i=e.mutate;if("FeatureCollection"!==rt(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==i&&void 0!==i||(t=Me(t));var n=[],r=V(t,(function(t,e){var i=function(t,e){var i,n=t.geometry.coordinates,r=e.geometry.coordinates,o=Re(n[0]),s=Re(n[n.length-1]),a=Re(r[0]),h=Re(r[r.length-1]);if(o===h)i=r.concat(n.slice(1));else if(a===s)i=n.concat(r.slice(1));else if(o===a)i=n.slice(1).reverse().concat(r);else{if(s!==h)return null;i=n.concat(r.reverse().slice(1))}return c(i)}(t,e);return i||(n.push(t),e)}));return r&&n.push(r),n.length?1===n.length?n[0]:d(n.map((function(t){return t.coordinates}))):null}function Re(t){return t[0].toString()+","+t[1].toString()}function Te(t){return t}function Le(t,e){var i=function(t){if(null==t)return Te;var e,i,n=t.scale[0],r=t.scale[1],o=t.translate[0],s=t.translate[1];return function(t,a){a||(e=i=0);var h=2,l=t.length,u=new Array(l);for(u[0]=(e+=t[0])*n+o,u[1]=(i+=t[1])*r+s;h<l;)u[h]=t[h],++h;return u}}(t.transform),n=t.arcs;function r(t,e){e.length&&e.pop();for(var r=n[t<0?~t:t],o=0,s=r.length;o<s;++o)e.push(i(r[o],o));t<0&&function(t,e){for(var i,n=t.length,r=n-e;r<--n;)i=t[r],t[r++]=t[n],t[n]=i}(e,s)}function o(t){return i(t)}function s(t){for(var e=[],i=0,n=t.length;i<n;++i)r(t[i],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function h(t){return t.map(a)}return function t(e){var i,n=e.type;switch(n){case"GeometryCollection":return{type:n,geometries:e.geometries.map(t)};case"Point":i=o(e.coordinates);break;case"MultiPoint":i=e.coordinates.map(o);break;case"LineString":i=s(e.arcs);break;case"MultiLineString":i=e.arcs.map(s);break;case"Polygon":i=h(e.arcs);break;case"MultiPolygon":i=e.arcs.map(h);break;default:return null}return{type:n,coordinates:i}}(e)}function Oe(t,e){var i={},n={},r={},o=[],s=-1;function a(t,e){for(var n in t){var r=t[n];delete e[r.start],delete r.start,delete r.end,r.forEach((function(t){i[t<0?~t:t]=1})),o.push(r)}}return e.forEach((function(i,n){var r,o=t.arcs[i<0?~i:i];o.length<3&&!o[1][0]&&!o[1][1]&&(r=e[++s],e[s]=i,e[n]=r)})),e.forEach((function(e){var i,o,s=function(e){var i,n=t.arcs[e<0?~e:e],r=n[0];return t.transform?(i=[0,0],n.forEach((function(t){i[0]+=t[0],i[1]+=t[1]}))):i=n[n.length-1],e<0?[i,r]:[r,i]}(e),a=s[0],h=s[1];if(i=r[a])if(delete r[i.end],i.push(e),i.end=h,o=n[h]){delete n[o.start];var l=o===i?i:i.concat(o);n[l.start=i.start]=r[l.end=o.end]=l}else n[i.start]=r[i.end]=i;else if(i=n[h])if(delete n[i.start],i.unshift(e),i.start=a,o=r[a]){delete r[o.end];var u=o===i?i:o.concat(i);n[u.start=o.start]=r[u.end=i.end]=u}else n[i.start]=r[i.end]=i;else n[(i=[e]).start=a]=r[i.end=h]=i})),a(r,n),a(n,r),e.forEach((function(t){i[t<0?~t:t]||o.push([t])})),o}function Ae(t,e){var i={},n=[],r=[];function o(t){t.forEach((function(e){e.forEach((function(e){(i[e=e<0?~e:e]||(i[e]=[])).push(t)}))})),n.push(t)}function s(e){return function(t){for(var e,i=-1,n=t.length,r=t[n-1],o=0;++i<n;)e=r,r=t[i],o+=e[0]*r[1]-e[1]*r[0];return Math.abs(o)}(Le(t,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach((function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":o(e.arcs);break;case"MultiPolygon":e.arcs.forEach(o)}})),n.forEach((function(t){if(!t._){var e=[],n=[t];for(t._=1,r.push(e);t=n.pop();)e.push(t),t.forEach((function(t){t.forEach((function(t){i[t<0?~t:t].forEach((function(t){t._||(t._=1,n.push(t))}))}))}))}})),n.forEach((function(t){delete t._})),{type:"MultiPolygon",arcs:r.map((function(e){var n,r=[];if(e.forEach((function(t){t.forEach((function(t){t.forEach((function(t){i[t<0?~t:t].length<2&&r.push(t)}))}))})),(n=(r=Oe(t,r)).length)>1)for(var o,a,h=1,l=s(r[0]);h<n;++h)(o=s(r[h]))>l&&(a=r[0],r[0]=r[h],r[h]=a,l=o);return r})).filter((function(t){return t.length>0}))}}var De=Object.prototype.hasOwnProperty;function Fe(t,e,i,n,r,o){3===arguments.length&&(n=o=Array,r=null);for(var s=new n(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=new o(t),h=t-1,l=0;l<t;++l)s[l]=r;function u(n,o){for(var l=e(n)&h,u=s[l],c=0;u!=r;){if(i(u,n))return a[l]=o;if(++c>=t)throw new Error("full hashmap");u=s[l=l+1&h]}return s[l]=n,a[l]=o,o}function c(n,o){for(var l=e(n)&h,u=s[l],c=0;u!=r;){if(i(u,n))return a[l];if(++c>=t)throw new Error("full hashmap");u=s[l=l+1&h]}return s[l]=n,a[l]=o,o}function p(n,o){for(var l=e(n)&h,u=s[l],c=0;u!=r;){if(i(u,n))return a[l];if(++c>=t)break;u=s[l=l+1&h]}return o}function f(){for(var t=[],e=0,i=s.length;e<i;++e){var n=s[e];n!=r&&t.push(n)}return t}return{set:u,maybeSet:c,get:p,keys:f}}function ke(t,e){return t[0]===e[0]&&t[1]===e[1]}var Ge=new ArrayBuffer(16),ze=new Float64Array(Ge),je=new Uint32Array(Ge);function qe(t){ze[0]=t[0],ze[1]=t[1];var e=je[0]^je[1];return 2147483647&(e<<5^e>>7^je[2]^je[3])}function Be(t){var e,i,n,r,o=t.coordinates,s=t.lines,a=t.rings,h=function(){for(var t=Fe(1.4*o.length,E,w,Int32Array,-1,Int32Array),e=new Int32Array(o.length),i=0,n=o.length;i<n;++i)e[i]=t.maybeSet(i,i);return e}(),l=new Int32Array(o.length),u=new Int32Array(o.length),c=new Int32Array(o.length),p=new Int8Array(o.length),f=0;for(e=0,i=o.length;e<i;++e)l[e]=u[e]=c[e]=-1;for(e=0,i=s.length;e<i;++e){var d=s[e],g=d[0],y=d[1];for(n=h[g],r=h[++g],++f,p[n]=1;++g<=y;)x(e,n,n=r,r=h[g]);++f,p[r]=1}for(e=0,i=o.length;e<i;++e)l[e]=-1;for(e=0,i=a.length;e<i;++e){var _=a[e],m=_[0]+1,v=_[1];for(x(e,h[v-1],n=h[m-1],r=h[m]);++m<=v;)x(e,n,n=r,r=h[m])}function x(t,e,i,n){if(l[i]!==t){l[i]=t;var r=u[i];if(r>=0){var o=c[i];r===e&&o===n||r===n&&o===e||(++f,p[i]=1)}else u[i]=e,c[i]=n}}function E(t){return qe(o[t])}function w(t,e){return ke(o[t],o[e])}l=u=c=null;var b,M=function(t,e,i,n,r){3===arguments.length&&(n=Array,r=null);for(var o=new n(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=t-1,a=0;a<t;++a)o[a]=r;function h(n){for(var a=e(n)&s,h=o[a],l=0;h!=r;){if(i(h,n))return!0;if(++l>=t)throw new Error("full hashset");h=o[a=a+1&s]}return o[a]=n,!0}function l(n){for(var a=e(n)&s,h=o[a],l=0;h!=r;){if(i(h,n))return!0;if(++l>=t)break;h=o[a=a+1&s]}return!1}function u(){for(var t=[],e=0,i=o.length;e<i;++e){var n=o[e];n!=r&&t.push(n)}return t}return{add:h,has:l,values:u}}(1.4*f,qe,ke);for(e=0,i=o.length;e<i;++e)p[b=h[e]]&&M.add(o[b]);return M}function Ue(t,e,i,n){Xe(t,e,i),Xe(t,e,e+n),Xe(t,e+n,i)}function Xe(t,e,i){for(var n,r=e+(i---e>>1);e<r;++e,--i)n=t[e],t[e]=t[i],t[i]=n}function Ye(t){var e,i,n={};for(e in t)n[e]=null==(i=t[e])?{type:null}:("FeatureCollection"===i.type?Ve:"Feature"===i.type?We:Ke)(i);return n}function Ve(t){var e={type:"GeometryCollection",geometries:t.features.map(We)};return null!=t.bbox&&(e.bbox=t.bbox),e}function We(t){var e,i=Ke(t.geometry);for(e in null!=t.id&&(i.id=t.id),null!=t.bbox&&(i.bbox=t.bbox),t.properties){i.properties=t.properties;break}return i}function Ke(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(Ke)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function He(t,e){var i=function(t){var e=1/0,i=1/0,n=-1/0,r=-1/0;function o(t){null!=t&&De.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(o)},Point:function(t){a(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(a)},LineString:function(t){h(t.arcs)},MultiLineString:function(t){t.arcs.forEach(h)},Polygon:function(t){t.arcs.forEach(h)},MultiPolygon:function(t){t.arcs.forEach(l)}};function a(t){var o=t[0],s=t[1];o<e&&(e=o),o>n&&(n=o),s<i&&(i=s),s>r&&(r=s)}function h(t){t.forEach(a)}function l(t){t.forEach(h)}for(var u in t)o(t[u]);return n>=e&&r>=i?[e,i,n,r]:void 0}(t=Ye(t)),n=e>0&&i&&function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=o-n?(i-1)/(o-n):1,h=s-r?(i-1)/(s-r):1;function l(t){return[Math.round((t[0]-n)*a),Math.round((t[1]-r)*h)]}function u(t,e){for(var i,o,s,l,u,c=-1,p=0,f=t.length,d=new Array(f);++c<f;)i=t[c],l=Math.round((i[0]-n)*a),u=Math.round((i[1]-r)*h),l===o&&u===s||(d[p++]=[o=l,s=u]);for(d.length=p;p<e;)p=d.push([d[0][0],d[0][1]]);return d}function c(t){return u(t,2)}function p(t){return u(t,4)}function f(t){return t.map(p)}function d(t){null!=t&&De.call(g,t.type)&&g[t.type](t)}var g={GeometryCollection:function(t){t.geometries.forEach(d)},Point:function(t){t.coordinates=l(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(l)},LineString:function(t){t.arcs=c(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(c)},Polygon:function(t){t.arcs=f(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(f)}};for(var y in t)d(t[y]);return{scale:[1/a,1/h],translate:[n,r]}}(t,i,e),r=function(t){var e,i,n,r,o=t.coordinates,s=t.lines,a=t.rings,h=s.length+a.length;for(delete t.lines,delete t.rings,n=0,r=s.length;n<r;++n)for(e=s[n];e=e.next;)++h;for(n=0,r=a.length;n<r;++n)for(i=a[n];i=i.next;)++h;var l=Fe(2*h*1.4,qe,ke),u=t.arcs=[];for(n=0,r=s.length;n<r;++n){e=s[n];do{c(e)}while(e=e.next)}for(n=0,r=a.length;n<r;++n)if((i=a[n]).next)do{c(i)}while(i=i.next);else p(i);function c(t){var e,i,n,r,s,a,h,c;if(n=l.get(e=o[t[0]]))for(h=0,c=n.length;h<c;++h)if(f(r=n[h],t))return t[0]=r[0],void(t[1]=r[1]);if(s=l.get(i=o[t[1]]))for(h=0,c=s.length;h<c;++h)if(d(a=s[h],t))return t[1]=a[0],void(t[0]=a[1]);n?n.push(t):l.set(e,[t]),s?s.push(t):l.set(i,[t]),u.push(t)}function p(t){var e,i,n,r,s;if(i=l.get(o[t[0]]))for(r=0,s=i.length;r<s;++r){if(g(n=i[r],t))return t[0]=n[0],void(t[1]=n[1]);if(y(n,t))return t[0]=n[1],void(t[1]=n[0])}if(i=l.get(e=o[t[0]+_(t)]))for(r=0,s=i.length;r<s;++r){if(g(n=i[r],t))return t[0]=n[0],void(t[1]=n[1]);if(y(n,t))return t[0]=n[1],void(t[1]=n[0])}i?i.push(t):l.set(e,[t]),u.push(t)}function f(t,e){var i=t[0],n=e[0],r=t[1];if(i-r!=n-e[1])return!1;for(;i<=r;++i,++n)if(!ke(o[i],o[n]))return!1;return!0}function d(t,e){var i=t[0],n=e[0],r=t[1],s=e[1];if(i-r!=n-s)return!1;for(;i<=r;++i,--s)if(!ke(o[i],o[s]))return!1;return!0}function g(t,e){var i=t[0],n=e[0],r=t[1]-i;if(r!==e[1]-n)return!1;for(var s=_(t),a=_(e),h=0;h<r;++h)if(!ke(o[i+(h+s)%r],o[n+(h+a)%r]))return!1;return!0}function y(t,e){var i=t[0],n=e[0],r=t[1],s=e[1],a=r-i;if(a!==s-n)return!1;for(var h=_(t),l=a-_(e),u=0;u<a;++u)if(!ke(o[i+(u+h)%a],o[s-(u+l)%a]))return!1;return!0}function _(t){for(var e=t[0],i=t[1],n=e,r=n,s=o[n];++n<i;){var a=o[n];(a[0]<s[0]||a[0]===s[0]&&a[1]<s[1])&&(r=n,s=a)}return r-e}return t}(function(t){var e,i,n,r=Be(t),o=t.coordinates,s=t.lines,a=t.rings;for(i=0,n=s.length;i<n;++i)for(var h=s[i],l=h[0],u=h[1];++l<u;)r.has(o[l])&&(e={0:l,1:h[1]},h[1]=l,h=h.next=e);for(i=0,n=a.length;i<n;++i)for(var c=a[i],p=c[0],f=p,d=c[1],g=r.has(o[p]);++f<d;)r.has(o[f])&&(g?(e={0:f,1:c[1]},c[1]=f,c=c.next=e):(Ue(o,p,d,d-f),o[d]=o[p],g=!0,f=p));return t}(function(t){var e=-1,i=[],n=[],r=[];function o(t){t&&De.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(o)},LineString:function(t){t.arcs=a(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(a)},Polygon:function(t){t.arcs=t.arcs.map(h)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};function a(t){for(var n=0,o=t.length;n<o;++n)r[++e]=t[n];var s={0:e-o+1,1:e};return i.push(s),s}function h(t){for(var i=0,o=t.length;i<o;++i)r[++e]=t[i];var s={0:e-o+1,1:e};return n.push(s),s}function l(t){return t.map(h)}for(var u in t)o(t[u]);return{type:"Topology",coordinates:r,lines:i,rings:n,objects:t}}(t))),o=r.coordinates,s=Fe(1.4*r.arcs.length,Ze,Je);function a(t){t&&De.call(h,t.type)&&h[t.type](t)}t=r.objects,r.bbox=i,r.arcs=r.arcs.map((function(t,e){return s.set(t,e),o.slice(t[0],t[1]+1)})),delete r.coordinates,o=null;var h={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=l(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(l)},Polygon:function(t){t.arcs=t.arcs.map(l)},MultiPolygon:function(t){t.arcs=t.arcs.map(u)}};function l(t){var e=[];do{var i=s.get(t);e.push(t[0]<t[1]?i:~i)}while(t=t.next);return e}function u(t){return t.map(l)}for(var c in t)a(t[c]);return n&&(r.transform=n,r.arcs=function(t){for(var e=-1,i=t.length;++e<i;){for(var n,r,o=t[e],s=0,a=1,h=o.length,l=o[0],u=l[0],c=l[1];++s<h;)n=(l=o[s])[0],r=l[1],n===u&&r===c||(o[a++]=[n-u,r-c],u=n,c=r);1===a&&(o[a++]=[0,0]),o.length=a}return t}(r.arcs)),r}function Ze(t){var e,i=t[0],n=t[1];return n<i&&(e=i,i=n,n=e),i+31*n}function Je(t,e){var i,n=t[0],r=t[1],o=e[0],s=e[1];return r<n&&(i=n,n=r,r=i),s<o&&(i=o,o=s,s=i),n===o&&r===s}function Qe(t,e){if(void 0===e&&(e={}),"FeatureCollection"!==rt(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==e.mutate&&void 0!==e.mutate||(t=Me(t));var i=[];q(t,(function(t){i.push(t.geometry)}));var n=He({geoms:_(i).geometry});return function(t){return Le(t,Ae.apply(this,arguments))}(n,n.objects.geoms.geometries)}function $e(t,e){if(void 0===e&&(e={}),!P(e=e||{}))throw new Error("options is invalid");var i=e.mutate;if("FeatureCollection"!==rt(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==i&&void 0!==i||(t=Me(t));var n=function(t){var e={};q(t,(function(t){e[t.geometry.type]=!0}));var i=Object.keys(e);return 1===i.length?i[0]:null}(t);if(!n)throw new Error("geojson must be homogenous");var r=t;switch(n){case"LineString":return Ne(r,e);case"Polygon":return Qe(r,e);default:throw new Error(n+" is not supported")}}function ti(t,e){void 0===e&&(e={});var i="object"==typeof e?e.mutate:e;if(!t)throw new Error("geojson is required");var n=rt(t),r=[];switch(n){case"LineString":r=ei(t);break;case"MultiLineString":case"Polygon":Q(t).forEach((function(t){r.push(ei(t))}));break;case"MultiPolygon":Q(t).forEach((function(t){var e=[];t.forEach((function(t){e.push(ei(t))})),r.push(e)}));break;case"Point":return t;case"MultiPoint":var s={};Q(t).forEach((function(t){var e=t.join("-");Object.prototype.hasOwnProperty.call(s,e)||(r.push(t),s[e]=!0)}));break;default:throw new Error(n+" geometry not supported")}return t.coordinates?!0===i?(t.coordinates=r,t):{type:n,coordinates:r}:!0===i?(t.geometry.coordinates=r,t):o({type:n,coordinates:r},t.properties,{bbox:t.bbox,id:t.id})}function ei(t){var e=Q(t);if(2===e.length&&!ii(e[0],e[1]))return e;var i=[],n=e.length-1,r=i.length;i.push(e[0]);for(var o=1;o<n;o++){var s=i[i.length-1];e[o][0]===s[0]&&e[o][1]===s[1]||(i.push(e[o]),(r=i.length)>2&&ni(i[r-3],i[r-1],i[r-2])&&i.splice(i.length-2,1))}if(i.push(e[e.length-1]),r=i.length,ii(e[0],e[e.length-1])&&r<4)throw new Error("invalid polygon");return ni(i[r-3],i[r-1],i[r-2])&&i.splice(i.length-2,1),i}function ii(t,e){return t[0]===e[0]&&t[1]===e[1]}function ni(t,e,i){var n=i[0],r=i[1],o=t[0],s=t[1],a=e[0],h=e[1],l=a-o,u=h-s;return 0==(n-o)*u-(r-s)*l&&(Math.abs(l)>=Math.abs(u)?l>0?o<=n&&n<=a:a<=n&&n<=o:u>0?s<=r&&r<=h:h<=r&&r<=s)}function ri(t,e,i){var n=e.x,r=e.y,o=i.x-n,s=i.y-r;if(0!==o||0!==s){var a=((t.x-n)*o+(t.y-r)*s)/(o*o+s*s);a>1?(n=i.x,r=i.y):a>0&&(n+=o*a,r+=s*a)}return(o=t.x-n)*o+(s=t.y-r)*s}function oi(t,e,i,n,r){for(var o,s=n,a=e+1;a<i;a++){var h=ri(t[a],t[e],t[i]);h>s&&(o=a,s=h)}s>n&&(o-e>1&&oi(t,e,o,n,r),r.push(t[o]),i-o>1&&oi(t,o,i,n,r))}function si(t,e){var i=t.length-1,n=[t[0]];return oi(t,0,i,e,n),n.push(t[i]),n}function ai(t,e,i){if(t.length<=2)return t;var n=void 0!==e?e*e:1;return si(t=i?t:function(t,e){for(var i,n,r,o,s,a=t[0],h=[a],l=1,u=t.length;l<u;l++)r=a,o=void 0,s=void 0,(o=(n=i=t[l]).x-r.x)*o+(s=n.y-r.y)*s>e&&(h.push(i),a=i);return a!==i&&h.push(i),h}(t,n),n)}function hi(t,e,i){return ai(t.map((function(t){return{x:t[0],y:t[1],z:t[2]}})),e,i).map((function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]}))}function li(t,e,i){return t.map((function(t){var n=t.map((function(t){return{x:t[0],y:t[1]}}));if(n.length<4)throw new Error("invalid polygon");for(var r=ai(n,e,i).map((function(t){return[t.x,t.y]}));!ui(r);)r=ai(n,e-=.01*e,i).map((function(t){return[t.x,t.y]}));return r[r.length-1][0]===r[0][0]&&r[r.length-1][1]===r[0][1]||r.push(r[0]),r}))}function ui(t){return!(t.length<3||3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}var ci=function(){function t(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var i=this.points[e],n=this.points[e+1];this.centers.push({x:(i.x+n.x)/2,y:(i.y+n.y)/2,z:(i.z+n.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return t.prototype.cacheSteps=function(t){var e=[],i=this.pos(0);e.push(0);for(var n=0;n<this.duration;n+=10){var r=this.pos(n);Math.sqrt((r.x-i.x)*(r.x-i.x)+(r.y-i.y)*(r.y-i.y)+(r.z-i.z)*(r.z-i.z))>t&&(e.push(n),i=r)}return e},t.prototype.vector=function(t){var e=this.pos(t+10),i=this.pos(t-10);return{angle:180*Math.atan2(e.y-i.y,e.x-i.x)/3.14,speed:Math.sqrt((i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y)+(i.z-e.z)*(i.z-e.z))}},t.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var i=e/this.duration;if(i>=1)return this.points[this.length-1];var n=Math.floor((this.points.length-1)*i);return function(t,e,i,n,r){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:r.x*o[0]+n.x*o[1]+i.x*o[2]+e.x*o[3],y:r.y*o[0]+n.y*o[1]+i.y*o[2]+e.y*o[3],z:r.z*o[0]+n.z*o[1]+i.z*o[2]+e.z*o[3]}}((this.length-1)*i-n,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1])},t}();function pi(t,e){void 0===e&&(e={});for(var i=e.resolution||1e4,n=e.sharpness||.85,r=[],o=nt(t).coordinates.map((function(t){return{x:t[0],y:t[1]}})),s=new ci({duration:i,points:o,sharpness:n}),a=function(t){var e=s.pos(t);Math.floor(t/100)%2==0&&r.push([e.x,e.y])},h=0;h<s.duration;h+=10)a(h);return a(s.duration),c(r,e.properties)}function fi(t,e){void 0===e&&(e={});var i=Number(t[0]),n=Number(t[1]),r=Number(t[2]),o=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[i,n];return l([[s,[r,n],[r,o],[i,o],s]],e.properties,{bbox:t,id:e.id})}function di(t){return fi(Z(t))}function gi(t){var e=t[0],i=t[1],n=t[2],r=t[3];if(ve(t.slice(0,2),[n,i])>=ve(t.slice(0,2),[e,r])){var o=(i+r)/2;return[e,o-(n-e)/2,n,o+(n-e)/2]}var s=(e+n)/2;return[s-(r-i)/2,i,s+(r-i)/2,r]}function yi(t,e,i,n){void 0===n&&(n={});var r=J(t),o=M(r[0]),s=M(r[1]),h=M(i),l=x(e,n.units),u=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(h));return a([b(o+Math.atan2(Math.sin(h)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(u))),b(u)],n.properties)}function _i(t,e,i){void 0===i&&(i={});for(var n=i.steps||64,r=i.properties?i.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},o=[],s=0;s<n;s++)o.push(yi(t,e,-360*s/n,i).geometry.coordinates);return o.push(o[0]),l([o],r)}function mi(t,e,i){if(void 0===i&&(i={}),!0===i.final)return function(t,e){var i=mi(e,t);return(i+180)%360}(t,e);var n=J(t),r=J(e),o=M(n[0]),s=M(r[0]),a=M(n[1]),h=M(r[1]),l=Math.sin(s-o)*Math.cos(h),u=Math.cos(a)*Math.sin(h)-Math.sin(a)*Math.cos(h)*Math.cos(s-o);return b(Math.atan2(l,u))}function vi(t,e){void 0===e&&(e={});var i=Z(t);return a([(i[0]+i[2])/2,(i[1]+i[3])/2],e.properties,e)}function xi(t,e){void 0===e&&(e={});var i=0,n=0,r=0;return L(t,(function(t){i+=t[0],n+=t[1],r++}),!0),a([i/r,n/r],e.properties)}function Ei(t){var e=[];return"FeatureCollection"===t.type?F(t,(function(t){L(t,(function(i){e.push(a(i,t.properties))}))})):L(t,(function(i){e.push(a(i,t.properties))})),f(e)}var wi=Mi,bi=Mi;function Mi(t,e,i){i=i||2;var n,r,o,s,a,h,l,u=e&&e.length,c=u?e[0]*i:t.length,p=Ci(t,0,c,i,!0),f=[];if(!p)return f;if(u&&(p=function(t,e,i,n){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=Ci(t,e[r]*n,r<o-1?e[r+1]*n:t.length,n,!1))===s.next&&(s.steiner=!0),a.push(Di(s));for(a.sort(Li),r=0;r<a.length;r++)Oi(a[r],i),i=Ii(i,i.next);return i}(t,e,p,i)),t.length>80*i){n=o=t[0],r=s=t[1];for(var d=i;d<c;d+=i)(a=t[d])<n&&(n=a),(h=t[d+1])<r&&(r=h),a>o&&(o=a),h>s&&(s=h);l=0!==(l=Math.max(o-n,s-r))?1/l:0}return Si(p,f,i,n,r,l),f}function Ci(t,e,i,n,r){var o,s;if(r===Vi(t,e,i,n)>0)for(o=e;o<i;o+=n)s=Ui(o,t[o],t[o+1],s);else for(o=i-n;o>=e;o-=n)s=Ui(o,t[o],t[o+1],s);return s&&zi(s,s.next)&&(Xi(s),s=s.next),s}function Ii(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!zi(n,n.next)&&0!==Gi(n.prev,n,n.next))n=n.next;else{if(Xi(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function Si(t,e,i,n,r,o,s){if(t){!s&&o&&function(t,e,i,n){var r=t;do{null===r.z&&(r.z=Ai(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,o,s,a,h,l=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,n=i,a=0,e=0;e<l&&(a++,n=n.nextZ);e++);for(h=l;a>0||h>0&&n;)0!==a&&(0===h||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,h--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,l*=2}while(s>1)}(r)}(t,n,r,o);for(var a,h,l=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?Ni(t,n,r,o):Pi(t))e.push(a.i/i),e.push(t.i/i),e.push(h.i/i),Xi(t),t=h.next,l=h.next;else if((t=h)===l){s?1===s?Si(t=Ri(t,e,i),e,i,n,r,o,2):2===s&&Ti(t,e,i,n,r,o):Si(Ii(t),e,i,n,r,o,1);break}}}function Pi(t){var e=t.prev,i=t,n=t.next;if(Gi(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(Fi(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&Gi(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Ni(t,e,i,n){var r=t.prev,o=t,s=t.next;if(Gi(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,h=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,l=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,u=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,c=Ai(a,h,e,i,n),p=Ai(l,u,e,i,n),f=t.prevZ,d=t.nextZ;f&&f.z>=c&&d&&d.z<=p;){if(f!==t.prev&&f!==t.next&&Fi(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Gi(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,d!==t.prev&&d!==t.next&&Fi(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&Gi(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&Fi(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Gi(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&Fi(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&Gi(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Ri(t,e,i){var n=t;do{var r=n.prev,o=n.next.next;!zi(r,o)&&ji(r,n,n.next,o)&&qi(r,o)&&qi(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),Xi(n),Xi(n.next),n=t=o),n=n.next}while(n!==t);return n}function Ti(t,e,i,n,r,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&ki(s,a)){var h=Bi(s,a);return s=Ii(s,s.next),h=Ii(h,h.next),Si(s,e,i,n,r,o),void Si(h,e,i,n,r,o)}a=a.next}s=s.next}while(s!==t)}function Li(t,e){return t.x-e.x}function Oi(t,e){if(e=function(t,e){var i,n=e,r=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s){if(s=a,a===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===s)return i.prev;var h,l=i,u=i.x,c=i.y,p=1/0;for(n=i.next;n!==l;)r>=n.x&&n.x>=u&&r!==n.x&&Fi(o<c?r:s,o,u,c,o<c?s:r,o,n.x,n.y)&&((h=Math.abs(o-n.y)/(r-n.x))<p||h===p&&n.x>i.x)&&qi(n,t)&&(i=n,p=h),n=n.next;return i}(t,e)){var i=Bi(e,t);Ii(i,i.next)}}function Ai(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Di(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function Fi(t,e,i,n,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(n-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(r-s)*(n-a)>=0}function ki(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&ji(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&qi(t,e)&&qi(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)}function Gi(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function zi(t,e){return t.x===e.x&&t.y===e.y}function ji(t,e,i,n){return!!(zi(t,e)&&zi(i,n)||zi(t,n)&&zi(i,e))||Gi(t,e,i)>0!=Gi(t,e,n)>0&&Gi(i,n,t)>0!=Gi(i,n,e)>0}function qi(t,e){return Gi(t.prev,t,t.next)<0?Gi(t,e,t.next)>=0&&Gi(t,t.prev,e)>=0:Gi(t,e,t.prev)<0||Gi(t,t.next,e)<0}function Bi(t,e){var i=new Yi(t.i,t.x,t.y),n=new Yi(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function Ui(t,e,i,n){var r=new Yi(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Xi(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Yi(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Vi(t,e,i,n){for(var r=0,o=e,s=i-n;o<i;o+=n)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}function Wi(t){var e=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)i.vertices.push(t[r][o][s]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}(t),i=wi(e.vertices,e.holes,2),n=[],r=[];i.forEach((function(t,n){var o=i[n];r.push([e.vertices[2*o],e.vertices[2*o+1]])}));for(var o=0;o<r.length;o+=3){var s=r.slice(o,o+3);s.push(r[o]),n.push(l([s]))}return n}function Ki(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var i,n=1/0,r=0;return F(e,(function(e,i){var o=ve(t,e);o<n&&(r=i,n=o)})),(i=Me(e.features[r])).properties.featureIndex=r,i.properties.distanceToPoint=n,i}function Hi(t){if(!t)throw new Error("geojson is required");var e=[];return q(t,(function(t){!function(t,e){var i=[],n=t.geometry;if(null!==n){switch(n.type){case"Polygon":i=Q(n);break;case"LineString":i=[Q(n)]}i.forEach((function(i){(function(t,e){var i=[];return t.reduce((function(t,n){var r=c([t,n],e);return r.bbox=function(t,e){var i=t[0],n=t[1],r=e[0],o=e[1];return[i<r?i:r,n<o?n:o,i>r?i:r,n>o?n:o]}(t,n),i.push(r),n})),i})(i,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),f(e)}Mi.deviation=function(t,e,i,n){var r=e&&e.length,o=r?e[0]*i:t.length,s=Math.abs(Vi(t,0,o,i));if(r)for(var a=0,h=e.length;a<h;a++){var l=e[a]*i,u=a<h-1?e[a+1]*i:t.length;s-=Math.abs(Vi(t,l,u,i))}var c=0;for(a=0;a<n.length;a+=3){var p=n[a]*i,f=n[a+1]*i,d=n[a+2]*i;c+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},Mi.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)i.vertices.push(t[r][o][s]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i},wi.default=bi;var Zi=jt((function(t,e){function i(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function n(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(t[0])||!f(t[1]))throw new Error("coordinates must contain numbers");return i({type:"Point",coordinates:t},e,n)}function r(t,e,n){void 0===n&&(n={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return i({type:"Polygon",coordinates:t},e,n)}function o(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return i({type:"LineString",coordinates:t},e,n)}function s(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function a(t,e,n){return void 0===n&&(n={}),i({type:"MultiLineString",coordinates:t},e,n)}function h(t,e,n){return void 0===n&&(n={}),i({type:"MultiPoint",coordinates:t},e,n)}function l(t,e,n){return void 0===n&&(n={}),i({type:"MultiPolygon",coordinates:t},e,n)}function u(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t*n}function c(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t/n}function p(t){return t%(2*Math.PI)*180/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=i,e.geometry=function(t,e,i){switch(t){case"Point":return n(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return h(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return l(e).geometry;default:throw new Error(t+" is invalid")}},e.point=n,e.points=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return n(t,e)})),i)},e.polygon=r,e.polygons=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return r(t,e)})),i)},e.lineString=o,e.lineStrings=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return o(t,e)})),i)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=h,e.multiPolygon=l,e.geometryCollection=function(t,e,n){return void 0===n&&(n={}),i({type:"GeometryCollection",geometries:t},e,n)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i},e.radiansToLength=u,e.lengthToRadians=c,e.lengthToDegrees=function(t,e){return p(c(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=p,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("length must be a positive number");return u(c(t,e),i)},e.convertArea=function(t,i,n){if(void 0===i&&(i="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[i];if(!r)throw new Error("invalid original units");var o=e.areaFactors[n];if(!o)throw new Error("invalid final units");return t/r*o},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}}));function Ji(t,e,i){if(null!==t)for(var n,r,o,s,a,h,l,u,c=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,y=d?t.features.length:1,_=0;_<y;_++){a=(u=!!(l=d?t.features[_].geometry:g?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var m=0;m<a;m++){var v=0,x=0;if(null!==(s=u?l.geometries[m]:l)){h=s.coordinates;var E=s.type;switch(c=!i||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case"Point":if(!1===e(h,p,_,v,x))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<h.length;n++){if(!1===e(h[n],p,_,v,x))return!1;p++,"MultiPoint"===E&&v++}"LineString"===E&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<h.length;n++){for(r=0;r<h[n].length-c;r++){if(!1===e(h[n][r],p,_,v,x))return!1;p++}"MultiLineString"===E&&v++,"Polygon"===E&&x++}"Polygon"===E&&v++;break;case"MultiPolygon":for(n=0;n<h.length;n++){for(x=0,r=0;r<h[n].length;r++){for(o=0;o<h[n][r].length-c;o++){if(!1===e(h[n][r][o],p,_,v,x))return!1;p++}x++}v++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===Ji(s.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Qi(t,e){var i;switch(t.type){case"FeatureCollection":for(i=0;i<t.features.length&&!1!==e(t.features[i].properties,i);i++);break;case"Feature":e(t.properties,0)}}function $i(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function tn(t,e){var i,n,r,o,s,a,h,l,u,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(i=0;i<g;i++){for(a=f?t.features[i].geometry:d?t.geometry:t,l=f?t.features[i].properties:d?t.properties:{},u=f?t.features[i].bbox:d?t.bbox:void 0,c=f?t.features[i].id:d?t.id:void 0,s=(h=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=h?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,l,u,c))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],p,l,u,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,l,u,c))return!1;p++}}function en(t,e){tn(t,(function(t,i,n,r,o){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Zi.feature(t,n,{bbox:r,id:o}),i,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var h=0;h<t.coordinates.length;h++){var l={type:s,coordinates:t.coordinates[h]};if(!1===e(Zi.feature(l,n),i,h))return!1}}))}function nn(t,e){en(t,(function(t,i,n){var r=0;if(t.geometry){var o=t.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var s,a=0,h=0,l=0;return!1!==Ji(t,(function(o,u,c,p,f){if(void 0===s||i>a||p>h||f>l)return s=o,a=i,h=p,l=f,void(r=0);var d=Zi.lineString([s,o],t.properties);if(!1===e(d,i,n,f,r))return!1;r++,s=o}))&&void 0}}}))}function rn(t,e){if(!t)throw new Error("geojson is required");en(t,(function(t,i,n){if(null!==t.geometry){var r=t.geometry.type,o=t.geometry.coordinates;switch(r){case"LineString":if(!1===e(t,i,n,0,0))return!1;break;case"Polygon":for(var s=0;s<o.length;s++)if(!1===e(Zi.lineString(o[s],t.properties),i,n,s))return!1}}}))}var on=function(t){var e=[];return Ji(t,(function(t){e.push(t)})),e},sn=Ji,an=function(t,e,i,n){var r=i;return Ji(t,(function(t,n,o,s,a){r=0===n&&void 0===i?t:e(r,t,n,o,s,a)}),n),r},hn=$i,ln=function(t,e,i){var n=i;return $i(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n},un=function(t,e){if(e=e||{},!Zi.isObject(e))throw new Error("options is invalid");var i,n=e.featureIndex||0,r=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.coordIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),a=a||t.features[n].properties,i=t.features[n].geometry;break;case"Feature":a=a||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var h=i.coordinates;switch(i.type){case"Point":return Zi.point(h,a,e);case"MultiPoint":return r<0&&(r=h.length+r),Zi.point(h[r],a,e);case"LineString":return s<0&&(s=h.length+s),Zi.point(h[s],a,e);case"Polygon":return o<0&&(o=h.length+o),s<0&&(s=h[o].length+s),Zi.point(h[o][s],a,e);case"MultiLineString":return r<0&&(r=h.length+r),s<0&&(s=h[r].length+s),Zi.point(h[r][s],a,e);case"MultiPolygon":return r<0&&(r=h.length+r),o<0&&(o=h[r].length+o),s<0&&(s=h[r][o].length-s),Zi.point(h[r][o][s],a,e)}throw new Error("geojson is invalid")},cn=function(t,e){if(e=e||{},!Zi.isObject(e))throw new Error("options is invalid");var i,n=e.featureIndex||0,r=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.segmentIndex||0,a=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),a=a||t.features[n].properties,i=t.features[n].geometry;break;case"Feature":a=a||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var h=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=h.length+s-1),Zi.lineString([h[s],h[s+1]],a,e);case"Polygon":return o<0&&(o=h.length+o),s<0&&(s=h[o].length+s-1),Zi.lineString([h[o][s],h[o][s+1]],a,e);case"MultiLineString":return r<0&&(r=h.length+r),s<0&&(s=h[r].length+s-1),Zi.lineString([h[r][s],h[r][s+1]],a,e);case"MultiPolygon":return r<0&&(r=h.length+r),o<0&&(o=h[r].length+o),s<0&&(s=h[r][o].length-s-1),Zi.lineString([h[r][o][s],h[r][o][s+1]],a,e)}throw new Error("geojson is invalid")},pn=en,fn=function(t,e,i){var n=i;return en(t,(function(t,r,o){n=0===r&&0===o&&void 0===i?t:e(n,t,r,o)})),n},dn=tn,gn=function(t,e,i){var n=i;return tn(t,(function(t,r,o,s,a){n=0===r&&void 0===i?t:e(n,t,r,o,s,a)})),n},yn=rn,_n=function(t,e,i){var n=i;return rn(t,(function(t,r,o,s){n=0===r&&void 0===i?t:e(n,t,r,o,s)})),n},mn=Qi,vn=function(t,e,i){var n=i;return Qi(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n},xn=nn,En=function(t,e,i){var n=i,r=!1;return nn(t,(function(t,o,s,a,h){n=!1===r&&void 0===i?t:e(n,t,o,s,a,h),r=!0})),n},wn=Object.defineProperty({coordAll:on,coordEach:sn,coordReduce:an,featureEach:hn,featureReduce:ln,findPoint:un,findSegment:cn,flattenEach:pn,flattenReduce:fn,geomEach:dn,geomReduce:gn,lineEach:yn,lineReduce:_n,propEach:mn,propReduce:vn,segmentEach:xn,segmentReduce:En},"__esModule",{value:!0});function bn(t){var e=[1/0,1/0,-1/0,-1/0];return wn.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}bn.default=bn;var Mn=bn,Cn=Object.defineProperty({default:Mn},"__esModule",{value:!0}).default,In=wn.featureEach,Sn=(wn.coordEach,Zi.polygon,Zi.featureCollection);function Pn(t){var e=Ct(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Cn(t),Ct.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:Cn(t),e.push(t)})):In(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:Cn(t),e.push(t)})),Ct.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:Cn(t),Ct.prototype.remove.call(this,t,e)},e.clear=function(){return Ct.prototype.clear.call(this)},e.search=function(t){var e=Ct.prototype.search.call(this,this.toBBox(t));return Sn(e)},e.collides=function(t){return Ct.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=Ct.prototype.all.call(this);return Sn(t)},e.toJSON=function(){return Ct.prototype.toJSON.call(this)},e.fromJSON=function(t){return Ct.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=Cn(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=Cn(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}var Nn=Pn,Rn=Pn;function Tn(t,e){var i={},n=[];if("LineString"===t.type&&(t=o(t)),"LineString"===e.type&&(e=o(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var r=Ln(t,e);return r&&n.push(r),f(n)}var s=Nn();return s.load(Hi(e)),F(Hi(t),(function(t){F(s.search(t),(function(e){var r=Ln(t,e);if(r){var o=Q(r).join(",");i[o]||(i[o]=!0,n.push(r))}}))})),f(n)}function Ln(t,e){var i=Q(t),n=Q(e);if(2!==i.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=i[0][0],o=i[0][1],s=i[1][0],h=i[1][1],l=n[0][0],u=n[0][1],c=n[1][0],p=n[1][1],f=(p-u)*(s-r)-(c-l)*(h-o);if(0===f)return null;var d=((c-l)*(o-u)-(p-u)*(r-l))/f,g=((s-r)*(o-u)-(h-o)*(r-l))/f;return d>=0&&d<=1&&g>=0&&g<=1?a([r+d*(s-r),o+d*(h-o)]):null}function On(t,e,i){void 0===i&&(i={});var n=a([1/0,1/0],{dist:1/0}),r=0;return q(t,(function(t){for(var o=Q(t),s=0;s<o.length-1;s++){var h=a(o[s]);h.properties.dist=ve(e,h,i);var l=a(o[s+1]);l.properties.dist=ve(e,l,i);var u=ve(h,l,i),p=Math.max(h.properties.dist,l.properties.dist),f=mi(h,l),d=yi(e,p,f+90,i),g=yi(e,p,f-90,i),y=Tn(c([d.geometry.coordinates,g.geometry.coordinates]),c([h.geometry.coordinates,l.geometry.coordinates])),_=null;y.features.length>0&&((_=y.features[0]).properties.dist=ve(e,_,i),_.properties.location=r+ve(h,_,i)),h.properties.dist<n.properties.dist&&((n=h).properties.index=s,n.properties.location=r),l.properties.dist<n.properties.dist&&((n=l).properties.index=s+1,n.properties.location=r+u),_&&_.properties.dist<n.properties.dist&&((n=_).properties.index=s),r+=u}})),n}function An(t,i,n){void 0===n&&(n={});var r=J(t),o=J(i);return o[0]+=o[0]-r[0]>180?-360:r[0]-o[0]>180?360:0,C(function(t,i,n){var r=n=void 0===n?e:Number(n),o=t[1]*Math.PI/180,s=i[1]*Math.PI/180,a=s-o,h=Math.abs(i[0]-t[0])*Math.PI/180;h>Math.PI&&(h-=2*Math.PI);var l=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),u=Math.abs(l)>1e-11?a/l:Math.cos(o);return Math.sqrt(a*a+u*u*h*h)*r}(r,o),"meters",n.units)}function Dn(t,e,i){if(void 0===i&&(i={}),i.method||(i.method="geodesic"),i.units||(i.units="kilometers"),!t)throw new Error("pt is required");if(Array.isArray(t)?t=a(t):"Point"===t.type?t=o(t):et(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=c(e):"LineString"===e.type?e=o(e):et(e,"LineString","line");var n=1/0,r=t.geometry.coordinates;return U(e,(function(t){var e=t.geometry.coordinates[0],o=t.geometry.coordinates[1],s=function(t,e,i,n){var r=[i[0]-e[0],i[1]-e[1]],o=Fn([t[0]-e[0],t[1]-e[1]],r);if(o<=0)return kn(t,e,{method:n.method,units:"degrees"});var s=Fn(r,r);if(s<=o)return kn(t,i,{method:n.method,units:"degrees"});var a=o/s;return kn(t,[e[0]+a*r[0],e[1]+a*r[1]],{method:n.method,units:"degrees"})}(r,e,o,i);s<n&&(n=s)})),C(n,"degrees",i.units)}function Fn(t,e){return t[0]*e[0]+t[1]*e[1]}function kn(t,e,i){return"planar"===i.method?An(t,e,i):ve(t,e,i)}function Gn(t,e,i,n,r,o,s,a){var h,l,u,c,p={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(h=(a-o)*(i-t)-(s-r)*(n-e))?null!==p.x&&null!==p.y&&p:(c=(i-t)*(l=e-o)-(n-e)*(u=t-r),l=((s-r)*l-(a-o)*u)/h,u=c/h,p.x=t+l*(i-t),p.y=e+l*(n-e),l>=0&&l<=1&&(p.onLine1=!0),u>=0&&u<=1&&(p.onLine2=!0),!(!p.onLine1||!p.onLine2)&&[p.x,p.y])}function zn(t){for(var e=function(t){return"FeatureCollection"!==t.type?"Feature"!==t.type?f([o(t)]):f([t]):t}(t),i=vi(e),n=!1,r=0;!n&&r<e.features.length;){var s,h=e.features[r].geometry,l=!1;if("Point"===h.type)i.geometry.coordinates[0]===h.coordinates[0]&&i.geometry.coordinates[1]===h.coordinates[1]&&(n=!0);else if("MultiPoint"===h.type){var u=!1;for(s=0;!u&&s<h.coordinates.length;)i.geometry.coordinates[0]===h.coordinates[s][0]&&i.geometry.coordinates[1]===h.coordinates[s][1]&&(n=!0,u=!0),s++}else if("LineString"===h.type)for(s=0;!l&&s<h.coordinates.length-1;)jn(i.geometry.coordinates[0],i.geometry.coordinates[1],h.coordinates[s][0],h.coordinates[s][1],h.coordinates[s+1][0],h.coordinates[s+1][1])&&(l=!0,n=!0),s++;else if("MultiLineString"===h.type)for(var c=0;c<h.coordinates.length;){l=!1,s=0;for(var p=h.coordinates[c];!l&&s<p.length-1;)jn(i.geometry.coordinates[0],i.geometry.coordinates[1],p[s][0],p[s][1],p[s+1][0],p[s+1][1])&&(l=!0,n=!0),s++;c++}else"Polygon"!==h.type&&"MultiPolygon"!==h.type||ye(i,h)&&(n=!0);r++}if(n)return i;var d=f([]);for(r=0;r<e.features.length;r++)d.features=d.features.concat(Ei(e.features[r]).features);return a(Ki(i,d).geometry.coordinates)}function jn(t,e,i,n,r,o){return Math.sqrt((r-i)*(r-i)+(o-n)*(o-n))===Math.sqrt((t-i)*(t-i)+(e-n)*(e-n))+Math.sqrt((r-t)*(r-t)+(o-e)*(o-e))}Nn.default=Rn;var qn=6378137;function Bn(t){return j(t,(function(t,e){return t+function(t){var e,i=0;switch(t.type){case"Polygon":return Un(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=Un(t.coordinates[e]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function Un(t){var e=0;if(t&&t.length>0){e+=Math.abs(Xn(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(Xn(t[i]))}return e}function Xn(t){var e,i,n,r,o,s,a=0,h=t.length;if(h>2){for(s=0;s<h;s++)s===h-2?(n=h-2,r=h-1,o=0):s===h-1?(n=h-1,r=0,o=1):(n=s,r=s+1,o=s+2),e=t[n],i=t[r],a+=(Yn(t[o][0])-Yn(e[0]))*Math.sin(Yn(i[1]));a=a*qn*qn/2}return a}function Yn(t){return t*Math.PI/180}function Vn(t,e){return void 0===e&&(e={}),X(t,(function(t,i){var n=i.geometry.coordinates;return t+ve(n[0],n[1],e)}),0)}function Wn(t,e,i,n){if(!P(n=n||{}))throw new Error("options is invalid");var r,o=[];if("Feature"===t.type)r=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");r=t.coordinates}for(var s,a,h,l=r.length,u=0,p=0;p<r.length&&!(e>=u&&p===r.length-1);p++){if(u>e&&0===o.length){if(!(s=e-u))return o.push(r[p]),c(o);a=mi(r[p],r[p-1])-180,h=yi(r[p],s,a,n),o.push(h.geometry.coordinates)}if(u>=i)return(s=i-u)?(a=mi(r[p],r[p-1])-180,h=yi(r[p],s,a,n),o.push(h.geometry.coordinates),c(o)):(o.push(r[p]),c(o));if(u>=e&&o.push(r[p]),p===r.length-1)return c(o);u+=ve(r[p],r[p+1],n)}if(u<e&&r.length===l)throw new Error("Start position is beyond line");var f=r[r.length-1];return c([f,f])}function Kn(t,e,i){void 0===i&&(i={});for(var n=J(t),r=Q(e),o=0;o<r.length-1;o++){var s=!1;if(i.ignoreEndVertices&&(0===o&&(s="start"),o===r.length-2&&(s="end"),0===o&&o+1===r.length-1&&(s="both")),Hn(r[o],r[o+1],n,s,void 0===i.epsilon?null:i.epsilon))return!0}return!1}function Hn(t,e,i,n,r){var o=i[0],s=i[1],a=t[0],h=t[1],l=e[0],u=e[1],c=l-a,p=u-h,f=(i[0]-a)*p-(i[1]-h)*c;if(null!==r){if(Math.abs(f)>r)return!1}else if(0!==f)return!1;return n?"start"===n?Math.abs(c)>=Math.abs(p)?c>0?a<o&&o<=l:l<=o&&o<a:p>0?h<s&&s<=u:u<=s&&s<h:"end"===n?Math.abs(c)>=Math.abs(p)?c>0?a<=o&&o<l:l<o&&o<=a:p>0?h<=s&&s<u:u<s&&s<=h:"both"===n&&(Math.abs(c)>=Math.abs(p)?c>0?a<o&&o<l:l<o&&o<a:p>0?h<s&&s<u:u<s&&s<h):Math.abs(c)>=Math.abs(p)?c>0?a<=o&&o<=l:l<=o&&o<=a:p>0?h<=s&&s<=u:u<=s&&s<=h}function Zn(t,e){var i=nt(t),n=nt(e),r=i.type,o=n.type;switch(r){case"Point":switch(o){case"MultiPoint":return function(t,e){var i,n=!1;for(i=0;i<e.coordinates.length;i++)if(Qn(e.coordinates[i],t.coordinates)){n=!0;break}return n}(i,n);case"LineString":return Kn(i,n,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return ye(i,n,{ignoreBoundary:!0});default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"MultiPoint":return function(t,e){for(var i=0;i<t.coordinates.length;i++){for(var n=!1,r=0;r<e.coordinates.length;r++)Qn(t.coordinates[i],e.coordinates[r])&&(n=!0);if(!n)return!1}return!0}(i,n);case"LineString":return function(t,e){for(var i=!1,n=0;n<t.coordinates.length;n++){if(!Kn(t.coordinates[n],e))return!1;i||(i=Kn(t.coordinates[n],e,{ignoreEndVertices:!0}))}return i}(i,n);case"Polygon":case"MultiPolygon":return function(t,e){for(var i=!0,n=!1,r=0;r<t.coordinates.length;r++){if(!(n=ye(t.coordinates[1],e))){i=!1;break}n=ye(t.coordinates[1],e,{ignoreBoundary:!0})}return i&&n}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"LineString":return function(t,e){for(var i=0;i<t.coordinates.length;i++)if(!Kn(t.coordinates[i],e))return!1;return!0}(i,n);case"Polygon":case"MultiPolygon":return function(t,e){if(!Jn(Z(e),Z(t)))return!1;for(var i=!1,n=0;n<t.coordinates.length-1;n++){if(!ye(t.coordinates[n],e))return!1;i||(i=ye(t.coordinates[n],e,{ignoreBoundary:!0})),i||(i=ye($n(t.coordinates[n],t.coordinates[n+1]),e,{ignoreBoundary:!0}))}return i}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Polygon":case"MultiPolygon":return function(t,e){var i=Z(t);if(!Jn(Z(e),i))return!1;for(var n=0;n<t.coordinates[0].length;n++)if(!ye(t.coordinates[0][n],e))return!1;return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}}function Jn(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function Qn(t,e){return t[0]===e[0]&&t[1]===e[1]}function $n(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function tr(t,e,i){void 0===i&&(i={}),i.mask&&!i.units&&(i.units="kilometers");for(var n=[],r=t[0],o=t[1],s=t[2],h=t[3],l=e/ve([r,o],[s,o],i)*(s-r),u=e/ve([r,o],[r,h],i)*(h-o),c=s-r,p=h-o,d=Math.floor(c/l),g=(p-Math.floor(p/u)*u)/2,y=r+(c-d*l)/2;y<=s;){for(var _=o+g;_<=h;){var m=a([y,_],i.properties);i.mask?Zn(m,i.mask)&&n.push(m):n.push(m),_+=u}y+=l}return f(n)}function er(t,e){void 0===e&&(e={});var i=e.precision,n=e.coordinates,r=e.mutate;if(i=null==i||isNaN(i)?6:i,n=null==n||isNaN(n)?3:n,!t)throw new Error("<geojson> is required");if("number"!=typeof i)throw new Error("<precision> must be a number");if("number"!=typeof n)throw new Error("<coordinates> must be a number");!1!==r&&void 0!==r||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,i);return L(t,(function(t){!function(t,e,i){t.length>i&&t.splice(i,t.length);for(var n=0;n<t.length;n++)t[n]=Math.round(t[n]*e)/e}(t,o,n)})),t}function ir(t){if(!t)throw new Error("geojson is required");var e=[];return q(t,(function(t){e.push(t)})),f(e)}function nr(t,e,i){if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===i&&(i=1);var n=t.geometry.coordinates,r=[],o={};if(i){for(var s=[],a=0;a<n.length;a++)for(var h=0;h<n[a].length-1;h++)s.push(g(a,h));var l=Ct();l.load(s)}for(var u=0;u<n.length;u++)for(var c=0;c<n[u].length-1;c++)if(i)l.search(g(u,c)).forEach((function(t){var e=t.ring,i=t.edge;d(u,c,e,i)}));else for(var p=0;p<n.length;p++)for(var f=0;f<n[p].length-1;f++)d(u,c,p,f);return e||(r={type:"Feature",geometry:{type:"MultiPoint",coordinates:r}}),r;function d(t,i,s,a){var h,l,u=n[t][i],c=n[t][i+1],p=n[s][a],f=n[s][a+1],d=function(t,e,i,n){if(rr(t,i)||rr(t,n)||rr(e,i)||rr(n,i))return null;var r=t[0],o=t[1],s=e[0],a=e[1],h=i[0],l=i[1],u=n[0],c=n[1],p=(r-s)*(l-c)-(o-a)*(h-u);return 0===p?null:[((r*a-o*s)*(h-u)-(r-s)*(h*c-l*u))/p,((r*a-o*s)*(l-c)-(o-a)*(h*c-l*u))/p]}(u,c,p,f);if(null!==d&&(h=c[0]!==u[0]?(d[0]-u[0])/(c[0]-u[0]):(d[1]-u[1])/(c[1]-u[1]),l=f[0]!==p[0]?(d[0]-p[0])/(f[0]-p[0]):(d[1]-p[1])/(f[1]-p[1]),!(h>=1||h<=0||l>=1||l<=0))){var g=d,y=!o[g];y&&(o[g]=!0),e?r.push(e(d,t,i,u,c,h,s,a,p,f,l,y)):r.push(d)}}function g(t,e){var i,r,o,s,a=n[t][e],h=n[t][e+1];return a[0]<h[0]?(i=a[0],r=h[0]):(i=h[0],r=a[0]),a[1]<h[1]?(o=a[1],s=h[1]):(o=h[1],s=a[1]),{minX:i,minY:o,maxX:r,maxY:s,ring:t,edge:e}}}function rr(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]instanceof Array&&e[i]instanceof Array){if(!rr(t[i],e[i]))return!1}else if(t[i]!==e[i])return!1;return!0}function or(t){if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var e=t.geometry.coordinates.length,i=[],n=0;n<e;n++){var r=t.geometry.coordinates[n];ur(r[0],r[r.length-1])||r.push(r[0]),i.push.apply(i,r.slice(0,r.length-1))}if(!function(t){for(var e={},i=1,n=0,r=t.length;n<r;++n){if(Object.prototype.hasOwnProperty.call(e,t[n])){i=0;break}e[t[n]]=1}return i}(i))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=i.length,s=nr(t,(function(t,e,i,n,r,o,s,a,h,l,u,c){return[t,e,i,n,r,o,s,a,h,l,u,c]})),a=s.length;if(0==a){var h=[];for(n=0;n<e;n++)h.push(l([t.geometry.coordinates[n]],{parent:-1,winding:lr(t.geometry.coordinates[n])}));var u=f(h);return G(),z(),u}var c=[],p=[];for(n=0;n<e;n++){c.push([]);for(var d=0;d<t.geometry.coordinates[n].length-1;d++)c[n].push([new sr(t.geometry.coordinates[n][cr(d+1,t.geometry.coordinates[n].length-1)],1,[n,d],[n,cr(d+1,t.geometry.coordinates[n].length-1)],void 0)]),p.push(new ar(t.geometry.coordinates[n][d],[n,cr(d-1,t.geometry.coordinates[n].length-1)],[n,d],void 0,void 0,!1,!0))}for(n=0;n<a;n++)c[s[n][1]][s[n][2]].push(new sr(s[n][0],s[n][5],[s[n][1],s[n][2]],[s[n][6],s[n][7]],void 0)),s[n][11]&&p.push(new ar(s[n][0],[s[n][1],s[n][2]],[s[n][6],s[n][7]],void 0,void 0,!0,!0));var g=p.length;for(n=0;n<c.length;n++)for(d=0;d<c[n].length;d++)c[n][d].sort((function(t,e){return t.param<e.param?-1:1}));var y=[];for(n=0;n<g;n++)y.push({minX:p[n].coord[0],minY:p[n].coord[1],maxX:p[n].coord[0],maxY:p[n].coord[1],index:n});var _=Ct();for(_.load(y),n=0;n<c.length;n++)for(d=0;d<c[n].length;d++)for(var m=0;m<c[n][d].length;m++){x=m==c[n][d].length-1?c[n][cr(d+1,t.geometry.coordinates[n].length-1)][0].coord:c[n][d][m+1].coord;var v=_.search({minX:x[0],minY:x[1],maxX:x[0],maxY:x[1]})[0];c[n][d][m].nxtIsectAlongEdgeIn=v.index}for(n=0;n<c.length;n++)for(d=0;d<c[n].length;d++)for(m=0;m<c[n][d].length;m++){var x=c[n][d][m].coord,E=(v=_.search({minX:x[0],minY:x[1],maxX:x[0],maxY:x[1]})[0]).index;E<o?p[E].nxtIsectAlongRingAndEdge2=c[n][d][m].nxtIsectAlongEdgeIn:ur(p[E].ringAndEdge1,c[n][d][m].ringAndEdgeIn)?p[E].nxtIsectAlongRingAndEdge1=c[n][d][m].nxtIsectAlongEdgeIn:p[E].nxtIsectAlongRingAndEdge2=c[n][d][m].nxtIsectAlongEdgeIn}var w=[];for(n=0,d=0;d<e;d++){var b=n;for(m=0;m<t.geometry.coordinates[d].length-1;m++)p[n].coord[0]<p[b].coord[0]&&(b=n),n++;var M=p[b].nxtIsectAlongRingAndEdge2;for(m=0;m<p.length;m++)if(p[m].nxtIsectAlongRingAndEdge1==b||p[m].nxtIsectAlongRingAndEdge2==b){var C=m;break}var I=hr([p[C].coord,p[b].coord,p[M].coord],!0)?1:-1;w.push({isect:b,parent:-1,winding:I})}for(w.sort((function(t,e){return p[t.isect].coord>p[e.isect].coord?-1:1})),h=[];w.length>0;){var S=w.pop(),P=S.isect,N=S.parent,R=S.winding,T=h.length,L=[p[P].coord],O=P;if(p[P].ringAndEdge1Walkable)var A=p[P].ringAndEdge1,D=p[P].nxtIsectAlongRingAndEdge1;else A=p[P].ringAndEdge2,D=p[P].nxtIsectAlongRingAndEdge2;for(;!ur(p[P].coord,p[D].coord);){L.push(p[D].coord);var F=void 0;for(n=0;n<w.length;n++)if(w[n].isect==D){F=n;break}if(null!=F&&w.splice(F,1),ur(A,p[D].ringAndEdge1)){if(A=p[D].ringAndEdge2,p[D].ringAndEdge2Walkable=!1,p[D].ringAndEdge1Walkable){var k={isect:D};hr([p[O].coord,p[D].coord,p[p[D].nxtIsectAlongRingAndEdge2].coord],1==R)?(k.parent=N,k.winding=-R):(k.parent=T,k.winding=R),w.push(k)}O=D,D=p[D].nxtIsectAlongRingAndEdge2}else A=p[D].ringAndEdge1,p[D].ringAndEdge1Walkable=!1,p[D].ringAndEdge2Walkable&&(k={isect:D},hr([p[O].coord,p[D].coord,p[p[D].nxtIsectAlongRingAndEdge1].coord],1==R)?(k.parent=N,k.winding=-R):(k.parent=T,k.winding=R),w.push(k)),O=D,D=p[D].nxtIsectAlongRingAndEdge1}L.push(p[D].coord),h.push(l([L],{index:T,parent:N,winding:R,netWinding:void 0}))}function G(){for(var t=[],e=0;e<u.features.length;e++)-1==u.features[e].properties.parent&&t.push(e);if(t.length>1)for(e=0;e<t.length;e++){for(var i=-1,n=0;n<u.features.length;n++)t[e]!=n&&ye(u.features[t[e]].geometry.coordinates[0][0],u.features[n],{ignoreBoundary:!0})&&Bn(u.features[n])<1/0&&(i=n);u.features[t[e]].properties.parent=i}}function z(){for(var t=0;t<u.features.length;t++)if(-1==u.features[t].properties.parent){var e=u.features[t].properties.winding;u.features[t].properties.netWinding=e,j(t,e)}}function j(t,e){for(var i=0;i<u.features.length;i++)if(u.features[i].properties.parent==t){var n=e+u.features[i].properties.winding;u.features[i].properties.netWinding=n,j(i,n)}}return u=f(h),G(),z(),u}var sr=function(t,e,i,n,r){this.coord=t,this.param=e,this.ringAndEdgeIn=i,this.ringAndEdgeOut=n,this.nxtIsectAlongEdgeIn=r},ar=function(t,e,i,n,r,o,s){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=i,this.nxtIsectAlongRingAndEdge1=n,this.nxtIsectAlongRingAndEdge2=r,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=s};function hr(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function lr(t){for(var e=0,i=0;i<t.length-1;i++)t[i][0]<t[e][0]&&(e=i);if(hr([t[cr(e-1,t.length-1)],t[e],t[cr(e+1,t.length-1)]],!0))var n=1;else n=-1;return n}function ur(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]instanceof Array&&e[i]instanceof Array){if(!ur(t[i],e[i]))return!1}else if(t[i]!=e[i])return!1;return!0}function cr(t,e){return(t%e+e)%e}var pr=Math.PI/180,fr=180/Math.PI,dr=function(t,e){this.lon=t,this.lat=e,this.x=pr*t,this.y=pr*e};dr.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},dr.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new dr(e,t)};var gr=function(){this.coords=[],this.length=0};gr.prototype.move_to=function(t){this.length++,this.coords.push(t)};var yr=function(t){this.properties=t||{},this.geometries=[]};yr.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},yr.prototype.wkt=function(){for(var t="",e="LINESTRING(",i=function(t){e+=t[0]+" "+t[1]+","},n=0;n<this.geometries.length;n++){if(0===this.geometries[n].coords.length)return"LINESTRING(empty)";this.geometries[n].coords.forEach(i),t+=e.substring(0,e.length-1)+")"}return t};var _r=function(t,e,i){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new dr(t.x,t.y),this.end=new dr(e.x,e.y),this.properties=i||{};var n=this.start.x-this.end.x,r=this.start.y-this.end.y,o=Math.pow(Math.sin(r/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(n/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};function mr(t,e){var i=[],n=Nn();return q(e,(function(e){if(i.forEach((function(t,e){t.id=e})),i.length){var r=n.search(e);if(r.features.length){var o=xr(e,r);i=i.filter((function(t){return t.id!==o.id})),n.remove(o),F(vr(o,e),(function(t){i.push(t),n.insert(t)}))}}else(i=vr(t,e).features).forEach((function(t){t.bbox||(t.bbox=gi(Z(t)))})),n.load(f(i))})),f(i)}function vr(t,e){var i=[],n=Q(t)[0],r=Q(t)[t.geometry.coordinates.length-1];if(Er(n,J(e))||Er(r,J(e)))return f([t]);var o=Nn(),s=Hi(t);o.load(s);var a=o.search(e);if(!a.features.length)return f([t]);var h=xr(e,a),l=k(s,(function(t,n,r){var o=Q(n)[1],s=J(e);return r===h.id?(t.push(s),i.push(c(t)),Er(s,o)?[s]:[s,o]):(t.push(o),t)}),[n]);return l.length>1&&i.push(c(l)),f(i)}function xr(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var i,n=1/0;return F(e,(function(e){var r=On(e,t).properties.dist;r<n&&(i=e,n=r)})),i}function Er(t,e){return t[0]===e[0]&&t[1]===e[1]}function wr(t,e,i,n,r){void 0===r&&(r={});var o=r.steps||64,s=br(i),a=br(n),h=Array.isArray(t)||"Feature"!==t.type?{}:t.properties;if(s===a)return c(_i(t,e,r).geometry.coordinates[0],h);for(var l=s,u=s<a?a:a+360,p=l,f=[],d=0;p<u;)f.push(yi(t,e,p,r).geometry.coordinates),p=l+360*++d/o;return p>u&&f.push(yi(t,e,u,r).geometry.coordinates),c(f,h)}function br(t){var e=t%360;return e<0&&(e+=360),e}function Mr(t,e){void 0===e&&(e={});var i=nt(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),i.type){case"Polygon":return Cr(i,e);case"MultiPolygon":return function(t,e){void 0===e&&(e={});var i=nt(t).coordinates,n=e.properties?e.properties:"Feature"===t.type?t.properties:{},r=[];return i.forEach((function(t){r.push(Ir(t,n))})),f(r)}(i,e);default:throw new Error("invalid poly")}}function Cr(t,e){return void 0===e&&(e={}),Ir(nt(t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}function Ir(t,e){return t.length>1?d(t,e):c(t[0],e)}function Sr(t,e){var i,n,r;void 0===e&&(e={});var o=e.properties,s=null===(i=e.autoComplete)||void 0===i||i,a=null===(n=e.orderCoords)||void 0===n||n;if("FeatureCollection"===(null!==(r=e.mutate)&&void 0!==r&&r||(t=Me(t)),t.type)){var h=[];return t.features.forEach((function(t){h.push(Q(Pr(t,{},s,a)))})),y(h,o)}return Pr(t,o,s,a)}function Pr(t,e,i,n){e=e||("Feature"===t.type?t.properties:{});var r=nt(t),o=r.coordinates,s=r.type;if(!o.length)throw new Error("line must contain coordinates");switch(s){case"LineString":return i&&(o=Nr(o)),l([o],e);case"MultiLineString":var a=[],h=0;return o.forEach((function(t){if(i&&(t=Nr(t)),n){var e=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.abs(e-n)*Math.abs(i-r)}(Z(c(t)));e>h?(a.unshift(t),h=e):a.push(t)}else a.push(t)})),l(a,e);default:throw new Error("geometry type "+s+" is not supported")}}function Nr(t){var e=t[0],i=e[0],n=e[1],r=t[t.length-1],o=r[0],s=r[1];return i===o&&n===s||t.push(e),t}function Rr(t,e){var i,n,r,o,s,a,h;for(n=1;n<=8;n*=2){for(i=[],o=!(Lr(r=t[t.length-1],e)&n),s=0;s<t.length;s++)(h=!(Lr(a=t[s],e)&n))!==o&&i.push(Tr(r,a,n,e)),h&&i.push(a),r=a,o=h;if(!(t=i).length)break}return i}function Tr(t,e,i,n){return 8&i?[t[0]+(e[0]-t[0])*(n[3]-t[1])/(e[1]-t[1]),n[3]]:4&i?[t[0]+(e[0]-t[0])*(n[1]-t[1])/(e[1]-t[1]),n[1]]:2&i?[n[2],t[1]+(e[1]-t[1])*(n[2]-t[0])/(e[0]-t[0])]:1&i?[n[0],t[1]+(e[1]-t[1])*(n[0]-t[0])/(e[0]-t[0])]:null}function Lr(t,e){var i=0;return t[0]<e[0]?i|=1:t[0]>e[2]&&(i|=2),t[1]<e[1]?i|=4:t[1]>e[3]&&(i|=8),i}function Or(t,e){for(var i=[],n=0,r=t;n<r.length;n++){var o=Rr(r[n],e);o.length>0&&(o[0][0]===o[o.length-1][0]&&o[0][1]===o[o.length-1][1]||o.push(o[0]),o.length>=4&&i.push(o))}return i}_r.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),i=Math.sin(t*this.g)/Math.sin(this.g),n=e*Math.cos(this.start.y)*Math.cos(this.start.x)+i*Math.cos(this.end.y)*Math.cos(this.end.x),r=e*Math.cos(this.start.y)*Math.sin(this.start.x)+i*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+i*Math.sin(this.end.y),s=fr*Math.atan2(o,Math.sqrt(Math.pow(n,2)+Math.pow(r,2)));return[fr*Math.atan2(r,n),s]},_r.prototype.Arc=function(t,e){var i=[];if(!t||t<=2)i.push([this.start.lon,this.start.lat]),i.push([this.end.lon,this.end.lat]);else for(var n=1/(t-1),r=0;r<t;++r){var o=n*r,s=this.interpolate(o);i.push(s)}for(var a=!1,h=0,l=e&&e.offset?e.offset:10,u=180-l,c=-180+l,p=360-l,f=1;f<i.length;++f){var d=i[f-1][0],g=i[f][0],y=Math.abs(g-d);y>p&&(g>u&&d<c||d>u&&g<c)?a=!0:y>h&&(h=y)}var _=[];if(a&&h<l){var m=[];_.push(m);for(var v=0;v<i.length;++v){var x=parseFloat(i[v][0]);if(v>0&&Math.abs(x-i[v-1][0])>p){var E=parseFloat(i[v-1][0]),w=parseFloat(i[v-1][1]),b=parseFloat(i[v][0]),M=parseFloat(i[v][1]);if(E>-180&&E<c&&180===b&&v+1<i.length&&i[v-1][0]>-180&&i[v-1][0]<c){m.push([-180,i[v][1]]),v++,m.push([i[v][0],i[v][1]]);continue}if(E>u&&E<180&&-180===b&&v+1<i.length&&i[v-1][0]>u&&i[v-1][0]<180){m.push([180,i[v][1]]),v++,m.push([i[v][0],i[v][1]]);continue}if(E<c&&b>u){var C=E;E=b,b=C;var I=w;w=M,M=I}if(E>u&&b<c&&(b+=360),E<=180&&b>=180&&E<b){var S=(180-E)/(b-E),P=S*M+(1-S)*w;m.push([i[v-1][0]>u?180:-180,P]),(m=[]).push([i[v-1][0]>u?-180:180,P]),_.push(m)}else m=[],_.push(m);m.push([x,i[v][1]])}else m.push([i[v][0],i[v][1]])}}else{var N=[];_.push(N);for(var R=0;R<i.length;++R)N.push([i[R][0],i[R][1]])}for(var T=new yr(this.properties),L=0;L<_.length;++L){var O=new gr;T.geometries.push(O);for(var A=_[L],D=0;D<A.length;++D)O.move_to(A[D])}return T};var Ar=jt((function(t,e){function i(t){var e=[];for(var i in t)e.push(i);return e}(t.exports="function"==typeof Object.keys?Object.keys:i).shim=i})),Dr=jt((function(t,e){var i="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function n(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function r(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=i?n:r).supported=n,e.unsupported=r})),Fr=jt((function(t){var e=Array.prototype.slice,i=t.exports=function(t,o,s){return s||(s={}),t===o||(t instanceof Date&&o instanceof Date?t.getTime()===o.getTime():!t||!o||"object"!=typeof t&&"object"!=typeof o?s.strict?t===o:t==o:function(t,o,s){var a,h;if(n(t)||n(o))return!1;if(t.prototype!==o.prototype)return!1;if(Dr(t))return!!Dr(o)&&(t=e.call(t),o=e.call(o),i(t,o,s));if(r(t)){if(!r(o))return!1;if(t.length!==o.length)return!1;for(a=0;a<t.length;a++)if(t[a]!==o[a])return!1;return!0}try{var l=Ar(t),u=Ar(o)}catch(t){return!1}if(l.length!=u.length)return!1;for(l.sort(),u.sort(),a=l.length-1;a>=0;a--)if(l[a]!=u[a])return!1;for(a=l.length-1;a>=0;a--)if(h=l[a],!i(t[h],o[h],s))return!1;return typeof t==typeof o}(t,o,s))};function n(t){return null==t}function r(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}}));function kr(t,e,i){if(void 0===i&&(i={}),!P(i=i||{}))throw new Error("options is invalid");var n,r=i.tolerance||0,o=[],s=Nn(),a=Hi(t);return s.load(a),U(e,(function(t){var e=!1;t&&(F(s.search(t),(function(i){if(!1===e){var o=Q(t).sort(),s=Q(i).sort();Fr(o,s)||(0===r?Kn(o[0],i)&&Kn(o[1],i):On(i,o[0]).properties.dist<=r&&On(i,o[1]).properties.dist<=r)?(e=!0,n=n?Gr(n,t):t):(0===r?Kn(s[0],t)&&Kn(s[1],t):On(t,s[0]).properties.dist<=r&&On(t,s[1]).properties.dist<=r)&&(n=n?Gr(n,i):i)}})),!1===e&&n&&(o.push(n),n=void 0))})),n&&o.push(n),f(o)}function Gr(t,e){var i=Q(e),n=Q(t),r=n[0],o=n[n.length-1],s=t.geometry.coordinates;return Fr(i[0],r)?s.unshift(i[1]):Fr(i[0],o)?s.push(i[1]):Fr(i[1],r)?s.unshift(i[0]):Fr(i[1],o)&&s.push(i[0]),t}function zr(t){var e=t%360;return e<0&&(e+=360),e}function jr(t,e,i){var n;return void 0===i&&(i={}),(n=i.final?qr(J(e),J(t)):qr(J(t),J(e)))>180?-(360-n):n}function qr(t,e){var i=M(t[1]),n=M(e[1]),r=M(e[0]-t[0]);r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var o=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(i/2+Math.PI/4));return(b(Math.atan2(r,o))+360)%360}function Br(t,i,n,r){void 0===r&&(r={});var o=i<0,s=C(Math.abs(i),r.units,"meters");o&&(s=-Math.abs(s));var h=J(t),l=function(t,i,n,r){var o=i/(r=void 0===r?e:Number(r)),s=t[0]*Math.PI/180,a=M(t[1]),h=M(n),l=o*Math.cos(h),u=a+l;Math.abs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u);var c=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),p=Math.abs(c)>1e-11?l/c:Math.cos(a);return[(180*(s+o*Math.sin(h)/p)/Math.PI+540)%360-180,180*u/Math.PI]}(h,s,n);return l[0]+=l[0]-h[0]>180?-360:h[0]-l[0]>180?360:0,a(l,r.properties)}function Ur(t,e,i,n,r,o){for(var s=0;s<t.length;s++){var a=t[s],h=t[s+1];s===t.length-1&&(h=t[0]),n=Yr(a,h,e),i<=0&&n>0?Yr(e,a,r)<0||(r=a):i>0&&n<=0&&(Xr(e,a,o)||(o=a)),i=n}return[r,o]}function Xr(t,e,i){return Yr(t,e,i)>0}function Yr(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])}function Vr(t){for(var e,i,n=Q(t),r=0,o=1;o<n.length;)e=i||n[0],r+=((i=n[o])[0]-e[0])*(i[1]+e[1]),o++;return r>0}function Wr(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return z(t,(function(t){Wr(t,e)})),t;case"LineString":return Kr(Q(t),e),t;case"Polygon":return Hr(Q(t),e),t;case"MultiLineString":return Q(t).forEach((function(t){Kr(t,e)})),t;case"MultiPolygon":return Q(t).forEach((function(t){Hr(t,e)})),t;case"Point":case"MultiPoint":return t}}function Kr(t,e){Vr(t)===e&&t.reverse()}function Hr(t,e){Vr(t[0])!==e&&t[0].reverse();for(var i=1;i<t.length;i++)Vr(t[i])===e&&t[i].reverse()}function Zr(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.zProperty||"elevation",n=e.flip,r=e.flags;it(t,"Point","input must contain Points");for(var o=function(t,e){var i={};return F(t,(function(t){var e=Q(t)[1];i[e]||(i[e]=[]),i[e].push(t)})),Object.keys(i).map((function(t){return i[t].sort((function(t,e){return Q(t)[0]-Q(e)[0]}))})).sort((function(t,i){return e?Q(t[0])[1]-Q(i[0])[1]:Q(i[0])[1]-Q(t[0])[1]}))}(t,n),s=[],a=0;a<o.length;a++){for(var h=o[a],l=[],u=0;u<h.length;u++){var c=h[u];c.properties[i]?l.push(c.properties[i]):l.push(0),!0===r&&(c.properties.matrixPosition=[a,u])}s.push(l)}return s}var Jr={successCallback:null,verbose:!1,polygons:!1},Qr={};function $r(t,e,i,n){n=n||{};for(var r=Object.keys(Jr),o=0;o<r.length;o++){var s=r[o],a=n[s];a=null!=a?a:Jr[s],Qr[s]=a}Qr.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+e+":"+(e+i)+"]");var h,l=function(t,e,i){for(var n=t.length-1,r=t[0].length-1,o={rows:n,cols:r,cells:[]},s=e+Math.abs(i),a=0;a<n;++a){o.cells[a]=[];for(var h=0;h<r;++h){var l=0,u=t[a+1][h],c=t[a+1][h+1],p=t[a][h+1],f=t[a][h];if(!(isNaN(u)||isNaN(c)||isNaN(p)||isNaN(f))){l|=u<e?0:u>s?128:64,l|=c<e?0:c>s?32:16,l|=p<e?0:p>s?8:4;var d=+(l|=f<e?0:f>s?2:1),g=0;if(17===l||18===l||33===l||34===l||38===l||68===l||72===l||98===l||102===l||132===l||136===l||137===l||152===l||153===l){var y=(u+c+p+f)/4;g=y>s?2:y<e?0:1,34===l?1===g?l=35:0===g&&(l=136):136===l?1===g?(l=35,g=4):0===g&&(l=34):17===l?1===g?(l=155,g=4):0===g&&(l=153):68===l?1===g?(l=103,g=4):0===g&&(l=102):153===l?1===g&&(l=155):102===l?1===g&&(l=103):152===l?g<2&&(l=156,g=1):137===l?g<2&&(l=139,g=1):98===l?g<2&&(l=99,g=1):38===l?g<2&&(l=39,g=1):18===l?g>0?(l=156,g=4):l=152:33===l?g>0?(l=139,g=4):l=137:72===l?g>0?(l=99,g=4):l=98:132===l&&(g>0?(l=39,g=4):l=38)}if(0!=l&&170!=l){var _,m,v,x,E,w,b,M;_=m=v=x=E=w=b=M=.5;var C=[];1===l?(v=1-Xo(e,p,f),M=1-Xo(e,u,f),C.push(Go[l])):169===l?(v=Xo(s,f,p),M=Xo(s,f,u),C.push(Go[l])):4===l?(w=1-Xo(e,c,p),x=Xo(e,f,p),C.push(Fo[l])):166===l?(w=Xo(s,p,c),x=1-Xo(s,p,f),C.push(Fo[l])):16===l?(E=Xo(e,p,c),m=Xo(e,u,c),C.push(Do[l])):154===l?(E=1-Xo(s,c,p),m=1-Xo(s,c,u),C.push(Do[l])):64===l?(b=Xo(e,f,u),_=1-Xo(e,c,u),C.push(jo[l])):106===l?(b=1-Xo(s,u,f),_=Xo(s,u,c),C.push(jo[l])):168===l?(x=Xo(s,f,p),v=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),C.push(ko[l]),C.push(Go[l])):2===l?(x=1-Xo(e,p,f),v=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),C.push(ko[l]),C.push(Go[l])):162===l?(E=Xo(s,p,c),w=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),C.push(ko[l]),C.push(Go[l])):8===l?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),C.push(Do[l]),C.push(Fo[l])):138===l?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),_=1-Xo(s,c,u),m=1-Xo(e,c,u),C.push(Do[l]),C.push(Fo[l])):32===l?(E=Xo(s,p,c),w=Xo(e,p,c),_=Xo(e,u,c),m=Xo(s,u,c),C.push(Do[l]),C.push(Fo[l])):42===l?(M=1-Xo(s,u,f),b=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c),C.push(zo[l]),C.push(jo[l])):128===l&&(M=Xo(e,f,u),b=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u),C.push(zo[l]),C.push(jo[l])),5===l?(w=1-Xo(e,c,p),M=1-Xo(e,u,f),C.push(Fo[l])):165===l?(w=Xo(s,p,c),M=Xo(s,f,u),C.push(Fo[l])):20===l?(x=Xo(e,f,p),m=Xo(e,u,c),C.push(ko[l])):150===l?(x=1-Xo(s,p,f),m=1-Xo(s,c,u),C.push(ko[l])):80===l?(E=Xo(e,p,c),b=Xo(e,f,u),C.push(Do[l])):90===l?(E=1-Xo(s,c,p),b=1-Xo(s,u,f),C.push(Do[l])):65===l?(v=1-Xo(e,p,f),_=1-Xo(e,c,u),C.push(Go[l])):105===l?(v=Xo(s,f,p),_=Xo(s,u,c),C.push(Go[l])):160===l?(E=Xo(s,p,c),w=Xo(e,p,c),M=Xo(e,f,u),b=Xo(s,f,u),C.push(Do[l]),C.push(Fo[l])):10===l?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),M=1-Xo(s,u,f),b=1-Xo(e,u,f),C.push(Do[l]),C.push(Fo[l])):130===l?(x=1-Xo(e,p,f),v=1-Xo(s,p,f),_=1-Xo(s,c,u),m=1-Xo(e,c,u),C.push(ko[l]),C.push(Go[l])):40===l?(x=Xo(s,f,p),v=Xo(e,f,p),_=Xo(e,u,c),m=Xo(s,u,c),C.push(ko[l]),C.push(Go[l])):101===l?(w=Xo(s,p,c),_=Xo(s,u,c),C.push(Fo[l])):69===l?(w=1-Xo(e,c,p),_=1-Xo(e,c,u),C.push(Fo[l])):149===l?(M=Xo(s,f,u),m=1-Xo(s,c,u),C.push(zo[l])):21===l?(M=1-Xo(e,u,f),m=Xo(e,u,c),C.push(zo[l])):86===l?(x=1-Xo(s,p,f),b=1-Xo(s,u,f),C.push(ko[l])):84===l?(x=Xo(e,f,p),b=Xo(e,f,u),C.push(ko[l])):89===l?(E=1-Xo(s,c,p),v=Xo(s,f,p),C.push(Go[l])):81===l?(E=Xo(e,p,c),v=1-Xo(e,p,f),C.push(Go[l])):96===l?(E=Xo(s,p,c),w=Xo(e,p,c),b=Xo(e,f,u),_=Xo(s,u,c),C.push(Do[l]),C.push(Fo[l])):74===l?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),b=1-Xo(s,u,f),_=1-Xo(e,c,u),C.push(Do[l]),C.push(Fo[l])):24===l?(E=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),m=Xo(e,u,c),C.push(Do[l]),C.push(Go[l])):146===l?(E=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),m=1-Xo(s,c,u),C.push(Do[l]),C.push(Go[l])):6===l?(w=1-Xo(e,c,p),x=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),C.push(Fo[l]),C.push(ko[l])):164===l?(w=Xo(s,p,c),x=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),C.push(Fo[l]),C.push(ko[l])):129===l?(v=1-Xo(e,p,f),M=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u),C.push(Go[l]),C.push(zo[l])):41===l?(v=Xo(s,f,p),M=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c),C.push(Go[l]),C.push(zo[l])):66===l?(x=1-Xo(e,p,f),v=1-Xo(s,p,f),b=1-Xo(s,u,f),_=1-Xo(e,c,u),C.push(ko[l]),C.push(Go[l])):104===l?(x=Xo(s,f,p),v=Xo(e,f,p),b=Xo(e,f,u),_=Xo(s,u,c),C.push(Go[l]),C.push(qo[l])):144===l?(E=Xo(e,p,c),M=Xo(e,f,u),b=Xo(s,f,u),m=1-Xo(s,c,u),C.push(Do[l]),C.push(jo[l])):26===l?(E=1-Xo(s,c,p),M=1-Xo(s,u,f),b=1-Xo(e,u,f),m=Xo(e,u,c),C.push(Do[l]),C.push(jo[l])):36===l?(w=Xo(s,p,c),x=Xo(e,f,p),_=Xo(e,u,c),m=Xo(s,u,c),C.push(Fo[l]),C.push(ko[l])):134===l?(w=1-Xo(e,c,p),x=1-Xo(s,p,f),_=1-Xo(s,c,u),m=1-Xo(e,c,u),C.push(Fo[l]),C.push(ko[l])):9===l?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),v=Xo(s,f,p),M=1-Xo(e,u,f),C.push(Do[l]),C.push(Fo[l])):161===l?(E=Xo(s,p,c),w=Xo(e,p,c),v=1-Xo(e,p,f),M=Xo(s,f,u),C.push(Do[l]),C.push(Fo[l])):37===l?(w=Xo(s,p,c),M=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c),C.push(Fo[l]),C.push(zo[l])):133===l?(w=1-Xo(e,c,p),M=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u),C.push(Fo[l]),C.push(zo[l])):148===l?(x=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),m=1-Xo(s,c,u),C.push(ko[l]),C.push(jo[l])):22===l?(x=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),m=Xo(e,u,c),C.push(ko[l]),C.push(jo[l])):82===l?(E=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),b=1-Xo(s,u,f),C.push(Do[l]),C.push(Go[l])):88===l?(E=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),b=Xo(e,f,u),C.push(Do[l]),C.push(Go[l])):73===l?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),v=Xo(s,f,p),_=1-Xo(e,c,u),C.push(Do[l]),C.push(Fo[l])):97===l?(E=Xo(s,p,c),w=Xo(e,p,c),v=1-Xo(e,p,f),_=Xo(s,u,c),C.push(Do[l]),C.push(Fo[l])):145===l?(E=Xo(e,p,c),v=1-Xo(e,p,f),M=Xo(s,f,u),m=1-Xo(s,c,u),C.push(Do[l]),C.push(zo[l])):25===l?(E=1-Xo(s,c,p),v=Xo(s,f,p),M=1-Xo(e,u,f),m=Xo(e,u,c),C.push(Do[l]),C.push(zo[l])):70===l?(w=1-Xo(e,c,p),x=1-Xo(s,p,f),b=1-Xo(s,u,f),_=1-Xo(e,c,u),C.push(Fo[l]),C.push(ko[l])):100===l?(w=Xo(s,p,c),x=Xo(e,f,p),b=Xo(e,f,u),_=Xo(s,u,c),C.push(Fo[l]),C.push(ko[l])):34===l?(0===g?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u)):(E=Xo(s,p,c),w=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c)),C.push(Do[l]),C.push(Fo[l]),C.push(zo[l]),C.push(jo[l])):35===l?(4===g?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u)):(E=Xo(s,p,c),w=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c)),C.push(Do[l]),C.push(Fo[l]),C.push(Go[l]),C.push(jo[l])):136===l?(0===g?(E=Xo(s,p,c),w=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c)):(E=1-Xo(e,c,p),w=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u)),C.push(Do[l]),C.push(Fo[l]),C.push(zo[l]),C.push(jo[l])):153===l?(0===g?(E=Xo(e,p,c),v=1-Xo(e,p,f),M=1-Xo(e,u,f),m=Xo(e,u,c)):(E=1-Xo(s,c,p),v=Xo(s,f,p),M=Xo(s,f,u),m=1-Xo(s,c,u)),C.push(Do[l]),C.push(Go[l])):102===l?(0===g?(w=1-Xo(e,c,p),x=Xo(e,f,p),b=Xo(e,f,u),_=1-Xo(e,c,u)):(w=Xo(s,p,c),x=1-Xo(s,p,f),b=1-Xo(s,u,f),_=Xo(s,u,c)),C.push(Fo[l]),C.push(jo[l])):155===l?(4===g?(E=Xo(e,p,c),v=1-Xo(e,p,f),M=1-Xo(e,u,f),m=Xo(e,u,c)):(E=1-Xo(s,c,p),v=Xo(s,f,p),M=Xo(s,f,u),m=1-Xo(s,c,u)),C.push(Do[l]),C.push(zo[l])):103===l?(4===g?(w=1-Xo(e,c,p),x=Xo(e,f,p),b=Xo(e,f,u),_=1-Xo(e,c,u)):(w=Xo(s,p,c),x=1-Xo(s,p,f),b=1-Xo(s,u,f),_=Xo(s,u,c)),C.push(Fo[l]),C.push(ko[l])):152===l?(0===g?(E=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),m=Xo(e,u,c)):(E=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),m=1-Xo(s,c,u)),C.push(Do[l]),C.push(ko[l]),C.push(Go[l])):156===l?(4===g?(E=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),m=Xo(e,u,c)):(E=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),m=1-Xo(s,c,u)),C.push(Do[l]),C.push(Go[l]),C.push(jo[l])):137===l?(0===g?(E=Xo(s,p,c),w=Xo(e,p,c),v=1-Xo(e,p,f),M=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c)):(E=1-Xo(e,c,p),w=1-Xo(s,c,p),v=Xo(s,f,p),M=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u)),C.push(Do[l]),C.push(Fo[l]),C.push(Go[l])):139===l?(4===g?(E=Xo(s,p,c),w=Xo(e,p,c),v=1-Xo(e,p,f),M=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c)):(E=1-Xo(e,c,p),w=1-Xo(s,c,p),v=Xo(s,f,p),M=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u)),C.push(Do[l]),C.push(Fo[l]),C.push(zo[l])):98===l?(0===g?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),b=Xo(e,f,u),_=1-Xo(e,c,u)):(E=Xo(s,p,c),w=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),b=1-Xo(s,u,f),_=Xo(s,u,c)),C.push(Do[l]),C.push(Fo[l]),C.push(jo[l])):99===l?(4===g?(E=1-Xo(e,c,p),w=1-Xo(s,c,p),x=Xo(s,f,p),v=Xo(e,f,p),b=Xo(e,f,u),_=1-Xo(e,c,u)):(E=Xo(s,p,c),w=Xo(e,p,c),x=1-Xo(e,p,f),v=1-Xo(s,p,f),b=1-Xo(s,u,f),_=Xo(s,u,c)),C.push(Do[l]),C.push(Fo[l]),C.push(Go[l])):38===l?(0===g?(w=1-Xo(e,c,p),x=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u)):(w=Xo(s,p,c),x=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c)),C.push(Fo[l]),C.push(zo[l]),C.push(jo[l])):39===l?(4===g?(w=1-Xo(e,c,p),x=Xo(e,f,p),M=Xo(e,f,u),b=Xo(s,f,u),_=1-Xo(s,c,u),m=1-Xo(e,c,u)):(w=Xo(s,p,c),x=1-Xo(s,p,f),M=1-Xo(s,u,f),b=1-Xo(e,u,f),_=Xo(e,u,c),m=Xo(s,u,c)),C.push(Fo[l]),C.push(ko[l]),C.push(jo[l])):85===l&&(E=1,w=0,x=1,v=0,M=0,b=1,_=0,m=1),(_<0||_>1||m<0||m>1||E<0||E>1||x<0||x>1||M<0||M>1||b<0||b>1)&&console.log("MarchingSquaresJS-isoBands: "+l+" "+d+" "+u+","+c+","+p+","+f+" "+g+" "+_+" "+m+" "+E+" "+w+" "+x+" "+v+" "+M+" "+b),o.cells[a][h]={cval:l,cval_real:d,flipped:g,topleft:_,topright:m,righttop:E,rightbottom:w,bottomright:x,bottomleft:v,leftbottom:M,lefttop:b,edges:C}}}}}return o}(t,e,i);return Qr.polygons?(Qr.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),h=function(t){var e=[],i=0;return t.cells.forEach((function(t,n){t.forEach((function(t,r){if(void 0!==t){var o=Uo[t.cval](t);"object"==typeof o&&Yo(o)?"object"==typeof o[0]&&Yo(o[0])?"object"==typeof o[0][0]&&Yo(o[0][0])?o.forEach((function(t){t.forEach((function(t){t[0]+=r,t[1]+=n})),e[i++]=t})):(o.forEach((function(t){t[0]+=r,t[1]+=n})),e[i++]=o):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}}))})),e}(l)):(Qr.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),h=function(t){for(var e=[],i=t.rows,n=t.cols,r=[],o=0;o<i;o++)for(var s=0;s<n;s++)if(void 0!==t.cells[o][s]&&t.cells[o][s].edges.length>0){var a=Wo(t.cells[o][s]),h=null,l=s,u=o;null!==a&&r.push([a.p[0]+l,a.p[1]+u]);do{if(null===(h=Ko(t.cells[u][l],a.x,a.y,a.o)))break;if(r.push([h.p[0]+l,h.p[1]+u]),l+=h.x,a=h,(u+=h.y)<0||u>=i||l<0||l>=n||void 0===t.cells[u][l]){var c=Vo(t,l-=h.x,u-=h.y,h.x,h.y,h.o);if(null===c)break;c.path.forEach((function(t){r.push(t)})),l=c.i,u=c.j,a=c}}while(void 0!==t.cells[u][l]&&t.cells[u][l].edges.length>0);e.push(r),r=[],t.cells[o][s].edges.length>0&&s--}return e}(l)),"function"==typeof Qr.successCallback&&Qr.successCallback(h),h}var to=64,eo=16,io=[],no=[],ro=[],oo=[],so=[],ao=[],ho=[],lo=[],uo=[],co=[],po=[],fo=[],go=[],yo=[],_o=[],mo=[],vo=[],xo=[],Eo=[],wo=[],bo=[],Mo=[],Co=[],Io=[];ho[85]=co[85]=-1,lo[85]=po[85]=0,uo[85]=fo[85]=1,Eo[85]=Mo[85]=1,wo[85]=Co[85]=0,bo[85]=Io[85]=1,io[85]=oo[85]=0,no[85]=so[85]=-1,ro[85]=_o[85]=0,mo[85]=go[85]=0,vo[85]=yo[85]=1,ao[85]=xo[85]=1,Mo[1]=Mo[169]=0,Co[1]=Co[169]=-1,Io[1]=Io[169]=0,go[1]=go[169]=-1,yo[1]=yo[169]=0,_o[1]=_o[169]=0,co[4]=co[166]=0,po[4]=po[166]=-1,fo[4]=fo[166]=1,mo[4]=mo[166]=1,vo[4]=vo[166]=0,xo[4]=xo[166]=0,ho[16]=ho[154]=0,lo[16]=lo[154]=1,uo[16]=uo[154]=1,oo[16]=oo[154]=1,so[16]=so[154]=0,ao[16]=ao[154]=1,Eo[64]=Eo[106]=0,wo[64]=wo[106]=1,bo[64]=bo[106]=0,io[64]=io[106]=-1,no[64]=no[106]=0,ro[64]=ro[106]=1,Eo[2]=Eo[168]=0,wo[2]=wo[168]=-1,bo[2]=bo[168]=1,Mo[2]=Mo[168]=0,Co[2]=Co[168]=-1,Io[2]=Io[168]=0,go[2]=go[168]=-1,yo[2]=yo[168]=0,_o[2]=_o[168]=0,mo[2]=mo[168]=-1,vo[2]=vo[168]=0,xo[2]=xo[168]=1,ho[8]=ho[162]=0,lo[8]=lo[162]=-1,uo[8]=uo[162]=0,co[8]=co[162]=0,po[8]=po[162]=-1,fo[8]=fo[162]=1,go[8]=go[162]=1,yo[8]=yo[162]=0,_o[8]=_o[162]=1,mo[8]=mo[162]=1,vo[8]=vo[162]=0,xo[8]=xo[162]=0,ho[32]=ho[138]=0,lo[32]=lo[138]=1,uo[32]=uo[138]=1,co[32]=co[138]=0,po[32]=po[138]=1,fo[32]=fo[138]=0,io[32]=io[138]=1,no[32]=no[138]=0,ro[32]=ro[138]=0,oo[32]=oo[138]=1,so[32]=so[138]=0,ao[32]=ao[138]=1,Mo[128]=Mo[42]=0,Co[128]=Co[42]=1,Io[128]=Io[42]=1,Eo[128]=Eo[42]=0,wo[128]=wo[42]=1,bo[128]=bo[42]=0,io[128]=io[42]=-1,no[128]=no[42]=0,ro[128]=ro[42]=1,oo[128]=oo[42]=-1,so[128]=so[42]=0,ao[128]=ao[42]=0,co[5]=co[165]=-1,po[5]=po[165]=0,fo[5]=fo[165]=0,Mo[5]=Mo[165]=1,Co[5]=Co[165]=0,Io[5]=Io[165]=0,mo[20]=mo[150]=0,vo[20]=vo[150]=1,xo[20]=xo[150]=1,oo[20]=oo[150]=0,so[20]=so[150]=-1,ao[20]=ao[150]=1,ho[80]=ho[90]=-1,lo[80]=lo[90]=0,uo[80]=uo[90]=1,Eo[80]=Eo[90]=1,wo[80]=wo[90]=0,bo[80]=bo[90]=1,go[65]=go[105]=0,yo[65]=yo[105]=1,_o[65]=_o[105]=0,io[65]=io[105]=0,no[65]=no[105]=-1,ro[65]=ro[105]=0,ho[160]=ho[10]=-1,lo[160]=lo[10]=0,uo[160]=uo[10]=1,co[160]=co[10]=-1,po[160]=po[10]=0,fo[160]=fo[10]=0,Mo[160]=Mo[10]=1,Co[160]=Co[10]=0,Io[160]=Io[10]=0,Eo[160]=Eo[10]=1,wo[160]=wo[10]=0,bo[160]=bo[10]=1,mo[130]=mo[40]=0,vo[130]=vo[40]=1,xo[130]=xo[40]=1,go[130]=go[40]=0,yo[130]=yo[40]=1,_o[130]=_o[40]=0,io[130]=io[40]=0,no[130]=no[40]=-1,ro[130]=ro[40]=0,oo[130]=oo[40]=0,so[130]=so[40]=-1,ao[130]=ao[40]=1,co[37]=co[133]=0,po[37]=po[133]=1,fo[37]=fo[133]=1,Mo[37]=Mo[133]=0,Co[37]=Co[133]=1,Io[37]=Io[133]=0,io[37]=io[133]=-1,no[37]=no[133]=0,ro[37]=ro[133]=0,oo[37]=oo[133]=1,so[37]=so[133]=0,ao[37]=ao[133]=0,mo[148]=mo[22]=-1,vo[148]=vo[22]=0,xo[148]=xo[22]=0,Mo[148]=Mo[22]=0,Co[148]=Co[22]=-1,Io[148]=Io[22]=1,Eo[148]=Eo[22]=0,wo[148]=wo[22]=1,bo[148]=bo[22]=1,oo[148]=oo[22]=-1,so[148]=so[22]=0,ao[148]=ao[22]=1,ho[82]=ho[88]=0,lo[82]=lo[88]=-1,uo[82]=uo[88]=1,mo[82]=mo[88]=1,vo[82]=vo[88]=0,xo[82]=xo[88]=1,go[82]=go[88]=-1,yo[82]=yo[88]=0,_o[82]=_o[88]=1,Eo[82]=Eo[88]=0,wo[82]=wo[88]=-1,bo[82]=bo[88]=0,ho[73]=ho[97]=0,lo[73]=lo[97]=1,uo[73]=uo[97]=0,co[73]=co[97]=0,po[73]=po[97]=-1,fo[73]=fo[97]=0,go[73]=go[97]=1,yo[73]=yo[97]=0,_o[73]=_o[97]=0,io[73]=io[97]=1,no[73]=no[97]=0,ro[73]=ro[97]=1,ho[145]=ho[25]=0,lo[145]=lo[25]=-1,uo[145]=uo[25]=0,go[145]=go[25]=1,yo[145]=yo[25]=0,_o[145]=_o[25]=1,Mo[145]=Mo[25]=0,Co[145]=Co[25]=1,Io[145]=Io[25]=1,oo[145]=oo[25]=-1,so[145]=so[25]=0,ao[145]=ao[25]=0,co[70]=co[100]=0,po[70]=po[100]=1,fo[70]=fo[100]=0,mo[70]=mo[100]=-1,vo[70]=vo[100]=0,xo[70]=xo[100]=1,Eo[70]=Eo[100]=0,wo[70]=wo[100]=-1,bo[70]=bo[100]=1,io[70]=io[100]=1,no[70]=no[100]=0,ro[70]=ro[100]=0,co[101]=co[69]=0,po[101]=po[69]=1,fo[101]=fo[69]=0,io[101]=io[69]=1,no[101]=no[69]=0,ro[101]=ro[69]=0,Mo[149]=Mo[21]=0,Co[149]=Co[21]=1,Io[149]=Io[21]=1,oo[149]=oo[21]=-1,so[149]=so[21]=0,ao[149]=ao[21]=0,mo[86]=mo[84]=-1,vo[86]=vo[84]=0,xo[86]=xo[84]=1,Eo[86]=Eo[84]=0,wo[86]=wo[84]=-1,bo[86]=bo[84]=1,ho[89]=ho[81]=0,lo[89]=lo[81]=-1,uo[89]=uo[81]=0,go[89]=go[81]=1,yo[89]=yo[81]=0,_o[89]=_o[81]=1,ho[96]=ho[74]=0,lo[96]=lo[74]=1,uo[96]=uo[74]=0,co[96]=co[74]=-1,po[96]=po[74]=0,fo[96]=fo[74]=1,Eo[96]=Eo[74]=1,wo[96]=wo[74]=0,bo[96]=bo[74]=0,io[96]=io[74]=1,no[96]=no[74]=0,ro[96]=ro[74]=1,ho[24]=ho[146]=0,lo[24]=lo[146]=-1,uo[24]=uo[146]=1,mo[24]=mo[146]=1,vo[24]=vo[146]=0,xo[24]=xo[146]=1,go[24]=go[146]=0,yo[24]=yo[146]=1,_o[24]=_o[146]=1,oo[24]=oo[146]=0,so[24]=so[146]=-1,ao[24]=ao[146]=0,co[6]=co[164]=-1,po[6]=po[164]=0,fo[6]=fo[164]=1,mo[6]=mo[164]=-1,vo[6]=vo[164]=0,xo[6]=xo[164]=0,Mo[6]=Mo[164]=0,Co[6]=Co[164]=-1,Io[6]=Io[164]=1,Eo[6]=Eo[164]=1,wo[6]=wo[164]=0,bo[6]=bo[164]=0,go[129]=go[41]=0,yo[129]=yo[41]=1,_o[129]=_o[41]=1,Mo[129]=Mo[41]=0,Co[129]=Co[41]=1,Io[129]=Io[41]=0,io[129]=io[41]=-1,no[129]=no[41]=0,ro[129]=ro[41]=0,oo[129]=oo[41]=0,so[129]=so[41]=-1,ao[129]=ao[41]=0,mo[66]=mo[104]=0,vo[66]=vo[104]=1,xo[66]=xo[104]=0,go[66]=go[104]=-1,yo[66]=yo[104]=0,_o[66]=_o[104]=1,Eo[66]=Eo[104]=0,wo[66]=wo[104]=-1,bo[66]=bo[104]=0,io[66]=io[104]=0,no[66]=no[104]=-1,ro[66]=ro[104]=1,ho[144]=ho[26]=-1,lo[144]=lo[26]=0,uo[144]=uo[26]=0,Mo[144]=Mo[26]=1,Co[144]=Co[26]=0,Io[144]=Io[26]=1,Eo[144]=Eo[26]=0,wo[144]=wo[26]=1,bo[144]=bo[26]=1,oo[144]=oo[26]=-1,so[144]=so[26]=0,ao[144]=ao[26]=1,co[36]=co[134]=0,po[36]=po[134]=1,fo[36]=fo[134]=1,mo[36]=mo[134]=0,vo[36]=vo[134]=1,xo[36]=xo[134]=0,io[36]=io[134]=0,no[36]=no[134]=-1,ro[36]=ro[134]=1,oo[36]=oo[134]=1,so[36]=so[134]=0,ao[36]=ao[134]=0,ho[9]=ho[161]=-1,lo[9]=lo[161]=0,uo[9]=uo[161]=0,co[9]=co[161]=0,po[9]=po[161]=-1,fo[9]=fo[161]=0,go[9]=go[161]=1,yo[9]=yo[161]=0,_o[9]=_o[161]=0,Mo[9]=Mo[161]=1,Co[9]=Co[161]=0,Io[9]=Io[161]=1,ho[136]=0,lo[136]=1,uo[136]=1,co[136]=0,po[136]=1,fo[136]=0,mo[136]=-1,vo[136]=0,xo[136]=1,go[136]=-1,yo[136]=0,_o[136]=0,Mo[136]=0,Co[136]=-1,Io[136]=0,Eo[136]=0,wo[136]=-1,bo[136]=1,io[136]=1,no[136]=0,ro[136]=0,oo[136]=1,so[136]=0,ao[136]=1,ho[34]=0,lo[34]=-1,uo[34]=0,co[34]=0,po[34]=-1,fo[34]=1,mo[34]=1,vo[34]=0,xo[34]=0,go[34]=1,yo[34]=0,_o[34]=1,Mo[34]=0,Co[34]=1,Io[34]=1,Eo[34]=0,wo[34]=1,bo[34]=0,io[34]=-1,no[34]=0,ro[34]=1,oo[34]=-1,so[34]=0,ao[34]=0,ho[35]=0,lo[35]=1,uo[35]=1,co[35]=0,po[35]=-1,fo[35]=1,mo[35]=1,vo[35]=0,xo[35]=0,go[35]=-1,yo[35]=0,_o[35]=0,Mo[35]=0,Co[35]=-1,Io[35]=0,Eo[35]=0,wo[35]=1,bo[35]=0,io[35]=-1,no[35]=0,ro[35]=1,oo[35]=1,so[35]=0,ao[35]=1,ho[153]=0,lo[153]=1,uo[153]=1,go[153]=-1,yo[153]=0,_o[153]=0,Mo[153]=0,Co[153]=-1,Io[153]=0,oo[153]=1,so[153]=0,ao[153]=1,co[102]=0,po[102]=-1,fo[102]=1,mo[102]=1,vo[102]=0,xo[102]=0,Eo[102]=0,wo[102]=1,bo[102]=0,io[102]=-1,no[102]=0,ro[102]=1,ho[155]=0,lo[155]=-1,uo[155]=0,go[155]=1,yo[155]=0,_o[155]=1,Mo[155]=0,Co[155]=1,Io[155]=1,oo[155]=-1,so[155]=0,ao[155]=0,co[103]=0,po[103]=1,fo[103]=0,mo[103]=-1,vo[103]=0,xo[103]=1,Eo[103]=0,wo[103]=-1,bo[103]=1,io[103]=1,no[103]=0,ro[103]=0,ho[152]=0,lo[152]=1,uo[152]=1,mo[152]=-1,vo[152]=0,xo[152]=1,go[152]=-1,yo[152]=0,_o[152]=0,Mo[152]=0,Co[152]=-1,Io[152]=0,Eo[152]=0,wo[152]=-1,bo[152]=1,oo[152]=1,so[152]=0,ao[152]=1,ho[156]=0,lo[156]=-1,uo[156]=1,mo[156]=1,vo[156]=0,xo[156]=1,go[156]=-1,yo[156]=0,_o[156]=0,Mo[156]=0,Co[156]=-1,Io[156]=0,Eo[156]=0,wo[156]=1,bo[156]=1,oo[156]=-1,so[156]=0,ao[156]=1,ho[137]=0,lo[137]=1,uo[137]=1,co[137]=0,po[137]=1,fo[137]=0,go[137]=-1,yo[137]=0,_o[137]=0,Mo[137]=0,Co[137]=-1,Io[137]=0,io[137]=1,no[137]=0,ro[137]=0,oo[137]=1,so[137]=0,ao[137]=1,ho[139]=0,lo[139]=1,uo[139]=1,co[139]=0,po[139]=-1,fo[139]=0,go[139]=1,yo[139]=0,_o[139]=0,Mo[139]=0,Co[139]=1,Io[139]=0,io[139]=-1,no[139]=0,ro[139]=0,oo[139]=1,so[139]=0,ao[139]=1,ho[98]=0,lo[98]=-1,uo[98]=0,co[98]=0,po[98]=-1,fo[98]=1,mo[98]=1,vo[98]=0,xo[98]=0,go[98]=1,yo[98]=0,_o[98]=1,Eo[98]=0,wo[98]=1,bo[98]=0,io[98]=-1,no[98]=0,ro[98]=1,ho[99]=0,lo[99]=1,uo[99]=0,co[99]=0,po[99]=-1,fo[99]=1,mo[99]=1,vo[99]=0,xo[99]=0,go[99]=-1,yo[99]=0,_o[99]=1,Eo[99]=0,wo[99]=-1,bo[99]=0,io[99]=1,no[99]=0,ro[99]=1,co[38]=0,po[38]=-1,fo[38]=1,mo[38]=1,vo[38]=0,xo[38]=0,Mo[38]=0,Co[38]=1,Io[38]=1,Eo[38]=0,wo[38]=1,bo[38]=0,io[38]=-1,no[38]=0,ro[38]=1,oo[38]=-1,so[38]=0,ao[38]=0,co[39]=0,po[39]=1,fo[39]=1,mo[39]=-1,vo[39]=0,xo[39]=0,Mo[39]=0,Co[39]=-1,Io[39]=1,Eo[39]=0,wo[39]=1,bo[39]=0,io[39]=-1,no[39]=0,ro[39]=1,oo[39]=1,so[39]=0,ao[39]=0;var So=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},Po=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},No=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},Ro=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},To=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},Lo=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},Oo=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},Ao=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Do=[],Fo=[],ko=[],Go=[],zo=[],jo=[],qo=[],Bo=[];Go[1]=zo[1]=18,Go[169]=zo[169]=18,ko[4]=Fo[4]=12,ko[166]=Fo[166]=12,Do[16]=Bo[16]=4,Do[154]=Bo[154]=4,jo[64]=qo[64]=22,jo[106]=qo[106]=22,ko[2]=jo[2]=17,Go[2]=zo[2]=18,ko[168]=jo[168]=17,Go[168]=zo[168]=18,Do[8]=Go[8]=9,Fo[8]=ko[8]=12,Do[162]=Go[162]=9,Fo[162]=ko[162]=12,Do[32]=Bo[32]=4,Fo[32]=qo[32]=1,Do[138]=Bo[138]=4,Fo[138]=qo[138]=1,zo[128]=Bo[128]=21,jo[128]=qo[128]=22,zo[42]=Bo[42]=21,jo[42]=qo[42]=22,Fo[5]=zo[5]=14,Fo[165]=zo[165]=14,ko[20]=Bo[20]=6,ko[150]=Bo[150]=6,Do[80]=jo[80]=11,Do[90]=jo[90]=11,Go[65]=qo[65]=3,Go[105]=qo[105]=3,Do[160]=jo[160]=11,Fo[160]=zo[160]=14,Do[10]=jo[10]=11,Fo[10]=zo[10]=14,ko[130]=Bo[130]=6,Go[130]=qo[130]=3,ko[40]=Bo[40]=6,Go[40]=qo[40]=3,Fo[101]=qo[101]=1,Fo[69]=qo[69]=1,zo[149]=Bo[149]=21,zo[21]=Bo[21]=21,ko[86]=jo[86]=17,ko[84]=jo[84]=17,Do[89]=Go[89]=9,Do[81]=Go[81]=9,Do[96]=qo[96]=0,Fo[96]=jo[96]=15,Do[74]=qo[74]=0,Fo[74]=jo[74]=15,Do[24]=ko[24]=8,Go[24]=Bo[24]=7,Do[146]=ko[146]=8,Go[146]=Bo[146]=7,Fo[6]=jo[6]=15,ko[6]=zo[6]=16,Fo[164]=jo[164]=15,ko[164]=zo[164]=16,Go[129]=Bo[129]=7,zo[129]=qo[129]=20,Go[41]=Bo[41]=7,zo[41]=qo[41]=20,ko[66]=qo[66]=2,Go[66]=jo[66]=19,ko[104]=qo[104]=2,Go[104]=jo[104]=19,Do[144]=zo[144]=10,jo[144]=Bo[144]=23,Do[26]=zo[26]=10,jo[26]=Bo[26]=23,Fo[36]=Bo[36]=5,ko[36]=qo[36]=2,Fo[134]=Bo[134]=5,ko[134]=qo[134]=2,Do[9]=zo[9]=10,Fo[9]=Go[9]=13,Do[161]=zo[161]=10,Fo[161]=Go[161]=13,Fo[37]=Bo[37]=5,zo[37]=qo[37]=20,Fo[133]=Bo[133]=5,zo[133]=qo[133]=20,ko[148]=zo[148]=16,jo[148]=Bo[148]=23,ko[22]=zo[22]=16,jo[22]=Bo[22]=23,Do[82]=ko[82]=8,Go[82]=jo[82]=19,Do[88]=ko[88]=8,Go[88]=jo[88]=19,Do[73]=qo[73]=0,Fo[73]=Go[73]=13,Do[97]=qo[97]=0,Fo[97]=Go[97]=13,Do[145]=Go[145]=9,zo[145]=Bo[145]=21,Do[25]=Go[25]=9,zo[25]=Bo[25]=21,Fo[70]=qo[70]=1,ko[70]=jo[70]=17,Fo[100]=qo[100]=1,ko[100]=jo[100]=17,Do[34]=Go[34]=9,Fo[34]=ko[34]=12,zo[34]=Bo[34]=21,jo[34]=qo[34]=22,Do[136]=Bo[136]=4,Fo[136]=qo[136]=1,ko[136]=jo[136]=17,Go[136]=zo[136]=18,Do[35]=Bo[35]=4,Fo[35]=ko[35]=12,Go[35]=zo[35]=18,jo[35]=qo[35]=22,Do[153]=Bo[153]=4,Go[153]=zo[153]=18,Fo[102]=ko[102]=12,jo[102]=qo[102]=22,Do[155]=Go[155]=9,zo[155]=Bo[155]=23,Fo[103]=qo[103]=1,ko[103]=jo[103]=17,Do[152]=Bo[152]=4,ko[152]=jo[152]=17,Go[152]=zo[152]=18,Do[156]=ko[156]=8,Go[156]=zo[156]=18,jo[156]=Bo[156]=23,Do[137]=Bo[137]=4,Fo[137]=qo[137]=1,Go[137]=zo[137]=18,Do[139]=Bo[139]=4,Fo[139]=Go[139]=13,zo[139]=qo[139]=20,Do[98]=Go[98]=9,Fo[98]=ko[98]=12,jo[98]=qo[98]=22,Do[99]=qo[99]=0,Fo[99]=ko[99]=12,Go[99]=jo[99]=19,Fo[38]=ko[38]=12,zo[38]=Bo[38]=21,jo[38]=qo[38]=22,Fo[39]=Bo[39]=5,ko[39]=zo[39]=16,jo[39]=qo[39]=22;var Uo=[];function Xo(t,e,i){return(t-e)/(i-e)}function Yo(t){return t.constructor.toString().indexOf("Array")>-1}function Vo(t,e,i,n,r,o){for(var s=t.cells[i][e],a=s.cval_real,h=e+n,l=i+r,u=[],c=!1;!c;){if(void 0===t.cells[l]||void 0===t.cells[l][h])if(l-=r,h-=n,a=(s=t.cells[l][h]).cval_real,-1===r)if(0===o)if(1&a)u.push([h,l]),n=-1,r=0,o=0;else{if(!(4&a)){u.push([h+s.bottomright,l]),n=0,r=1,o=1,c=!0;break}u.push([h+1,l]),n=1,r=0,o=0}else{if(!(1&a)){if(4&a){u.push([h+s.bottomright,l]),n=0,r=1,o=1,c=!0;break}u.push([h+s.bottomleft,l]),n=0,r=1,o=0,c=!0;break}u.push([h,l]),n=-1,r=0,o=0}else if(1===r)if(0===o){if(!(a&eo)){if(a&to){u.push([h+s.topleft,l+1]),n=0,r=-1,o=0,c=!0;break}u.push([h+s.topright,l+1]),n=0,r=-1,o=1,c=!0;break}u.push([h+1,l+1]),n=1,r=0,o=1}else u.push([h+1,l+1]),n=1,r=0,o=1;else if(-1===n)if(0===o){if(!(a&to)){if(1&a){u.push([h,l+s.leftbottom]),n=1,r=0,o=0,c=!0;break}u.push([h,l+s.lefttop]),n=1,r=0,o=1,c=!0;break}u.push([h,l+1]),n=0,r=1,o=0}else{if(!(a&to)){console.log("MarchingSquaresJS-isoBands: wtf");break}u.push([h,l+1]),n=0,r=1,o=0}else{if(1!==n){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(4&a)){u.push([h+1,l+s.rightbottom]),n=-1,r=0,o=0,c=!0;break}u.push([h+1,l]),n=0,r=-1,o=1}else{if(!(4&a)){if(a&eo){u.push([h+1,l+s.righttop]),n=-1,r=0,o=1;break}u.push([h+1,l+s.rightbottom]),n=-1,r=0,o=0,c=!0;break}u.push([h+1,l]),n=0,r=-1,o=1}}else if(a=(s=t.cells[l][h]).cval_real,-1===n)if(0===o)if(void 0!==t.cells[l-1]&&void 0!==t.cells[l-1][h])n=0,r=-1,o=1;else{if(!(1&a)){u.push([h+s.bottomright,l]),n=0,r=1,o=1,c=!0;break}u.push([h,l])}else{if(!(a&to)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+h+","+l);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===n){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l+1]&&void 0!==t.cells[l+1][h])n=0,r=1,o=0;else{if(!(a&eo)){u.push([h+s.topleft,l+1]),n=0,r=-1,o=0,c=!0;break}u.push([h+1,l+1]),n=1,r=0,o=1}}else if(-1===r){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l][h+1])n=1,r=0,o=1;else{if(!(4&a)){u.push([h+1,l+s.righttop]),n=-1,r=0,o=1,c=!0;break}u.push([h+1,l]),n=0,r=-1,o=1}}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l][h-1])n=-1,r=0,o=0;else{if(!(a&to)){u.push([h,l+s.leftbottom]),n=1,r=0,o=0,c=!0;break}u.push([h,l+1]),n=0,r=1,o=0}}if(l+=r,(h+=n)===e&&l===i)break}return{path:u,i:h,j:l,x:n,y:r,o:o}}function Wo(t){if(t.edges.length>0){var e=t.edges[t.edges.length-1],i=t.cval_real;switch(e){case 0:return i&eo?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return 4&i?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return 4&i?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return 1&i?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return i&eo?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return 4&i?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return 4&i?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return 1&i?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return 4&i?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return 1&i?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return 1&i?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return i&to?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return 4&i?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return 1&i?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return 1&i?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return i&to?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return 4&i?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return i&to?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return 1&i?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return i&to?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return i&to?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return i&eo?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return i&to?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return i&eo?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}function Ko(t,e,i,n){var r,o,s,a,h,l=t.cval;switch(e){case-1:0===n?(r=Fo[l],s=co[l],a=po[l],h=fo[l]):(r=Do[l],s=ho[l],a=lo[l],h=uo[l]);break;case 1:0===n?(r=zo[l],s=Mo[l],a=Co[l],h=Io[l]):(r=jo[l],s=Eo[l],a=wo[l],h=bo[l]);break;default:switch(i){case-1:0===n?(r=qo[l],s=io[l],a=no[l],h=ro[l]):(r=Bo[l],s=oo[l],a=so[l],h=ao[l]);break;case 1:0===n?(r=Go[l],s=go[l],a=yo[l],h=_o[l]):(r=ko[l],s=mo[l],a=vo[l],h=xo[l])}}if(o=t.edges.indexOf(r),void 0===t.edges[o])return null;switch(function(t,e){delete t.edges[e];for(var i=e+1;i<t.edges.length;i++)t.edges[i-1]=t.edges[i];t.edges.pop()}(t,o),l=t.cval_real,r){case 0:l&eo?(e=t.topleft,i=1):(e=1,i=t.righttop);break;case 1:4&l?(e=1,i=t.rightbottom):(e=t.topleft,i=1);break;case 2:4&l?(e=t.topleft,i=1):(e=t.bottomright,i=0);break;case 3:1&l?(e=t.bottomleft,i=0):(e=t.topleft,i=1);break;case 4:l&eo?(e=t.topright,i=1):(e=1,i=t.righttop);break;case 5:4&l?(e=1,i=t.rightbottom):(e=t.topright,i=1);break;case 6:4&l?(e=t.topright,i=1):(e=t.bottomright,i=0);break;case 7:1&l?(e=t.bottomleft,i=0):(e=t.topright,i=1);break;case 8:4&l?(e=1,i=t.righttop):(e=t.bottomright,i=0);break;case 9:1&l?(e=t.bottomleft,i=0):(e=1,i=t.righttop);break;case 10:1&l?(e=1,i=t.righttop):(e=0,i=t.leftbottom);break;case 11:l&to?(e=0,i=t.lefttop):(e=1,i=t.righttop);break;case 12:4&l?(e=1,i=t.rightbottom):(e=t.bottomright,i=0);break;case 13:1&l?(e=t.bottomleft,i=0):(e=1,i=t.rightbottom);break;case 14:1&l?(e=1,i=t.rightbottom):(e=0,i=t.leftbottom);break;case 15:l&to?(e=0,i=t.lefttop):(e=1,i=t.rightbottom);break;case 16:4&l?(e=0,i=t.leftbottom):(e=t.bottomright,i=0);break;case 17:l&to?(e=0,i=t.lefttop):(e=t.bottomright,i=0);break;case 18:1&l?(e=t.bottomleft,i=0):(e=0,i=t.leftbottom);break;case 19:l&to?(e=0,i=t.lefttop):(e=t.bottomleft,i=0);break;case 20:l&to?(e=0,i=t.leftbottom):(e=t.topleft,i=1);break;case 21:l&eo?(e=t.topright,i=1):(e=0,i=t.leftbottom);break;case 22:l&to?(e=0,i=t.lefttop):(e=t.topleft,i=1);break;case 23:l&eo?(e=t.topright,i=1):(e=0,i=t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==i&&void 0!==s&&void 0!==a&&void 0!==h||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+i+" "+s+" "+a+" "+h)),{p:[e,i],x:s,y:a,o:h}}function Ho(t){var e=[],i=[];t.forEach((function(t){var n=Bn(l([t]));i.push(n),e.push({ring:t,area:n})})),i.sort((function(t,e){return e-t}));var n=[];return i.forEach((function(t){for(var i=0;i<e.length;i++)if(e[i].area===t){n.push(e[i].ring),e.splice(i,1);break}})),n}function Zo(t){for(var e=t.map((function(t){return{lrCoordinates:t,grouped:!1}})),i=[];!Qo(e);)for(var n=0;n<e.length;n++)if(!e[n].grouped){var r=[];r.push(e[n].lrCoordinates),e[n].grouped=!0;for(var o=l([e[n].lrCoordinates]),s=n+1;s<e.length;s++)e[s].grouped||Jo(l([e[s].lrCoordinates]),o)&&(r.push(e[s].lrCoordinates),e[s].grouped=!0);i.push(r)}return i}function Jo(t,e){for(var i=Ei(t),n=0;n<i.features.length;n++)if(!ye(i.features[n],e))return!1;return!0}function Qo(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}function $o(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.pivot,r=i.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(n||(n=xi(t)),!1!==r&&void 0!==r||(t=Me(t)),L(t,(function(t){var i=jr(n,t)+e,r=An(n,t),o=Q(Br(n,r,i));t[0]=o[0],t[1]=o[1]}))),t}function ts(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.origin,r=i.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var o=Array.isArray(n)||"object"==typeof n;return!0!==r&&(t=Me(t)),"FeatureCollection"!==t.type||o?es(t,e,n):(F(t,(function(i,r){t.features[r]=es(i,e,n)})),t)}function es(t,e,i){var n="Point"===rt(t);return i=function(t,e){if(null==e&&(e="centroid"),Array.isArray(e)||"object"==typeof e)return J(e);var i=t.bbox?t.bbox:Z(t),n=i[0],r=i[1],o=i[2],s=i[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return a([n,r]);case"se":case"southeast":case"eastsouth":case"bottomright":return a([o,r]);case"nw":case"northwest":case"westnorth":case"topleft":return a([n,s]);case"ne":case"northeast":case"eastnorth":case"topright":return a([o,s]);case"center":return vi(t);case void 0:case null:case"centroid":return xi(t);default:throw new Error("invalid origin")}}(t,i),1===e||n||L(t,(function(t){var n=An(i,t),r=jr(i,t),o=Q(Br(i,n*e,r));t[0]=o[0],t[1]=o[1],3===t.length&&(t[2]*=e)})),t}function is(t){var e=t[0],i=t[1];return[i[0]-e[0],i[1]-e[1]]}function ns(t,e){return t[0]*e[1]-e[0]*t[1]}function rs(t,e){return!function(t,e){return 0===ns(is(t),is(e))}(t,e)&&function(t,e){var i,n,r=t[0],o=is(t),s=e[0],a=is(e),h=ns(o,a);return function(t,e){return[t[0]+e[0],t[1]+e[1]]}(r,function(t,e){return[t*e[0],t*e[1]]}(ns((n=r,[(i=s)[0]-n[0],i[1]-n[1]]),a)/h,o))}(t,e)}function os(t,e,i){var n=[],r=E(e,i),o=Q(t),s=[];return o.forEach((function(t,e){if(e!==o.length-1){var i=(l=t,u=o[e+1],c=r,p=Math.sqrt((l[0]-u[0])*(l[0]-u[0])+(l[1]-u[1])*(l[1]-u[1])),f=l[0]+c*(u[1]-l[1])/p,d=u[0]+c*(u[1]-l[1])/p,[[f,l[1]+c*(l[0]-u[0])/p],[d,u[1]+c*(l[0]-u[0])/p]]);if(n.push(i),e>0){var a=n[e-1],h=rs(i,a);!1!==h&&(a[1]=h,i[0]=h),s.push(a[0]),e===o.length-2&&(s.push(i[0]),s.push(i[1]))}2===o.length&&(s.push(i[0]),s.push(i[1]))}var l,u,c,p,f,d})),c(s,t.properties)}function ss(t,e,i){var n=e[0]-t[0],r=e[1]-t[1],o=i[0]-e[0];return function(t){return(t>0)-(t<0)||+t}(n*(i[1]-e[1])-o*r)}function as(t,e){return e.geometry.coordinates[0].every((function(e){return ye(a(e),t)}))}Uo[1]=Uo[169]=So,Uo[4]=Uo[166]=Po,Uo[16]=Uo[154]=No,Uo[64]=Uo[106]=Ro,Uo[168]=Uo[2]=To,Uo[162]=Uo[8]=Lo,Uo[138]=Uo[32]=Oo,Uo[42]=Uo[128]=Ao,Uo[5]=Uo[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},Uo[20]=Uo[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},Uo[80]=Uo[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},Uo[65]=Uo[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},Uo[160]=Uo[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},Uo[130]=Uo[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},Uo[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},Uo[101]=Uo[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},Uo[149]=Uo[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},Uo[86]=Uo[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},Uo[89]=Uo[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},Uo[96]=Uo[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},Uo[24]=Uo[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},Uo[6]=Uo[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},Uo[129]=Uo[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},Uo[66]=Uo[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Uo[144]=Uo[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Uo[36]=Uo[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},Uo[9]=Uo[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},Uo[37]=Uo[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},Uo[148]=Uo[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Uo[82]=Uo[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},Uo[73]=Uo[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},Uo[145]=Uo[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},Uo[70]=Uo[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Uo[34]=function(t){return[Ao(t),Lo(t)]},Uo[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Uo[136]=function(t){return[Oo(t),To(t)]},Uo[153]=function(t){return[No(t),So(t)]},Uo[102]=function(t){return[Po(t),Ro(t)]},Uo[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},Uo[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Uo[152]=function(t){return[No(t),To(t)]},Uo[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},Uo[137]=function(t){return[Oo(t),So(t)]},Uo[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},Uo[98]=function(t){return[Lo(t),Ro(t)]},Uo[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},Uo[38]=function(t){return[Po(t),Ao(t)]},Uo[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};var hs=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return t.buildId=function(t){return t.join(",")},t.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},t.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},t.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,i){var n=e.to,r=i.to;if(n.coordinates[0]-t.coordinates[0]>=0&&r.coordinates[0]-t.coordinates[0]<0)return 1;if(n.coordinates[0]-t.coordinates[0]<0&&r.coordinates[0]-t.coordinates[0]>=0)return-1;if(n.coordinates[0]-t.coordinates[0]==0&&r.coordinates[0]-t.coordinates[0]==0)return n.coordinates[1]-t.coordinates[1]>=0||r.coordinates[1]-t.coordinates[1]>=0?n.coordinates[1]-r.coordinates[1]:r.coordinates[1]-n.coordinates[1];var o=ss(t.coordinates,n.coordinates,r.coordinates);return o<0?1:o>0?-1:Math.pow(n.coordinates[0]-t.coordinates[0],2)+Math.pow(n.coordinates[1]-t.coordinates[1],2)-(Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},t.prototype.addInnerEdge=function(t){this.innerEdges.push(t)},t}(),ls=function(){function t(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return c([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(t){return ss(t.from.coordinates,t.to.coordinates,this.to.coordinates)},t}(),us=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return t.prototype.push=function(t){this.edges.push(t),this.polygon=this.envelope=void 0},t.prototype.get=function(t){return this.edges[t]},Object.defineProperty(t.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.edges.forEach(t)},t.prototype.map=function(t){return this.edges.map(t)},t.prototype.some=function(t){return this.edges.some(t)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,i,n){return i.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=n),e}),0),i=(0===e?this.length:e)-1,n=(e+1)%this.length,r=ss(this.edges[i].from.coordinates,this.edges[e].from.coordinates,this.edges[n].from.coordinates);return 0===r?this.edges[i].from.coordinates[0]>this.edges[n].from.coordinates[0]:r>0},t.prototype.toMultiPoint=function(){return g(this.edges.map((function(t){return t.from.coordinates})))},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=l([t])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=di(this.toPolygon())},t.findEdgeRingContaining=function(t,e){var i,n,r=t.getEnvelope();return e.forEach((function(e){var o,s,h,l,u,c,p=e.getEnvelope();if(n&&(i=n.getEnvelope()),s=r,h=(o=p).geometry.coordinates[0].map((function(t){return t[0]})),l=o.geometry.coordinates[0].map((function(t){return t[1]})),u=s.geometry.coordinates[0].map((function(t){return t[0]})),c=s.geometry.coordinates[0].map((function(t){return t[1]})),(Math.max.apply(null,h)!==Math.max.apply(null,u)||Math.max.apply(null,l)!==Math.max.apply(null,c)||Math.min.apply(null,h)!==Math.min.apply(null,u)||Math.min.apply(null,l)!==Math.min.apply(null,c))&&as(p,r)){for(var f=t.map((function(t){return t.from.coordinates})),d=void 0,g=function(t){e.some((function(e){var i,n;return i=t,n=e.from.coordinates,i[0]===n[0]&&i[1]===n[1]}))||(d=t)},y=0,_=f;y<_.length;y++)g(_[y]);d&&e.inside(a(d))&&(n&&!as(i,p)||(n=e))}})),n},t.prototype.inside=function(t){return ye(t,this.toPolygon())},t}(),cs=function(){function t(){this.edges=[],this.nodes={}}return t.fromGeoJson=function(e){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var i=new t;return q(e,(function(t){et(t,"LineString","Graph::fromGeoJson"),O(t,(function(t,e){if(t){var n=i.getNode(t),r=i.getNode(e);i.addEdge(n,r)}return e}))})),i},t.prototype.getNode=function(t){var e=hs.buildId(t),i=this.nodes[e];return i||(i=this.nodes[e]=new hs(t)),i},t.prototype.addEdge=function(t,e){var i=new ls(t,e),n=i.getSymetric();this.edges.push(i),this.edges.push(n)},t.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},t.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var i=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),i.forEach((function(t){return e._removeIfDangle(t)}))}},t.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},t.prototype._computeNextCWEdges=function(t){var e=this;void 0===t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,i){t.getOuterEdge((0===i?t.getOuterEdges().length:i)-1).symetric.next=e}))},t.prototype._computeNextCCWEdges=function(t,e){for(var i,n,r=t.getOuterEdges(),o=r.length-1;o>=0;--o){var s=r[o],a=s.symetric,h=void 0,l=void 0;s.label===e&&(h=s),a.label===e&&(l=a),h&&l&&(l&&(n=l),h&&(n&&(n.next=h,n=void 0),i||(i=h)))}n&&(n.next=i)},t.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(i){if(!(i.label>=0)){t.push(i);var n=i;do{n.label=e,n=n.next}while(!i.isEqual(n));e++}})),t},t.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(i){t._computeNextCCWEdges(i,e.label)}))}));var e=[];return this.edges.forEach((function(i){i.ring||e.push(t._findEdgeRing(i))})),e},t.prototype._findIntersectionNodes=function(t){var e=[],i=t,n=function(){var n=0;i.from.getOuterEdges().forEach((function(e){e.label===t.label&&++n})),n>1&&e.push(i.from),i=i.next};do{n()}while(!t.isEqual(i));return e},t.prototype._findEdgeRing=function(t){var e=t,i=new us;do{i.push(e),e.ring=i,e=e.next}while(!t.isEqual(e));return i},t.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},t.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()},t}();function ps(t,e){var i=!0;return q(t,(function(t){q(e,(function(e){if(!1===i)return!1;i=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return i=t.coordinates,n=e.coordinates,!(i[0]===n[0]&&i[1]===n[1]);case"LineString":return!fs(e,t);case"Polygon":return!ye(t,e)}break;case"LineString":switch(e.type){case"Point":return!fs(t,e);case"LineString":return!function(t,e){return Tn(t,e).features.length>0}(t,e);case"Polygon":return!ds(e,t)}break;case"Polygon":switch(e.type){case"Point":return!ye(e,t);case"LineString":return!ds(t,e);case"Polygon":return!function(t,e){for(var i=0,n=t.coordinates[0];i<n.length;i++)if(ye(n[i],e))return!0;for(var r=0,o=e.coordinates[0];r<o.length;r++)if(ye(o[r],t))return!0;return Tn(Mr(t),Mr(e)).features.length>0}(e,t)}}var i,n;return!1}(t.geometry,e.geometry)}))})),i}function fs(t,e){for(var i=0;i<t.coordinates.length-1;i++)if(gs(t.coordinates[i],t.coordinates[i+1],e.coordinates))return!0;return!1}function ds(t,e){for(var i=0,n=e.coordinates;i<n.length;i++)if(ye(n[i],t))return!0;return Tn(e,Mr(t)).features.length>0}function gs(t,e,i){var n=i[0]-t[0],r=i[1]-t[1],o=e[0]-t[0],s=e[1]-t[1];return 0==n*s-r*o&&(Math.abs(o)>=Math.abs(s)?o>0?t[0]<=i[0]&&i[0]<=e[0]:e[0]<=i[0]&&i[0]<=t[0]:s>0?t[1]<=i[1]&&i[1]<=e[1]:e[1]<=i[1]&&i[1]<=t[1])}function ys(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function _s(t,e){return t[0]===e[0]&&t[1]===e[1]}function ms(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function vs(t,e){for(var i=!1,n=!1,r=t.coordinates.length,o=0;o<r&&!i&&!n;){for(var s=0;s<e.coordinates.length-1;s++){var a=!0;0!==s&&s!==e.coordinates.length-2||(a=!1),ws(e.coordinates[s],e.coordinates[s+1],t.coordinates[o],a)?i=!0:n=!0}o++}return i&&n}function xs(t,e){return Tn(t,Cr(e)).features.length>0}function Es(t,e){for(var i=!1,n=!1,r=t.coordinates.length,o=0;o<r&&(!i||!n);o++)ye(a(t.coordinates[o]),e)?i=!0:n=!0;return n&&i}function ws(t,e,i,n){var r=i[0]-t[0],o=i[1]-t[1],s=e[0]-t[0],a=e[1]-t[1];return 0==r*a-o*s&&(n?Math.abs(s)>=Math.abs(a)?s>0?t[0]<=i[0]&&i[0]<=e[0]:e[0]<=i[0]&&i[0]<=t[0]:a>0?t[1]<=i[1]&&i[1]<=e[1]:e[1]<=i[1]&&i[1]<=t[1]:Math.abs(s)>=Math.abs(a)?s>0?t[0]<i[0]&&i[0]<e[0]:e[0]<i[0]&&i[0]<t[0]:a>0?t[1]<i[1]&&i[1]<e[1]:e[1]<i[1]&&i[1]<t[1])}var bs=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:Is};function Ms(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function Cs(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function Is(t,e){return Fr(t,e,{strict:!0})}bs.prototype.compare=function(t,e){if(t.type!==e.type||!Cs(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var i=this,n=Ms(t),r=Ms(e);return n.every((function(t){return this.some((function(e){return i.compare(t,e)}))}),r)}}return!1},bs.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i].toFixed(this.precision)!==e[i].toFixed(this.precision))return!1;return!0},bs.prototype.compareLine=function(t,e,i,n){if(!Cs(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!n||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var s=this.compareCoord(r[i],o[i]);return this.direction||s?this.comparePath(r,o):!!this.compareCoord(r[i],o[o.length-(1+i)])&&this.comparePath(r.slice().reverse(),o)}},bs.prototype.fixStartIndex=function(t,e){for(var i,n=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){n=r;break}return n>=0&&(i=[].concat(t.slice(n,t.length),t.slice(1,n+1))),i},bs.prototype.comparePath=function(t,e){var i=this;return t.every((function(t,e){return i.compareCoord(t,this[e])}),e)},bs.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var i=t.coordinates.slice(1,t.coordinates.length),n=e.coordinates.slice(1,e.coordinates.length),r=this;return i.every((function(t){return this.some((function(e){return r.compareLine(t,e,1,!0)}))}),n)}return!1},bs.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},bs.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},bs.prototype.removePseudo=function(t){return t};var Ss=bs;function Ps(t,e){var i=!1;return q(t,(function(t){q(e,(function(e){if(!0===i)return!0;i=!ps(t.geometry,e.geometry)}))})),i}var Ns=jt((function(t){function e(t,e,i,n){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,i,n)}e.prototype.run=function(t,e,i,n){this._init(t,e,i,n);for(var r=0;r<this._datasetLength;r++)if(1!==this._visited[r]){this._visited[r]=1;var o=this._regionQuery(r);if(o.length<this.minPts)this.noise.push(r);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(r,s),this._expandCluster(s,o)}}return this.clusters},e.prototype._init=function(t,e,i,n){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),i&&(this.minPts=i),n&&(this.distance=n)},e.prototype._expandCluster=function(t,e){for(var i=0;i<e.length;i++){var n=e[i];if(1!==this._visited[n]){this._visited[n]=1;var r=this._regionQuery(n);r.length>=this.minPts&&(e=this._mergeArrays(e,r))}1!==this._assigned[n]&&this._addToCluster(n,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],i=0;i<this._datasetLength;i++)this.distance(this.dataset[t],this.dataset[i])<this.epsilon&&e.push(i);return e},e.prototype._mergeArrays=function(t,e){for(var i=e.length,n=0;n<i;n++){var r=e[n];t.indexOf(r)<0&&t.push(r)}return t},e.prototype._euclideanDistance=function(t,e){for(var i=0,n=Math.min(t.length,e.length);n--;)i+=(t[n]-e[n])*(t[n]-e[n]);return Math.sqrt(i)},t.exports&&(t.exports=e)})),Rs=jt((function(t){function e(t,e,i){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,i)}e.prototype.init=function(t,e,i){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==i&&(this.distance=i)},e.prototype.run=function(t,e){this.init(t,e);for(var i=this.dataset.length,n=0;n<this.k;n++)this.centroids[n]=this.randomCentroid();for(var r=!0;r;){r=this.assign();for(var o=0;o<this.k;o++){for(var s=new Array(u),a=0,h=0;h<u;h++)s[h]=0;for(var l=0;l<i;l++){var u=this.dataset[l].length;if(o===this.assignments[l]){for(h=0;h<u;h++)s[h]+=this.dataset[l][h];a++}}if(a>0){for(h=0;h<u;h++)s[h]/=a;this.centroids[o]=s}else this.centroids[o]=this.randomCentroid(),r=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,i=this.dataset.length-1;do{e=Math.round(Math.random()*i),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,i=this.dataset.length,n=0;n<i;n++)(t=this.argmin(this.dataset[n],this.centroids,this.distance))!=this.assignments[n]&&(this.assignments[n]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),i=0;i<this.assignments.length;i++)void 0===e[t=this.assignments[i]]&&(e[t]=[]),e[t].push(i);return e},e.prototype.argmin=function(t,e,i){for(var n,r=Number.MAX_VALUE,o=0,s=e.length,a=0;a<s;a++)(n=i(t,e[a]))<r&&(r=n,o=a);return o},e.prototype.distance=function(t,e){for(var i=0,n=Math.min(t.length,e.length);n--;){var r=t[n]-e[n];i+=r*r}return Math.sqrt(i)},t.exports&&(t.exports=e)})),Ts=jt((function(t){function e(t,e,i){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,i)}e.prototype.insert=function(t,e){for(var i=this._queue.length,n=i;n--;){var r=this._priorities[n];"desc"===this._sorting?e>r&&(i=n):e<r&&(i=n)}this._insertAt(t,e,i)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;)if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,i=this._queue.length;e<i;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,i){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var n=0;n<t.length;n++)this.insert(t[n],e[n])}i&&(this._sorting=i)},e.prototype._insertAt=function(t,e,i){this._queue.length===i?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(i,0,t),this._priorities.splice(i,0,e))},t.exports&&(t.exports=e)})),Ls=jt((function(t){if(t.exports)var e=Ts;function i(t,e,i,n){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,i,n)}i.prototype.run=function(t,i,n,r){this._init(t,i,n,r);for(var o=0,s=this.dataset.length;o<s;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var a=this.clusters.length-1;this._orderedList.push(o);var h=new e(null,null,"asc"),l=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,l,h),this._expandCluster(a,h))}return this.clusters},i.prototype.getReachabilityPlot=function(){for(var t=[],e=0,i=this._orderedList.length;e<i;e++){var n=this._orderedList[e],r=this._reachability[n];t.push([n,r])}return t},i.prototype._init=function(t,e,i,n){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),i&&(this.minPts=i),n&&(this.distance=n)},i.prototype._updateQueue=function(t,e,i){var n=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===n._processed[e]){var r=n.distance(n.dataset[t],n.dataset[e]),o=Math.max(n._coreDistance,r);void 0===n._reachability[e]?(n._reachability[e]=o,i.insert(e,o)):o<n._reachability[e]&&(n._reachability[e]=o,i.remove(e),i.insert(e,o))}}))},i.prototype._expandCluster=function(t,e){for(var i=e.getElements(),n=0,r=i.length;n<r;n++){var o=i[n];if(void 0===this._processed[o]){var s=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,s,e),this._expandCluster(t,e))}}},i.prototype._distanceToCore=function(t){for(var e=this.epsilon,i=0;i<e;i++)if(this._regionQuery(t,i).length>=this.minPts)return i},i.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var i=[],n=0,r=this.dataset.length;n<r;n++)this.distance(this.dataset[t],this.dataset[n])<e&&i.push(n);return i},i.prototype._euclideanDistance=function(t,e){for(var i=0,n=Math.min(t.length,e.length);n--;)i+=(t[n]-e[n])*(t[n]-e[n]);return Math.sqrt(i)},t.exports&&(t.exports=i)})),Os=jt((function(t){t.exports&&(t.exports={DBSCAN:Ns,KMEANS:Rs,OPTICS:Ls,PriorityQueue:Ts})})),As=function(t,e,i){for(var n=t.length,r=0,o=0;o<n;o++){var s=(t[o]||0)-(e[o]||0);r+=s*s}return i?Math.sqrt(r):r},Ds=As,Fs=function(t,e,i){var n=Math.abs(t-e);return i?n:n*n},ks=As,Gs=function(t,e){for(var i={},n=[],r=e<<2,o=t.length,s=t[0].length>0;n.length<e&&r-- >0;){var a=t[Math.floor(Math.random()*o)],h=s?a.join("_"):""+a;i[h]||(i[h]=!0,n.push(a))}if(n.length<e)throw new Error("Error initializating clusters");return n},zs=function(t,e){var i=t[0].length?Ds:Fs,n=[],r=t.length,o=t[0].length>0,s=t[Math.floor(Math.random()*r)];for(o&&s.join("_"),n.push(s);n.length<e;){for(var a=[],h=n.length,l=0,u=[],c=0;c<r;c++){for(var p=1/0,f=0;f<h;f++){var d=i(t[c],n[f]);d<=p&&(p=d)}a[c]=p}for(var g=0;g<r;g++)l+=a[g];for(var y=0;y<r;y++)u[y]={i:y,v:t[y],pr:a[y]/l,cs:0};u.sort((function(t,e){return t.pr-e.pr})),u[0].cs=u[0].pr;for(var _=1;_<r;_++)u[_].cs=u[_-1].cs+u[_].pr;for(var m=Math.random(),v=0;v<r-1&&u[v++].cs<m;);n.push(u[v-1].v)}return n};function js(t,e,i){i=i||[];for(var n=0;n<t;n++)i[n]=e;return i}var qs=function(t,e,i,n){var r=[],o=[],s=[],a=[],h=!1,l=n||1e4,u=t.length,c=t[0].length,p=c>0,f=[];if(i)r="kmrand"==i?Gs(t,e):"kmpp"==i?zs(t,e):i;else for(var d={};r.length<e;){var g=Math.floor(Math.random()*u);d[g]||(d[g]=!0,r.push(t[g]))}do{js(e,0,f);for(var y=0;y<u;y++){for(var _=1/0,m=0,v=0;v<e;v++)(a=p?ks(t[y],r[v]):Math.abs(t[y]-r[v]))<=_&&(_=a,m=v);s[y]=m,f[m]++}for(var x=[],E=(o=[],0);E<e;E++)x[E]=p?js(c,0,x[E]):0,o[E]=r[E];if(p){for(var w=0;w<e;w++)r[w]=[];for(var b=0;b<u;b++)for(var M=x[s[b]],C=t[b],I=0;I<c;I++)M[I]+=C[I];h=!0;for(var S=0;S<e;S++){for(var P=r[S],N=x[S],R=o[S],T=f[S],L=0;L<c;L++)P[L]=N[L]/T||0;if(h)for(var O=0;O<c;O++)if(R[O]!=P[O]){h=!1;break}}}else{for(var A=0;A<u;A++)x[s[A]]+=t[A];for(var D=0;D<e;D++)r[D]=x[D]/f[D]||0;h=!0;for(var F=0;F<e;F++)if(o[F]!=r[F]){h=!1;break}}h=h||--l<=0}while(!h);return{it:1e4-l,k:e,idxs:s,centroids:r}};function Bs(t,e){return w(jr(t[0],t[1]))===w(jr(e[0],e[1]))}function Us(t,e){if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("Invalid GeoJSON object for "+e)}function Xs(t){for(var e=t,i=[];e.parent;)i.unshift(e),e=e.parent;return i}var Ys={search:function(t,e,i,n){t.cleanDirty();var r=(n=n||{}).heuristic||Ys.heuristics.manhattan,o=n.closest||!1,s=new Ks((function(t){return t.f})),a=e;for(e.h=r(e,i),s.push(e);s.size()>0;){var h=s.pop();if(h===i)return Xs(h);h.closed=!0;for(var l=t.neighbors(h),u=0,c=l.length;u<c;++u){var p=l[u];if(!p.closed&&!p.isWall()){var f=h.g+p.getCost(h),d=p.visited;(!d||f<p.g)&&(p.visited=!0,p.parent=h,p.h=p.h||r(p,i),p.g=f,p.f=p.g+p.h,t.markDirty(p),o&&(p.h<a.h||p.h===a.h&&p.g<a.g)&&(a=p),d?s.rescoreElement(p):s.push(p))}}}return o?Xs(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var i=Math.sqrt(2),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return 1*(n+r)+(i-2)*Math.min(n,r)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function Vs(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var i=0;i<t.length;i++){this.grid[i]=[];for(var n=0,r=t[i];n<r.length;n++){var o=new Ws(i,n,r[n]);this.grid[i][n]=o,this.nodes.push(o)}}this.init()}function Ws(t,e,i){this.x=t,this.y=e,this.weight=i}function Ks(t){this.content=[],this.scoreFunction=t}function Hs(t,e){for(var i=0;i<e.features.length;i++)if(ye(t,e.features[i]))return!0;return!1}function Zs(t){return function(){return t}}function Js(t){return t[0]}function Qs(t){return t[1]}function $s(){this._=null}function ta(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ea(t,e){var i=e,n=e.R,r=i.U;r?r.L===i?r.L=n:r.R=n:t._=n,n.U=r,i.U=n,i.R=n.L,i.R&&(i.R.U=i),n.L=i}function ia(t,e){var i=e,n=e.L,r=i.U;r?r.L===i?r.L=n:r.R=n:t._=n,n.U=r,i.U=n,i.L=n.R,i.L&&(i.L.U=i),n.R=i}function na(t){for(;t.L;)t=t.L;return t}function ra(t,e,i,n){var r=[null,null],o=Pa.push(r)-1;return r.left=t,r.right=e,i&&sa(r,t,e,i),n&&sa(r,e,t,n),Ia[t.index].halfedges.push(o),Ia[e.index].halfedges.push(o),r}function oa(t,e,i){var n=[e,i];return n.left=t,n}function sa(t,e,i,n){t[0]||t[1]?t.left===i?t[1]=n:t[0]=n:(t[0]=n,t.left=e,t.right=i)}function aa(t,e,i,n,r){var o,s=t[0],a=t[1],h=s[0],l=s[1],u=0,c=1,p=a[0]-h,f=a[1]-l;if(o=e-h,p||!(o>0)){if(o/=p,p<0){if(o<u)return;o<c&&(c=o)}else if(p>0){if(o>c)return;o>u&&(u=o)}if(o=n-h,p||!(o<0)){if(o/=p,p<0){if(o>c)return;o>u&&(u=o)}else if(p>0){if(o<u)return;o<c&&(c=o)}if(o=i-l,f||!(o>0)){if(o/=f,f<0){if(o<u)return;o<c&&(c=o)}else if(f>0){if(o>c)return;o>u&&(u=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(o>c)return;o>u&&(u=o)}else if(f>0){if(o<u)return;o<c&&(c=o)}return!(u>0||c<1)||(u>0&&(t[0]=[h+u*p,l+u*f]),c<1&&(t[1]=[h+c*p,l+c*f]),!0)}}}}}function ha(t,e,i,n,r){var o=t[1];if(o)return!0;var s,a,h=t[0],l=t.left,u=t.right,c=l[0],p=l[1],f=u[0],d=u[1],g=(c+f)/2,y=(p+d)/2;if(d===p){if(g<e||g>=n)return;if(c>f){if(h){if(h[1]>=r)return}else h=[g,i];o=[g,r]}else{if(h){if(h[1]<i)return}else h=[g,r];o=[g,i]}}else if(a=y-(s=(c-f)/(d-p))*g,s<-1||s>1)if(c>f){if(h){if(h[1]>=r)return}else h=[(i-a)/s,i];o=[(r-a)/s,r]}else{if(h){if(h[1]<i)return}else h=[(r-a)/s,r];o=[(i-a)/s,i]}else if(p<d){if(h){if(h[0]>=n)return}else h=[e,s*e+a];o=[n,s*n+a]}else{if(h){if(h[0]<e)return}else h=[n,s*n+a];o=[e,s*e+a]}return t[0]=h,t[1]=o,!0}function la(t,e){var i=t.site,n=e.left,r=e.right;return i===r&&(r=n,n=i),r?Math.atan2(r[1]-n[1],r[0]-n[0]):(i===n?(n=e[1],r=e[0]):(n=e[0],r=e[1]),Math.atan2(n[0]-r[0],r[1]-n[1]))}function ua(t,e){return e[+(e.left!==t.site)]}function ca(t,e){return e[+(e.left===t.site)]}Vs.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)Ys.cleanNode(this.nodes[t])},Vs.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)Ys.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},Vs.prototype.markDirty=function(t){this.dirtyNodes.push(t)},Vs.prototype.neighbors=function(t){var e=[],i=t.x,n=t.y,r=this.grid;return r[i-1]&&r[i-1][n]&&e.push(r[i-1][n]),r[i+1]&&r[i+1][n]&&e.push(r[i+1][n]),r[i]&&r[i][n-1]&&e.push(r[i][n-1]),r[i]&&r[i][n+1]&&e.push(r[i][n+1]),this.diagonal&&(r[i-1]&&r[i-1][n-1]&&e.push(r[i-1][n-1]),r[i+1]&&r[i+1][n-1]&&e.push(r[i+1][n-1]),r[i-1]&&r[i-1][n+1]&&e.push(r[i-1][n+1]),r[i+1]&&r[i+1][n+1]&&e.push(r[i+1][n+1])),e},Vs.prototype.toString=function(){for(var t,e,i,n,r=[],o=this.grid,s=0,a=o.length;s<a;s++){for(t=[],i=0,n=(e=o[s]).length;i<n;i++)t.push(e[i].weight);r.push(t.join(" "))}return r.join("\n")},Ws.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Ws.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},Ws.prototype.isWall=function(){return 0===this.weight},Ks.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),i=this.content.pop();e!==this.content.length-1&&(this.content[e]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var i=(t+1>>1)-1,n=this.content[i];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[i]=e,this.content[t]=n,t=i}},bubbleUp:function(t){for(var e=this.content.length,i=this.content[t],n=this.scoreFunction(i);;){var r,o=t+1<<1,s=o-1,a=null;if(s<e){var h=this.content[s];(r=this.scoreFunction(h))<n&&(a=s)}if(o<e){var l=this.content[o];this.scoreFunction(l)<(null===a?n:r)&&(a=o)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=i,t=a}}},$s.prototype={constructor:$s,insert:function(t,e){var i,n,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;i=t}else this._?(t=na(this._),e.P=null,e.N=t,t.P=t.L=e,i=t):(e.P=e.N=null,this._=e,i=null);for(e.L=e.R=null,e.U=i,e.C=!0,t=e;i&&i.C;)i===(n=i.U).L?(r=n.R)&&r.C?(i.C=r.C=!1,n.C=!0,t=n):(t===i.R&&(ea(this,i),i=(t=i).U),i.C=!1,n.C=!0,ia(this,n)):(r=n.L)&&r.C?(i.C=r.C=!1,n.C=!0,t=n):(t===i.L&&(ia(this,i),i=(t=i).U),i.C=!1,n.C=!0,ea(this,n)),i=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,i,n,r=t.U,o=t.L,s=t.R;if(i=o?s?na(s):o:s,r?r.L===t?r.L=i:r.R=i:this._=i,o&&s?(n=i.C,i.C=t.C,i.L=o,o.U=i,i!==s?(r=i.U,i.U=t.U,t=i.R,r.L=t,i.R=s,s.U=i):(i.U=r,r=i,t=i.R)):(n=t.C,t=i),t&&(t.U=r),!n)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,ea(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,ia(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,ea(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,ia(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,ea(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,ia(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var pa,fa=[];function da(){ta(this),this.x=this.y=this.arc=this.site=this.cy=null}function ga(t){var e=t.P,i=t.N;if(e&&i){var n=e.site,r=t.site,o=i.site;if(n!==o){var s=r[0],a=r[1],h=n[0]-s,l=n[1]-a,u=o[0]-s,c=o[1]-a,p=2*(h*c-l*u);if(!(p>=-Ra)){var f=h*h+l*l,d=u*u+c*c,g=(c*f-l*d)/p,y=(h*d-u*f)/p,_=fa.pop()||new da;_.arc=t,_.site=r,_.x=g+s,_.y=(_.cy=y+a)+Math.sqrt(g*g+y*y),t.circle=_;for(var m=null,v=Sa._;v;)if(_.y<v.y||_.y===v.y&&_.x<=v.x){if(!v.L){m=v.P;break}v=v.L}else{if(!v.R){m=v;break}v=v.R}Sa.insert(m,_),m||(pa=_)}}}}function ya(t){var e=t.circle;e&&(e.P||(pa=e.N),Sa.remove(e),fa.push(e),ta(e),t.circle=null)}var _a=[];function ma(){ta(this),this.edge=this.site=this.circle=null}function va(t){var e=_a.pop()||new ma;return e.site=t,e}function xa(t){ya(t),Ca.remove(t),_a.push(t),ta(t)}function Ea(t){var e=t.circle,i=e.x,n=e.cy,r=[i,n],o=t.P,s=t.N,a=[t];xa(t);for(var h=o;h.circle&&Math.abs(i-h.circle.x)<Na&&Math.abs(n-h.circle.cy)<Na;)o=h.P,a.unshift(h),xa(h),h=o;a.unshift(h),ya(h);for(var l=s;l.circle&&Math.abs(i-l.circle.x)<Na&&Math.abs(n-l.circle.cy)<Na;)s=l.N,a.push(l),xa(l),l=s;a.push(l),ya(l);var u,c=a.length;for(u=1;u<c;++u)l=a[u],h=a[u-1],sa(l.edge,h.site,l.site,r);h=a[0],(l=a[c-1]).edge=ra(h.site,l.site,null,r),ga(h),ga(l)}function wa(t){for(var e,i,n,r,o=t[0],s=t[1],a=Ca._;a;)if((n=ba(a,s)-o)>Na)a=a.L;else{if(!((r=o-Ma(a,s))>Na)){n>-Na?(e=a.P,i=a):r>-Na?(e=a,i=a.N):e=i=a;break}if(!a.R){e=a;break}a=a.R}!function(t){Ia[t.index]={site:t,halfedges:[]}}(t);var h=va(t);if(Ca.insert(e,h),e||i){if(e===i)return ya(e),i=va(e.site),Ca.insert(h,i),h.edge=i.edge=ra(e.site,h.site),ga(e),void ga(i);if(i){ya(e),ya(i);var l=e.site,u=l[0],c=l[1],p=t[0]-u,f=t[1]-c,d=i.site,g=d[0]-u,y=d[1]-c,_=2*(p*y-f*g),m=p*p+f*f,v=g*g+y*y,x=[(y*m-f*v)/_+u,(p*v-g*m)/_+c];sa(i.edge,l,d,x),h.edge=ra(l,t,null,x),i.edge=ra(t,d,null,x),ga(e),ga(i)}else h.edge=ra(e.site,h.site)}}function ba(t,e){var i=t.site,n=i[0],r=i[1],o=r-e;if(!o)return n;var s=t.P;if(!s)return-1/0;var a=(i=s.site)[0],h=i[1],l=h-e;if(!l)return a;var u=a-n,c=1/o-1/l,p=u/l;return c?(-p+Math.sqrt(p*p-2*c*(u*u/(-2*l)-h+l/2+r-o/2)))/c+n:(n+a)/2}function Ma(t,e){var i=t.N;if(i)return ba(i,e);var n=t.site;return n[1]===e?n[0]:1/0}var Ca,Ia,Sa,Pa,Na=1e-6,Ra=1e-12;function Ta(t,e){return e[1]-t[1]||e[0]-t[0]}function La(t,e){var i,n,r,o=t.sort(Ta).pop();for(Pa=[],Ia=new Array(t.length),Ca=new $s,Sa=new $s;;)if(r=pa,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===i&&o[1]===n||(wa(o),i=o[0],n=o[1]),o=t.pop();else{if(!r)break;Ea(r.arc)}if(function(){for(var t,e,i,n,r=0,o=Ia.length;r<o;++r)if((t=Ia[r])&&(n=(e=t.halfedges).length)){var s=new Array(n),a=new Array(n);for(i=0;i<n;++i)s[i]=i,a[i]=la(t,Pa[e[i]]);for(s.sort((function(t,e){return a[e]-a[t]})),i=0;i<n;++i)a[i]=e[s[i]];for(i=0;i<n;++i)e[i]=a[i]}}(),e){var s=+e[0][0],a=+e[0][1],h=+e[1][0],l=+e[1][1];!function(t,e,i,n){for(var r,o=Pa.length;o--;)ha(r=Pa[o],t,e,i,n)&&aa(r,t,e,i,n)&&(Math.abs(r[0][0]-r[1][0])>Na||Math.abs(r[0][1]-r[1][1])>Na)||delete Pa[o]}(s,a,h,l),function(t,e,i,n){var r,o,s,a,h,l,u,c,p,f,d,g,y=Ia.length,_=!0;for(r=0;r<y;++r)if(o=Ia[r]){for(s=o.site,a=(h=o.halfedges).length;a--;)Pa[h[a]]||h.splice(a,1);for(a=0,l=h.length;a<l;)d=(f=ca(o,Pa[h[a]]))[0],g=f[1],c=(u=ua(o,Pa[h[++a%l]]))[0],p=u[1],(Math.abs(d-c)>Na||Math.abs(g-p)>Na)&&(h.splice(a,0,Pa.push(oa(s,f,Math.abs(d-t)<Na&&n-g>Na?[t,Math.abs(c-t)<Na?p:n]:Math.abs(g-n)<Na&&i-d>Na?[Math.abs(p-n)<Na?c:i,n]:Math.abs(d-i)<Na&&g-e>Na?[i,Math.abs(c-i)<Na?p:e]:Math.abs(g-e)<Na&&d-t>Na?[Math.abs(p-e)<Na?c:t,e]:null))-1),++l);l&&(_=!1)}if(_){var m,v,x,E=1/0;for(r=0,_=null;r<y;++r)(o=Ia[r])&&(x=(m=(s=o.site)[0]-t)*m+(v=s[1]-e)*v)<E&&(E=x,_=o);if(_){var w=[t,e],b=[t,n],M=[i,n],C=[i,e];_.halfedges.push(Pa.push(oa(s=_.site,w,b))-1,Pa.push(oa(s,b,M))-1,Pa.push(oa(s,M,C))-1,Pa.push(oa(s,C,w))-1)}}for(r=0;r<y;++r)(o=Ia[r])&&(o.halfedges.length||delete Ia[r])}(s,a,h,l)}this.edges=Pa,this.cells=Ia,Ca=Sa=Pa=Ia=null}function Oa(t){return(t=t.slice()).push(t[0]),l([t])}function Aa(t,e,i,n){var r=(n=n||{}).steps||64,o=n.units||"kilometers",s=n.angle||0,a=n.pivot||t,h=n.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!i)throw new Error("ySemiAxis is required");if(!P(n))throw new Error("options must be an object");if(!S(r))throw new Error("steps must be a number");if(!S(s))throw new Error("angle must be a number");var u=J(t);if("degrees"===o)var c=M(s);else e=Br(t,e,90,{units:o}),i=Br(t,i,0,{units:o}),e=J(e)[0]-u[0],i=J(i)[1]-u[1];for(var p=[],f=0;f<r;f+=1){var d=-360*f/r,g=e*i/Math.sqrt(Math.pow(i,2)+Math.pow(e,2)*Math.pow(Da(d),2)),y=e*i/Math.sqrt(Math.pow(e,2)+Math.pow(i,2)/Math.pow(Da(d),2));if(d<-90&&d>=-270&&(g=-g),d<-180&&d>=-360&&(y=-y),"degrees"===o){var _=g*Math.cos(c)+y*Math.sin(c),m=y*Math.cos(c)-g*Math.sin(c);g=_,y=m}p.push([g+u[0],y+u[1]])}return p.push(p[0]),"degrees"===o?l([p],h):$o(l([p],h),s,{pivot:a})}function Da(t){var e=t*Math.PI/180;return Math.tan(e)}function Fa(t,e){void 0===e&&(e={});var i=0,n=0,r=0;return z(t,(function(t,o,s){var a=e.weight?null==s?void 0:s[e.weight]:void 0;if(!S(a=null==a?1:a))throw new Error("weight value must be a number for feature index "+o);(a=Number(a))>0&&L(t,(function(t){i+=t[0]*a,n+=t[1]*a,r+=a}))})),a([i/r,n/r],e.properties,e)}function ka(t,e,i,n,r){var o=n.tolerance||.001,s=0,h=0,l=0,u=0;if(F(i,(function(e){var i,n=null===(i=e.properties)||void 0===i?void 0:i.weight,r=null==n?1:n;if(!S(r=Number(r)))throw new Error("weight value must be a number");if(r>0){u+=1;var o=r*ve(e,t);0===o&&(o=1);var a=r/o;s+=e.geometry.coordinates[0]*a,h+=e.geometry.coordinates[1]*a,l+=a}})),u<1)throw new Error("no features to measure");var c=s/l,p=h/l;return 1===u||0===r||Math.abs(c-e[0])<o&&Math.abs(p-e[1])<o?a([c,p],{medianCandidates:n.medianCandidates}):(n.medianCandidates.push([c,p]),ka([c,p],t,i,n,r-1))}function Ga(t,e){return{x:t[0]-e[0],y:t[1]-e[1]}}function za(t,e){var i=0,n=0;L(t,(function(r,o,s,a,h){h>i&&(i=h,n=o,e.push([]));var l=o-n,u=t.coordinates[h][l+1],c=r[0],p=r[1],f=u[0],d=u[1];e[h].push([.75*c+.25*f,.75*p+.25*d]),e[h].push([.25*c+.75*f,.25*p+.75*d])}),!0),e.forEach((function(t){t.push(t[0])}))}function ja(t,e){var i=0,n=0,r=0;L(t,(function(o,s,a,h,l){h>r&&(r=h,n=s,e.push([[]])),l>i&&(i=l,n=s,e[h].push([]));var u=s-n,c=t.coordinates[h][l][u+1],p=o[0],f=o[1],d=c[0],g=c[1];e[h][l].push([.75*p+.25*d,.75*f+.25*g]),e[h][l].push([.25*p+.75*d,.25*f+.75*g])}),!0),e.forEach((function(t){t.forEach((function(t){t.push(t[0])}))}))}function qa(t,e,i){void 0===i&&(i=2);var n=J(t),r=J(e),o=n[0]-r[0],s=n[1]-r[1];return 1===i?Math.abs(o)+Math.abs(s):Math.pow(Math.pow(o,i)+Math.pow(s,i),1/i)}function Ba(t,e){var i=(e=e||{}).threshold||1e4,n=e.p||2,r=e.binary||!1,o=e.alpha||-1,s=e.standardization||!1,a=[];F(t,(function(t){a.push(xi(t))}));for(var h=[],l=0;l<a.length;l++)h[l]=[];for(l=0;l<a.length;l++)for(var u=l;u<a.length;u++){l===u&&(h[l][u]=0);var c=qa(a[l],a[u],n);h[l][u]=c,h[u][l]=c}for(l=0;l<a.length;l++)for(u=0;u<a.length;u++)0!==(c=h[l][u])&&(h[l][u]=r?c<=i?1:0:c<=i?Math.pow(c,o):0);if(s)for(l=0;l<a.length;l++){var p=h[l].reduce((function(t,e){return t+e}),0);for(u=0;u<a.length;u++)h[l][u]=h[l][u]/p}return h}function Ua(t){for(var e=0,i=0,n=t;i<n.length;i++)e+=n[i];return e/t.length}function Xa(t,e){return void 0===e&&(e={}),Va(t,"mercator",e)}function Ya(t,e){return void 0===e&&(e={}),Va(t,"wgs84",e)}function Va(t,e,i){void 0===i&&(i={});var n=(i=i||{}).mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&S(t[0])?t="mercator"===e?Wa(t):Ka(t):(!0!==n&&(t=Me(t)),L(t,(function(t){var i="mercator"===e?Wa(t):Ka(t);t[0]=i[0],t[1]=i[1]}))),t}function Wa(t){var e=Math.PI/180,i=6378137,n=20037508.342789244,r=[i*(Math.abs(t[0])<=180?t[0]:t[0]-360*function(t){return t<0?-1:t>0?1:0}(t[0]))*e,i*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];return r[0]>n&&(r[0]=n),r[0]<-n&&(r[0]=-n),r[1]>n&&(r[1]=n),r[1]<-n&&(r[1]=-n),r}function Ka(t){var e=180/Math.PI,i=6378137;return[t[0]*e/i,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/i)))*e]}La.prototype={constructor:La,polygons:function(){var t=this.edges;return this.cells.map((function(e){var i=e.halfedges.map((function(i){return ua(e,t[i])}));return i.data=e.site.data,i}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(i,n){if(o=(r=i.halfedges).length)for(var r,o,s,a,h,l,u=i.site,c=-1,p=e[r[o-1]],f=p.left===u?p.right:p.left;++c<o;)s=f,f=(p=e[r[c]]).left===u?p.right:p.left,s&&f&&n<s.index&&n<f.index&&(h=s,l=f,((a=u)[0]-l[0])*(h[1]-a[1])-(a[0]-h[0])*(l[1]-a[1])<0)&&t.push([u.data,s.data,f.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,i){for(var n,r,o=this,s=o._found||0,a=o.cells.length;!(r=o.cells[s]);)if(++s>=a)return null;var h=t-r.site[0],l=e-r.site[1],u=h*h+l*l;do{r=o.cells[n=s],s=null,r.halfedges.forEach((function(i){var n=o.edges[i],a=n.left;if(a!==r.site&&a||(a=n.right)){var h=t-a[0],l=e-a[1],c=h*h+l*l;c<u&&(u=c,s=a.index)}}))}while(null!==s);return o._found=n,null==i||u<=i*i?r.site:null}};var Ha=Object.freeze({__proto__:null,toMercator:Xa,toWgs84:Ya}),Za=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),r=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)n[r]=o[s];return n};function Ja(t){return Array.isArray(t)?ih(t):t&&t.bbox?ih(t.bbox):[360*eh(),180*eh()]}function Qa(t,e){void 0===e&&(e={}),null==t&&(t=1);for(var i=[],n=0;n<t;n++)i.push(a(Ja(e.bbox)));return f(i)}function $a(t,e){void 0===e&&(e={}),null==t&&(t=1),S(e.num_vertices)&&void 0!==e.num_vertices||(e.num_vertices=10),S(e.max_radial_length)&&void 0!==e.max_radial_length||(e.max_radial_length=10);for(var i=[],n=function(t){var n,r=[],o=Za(Array(e.num_vertices+1)).map(Math.random);o.forEach((function(t,e,i){i[e]=e>0?t+i[e-1]:t})),o.forEach((function(t){t=2*t*Math.PI/o[o.length-1];var i=Math.random();r.push([i*(e.max_radial_length||10)*Math.sin(t),i*(e.max_radial_length||10)*Math.cos(t)])})),r[r.length-1]=r[0],r=r.map((n=Ja(e.bbox),function(t){return[t[0]+n[0],t[1]+n[1]]})),i.push(l([r]))},r=0;r<t;r++)n();return f(i)}function th(t,e){if(void 0===e&&(e={}),!P(e=e||{}))throw new Error("options is invalid");var i=e.bbox,n=e.num_vertices,r=e.max_length,o=e.max_rotation;null==t&&(t=1),(!S(n)||void 0===n||n<2)&&(n=10),S(r)&&void 0!==r||(r=1e-4),S(o)&&void 0!==o||(o=Math.PI/8);for(var s=[],a=0;a<t;a++){for(var h=[Ja(i)],l=0;l<n-1;l++){var u=(0===l?2*Math.random()*Math.PI:Math.tan((h[l][1]-h[l-1][1])/(h[l][0]-h[l-1][0])))+(Math.random()-.5)*o*2,p=Math.random()*r;h.push([h[l][0]+p*Math.cos(u),h[l][1]+p*Math.sin(u)])}s.push(c(h))}return f(s)}function eh(){return Math.random()-.5}function ih(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}var nh=Object.freeze({__proto__:null,randomPosition:Ja,randomPoint:Qa,randomPolygon:$a,randomLineString:th});function rh(t,e){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("filter is required");var i=[];return F(t,(function(t){hh(t.properties,e)&&i.push(t)})),f(i)}function oh(t,e,i){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("property is required");for(var n=ah(t,e),r=Object.keys(n),o=0;o<r.length;o++){for(var s=r[o],a=n[s],h=[],l=0;l<a.length;l++)h.push(t.features[a[l]]);i(f(h),s,o)}}function sh(t,e,i,n){var r=n;return oh(t,e,(function(t,e,o){r=0===o&&void 0===n?t:i(r,t,e,o)})),r}function ah(t,e){var i={};return F(t,(function(t,n){var r=t.properties||{};if(Object.prototype.hasOwnProperty.call(r,String(e))){var o=r[e];Object.prototype.hasOwnProperty.call(i,o)?i[o].push(n):i[o]=[n]}})),i}function hh(t,e){if(void 0===t)return!1;var i=typeof e;if("number"===i||"string"===i)return Object.prototype.hasOwnProperty.call(t,e);if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(!hh(t,e[n]))return!1;return!0}return lh(t,e)}function lh(t,e){for(var i=Object.keys(e),n=0;n<i.length;n++){var r=i[n];if(t[r]!==e[r])return!1}return!0}function uh(t,e){if(!e)return{};if(!e.length)return{};for(var i={},n=0;n<e.length;n++){var r=e[n];Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i}var ch=Object.freeze({__proto__:null,getCluster:rh,clusterEach:oh,clusterReduce:sh,createBins:ah,applyFilter:hh,propertiesContainsFilter:lh,filterProperties:uh}),ph=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};
/**
     * splaytree v3.1.0
     * Fast Splay tree for Node and browser
     *
     * @author Alexander Milevski <info@w8r.name>
     * @license MIT
     * @preserve
     */function fh(t,e){return t>e?1:t<e?-1:0}function dh(t,e,i){for(var n=new ph(null,null),r=n,o=n;;){var s=i(t,e.key);if(s<0){if(null===e.left)break;if(i(t,e.left.key)<0){var a=e.left;if(e.left=a.right,a.right=e,null===(e=a).left)break}o.left=e,o=e,e=e.left}else{if(!(s>0))break;if(null===e.right)break;if(i(t,e.right.key)>0&&(a=e.right,e.right=a.left,a.left=e,null===(e=a).right))break;r.right=e,r=e,e=e.right}}return r.right=e.left,o.left=e.right,e.left=n.right,e.right=n.left,e}function gh(t,e,i,n){var r=new ph(t,e);if(null===i)return r.left=r.right=null,r;var o=n(t,(i=dh(t,i,n)).key);return o<0?(r.left=i.left,r.right=i,i.left=null):o>=0&&(r.right=i.right,r.left=i,i.right=null),r}function yh(t,e,i){var n=null,r=null;if(e){var o=i((e=dh(t,e,i)).key,t);0===o?(n=e.left,r=e.right):o<0?(r=e.right,e.right=null,n=e):(n=e.left,e.left=null,r=e)}return{left:n,right:r}}function _h(t,e,i,n,r){if(t){n(e+(i?"└── ":"├── ")+r(t)+"\n");var o=e+(i?"    ":"│   ");t.left&&_h(t.left,o,!1,n,r),t.right&&_h(t.right,o,!0,n,r)}}var mh=function(){function t(t){void 0===t&&(t=fh),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=gh(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var i=new ph(t,e);null===this._root&&(i.left=i.right=null,this._size++,this._root=i);var n=this._comparator,r=dh(t,this._root,n),o=n(t,r.key);return 0===o?this._root=r:(o<0?(i.left=r.left,i.right=r,r.left=null):o>0&&(i.right=r.right,i.left=r,r.right=null),this._size++,this._root=i),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,i){var n;return null===e?null:0===i(t,(e=dh(t,e,i)).key)?(null===e.left?n=e.right:(n=dh(t,e.left,i)).right=e.right,this._size--,n):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=dh(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=dh(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var i=this._root,n=[],r=!1;!r;)null!==i?(n.push(i),i=i.left):0!==n.length?(i=n.pop(),t.call(e,i),i=i.right):r=!0;return this},t.prototype.range=function(t,e,i,n){for(var r=[],o=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var i=e.key;return t.push(i)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var i=e.data;return t.push(i)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,i=!1,n=0,r=[];!i;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),n===t)return e;n++,e=e.right}else i=!0;return null},t.prototype.next=function(t){var e=this._root,i=null;if(t.right){for(i=t.right;i.left;)i=i.left;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?(i=e,e=e.left):e=e.right}return i},t.prototype.prev=function(t){var e=this._root,i=null;if(null!==t.left){for(i=t.left;i.right;)i=i.right;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?e=e.left:(i=e,e=e.right)}return i},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){for(var e=t,i=[],n=!1,r=new ph(null,null),o=r;!n;)e?(i.push(e),e=e.left):i.length>0?e=(e=o=o.next=i.pop()).right:n=!0;return o.next=null,r.next}(this._root)},t.prototype.load=function(t,e,i){void 0===e&&(e=[]),void 0===i&&(i=!1);var n=t.length,r=this._comparator;if(i&&Eh(t,e,0,n-1,r),null===this._root)this._root=vh(t,e,0,n),this._size=n;else{var o=function(t,e,i){for(var n=new ph(null,null),r=n,o=t,s=e;null!==o&&null!==s;)i(o.key,s.key)<0?(r.next=o,o=o.next):(r.next=s,s=s.next),r=r.next;return null!==o?r.next=o:null!==s&&(r.next=s),n.next}(this.toList(),function(t,e){for(var i=new ph(null,null),n=i,r=0;r<t.length;r++)n=n.next=new ph(t[r],e[r]);return n.next=null,i.next}(t,e),r);n=this._size+n,this._root=xh({head:o},0,n)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return _h(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,i){var n=this._comparator,r=yh(t,this._root,n),o=r.left,s=r.right;n(t,e)<0?s=gh(e,i,s,n):o=gh(e,i,o,n),this._root=function(t,e,i){return null===e?t:(null===t||((e=dh(t.key,e,i)).left=t),e)}(o,s,n)},t.prototype.split=function(t){return yh(t,this._root,this._comparator)},t}();function vh(t,e,i,n){var r=n-i;if(r>0){var o=i+Math.floor(r/2),s=t[o],a=e[o],h=new ph(s,a);return h.left=vh(t,e,i,o),h.right=vh(t,e,o+1,n),h}return null}function xh(t,e,i){var n=i-e;if(n>0){var r=e+Math.floor(n/2),o=xh(t,e,r),s=t.head;return s.left=o,t.head=t.head.next,s.right=xh(t,r+1,i),s}return null}function Eh(t,e,i,n,r){if(!(i>=n)){for(var o=t[i+n>>1],s=i-1,a=n+1;;){do{s++}while(r(t[s],o)<0);do{a--}while(r(t[a],o)>0);if(s>=a)break;var h=t[s];t[s]=t[a],t[a]=h,h=e[s],e[s]=e[a],e[a]=h}Eh(t,e,i,a,r),Eh(t,e,a+1,n,r)}}function wh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mh(t,e,i){return e&&bh(t.prototype,e),i&&bh(t,i),t}var Ch=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},Ih=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var i=t.ll.x<e.ll.x?e.ll.x:t.ll.x,n=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},Sh=Number.EPSILON;void 0===Sh&&(Sh=Math.pow(2,-52));var Ph=Sh*Sh,Nh=function(t,e){if(-Sh<t&&t<Sh&&-Sh<e&&e<Sh)return 0;var i=t-e;return i*i<Ph*t*e?0:t<e?-1:1},Rh=function(){function t(){wh(this,t),this.reset()}return Mh(t,[{key:"reset",value:function(){this.xRounder=new Th,this.yRounder=new Th}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),Th=function(){function t(){wh(this,t),this.tree=new mh,this.round(0)}return Mh(t,[{key:"round",value:function(t){var e=this.tree.add(t),i=this.tree.prev(e);if(null!==i&&0===Nh(e.key,i.key))return this.tree.remove(t),i.key;var n=this.tree.next(e);return null!==n&&0===Nh(e.key,n.key)?(this.tree.remove(t),n.key):t}}]),t}(),Lh=new Rh,Oh=function(t,e){return t.x*e.y-t.y*e.x},Ah=function(t,e){return t.x*e.x+t.y*e.y},Dh=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y},o=Oh(n,r);return Nh(o,0)},Fh=function(t){return Math.sqrt(Ah(t,t))},kh=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return Ah(r,n)/Fh(r)/Fh(n)},Gh=function(t,e,i){return 0===e.y?null:{x:t.x+e.x/e.y*(i-t.y),y:i}},zh=function(t,e,i){return 0===e.x?null:{x:i,y:t.y+e.y/e.x*(i-t.x)}},jh=function(){function t(e,i){wh(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=i}return Mh(t,null,[{key:"compare",value:function(e,i){var n=t.comparePoints(e.point,i.point);return 0!==n?n:(e.point!==i.point&&e.link(i),e.isLeft!==i.isLeft?e.isLeft?1:-1:Bh.compare(e.segment,i.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),Mh(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,i=0,n=e.length;i<n;i++){var r=e[i];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var i=this.point.events[e];if(void 0===i.segment.consumedBy)for(var n=e+1;n<t;n++){var r=this.point.events[n];void 0===r.consumedBy&&i.otherSE.point.events===r.otherSE.point.events&&i.segment.consume(r.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,i=this.point.events.length;e<i;e++){var n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,i=new Map,n=function(n){var r,o,s,a,h,l=n.otherSE;i.set(n,{sine:(r=e.point,o=t.point,s=l.point,a={x:o.x-r.x,y:o.y-r.y},h={x:s.x-r.x,y:s.y-r.y},Oh(h,a)/Fh(h)/Fh(a)),cosine:kh(e.point,t.point,l.point)})};return function(t,e){i.has(t)||n(t),i.has(e)||n(e);var r=i.get(t),o=r.sine,s=r.cosine,a=i.get(e),h=a.sine,l=a.cosine;return o>=0&&h>=0?s<l?1:s>l?-1:0:o<0&&h<0?s<l?-1:s>l?1:0:h<o?-1:h>o?1:0}}}]),t}(),qh=0,Bh=function(){function t(e,i,n,r){wh(this,t),this.id=++qh,this.leftSE=e,e.segment=this,e.otherSE=i,this.rightSE=i,i.segment=this,i.otherSE=e,this.rings=n,this.windings=r}return Mh(t,null,[{key:"compare",value:function(t,e){var i=t.leftSE.point.x,n=e.leftSE.point.x,r=t.rightSE.point.x,o=e.rightSE.point.x;if(o<i)return 1;if(r<n)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,h=t.rightSE.point.y,l=e.rightSE.point.y;if(i<n){if(a<s&&a<h)return 1;if(a>s&&a>h)return-1;var u=t.comparePoint(e.leftSE.point);if(u<0)return 1;if(u>0)return-1;var c=e.comparePoint(t.rightSE.point);return 0!==c?c:-1}if(i>n){if(s<a&&s<l)return-1;if(s>a&&s>l)return 1;var p=e.comparePoint(t.leftSE.point);if(0!==p)return p;var f=t.comparePoint(e.rightSE.point);return f<0?1:f>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(r<o){var d=e.comparePoint(t.rightSE.point);if(0!==d)return d}if(r>o){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(r!==o){var y=h-s,_=r-i,m=l-a,v=o-n;if(y>_&&m<v)return 1;if(y<_&&m>v)return-1}return r>o?1:r<o||h<l?-1:h>l?1:t.id<e.id?-1:t.id>e.id?1:0}}]),Mh(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,i=this.rightSE.point,n=this.vector();if(e.x===i.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/n.y,o=e.x+r*n.x;if(t.x===o)return 0;var s=(t.x-e.x)/n.x,a=e.y+s*n.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),i=t.bbox(),n=Ih(e,i);if(null===n)return null;var r=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,h=Ch(e,s)&&0===this.comparePoint(s),l=Ch(i,r)&&0===t.comparePoint(r),u=Ch(e,a)&&0===this.comparePoint(a),c=Ch(i,o)&&0===t.comparePoint(o);if(l&&h)return c&&!u?o:!c&&u?a:null;if(l)return u&&r.x===a.x&&r.y===a.y?null:r;if(h)return c&&o.x===s.x&&o.y===s.y?null:s;if(c&&u)return null;if(c)return o;if(u)return a;var p=function(t,e,i,n){if(0===e.x)return zh(i,n,t.x);if(0===n.x)return zh(t,e,i.x);if(0===e.y)return Gh(i,n,t.y);if(0===n.y)return Gh(t,e,i.y);var r=Oh(e,n);if(0==r)return null;var o={x:i.x-t.x,y:i.y-t.y},s=Oh(o,e)/r,a=Oh(o,n)/r;return{x:(t.x+a*e.x+(i.x+s*n.x))/2,y:(t.y+a*e.y+(i.y+s*n.y))/2}}(r,this.vector(),s,t.vector());return null===p?null:Ch(n,p)?Lh.round(p.x,p.y):null}},{key:"split",value:function(e){var i=[],n=void 0!==e.events,r=new jh(e,!0),o=new jh(e,!1),s=this.rightSE;this.replaceRightSE(o),i.push(o),i.push(r);var a=new t(r,s,this.rings.slice(),this.windings.slice());return jh.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),jh.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),o.checkForConsuming()),i}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,i=this.windings.length;e<i;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var i=this,n=e;i.consumedBy;)i=i.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var r=t.compare(i,n);if(0!==r){if(r>0){var o=i;i=n,n=o}if(i.prev===n){var s=i;i=n,n=s}for(var a=0,h=n.rings.length;a<h;a++){var l=n.rings[a],u=n.windings[a],c=i.rings.indexOf(l);-1===c?(i.rings.push(l),i.windings.push(u)):i.windings[c]+=u}n.rings=null,n.windings=null,n.consumedBy=i,n.leftSE.consumedBy=i.leftSE,n.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys,r=0,o=this.rings.length;r<o;r++){var s=this.rings[r],a=this.windings[r],h=e.indexOf(s);-1===h?(e.push(s),i.push(a)):i[h]+=a}for(var l=[],u=[],c=0,p=e.length;c<p;c++)if(0!==i[c]){var f=e[c],d=f.poly;if(-1===u.indexOf(d))if(f.isExterior)l.push(d);else{-1===u.indexOf(d)&&u.push(d);var g=l.indexOf(f.poly);-1!==g&&l.splice(g,1)}}for(var y=0,_=l.length;y<_;y++){var m=l[y].multiPoly;-1===n.indexOf(m)&&n.push(m)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Qh.type){case"union":var i=0===t.length,n=0===e.length;this._isInResult=i!==n;break;case"intersection":var r,o;t.length<e.length?(r=t.length,o=e.length):(r=e.length,o=t.length),this._isInResult=o===Qh.numMultiPolys&&r<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(Qh.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,i,n){var r,o,s,a=jh.comparePoints(e,i);if(a<0)r=e,o=i,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));r=i,o=e,s=-1}return new t(new jh(r,!0),new jh(o,!1),[n],[s])}}]),t}(),Uh=function(){function t(e,i,n){if(wh(this,t),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=n,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=Lh.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var o=r,s=1,a=e.length;s<a;s++){if("number"!=typeof e[s][0]||"number"!=typeof e[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var h=Lh.round(e[s][0],e[s][1]);h.x===o.x&&h.y===o.y||(this.segments.push(Bh.fromRing(o,h,this)),h.x<this.bbox.ll.x&&(this.bbox.ll.x=h.x),h.y<this.bbox.ll.y&&(this.bbox.ll.y=h.y),h.x>this.bbox.ur.x&&(this.bbox.ur.x=h.x),h.y>this.bbox.ur.y&&(this.bbox.ur.y=h.y),o=h)}r.x===o.x&&r.y===o.y||this.segments.push(Bh.fromRing(o,r,this))}return Mh(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.segments.length;e<i;e++){var n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}]),t}(),Xh=function(){function t(e,i){if(wh(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Uh(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,r=e.length;n<r;n++){var o=new Uh(e[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=i}return Mh(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,i=this.interiorRings.length;e<i;e++)for(var n=this.interiorRings[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),t}(),Yh=function(){function t(e,i){if(wh(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,r=e.length;n<r;n++){var o=new Xh(e[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=i}return Mh(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++)for(var n=this.polys[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),t}(),Vh=function(){function t(e){wh(this,t),this.events=e;for(var i=0,n=e.length;i<n;i++)e[i].segment.ringOut=this;this.poly=null}return Mh(t,null,[{key:"factory",value:function(e){for(var i=[],n=0,r=e.length;n<r;n++){var o=e[n];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,h=o.rightSE,l=[a],u=a.point,c=[];s=a,a=h,l.push(a),a.point!==u;)for(;;){var p=a.getAvailableLinkedEvents();if(0===p.length){var f=l[0].point,d=l[l.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(f.x,",")+" ".concat(f.y,"]. Last matching segment found ends at")+" [".concat(d.x,", ").concat(d.y,"]."))}if(1===p.length){h=p[0].otherSE;break}for(var g=null,y=0,_=c.length;y<_;y++)if(c[y].point===a.point){g=y;break}if(null===g){c.push({index:l.length,point:a.point});var m=a.getLeftmostComparator(s);h=p.sort(m)[0].otherSE;break}var v=c.splice(g)[0],x=l.splice(v.index);x.unshift(x[0].otherSE),i.push(new t(x.reverse()))}i.push(new t(l))}}return i}}]),Mh(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],i=1,n=this.events.length-1;i<n;i++){var r=this.events[i].point,o=this.events[i+1].point;0!==Dh(r,t,o)&&(e.push(r),t=r)}if(1===e.length)return null;var s=e[0],a=e[1];0===Dh(s,t,a)&&e.shift(),e.push(e[0]);for(var h=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:e.length-1,u=this.isExteriorRing()?e.length:-1,c=[],p=l;p!=u;p+=h)c.push([e[p].x,e[p].y]);return c}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,i=this.events.length;e<i;e++){var n=this.events[e];jh.compare(t,n)>0&&(t=n)}for(var r=t.segment.prevInResult(),o=r?r.prevInResult():null;;){if(!r)return null;if(!o)return r.ringOut;if(o.ringOut!==r.ringOut)return o.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=o.prevInResult(),o=r?r.prevInResult():null}}}]),t}(),Wh=function(){function t(e){wh(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return Mh(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,i=this.interiorRings.length;e<i;e++){var n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}]),t}(),Kh=function(){function t(e){wh(this,t),this.rings=e,this.polys=this._composePolys(e)}return Mh(t,[{key:"getGeom",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++){var n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}},{key:"_composePolys",value:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];if(!r.poly)if(r.isExteriorRing())e.push(new Wh(r));else{var o=r.enclosingRing();o.poly||e.push(new Wh(o)),o.poly.addInterior(r)}}return e}}]),t}(),Hh=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bh.compare;wh(this,t),this.queue=e,this.tree=new mh(i),this.segments=[]}return Mh(t,[{key:"process",value:function(t){var e=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),i;var n=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!n)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=n,o=n,s=void 0,a=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var h=null;if(s){var l=s.getIntersection(e);if(null!==l&&(e.isAnEndpoint(l)||(h=l),!s.isAnEndpoint(l)))for(var u=this._splitSafely(s,l),c=0,p=u.length;c<p;c++)i.push(u[c])}var f=null;if(a){var d=a.getIntersection(e);if(null!==d&&(e.isAnEndpoint(d)||(f=d),!a.isAnEndpoint(d)))for(var g=this._splitSafely(a,d),y=0,_=g.length;y<_;y++)i.push(g[y])}if(null!==h||null!==f){var m=null;m=null===h?f:null===f||jh.comparePoints(h,f)<=0?h:f,this.queue.remove(e.rightSE),i.push(e.rightSE);for(var v=e.split(m),x=0,E=v.length;x<E;x++)i.push(v[x])}i.length>0?(this.tree.remove(e),i.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var w=s.getIntersection(a);if(null!==w){if(!s.isAnEndpoint(w))for(var b=this._splitSafely(s,w),M=0,C=b.length;M<C;M++)i.push(b[M]);if(!a.isAnEndpoint(w))for(var I=this._splitSafely(a,w),S=0,P=I.length;S<P;S++)i.push(I[S])}}this.tree.remove(e)}return i}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var i=t.rightSE;this.queue.remove(i);var n=t.split(e);return n.push(i),void 0===t.consumedBy&&this.tree.insert(t),n}}]),t}(),Zh=1e6,Jh=1e6,Qh=new(function(){function t(){wh(this,t)}return Mh(t,[{key:"run",value:function(t,e,i){Qh.type=t,Lh.reset();for(var n=[new Yh(e,!0)],r=0,o=i.length;r<o;r++)n.push(new Yh(i[r],!1));if(Qh.numMultiPolys=n.length,"difference"===Qh.type)for(var s=n[0],a=1;a<n.length;)null!==Ih(n[a].bbox,s.bbox)?a++:n.splice(a,1);if("intersection"===Qh.type)for(var h=0,l=n.length;h<l;h++)for(var u=n[h],c=h+1,p=n.length;c<p;c++)if(null===Ih(u.bbox,n[c].bbox))return[];for(var f=new mh(jh.compare),d=0,g=n.length;d<g;d++)for(var y=n[d].getSweepEvents(),_=0,m=y.length;_<m;_++)if(f.insert(y[_]),f.size>Zh)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var v=new Hh(f),x=f.size,E=f.pop();E;){var w=E.key;if(f.size===x){var b=w.segment;throw new Error("Unable to pop() ".concat(w.isLeft?"left":"right"," SweepEvent ")+"[".concat(w.point.x,", ").concat(w.point.y,"] from segment #").concat(b.id," ")+"[".concat(b.leftSE.point.x,", ").concat(b.leftSE.point.y,"] -> ")+"[".concat(b.rightSE.point.x,", ").concat(b.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(f.size>Zh)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(v.segments.length>Jh)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var M=v.process(w),C=0,I=M.length;C<I;C++){var S=M[C];void 0===S.consumedBy&&f.insert(S)}x=f.size,E=f.pop()}Lh.reset();var P=Vh.factory(v.segments);return new Kh(P).getGeom()}}]),t}()),$h={union:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return Qh.run("union",t,i)},intersection:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return Qh.run("intersection",t,i)},xor:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return Qh.run("xor",t,i)},difference:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return Qh.run("difference",t,i)}};"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),i=Math.max(Math.min(e.length,9007199254740991),0)||0,n=1 in arguments&&parseInt(Number(arguments[1]),10)||0;n=n<0?Math.max(i+n,0):Math.min(n,i);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:i;for(r=r<0?Math.max(i+arguments[2],0):Math.min(r,i);n<r;)e[n]=t,++n;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var tl=function(){};tl.prototype.interfaces_=function(){return[]},tl.prototype.getClass=function(){return tl},tl.prototype.equalsWithTolerance=function(t,e,i){return Math.abs(t-e)<=i};var el=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),il=function(){},nl={MAX_VALUE:{configurable:!0}};il.isNaN=function(t){return Number.isNaN(t)},il.doubleToLongBits=function(t){return t},il.longBitsToDouble=function(t){return t},il.isInfinite=function(t){return!Number.isFinite(t)},nl.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(il,nl);var rl=function(){},ol=function(){},sl=function(){};function al(){}var hl=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},ll={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};hl.prototype.setOrdinate=function(t,e){switch(t){case hl.X:this.x=e;break;case hl.Y:this.y=e;break;case hl.Z:this.z=e;break;default:throw new el("Invalid ordinate index: "+t)}},hl.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!tl.equalsWithTolerance(this.x,e.x,i)&&!!tl.equalsWithTolerance(this.y,e.y,i)}},hl.prototype.getOrdinate=function(t){switch(t){case hl.X:return this.x;case hl.Y:return this.y;case hl.Z:return this.z}throw new el("Invalid ordinate index: "+t)},hl.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||il.isNaN(this.z))&&il.isNaN(t.z)},hl.prototype.equals=function(t){return t instanceof hl&&this.equals2D(t)},hl.prototype.equalInZ=function(t,e){return tl.equalsWithTolerance(this.z,t.z,e)},hl.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},hl.prototype.clone=function(){},hl.prototype.copy=function(){return new hl(this)},hl.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},hl.prototype.distance3D=function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)},hl.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},hl.prototype.hashCode=function(){var t=17;return 37*(t=37*t+hl.hashCode(this.x))+hl.hashCode(this.y)},hl.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},hl.prototype.interfaces_=function(){return[rl,ol,al]},hl.prototype.getClass=function(){return hl},hl.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=il.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},ll.DimensionalComparator.get=function(){return ul},ll.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},ll.NULL_ORDINATE.get=function(){return il.NaN},ll.X.get=function(){return 0},ll.Y.get=function(){return 1},ll.Z.get=function(){return 2},Object.defineProperties(hl,ll);var ul=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new el("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};ul.prototype.compare=function(t,e){var i=t,n=e,r=ul.compare(i.x,n.x);if(0!==r)return r;var o=ul.compare(i.y,n.y);return 0!==o?o:this._dimensionsToTest<=2?0:ul.compare(i.z,n.z)},ul.prototype.interfaces_=function(){return[sl]},ul.prototype.getClass=function(){return ul},ul.compare=function(t,e){return t<e?-1:t>e?1:il.isNaN(t)?il.isNaN(e)?0:-1:il.isNaN(e)?1:0};var cl=function(){};cl.prototype.create=function(){},cl.prototype.interfaces_=function(){return[]},cl.prototype.getClass=function(){return cl};var pl=function(){},fl={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};pl.prototype.interfaces_=function(){return[]},pl.prototype.getClass=function(){return pl},pl.toLocationSymbol=function(t){switch(t){case pl.EXTERIOR:return"e";case pl.BOUNDARY:return"b";case pl.INTERIOR:return"i";case pl.NONE:return"-"}throw new el("Unknown location value: "+t)},fl.INTERIOR.get=function(){return 0},fl.BOUNDARY.get=function(){return 1},fl.EXTERIOR.get=function(){return 2},fl.NONE.get=function(){return-1},Object.defineProperties(pl,fl);var dl=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},gl=function(){},yl={LOG_10:{configurable:!0}};gl.prototype.interfaces_=function(){return[]},gl.prototype.getClass=function(){return gl},gl.log10=function(t){var e=Math.log(t);return il.isInfinite(e)||il.isNaN(e)?e:e/gl.LOG_10},gl.min=function(t,e,i,n){var r=t;return e<r&&(r=e),i<r&&(r=i),n<r&&(r=n),r},gl.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var n=arguments[0],r=arguments[1],o=arguments[2];return n<r?r:n>o?o:n}},gl.wrap=function(t,e){return t<0?e- -t%e:t%e},gl.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],i=arguments[0];return t>i&&(i=t),e>i&&(i=e),i}if(4===arguments.length){var n=arguments[1],r=arguments[2],o=arguments[3],s=arguments[0];return n>s&&(s=n),r>s&&(s=r),o>s&&(s=o),s}},gl.average=function(t,e){return(t+e)/2},yl.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(gl,yl);var _l=function(t){this.str=t};_l.prototype.append=function(t){this.str+=t},_l.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},_l.prototype.toString=function(t){return this.str};var ml=function(t){this.value=t};ml.prototype.intValue=function(){return this.value},ml.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},ml.isNaN=function(t){return Number.isNaN(t)};var vl=function(){};vl.isWhitespace=function(t){return t<=32&&t>=0||127===t},vl.toUpperCase=function(t){return t.toUpperCase()};var xl=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length)if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var i=arguments[0];this.init(i)}else"string"==typeof arguments[0]&&t.call(this,t.parse(arguments[0]));else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n,r)}},El={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};xl.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},xl.prototype.extractSignificantDigits=function(t,e){var i=this.abs(),n=xl.magnitude(i._hi),r=xl.TEN.pow(n);(i=i.divide(r)).gt(xl.TEN)?(i=i.divide(xl.TEN),n+=1):i.lt(xl.ONE)&&(i=i.multiply(xl.TEN),n-=1);for(var o=n+1,s=new _l,a=xl.MAX_PRINT_DIGITS-1,h=0;h<=a;h++){t&&h===o&&s.append(".");var l=Math.trunc(i._hi);if(l<0)break;var u=!1,c=0;l>9?(u=!0,c="9"):c="0"+l,s.append(c),i=i.subtract(xl.valueOf(l)).multiply(xl.TEN),u&&i.selfAdd(xl.TEN);var p=!0,f=xl.magnitude(i._hi);if(f<0&&Math.abs(f)>=a-h&&(p=!1),!p)break}return e[0]=n,s.toString()},xl.prototype.sqr=function(){return this.multiply(this)},xl.prototype.doubleValue=function(){return this._hi+this._lo},xl.prototype.subtract=function(){if(arguments[0]instanceof xl){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},xl.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},xl.prototype.isZero=function(){return 0===this._hi&&0===this._lo},xl.prototype.selfSubtract=function(){if(arguments[0]instanceof xl){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},xl.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},xl.prototype.min=function(t){return this.le(t)?this:t},xl.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof xl){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1],r=null,o=null,s=null,a=null,h=null,l=null,u=null,c=null;return h=this._hi/i,c=(r=(l=xl.SPLIT*h)-(r=l-h))*(s=(c=xl.SPLIT*i)-(s=c-i))-(u=h*i)+r*(a=i-s)+(o=h-r)*s+o*a,c=h+(l=(this._hi-u-c+this._lo-h*n)/i),this._hi=c,this._lo=h-c+l,this}},xl.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},xl.prototype.divide=function(){if(arguments[0]instanceof xl){var t=arguments[0],e=null,i=null,n=null,r=null,o=null,s=null,a=null,h=null;i=(o=this._hi/t._hi)-(e=(s=xl.SPLIT*o)-(e=s-o)),h=e*(n=(h=xl.SPLIT*t._hi)-(n=h-t._hi))-(a=o*t._hi)+e*(r=t._hi-n)+i*n+i*r;var l=h=o+(s=(this._hi-a-h+this._lo-o*t._lo)/t._hi);return new xl(l,o-h+s)}if("number"==typeof arguments[0]){var u=arguments[0];return il.isNaN(u)?xl.createNaN():xl.copy(this).selfDivide(u,0)}},xl.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},xl.prototype.pow=function(t){if(0===t)return xl.valueOf(1);var e=new xl(this),i=xl.valueOf(1),n=Math.abs(t);if(n>1)for(;n>0;)n%2==1&&i.selfMultiply(e),(n/=2)>0&&(e=e.sqr());else i=e;return t<0?i.reciprocal():i},xl.prototype.ceil=function(){if(this.isNaN())return xl.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new xl(t,e)},xl.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},xl.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},xl.prototype.setValue=function(){if(arguments[0]instanceof xl){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},xl.prototype.max=function(t){return this.ge(t)?this:t},xl.prototype.sqrt=function(){if(this.isZero())return xl.valueOf(0);if(this.isNegative())return xl.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,i=xl.valueOf(e),n=this.subtract(i.sqr())._hi*(.5*t);return i.add(n)},xl.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof xl){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],i=null,n=null,r=null,o=null,s=null,a=null;return o=(r=this._hi+e)-(s=r-this._hi),n=(a=(o=e-s+(this._hi-o))+this._lo)+(r-(i=r+a)),this._hi=i+n,this._lo=n+(i-this._hi),this}}else if(2===arguments.length){var h=arguments[0],l=arguments[1],u=null,c=null,p=null,f=null,d=null,g=null,y=null;f=this._hi+h,c=this._lo+l,d=f-(g=f-this._hi),p=c-(y=c-this._lo);var _=(u=f+(g=(d=h-g+(this._hi-d))+c))+(g=(p=l-y+(this._lo-p))+(g+(f-u))),m=g+(u-_);return this._hi=_,this._lo=m,this}},xl.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof xl){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1],r=null,o=null,s=null,a=null,h=null,l=null;r=(h=xl.SPLIT*this._hi)-this._hi,l=xl.SPLIT*i,r=h-r,o=this._hi-r,s=l-i;var u=(h=this._hi*i)+(l=r*(s=l-s)-h+r*(a=i-s)+o*s+o*a+(this._hi*n+this._lo*i)),c=l+(r=h-u);return this._hi=u,this._lo=c,this}},xl.prototype.selfSqr=function(){return this.selfMultiply(this)},xl.prototype.floor=function(){if(this.isNaN())return xl.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new xl(t,e)},xl.prototype.negate=function(){return this.isNaN()?this:new xl(-this._hi,-this._lo)},xl.prototype.clone=function(){},xl.prototype.multiply=function(){if(arguments[0]instanceof xl){var t=arguments[0];return t.isNaN()?xl.createNaN():xl.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return il.isNaN(e)?xl.createNaN():xl.copy(this).selfMultiply(e,0)}},xl.prototype.isNaN=function(){return il.isNaN(this._hi)},xl.prototype.intValue=function(){return Math.trunc(this._hi)},xl.prototype.toString=function(){var t=xl.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},xl.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!0,e),n=e[0]+1,r=i;if("."===i.charAt(0))r="0"+i;else if(n<0)r="0."+xl.stringOfChar("0",-n)+i;else if(-1===i.indexOf(".")){var o=n-i.length;r=i+xl.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},xl.prototype.reciprocal=function(){var t,e,i,n,r=null,o=null,s=null,a=null;t=(i=1/this._hi)-(r=(s=xl.SPLIT*i)-(r=s-i)),o=(a=xl.SPLIT*this._hi)-this._hi;var h=i+(s=(1-(n=i*this._hi)-(a=r*(o=a-o)-n+r*(e=this._hi-o)+t*o+t*e)-i*this._lo)/this._hi);return new xl(h,i-h+s)},xl.prototype.toSciNotation=function(){if(this.isZero())return xl.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!1,e),n=xl.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===i.charAt(0))throw new Error("Found leading zero: "+i);var r="";i.length>1&&(r=i.substring(1));var o=i.charAt(0)+"."+r;return this.isNegative()?"-"+o+n:o+n},xl.prototype.abs=function(){return this.isNaN()?xl.NaN:this.isNegative()?this.negate():new xl(this)},xl.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},xl.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},xl.prototype.add=function(){if(arguments[0]instanceof xl){var t=arguments[0];return xl.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return xl.copy(this).selfAdd(e)}},xl.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof xl){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this._hi=i,this._lo=n}},xl.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},xl.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},xl.prototype.trunc=function(){return this.isNaN()?xl.NaN:this.isPositive()?this.floor():this.ceil()},xl.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},xl.prototype.interfaces_=function(){return[al,rl,ol]},xl.prototype.getClass=function(){return xl},xl.sqr=function(t){return xl.valueOf(t).selfMultiply(t)},xl.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return xl.parse(t)}if("number"==typeof arguments[0])return new xl(arguments[0])},xl.sqrt=function(t){return xl.valueOf(t).sqrt()},xl.parse=function(t){for(var e=0,i=t.length;vl.isWhitespace(t.charAt(e));)e++;var n=!1;if(e<i){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(n=!0))}for(var o=new xl,s=0,a=0,h=0;!(e>=i);){var l=t.charAt(e);if(e++,vl.isDigit(l)){var u=l-"0";o.selfMultiply(xl.TEN),o.selfAdd(u),s++}else{if("."!==l){if("e"===l||"E"===l){var c=t.substring(e);try{h=ml.parseInt(c)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+c+" in string "+t):e}break}throw new Error("Unexpected character '"+l+"' at position "+e+" in string "+t)}a=s}}var p=o,f=s-a-h;if(0===f)p=o;else if(f>0){var d=xl.TEN.pow(f);p=o.divide(d)}else if(f<0){var g=xl.TEN.pow(-f);p=o.multiply(g)}return n?p.negate():p},xl.createNaN=function(){return new xl(il.NaN,il.NaN)},xl.copy=function(t){return new xl(t)},xl.magnitude=function(t){var e=Math.abs(t),i=Math.log(e)/Math.log(10),n=Math.trunc(Math.floor(i));return 10*Math.pow(10,n)<=e&&(n+=1),n},xl.stringOfChar=function(t,e){for(var i=new _l,n=0;n<e;n++)i.append(t);return i.toString()},El.PI.get=function(){return new xl(3.141592653589793,12246467991473532e-32)},El.TWO_PI.get=function(){return new xl(6.283185307179586,24492935982947064e-32)},El.PI_2.get=function(){return new xl(1.5707963267948966,6123233995736766e-32)},El.E.get=function(){return new xl(2.718281828459045,14456468917292502e-32)},El.NaN.get=function(){return new xl(il.NaN,il.NaN)},El.EPS.get=function(){return 123259516440783e-46},El.SPLIT.get=function(){return 134217729},El.MAX_PRINT_DIGITS.get=function(){return 32},El.TEN.get=function(){return xl.valueOf(10)},El.ONE.get=function(){return xl.valueOf(1)},El.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},El.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(xl,El);var wl=function(){},bl={DP_SAFE_EPSILON:{configurable:!0}};wl.prototype.interfaces_=function(){return[]},wl.prototype.getClass=function(){return wl},wl.orientationIndex=function(t,e,i){var n=wl.orientationIndexFilter(t,e,i);if(n<=1)return n;var r=xl.valueOf(e.x).selfAdd(-t.x),o=xl.valueOf(e.y).selfAdd(-t.y),s=xl.valueOf(i.x).selfAdd(-e.x),a=xl.valueOf(i.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},wl.signOfDet2x2=function(t,e,i,n){return t.multiply(n).selfSubtract(e.multiply(i)).signum()},wl.intersection=function(t,e,i,n){var r=xl.valueOf(n.y).selfSubtract(i.y).selfMultiply(xl.valueOf(e.x).selfSubtract(t.x)),o=xl.valueOf(n.x).selfSubtract(i.x).selfMultiply(xl.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=xl.valueOf(n.x).selfSubtract(i.x).selfMultiply(xl.valueOf(t.y).selfSubtract(i.y)),h=xl.valueOf(n.y).selfSubtract(i.y).selfMultiply(xl.valueOf(t.x).selfSubtract(i.x)),l=a.subtract(h).selfDivide(s).doubleValue(),u=xl.valueOf(t.x).selfAdd(xl.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),c=xl.valueOf(e.x).selfSubtract(t.x).selfMultiply(xl.valueOf(t.y).selfSubtract(i.y)),p=xl.valueOf(e.y).selfSubtract(t.y).selfMultiply(xl.valueOf(t.x).selfSubtract(i.x)),f=c.subtract(p).selfDivide(s).doubleValue(),d=xl.valueOf(i.y).selfAdd(xl.valueOf(n.y).selfSubtract(i.y).selfMultiply(f)).doubleValue();return new hl(u,d)},wl.orientationIndexFilter=function(t,e,i){var n=null,r=(t.x-i.x)*(e.y-i.y),o=(t.y-i.y)*(e.x-i.x),s=r-o;if(r>0){if(o<=0)return wl.signum(s);n=r+o}else{if(!(r<0))return wl.signum(s);if(o>=0)return wl.signum(s);n=-r-o}var a=wl.DP_SAFE_EPSILON*n;return s>=a||-s>=a?wl.signum(s):2},wl.signum=function(t){return t>0?1:t<0?-1:0},bl.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(wl,bl);var Ml=function(){},Cl={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Cl.X.get=function(){return 0},Cl.Y.get=function(){return 1},Cl.Z.get=function(){return 2},Cl.M.get=function(){return 3},Ml.prototype.setOrdinate=function(t,e,i){},Ml.prototype.size=function(){},Ml.prototype.getOrdinate=function(t,e){},Ml.prototype.getCoordinate=function(){},Ml.prototype.getCoordinateCopy=function(t){},Ml.prototype.getDimension=function(){},Ml.prototype.getX=function(t){},Ml.prototype.clone=function(){},Ml.prototype.expandEnvelope=function(t){},Ml.prototype.copy=function(){},Ml.prototype.getY=function(t){},Ml.prototype.toCoordinateArray=function(){},Ml.prototype.interfaces_=function(){return[ol]},Ml.prototype.getClass=function(){return Ml},Object.defineProperties(Ml,Cl);var Il=function(){},Sl=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Il),Pl=function(){};Pl.arraycopy=function(t,e,i,n,r){for(var o=0,s=e;s<e+r;s++)i[n+o]=t[s],o++},Pl.getProperty=function(t){return{"line.separator":"\n"}[t]};var Nl=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var i=arguments[0],n=arguments[1];this.x=i,this.y=n,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof hl&&arguments[1]instanceof hl){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var h=arguments[0],l=arguments[1],u=arguments[2];this.x=h,this.y=l,this.w=u}else if(4===arguments.length){var c=arguments[0],p=arguments[1],f=arguments[2],d=arguments[3],g=c.y-p.y,y=p.x-c.x,_=c.x*p.y-p.x*c.y,m=f.y-d.y,v=d.x-f.x,x=f.x*d.y-d.x*f.y;this.x=y*x-v*_,this.y=m*_-g*x,this.w=g*v-m*y}};Nl.prototype.getY=function(){var t=this.y/this.w;if(il.isNaN(t)||il.isInfinite(t))throw new Sl;return t},Nl.prototype.getX=function(){var t=this.x/this.w;if(il.isNaN(t)||il.isInfinite(t))throw new Sl;return t},Nl.prototype.getCoordinate=function(){var t=new hl;return t.x=this.getX(),t.y=this.getY(),t},Nl.prototype.interfaces_=function(){return[]},Nl.prototype.getClass=function(){return Nl},Nl.intersection=function(t,e,i,n){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=i.y-n.y,h=n.x-i.x,l=i.x*n.y-n.x*i.y,u=r*h-a*o,c=(o*l-h*s)/u,p=(a*s-r*l)/u;if(il.isNaN(c)||il.isInfinite(c)||il.isNaN(p)||il.isInfinite(p))throw new Sl;return new hl(c,p)};var Rl=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof hl){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var i=arguments[0];this.init(i)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],h=arguments[3];this.init(o,s,a,h)}},Tl={serialVersionUID:{configurable:!0}};Rl.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Rl.prototype.equals=function(t){if(!(t instanceof Rl))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},Rl.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Rl;var e=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny,n=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new Rl(e,n,i,r)},Rl.prototype.isNull=function(){return this._maxx<this._minx},Rl.prototype.getMaxX=function(){return this._maxx},Rl.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof hl){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof Rl){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return!this.isNull()&&i>=this._minx&&i<=this._maxx&&n>=this._miny&&n<=this._maxy}},Rl.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Rl){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof hl){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return!this.isNull()&&!(i>this._maxx||i<this._minx||n>this._maxy||n<this._miny)}},Rl.prototype.getMinY=function(){return this._miny},Rl.prototype.getMinX=function(){return this._minx},Rl.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof hl){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Rl){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=n,this._maxy=n):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),n<this._miny&&(this._miny=n),n>this._maxy&&(this._maxy=n))}},Rl.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},Rl.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Rl.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},Rl.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},Rl.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Rl.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Rl.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Rl.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},Rl.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=i,this._maxy+=i,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Rl.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Rl){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof hl){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return this.covers(i,n)}},Rl.prototype.centre=function(){return this.isNull()?null:new hl((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Rl.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof hl){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Rl){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.init(i.x,n.x,i.y,n.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},Rl.prototype.getMaxY=function(){return this._maxy},Rl.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var i=0;return this._maxy<t._miny?i=t._miny-this._maxy:this._miny>t._maxy&&(i=this._miny-t._maxy),0===e?i:0===i?e:Math.sqrt(e*e+i*i)},Rl.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+hl.hashCode(this._minx))+hl.hashCode(this._maxx))+hl.hashCode(this._miny))+hl.hashCode(this._maxy)},Rl.prototype.interfaces_=function(){return[rl,al]},Rl.prototype.getClass=function(){return Rl},Rl.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2];return i.x>=(t.x<e.x?t.x:e.x)&&i.x<=(t.x>e.x?t.x:e.x)&&i.y>=(t.y<e.y?t.y:e.y)&&i.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),h=Math.max(o.x,s.x),l=Math.min(n.x,r.x),u=Math.max(n.x,r.x);return!(l>h||u<a||(a=Math.min(o.y,s.y),h=Math.max(o.y,s.y),l=Math.min(n.y,r.y),u=Math.max(n.y,r.y),l>h||u<a))}},Tl.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Rl,Tl);var Ll={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Ol=function(t){this.geometryFactory=t||new mc};Ol.prototype.read=function(t){var e,i,n;t=t.replace(/[\n\r]/g," ");var r=Ll.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=Ll.emptyTypeStr.exec(t))[2]=void 0),r&&(i=r[1].toLowerCase(),n=r[2],Dl[i]&&(e=Dl[i].apply(this,[n]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Ol.prototype.write=function(t){return this.extractGeometry(t)},Ol.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Al[e])return null;var i=e.toUpperCase();return t.isEmpty()?i+" EMPTY":i+"("+Al[e].apply(this,[t])+")"};var Al={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Al.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+Al.point.apply(this,[t._geometries[i]])+")");return e.join(",")},linestring:function(t){for(var e=[],i=0,n=t._points._coordinates.length;i<n;++i)e.push(Al.coordinate.apply(this,[t._points._coordinates[i]]));return e.join(",")},linearring:function(t){for(var e=[],i=0,n=t._points._coordinates.length;i<n;++i)e.push(Al.coordinate.apply(this,[t._points._coordinates[i]]));return e.join(",")},multilinestring:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+Al.linestring.apply(this,[t._geometries[i]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Al.linestring.apply(this,[t._shell])+")");for(var i=0,n=t._holes.length;i<n;++i)e.push("("+Al.linestring.apply(this,[t._holes[i]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+Al.polygon.apply(this,[t._geometries[i]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push(this.extractGeometry(t._geometries[i]));return e.join(",")}},Dl={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Ll.spaces);return this.geometryFactory.createPoint(new hl(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPoint();for(var i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(Ll.trimParens,"$1"),n.push(Dl.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(n)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].trim().split(Ll.spaces),n.push(new hl(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(n)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].trim().split(Ll.spaces),n.push(new hl(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(n)},multilinestring:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiLineString();for(var i=t.trim().split(Ll.parenComma),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(Ll.trimParens,"$1"),n.push(Dl.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(n)},polygon:function(t){var e,i,n;if(void 0===t)return this.geometryFactory.createPolygon();for(var r,o=t.trim().split(Ll.parenComma),s=[],a=0,h=o.length;a<h;++a)e=o[a].replace(Ll.trimParens,"$1"),i=Dl.linestring.apply(this,[e]),n=this.geometryFactory.createLinearRing(i._points),0===a?r=n:s.push(n);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var i=t.trim().split(Ll.doubleParenComma),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(Ll.trimParens,"$1"),n.push(Dl.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(n)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),i=[],n=0,r=e.length;n<r;++n)i.push(this.read(e[n]));return this.geometryFactory.createGeometryCollection(i)}},Fl=function(t){this.parser=new Ol(t)};Fl.prototype.write=function(t){return this.parser.write(t)},Fl.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var kl=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),Gl=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(kl),zl=function(){};zl.prototype.interfaces_=function(){return[]},zl.prototype.getClass=function(){return zl},zl.shouldNeverReachHere=function(){if(0===arguments.length)zl.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new Gl("Should never reach here"+(null!==t?": "+t:""))}},zl.isTrue=function(){var t;if(1===arguments.length)zl.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new Gl:new Gl(t)},zl.equals=function(){var t,e,i;if(2===arguments.length)zl.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],i=arguments[2],!(e=arguments[1]).equals(t)))throw new Gl("Expected "+t+" but encountered "+e+(null!==i?": "+i:""))};var jl=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new hl,this._intPt[1]=new hl,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ql={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};jl.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},jl.prototype.getTopologySummary=function(){var t=new _l;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},jl.prototype.computeIntersection=function(t,e,i,n){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=i,this._inputLines[1][1]=n,this._result=this.computeIntersect(t,e,i,n)},jl.prototype.getIntersectionNum=function(){return this._result},jl.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},jl.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},jl.prototype.setPrecisionModel=function(t){this._precisionModel=t},jl.prototype.isInteriorIntersection=function(){var t=this;if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var e=arguments[0],i=0;i<this._result;i++)if(!t._intPt[i].equals2D(t._inputLines[e][0])&&!t._intPt[i].equals2D(t._inputLines[e][1]))return!0;return!1}},jl.prototype.getIntersection=function(t){return this._intPt[t]},jl.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},jl.prototype.hasIntersection=function(){return this._result!==jl.NO_INTERSECTION},jl.prototype.getEdgeDistance=function(t,e){return jl.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},jl.prototype.isCollinear=function(){return this._result===jl.COLLINEAR_INTERSECTION},jl.prototype.toString=function(){return Fl.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Fl.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},jl.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},jl.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},jl.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},jl.prototype.interfaces_=function(){return[]},jl.prototype.getClass=function(){return jl},jl.computeEdgeDistance=function(t,e,i){var n=Math.abs(i.x-e.x),r=Math.abs(i.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(i))o=n>r?n:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=n>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return zl.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},jl.nonRobustComputeEdgeDistance=function(t,e,i){var n=t.x-e.x,r=t.y-e.y,o=Math.sqrt(n*n+r*r);return zl.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},ql.DONT_INTERSECT.get=function(){return 0},ql.DO_INTERSECT.get=function(){return 1},ql.COLLINEAR.get=function(){return 2},ql.NO_INTERSECTION.get=function(){return 0},ql.POINT_INTERSECTION.get=function(){return 1},ql.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(jl,ql);var Bl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new Rl(this._inputLines[0][0],this._inputLines[0][1]),i=new Rl(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&i.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],i=arguments[1],n=arguments[2];if(this._isProper=!1,Rl.intersects(i,n,e)&&0===Yl.orientationIndex(i,n,e)&&0===Yl.orientationIndex(n,i,e))return this._isProper=!0,(e.equals(i)||e.equals(n))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,i,n,r){r.x=this.smallestInAbsValue(t.x,e.x,i.x,n.x),r.y=this.smallestInAbsValue(t.y,e.y,i.y,n.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,i.x-=r.x,i.y-=r.y,n.x-=r.x,n.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,i,n,r){var o=null;try{o=Nl.intersection(t,i,n,r)}catch(s){if(!(s instanceof Sl))throw s;o=e.nearestEndpoint(t,i,n,r)}return o},e.prototype.intersection=function(t,i,n,r){var o=this.intersectionWithNormalization(t,i,n,r);return this.isInSegmentEnvelopes(o)||(o=new hl(e.nearestEndpoint(t,i,n,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,i,n){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(i)<o&&(r=i,o=Math.abs(i)),Math.abs(n)<o&&(r=n),r},e.prototype.checkDD=function(t,e,i,n,r){var o=wl.intersection(t,e,i,n),s=this.isInSegmentEnvelopes(o);Pl.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&Pl.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,i,n){var r=new hl(t),o=new hl(e),s=new hl(i),a=new hl(n),h=new hl;this.normalizeToEnvCentre(r,o,s,a,h);var l=this.safeHCoordinateIntersection(r,o,s,a);return l.x+=h.x,l.y+=h.y,l},e.prototype.computeCollinearIntersection=function(e,i,n,r){var o=Rl.intersects(e,i,n),s=Rl.intersects(e,i,r),a=Rl.intersects(n,r,e),h=Rl.intersects(n,r,i);return o&&s?(this._intPt[0]=n,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&h?(this._intPt[0]=e,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||s||h?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&h?(this._intPt[0]=n,this._intPt[1]=i,!n.equals(i)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||h?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&h?(this._intPt[0]=r,this._intPt[1]=i,!r.equals(i)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,i,n,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,h=t.y>e.y?t.y:e.y,l=i.x<n.x?i.x:n.x,u=i.y<n.y?i.y:n.y,c=i.x>n.x?i.x:n.x,p=i.y>n.y?i.y:n.y,f=((o>l?o:l)+(a<c?a:c))/2,d=((s>u?s:u)+(h<p?h:p))/2;r.x=f,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,i.x-=r.x,i.y-=r.y,n.x-=r.x,n.y-=r.y},e.prototype.computeIntersect=function(e,i,n,r){if(this._isProper=!1,!Rl.intersects(e,i,n,r))return t.NO_INTERSECTION;var o=Yl.orientationIndex(e,i,n),s=Yl.orientationIndex(e,i,r);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=Yl.orientationIndex(n,r,e),h=Yl.orientationIndex(n,r,i);return a>0&&h>0||a<0&&h<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===h?this.computeCollinearIntersection(e,i,n,r):(0===o||0===s||0===a||0===h?(this._isProper=!1,e.equals2D(n)||e.equals2D(r)?this._intPt[0]=e:i.equals2D(n)||i.equals2D(r)?this._intPt[0]=i:0===o?this._intPt[0]=new hl(n):0===s?this._intPt[0]=new hl(r):0===a?this._intPt[0]=new hl(e):0===h&&(this._intPt[0]=new hl(i))):(this._isProper=!0,this._intPt[0]=this.intersection(e,i,n,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,i,n){var r=t,o=Yl.distancePointLine(t,i,n),s=Yl.distancePointLine(e,i,n);return s<o&&(o=s,r=e),(s=Yl.distancePointLine(i,t,e))<o&&(o=s,r=i),(s=Yl.distancePointLine(n,t,e))<o&&(o=s,r=n),r},e}(jl),Ul=function(){};Ul.prototype.interfaces_=function(){return[]},Ul.prototype.getClass=function(){return Ul},Ul.orientationIndex=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,o=i.x-e.x,s=i.y-e.y;return Ul.signOfDet2x2(n,r,o,s)},Ul.signOfDet2x2=function(t,e,i,n){var r=null,o=null,s=null;if(r=1,0===t||0===n)return 0===e||0===i?0:e>0?i>0?-r:r:i>0?r:-r;if(0===e||0===i)return n>0?t>0?r:-r:t>0?-r:r;if(e>0?n>0?e<=n||(r=-r,o=t,t=i,i=o,o=e,e=n,n=o):e<=-n?(r=-r,i=-i,n=-n):(o=t,t=-i,i=o,o=e,e=-n,n=o):n>0?-e<=n?(r=-r,t=-t,e=-e):(o=-t,t=i,i=o,o=-e,e=n,n=o):e>=n?(t=-t,e=-e,i=-i,n=-n):(r=-r,o=-t,t=-i,i=o,o=-e,e=-n,n=o),t>0){if(!(i>0))return r;if(!(t<=i))return r}else{if(i>0)return-r;if(!(t>=i))return-r;r=-r,t=-t,i=-i}for(;;){if((n-=(s=Math.floor(i/t))*e)<0)return-r;if(n>e)return r;if(t>(i-=s*t)+i){if(e<n+n)return r}else{if(e>n+n)return-r;i=t-i,n=e-n,r=-r}if(0===n)return 0===i?0:-r;if(0===i)return r;if((e-=(s=Math.floor(t/i))*n)<0)return r;if(e>n)return-r;if(i>(t-=s*i)+t){if(n<e+e)return-r}else{if(n>e+e)return r;t=i-t,e=n-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var Xl=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};Xl.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var i=t.x,n=e.x;return i>n&&(i=e.x,n=t.x),this._p.x>=i&&this._p.x<=n&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,h=Ul.signOfDet2x2(r,o,s,a);if(0===h)return this._isPointOnSegment=!0,null;a<o&&(h=-h),h>0&&this._crossingCount++}},Xl.prototype.isPointInPolygon=function(){return this.getLocation()!==pl.EXTERIOR},Xl.prototype.getLocation=function(){return this._isPointOnSegment?pl.BOUNDARY:this._crossingCount%2==1?pl.INTERIOR:pl.EXTERIOR},Xl.prototype.isOnSegment=function(){return this._isPointOnSegment},Xl.prototype.interfaces_=function(){return[]},Xl.prototype.getClass=function(){return Xl},Xl.locatePointInRing=function(){if(arguments[0]instanceof hl&&dl(arguments[1],Ml)){for(var t=arguments[1],e=new Xl(arguments[0]),i=new hl,n=new hl,r=1;r<t.size();r++)if(t.getCoordinate(r,i),t.getCoordinate(r-1,n),e.countSegment(i,n),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof hl&&arguments[1]instanceof Array){for(var o=arguments[1],s=new Xl(arguments[0]),a=1;a<o.length;a++){var h=o[a],l=o[a-1];if(s.countSegment(h,l),s.isOnSegment())return s.getLocation()}return s.getLocation()}};var Yl=function(){},Vl={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Yl.prototype.interfaces_=function(){return[]},Yl.prototype.getClass=function(){return Yl},Yl.orientationIndex=function(t,e,i){return wl.orientationIndex(t,e,i)},Yl.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,i=t[0].x,n=1;n<t.length-1;n++){var r=t[n].x-i,o=t[n+1].y;e+=r*(t[n-1].y-o)}return e/2}if(dl(arguments[0],Ml)){var s=arguments[0],a=s.size();if(a<3)return 0;var h=new hl,l=new hl,u=new hl;s.getCoordinate(0,l),s.getCoordinate(1,u);var c=l.x;u.x-=c;for(var p=0,f=1;f<a-1;f++)h.y=l.y,l.x=u.x,l.y=u.y,s.getCoordinate(f+1,u),u.x-=c,p+=l.x*(h.y-u.y);return p/2}},Yl.distanceLineLine=function(t,e,i,n){if(t.equals(e))return Yl.distancePointLine(t,i,n);if(i.equals(n))return Yl.distancePointLine(n,t,e);var r=!1;if(Rl.intersects(t,e,i,n)){var o=(e.x-t.x)*(n.y-i.y)-(e.y-t.y)*(n.x-i.x);if(0===o)r=!0;else{var s=(t.y-i.y)*(n.x-i.x)-(t.x-i.x)*(n.y-i.y),a=((t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y))/o,h=s/o;(h<0||h>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?gl.min(Yl.distancePointLine(t,i,n),Yl.distancePointLine(e,i,n),Yl.distancePointLine(i,t,e),Yl.distancePointLine(n,t,e)):0},Yl.isPointInRing=function(t,e){return Yl.locatePointInRing(t,e)!==pl.EXTERIOR},Yl.computeLength=function(t){var e=t.size();if(e<=1)return 0;var i=0,n=new hl;t.getCoordinate(0,n);for(var r=n.x,o=n.y,s=1;s<e;s++){t.getCoordinate(s,n);var a=n.x,h=n.y,l=a-r,u=h-o;i+=Math.sqrt(l*l+u*u),r=a,o=h}return i},Yl.isCCW=function(t){var e=t.length-1;if(e<3)throw new el("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=t[0],n=0,r=1;r<=e;r++){var o=t[r];o.y>i.y&&(i=o,n=r)}var s=n;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(i)&&s!==n);var a=n;do{a=(a+1)%e}while(t[a].equals2D(i)&&a!==n);var h=t[s],l=t[a];if(h.equals2D(i)||l.equals2D(i)||h.equals2D(l))return!1;var u=Yl.computeOrientation(h,i,l);return 0===u?h.x>l.x:u>0},Yl.locatePointInRing=function(t,e){return Xl.locatePointInRing(t,e)},Yl.distancePointLinePerpendicular=function(t,e,i){var n=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),r=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/n;return Math.abs(r)*Math.sqrt(n)},Yl.computeOrientation=function(t,e,i){return Yl.orientationIndex(t,e,i)},Yl.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new el("Line array must contain at least one vertex");for(var i=t.distance(e[0]),n=0;n<e.length-1;n++){var r=Yl.distancePointLine(t,e[n],e[n+1]);r<i&&(i=r)}return i}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var h=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),l=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/h;if(l<=0)return o.distance(s);if(l>=1)return o.distance(a);var u=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/h;return Math.abs(u)*Math.sqrt(h)}},Yl.isOnLine=function(t,e){for(var i=new Bl,n=1;n<e.length;n++){var r=e[n-1],o=e[n];if(i.computeIntersection(t,r,o),i.hasIntersection())return!0}return!1},Vl.CLOCKWISE.get=function(){return-1},Vl.RIGHT.get=function(){return Yl.CLOCKWISE},Vl.COUNTERCLOCKWISE.get=function(){return 1},Vl.LEFT.get=function(){return Yl.COUNTERCLOCKWISE},Vl.COLLINEAR.get=function(){return 0},Vl.STRAIGHT.get=function(){return Yl.COLLINEAR},Object.defineProperties(Yl,Vl);var Wl=function(){};Wl.prototype.filter=function(t){},Wl.prototype.interfaces_=function(){return[]},Wl.prototype.getClass=function(){return Wl};var Kl=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},Hl={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Kl.prototype.isGeometryCollection=function(){return this.getSortIndex()===Kl.SORTINDEX_GEOMETRYCOLLECTION},Kl.prototype.getFactory=function(){return this._factory},Kl.prototype.getGeometryN=function(t){return this},Kl.prototype.getArea=function(){return 0},Kl.prototype.isRectangle=function(){return!1},Kl.prototype.equals=function(){if(arguments[0]instanceof Kl){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof Kl))return!1;var i=e;return this.equalsExact(i)}},Kl.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},Kl.prototype.geometryChanged=function(){this.apply(Kl.geometryChangedFilter)},Kl.prototype.geometryChangedAction=function(){this._envelope=null},Kl.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},Kl.prototype.getLength=function(){return 0},Kl.prototype.getNumGeometries=function(){return 1},Kl.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var i=arguments[0],n=arguments[1];return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(i,n)}},Kl.prototype.getUserData=function(){return this._userData},Kl.prototype.getSRID=function(){return this._SRID},Kl.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},Kl.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===Kl.SORTINDEX_GEOMETRYCOLLECTION)throw new el("This method does not support GeometryCollection arguments")},Kl.prototype.equal=function(t,e,i){return 0===i?t.equals(e):t.distance(e)<=i},Kl.prototype.norm=function(){var t=this.copy();return t.normalize(),t},Kl.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},Kl.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Rl(this._envelope)},Kl.prototype.setSRID=function(t){this._SRID=t},Kl.prototype.setUserData=function(t){this._userData=t},Kl.prototype.compare=function(t,e){for(var i=t.iterator(),n=e.iterator();i.hasNext()&&n.hasNext();){var r=i.next(),o=n.next(),s=r.compareTo(o);if(0!==s)return s}return i.hasNext()?1:n.hasNext()?-1:0},Kl.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},Kl.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Kl.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Kl.SORTINDEX_MULTIPOINT||this.getSortIndex()===Kl.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Kl.SORTINDEX_MULTIPOLYGON},Kl.prototype.interfaces_=function(){return[ol,rl,al]},Kl.prototype.getClass=function(){return Kl},Kl.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},Kl.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},Hl.serialVersionUID.get=function(){return 0x799ea46522854c00},Hl.SORTINDEX_POINT.get=function(){return 0},Hl.SORTINDEX_MULTIPOINT.get=function(){return 1},Hl.SORTINDEX_LINESTRING.get=function(){return 2},Hl.SORTINDEX_LINEARRING.get=function(){return 3},Hl.SORTINDEX_MULTILINESTRING.get=function(){return 4},Hl.SORTINDEX_POLYGON.get=function(){return 5},Hl.SORTINDEX_MULTIPOLYGON.get=function(){return 6},Hl.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},Hl.geometryChangedFilter.get=function(){return Zl},Object.defineProperties(Kl,Hl);var Zl=function(){};Zl.interfaces_=function(){return[Wl]},Zl.filter=function(t){t.geometryChangedAction()};var Jl=function(){};Jl.prototype.filter=function(t){},Jl.prototype.interfaces_=function(){return[]},Jl.prototype.getClass=function(){return Jl};var Ql=function(){},$l={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Ql.prototype.isInBoundary=function(t){},Ql.prototype.interfaces_=function(){return[]},Ql.prototype.getClass=function(){return Ql},$l.Mod2BoundaryNodeRule.get=function(){return tu},$l.EndPointBoundaryNodeRule.get=function(){return eu},$l.MultiValentEndPointBoundaryNodeRule.get=function(){return iu},$l.MonoValentEndPointBoundaryNodeRule.get=function(){return nu},$l.MOD2_BOUNDARY_RULE.get=function(){return new tu},$l.ENDPOINT_BOUNDARY_RULE.get=function(){return new eu},$l.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new iu},$l.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new nu},$l.OGC_SFS_BOUNDARY_RULE.get=function(){return Ql.MOD2_BOUNDARY_RULE},Object.defineProperties(Ql,$l);var tu=function(){};tu.prototype.isInBoundary=function(t){return t%2==1},tu.prototype.interfaces_=function(){return[Ql]},tu.prototype.getClass=function(){return tu};var eu=function(){};eu.prototype.isInBoundary=function(t){return t>0},eu.prototype.interfaces_=function(){return[Ql]},eu.prototype.getClass=function(){return eu};var iu=function(){};iu.prototype.isInBoundary=function(t){return t>1},iu.prototype.interfaces_=function(){return[Ql]},iu.prototype.getClass=function(){return iu};var nu=function(){};nu.prototype.isInBoundary=function(t){return 1===t},nu.prototype.interfaces_=function(){return[Ql]},nu.prototype.getClass=function(){return nu};var ru=function(){};function ou(t){this.message=t||""}ru.prototype.add=function(){},ru.prototype.addAll=function(){},ru.prototype.isEmpty=function(){},ru.prototype.iterator=function(){},ru.prototype.size=function(){},ru.prototype.toArray=function(){},ru.prototype.remove=function(){},ou.prototype=new Error,ou.prototype.name="IndexOutOfBoundsException";var su=function(){};su.prototype.hasNext=function(){},su.prototype.next=function(){},su.prototype.remove=function(){};var au=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(ru);function hu(t){this.message=t||""}hu.prototype=new Error,hu.prototype.name="NoSuchElementException";var lu=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof ru&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,ru]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var i=this.array_[t];return this.array_[t]=e,i},e.prototype.iterator=function(){return new uu(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new ou;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,i=0,n=this.array_.length;i<n;i++)if(this.array_[i]===t){this.array_.splice(i,1),e=!0;break}return e},e}(au),uu=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new hu;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(su),cu=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.ensureCapacity(i.length),this.add(i,n)}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={coordArrayType:{configurable:!0}};return i.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){var e=this;if(2===arguments.length){for(var i=arguments[1],n=!1,r=arguments[0].iterator();r.hasNext();)e.add(r.next(),i),n=!0;return n}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),i=0;i<this.size();i++)e.add(i,this.get(i).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){var e=this;if(1===arguments.length){var i=arguments[0];t.prototype.add.call(this,i)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],r=arguments[1];return this.add(n,r,!0),!0}if(arguments[0]instanceof hl&&"boolean"==typeof arguments[1]){var o=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(o))return null;t.prototype.add.call(this,o)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var s=arguments[0],a=arguments[1];return this.add(s,a),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var h=arguments[0],l=arguments[1];if(arguments[2])for(var u=0;u<h.length;u++)e.add(h[u],l);else for(var c=h.length-1;c>=0;c--)e.add(h[c],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof hl){var p=arguments[0],f=arguments[1];if(!arguments[2]){var d=this.size();if(d>0){if(p>0&&this.get(p-1).equals2D(f))return null;if(p<d&&this.get(p).equals2D(f))return null}}t.prototype.add.call(this,p,f)}}else if(4===arguments.length){var g=arguments[0],y=arguments[1],_=arguments[2],m=arguments[3],v=1;_>m&&(v=-1);for(var x=_;x!==m;x+=v)e.add(g[x],y);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new hl(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,i),e}(lu),pu=function(){},fu={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};fu.ForwardComparator.get=function(){return du},fu.BidirectionalComparator.get=function(){return gu},fu.coordArrayType.get=function(){return new Array(0).fill(null)},pu.prototype.interfaces_=function(){return[]},pu.prototype.getClass=function(){return pu},pu.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},pu.ptNotInList=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(pu.indexOf(n,e)<0)return n}return null},pu.scroll=function(t,e){var i=pu.indexOf(e,t);if(i<0)return null;var n=new Array(t.length).fill(null);Pl.arraycopy(t,i,n,0,t.length-i),Pl.arraycopy(t,0,n,t.length-i,i),Pl.arraycopy(n,0,t,0,t.length)},pu.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].equals(e[i]))return!1;return!0}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];if(n===r)return!0;if(null===n||null===r)return!1;if(n.length!==r.length)return!1;for(var s=0;s<n.length;s++)if(0!==o.compare(n[s],r[s]))return!1;return!0}},pu.intersection=function(t,e){for(var i=new cu,n=0;n<t.length;n++)e.intersects(t[n])&&i.add(t[n],!0);return i.toCoordinateArray()},pu.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},pu.removeRepeatedPoints=function(t){return pu.hasRepeatedPoints(t)?new cu(t,!1).toCoordinateArray():t},pu.reverse=function(t){for(var e=t.length-1,i=Math.trunc(e/2),n=0;n<=i;n++){var r=t[n];t[n]=t[e-n],t[e-n]=r}},pu.removeNull=function(t){for(var e=0,i=0;i<t.length;i++)null!==t[i]&&e++;var n=new Array(e).fill(null);if(0===e)return n;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(n[r++]=t[o]);return n},pu.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),i=0;i<t.length;i++)e[i]=new hl(t[i]);return e}if(5===arguments.length)for(var n=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],h=0;h<a;h++)o[s+h]=new hl(n[r+h])},pu.isEqualReversed=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=e[t.length-i-1];if(0!==n.compareTo(r))return!1}return!0},pu.envelope=function(t){for(var e=new Rl,i=0;i<t.length;i++)e.expandToInclude(t[i]);return e},pu.toCoordinateArray=function(t){return t.toArray(pu.coordArrayType)},pu.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},pu.indexOf=function(t,e){for(var i=0;i<e.length;i++)if(t.equals(e[i]))return i;return-1},pu.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var i=t.length-1-e,n=t[e].compareTo(t[i]);if(0!==n)return n}return 1},pu.compare=function(t,e){for(var i=0;i<t.length&&i<e.length;){var n=t[i].compareTo(e[i]);if(0!==n)return n;i++}return i<e.length?-1:i<t.length?1:0},pu.minCoordinate=function(t){for(var e=null,i=0;i<t.length;i++)(null===e||e.compareTo(t[i])>0)&&(e=t[i]);return e},pu.extract=function(t,e,i){e=gl.clamp(e,0,t.length);var n=(i=gl.clamp(i,-1,t.length))-e+1;i<0&&(n=0),e>=t.length&&(n=0),i<e&&(n=0);var r=new Array(n).fill(null);if(0===n)return r;for(var o=0,s=e;s<=i;s++)r[o++]=t[s];return r},Object.defineProperties(pu,fu);var du=function(){};du.prototype.compare=function(t,e){return pu.compare(t,e)},du.prototype.interfaces_=function(){return[sl]},du.prototype.getClass=function(){return du};var gu=function(){};gu.prototype.compare=function(t,e){var i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;var r=pu.compare(i,n);return pu.isEqualReversed(i,n)?0:r},gu.prototype.OLDcompare=function(t,e){var i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;for(var r=pu.increasingDirection(i),o=pu.increasingDirection(n),s=r>0?0:i.length-1,a=o>0?0:i.length-1,h=0;h<i.length;h++){var l=i[s].compareTo(n[a]);if(0!==l)return l;s+=r,a+=o}return 0},gu.prototype.interfaces_=function(){return[sl]},gu.prototype.getClass=function(){return gu};var yu=function(){};yu.prototype.get=function(){},yu.prototype.put=function(){},yu.prototype.size=function(){},yu.prototype.values=function(){},yu.prototype.entrySet=function(){};var _u=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(yu);function mu(t){this.message=t||""}function vu(){}mu.prototype=new Error,mu.prototype.name="OperationNotSupported",vu.prototype=new ru,vu.prototype.contains=function(){};var xu=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof ru&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,i=this.array_.length;e<i;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Eu(this)},e}(vu),Eu=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new hu;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new mu},e}(su);function wu(t){return null===t?0:t.color}function bu(t){return null===t?null:t.parent}function Mu(t,e){null!==t&&(t.color=e)}function Cu(t){return null===t?null:t.left}function Iu(t){return null===t?null:t.right}function Su(){this.root_=null,this.size_=0}Su.prototype=new _u,Su.prototype.get=function(t){for(var e=this.root_;null!==e;){var i=t.compareTo(e.key);if(i<0)e=e.left;else{if(!(i>0))return e.value;e=e.right}}return null},Su.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var i,n,r=this.root_;do{if(i=r,(n=t.compareTo(r.key))<0)r=r.left;else{if(!(n>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:i,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return n<0?i.left=s:i.right=s,this.fixAfterInsertion(s),this.size_++,null},Su.prototype.fixAfterInsertion=function(t){var e=this;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(bu(t)===Cu(bu(bu(t)))){var i=Iu(bu(bu(t)));1===wu(i)?(Mu(bu(t),0),Mu(i,0),Mu(bu(bu(t)),1),t=bu(bu(t))):(t===Iu(bu(t))&&(t=bu(t),e.rotateLeft(t)),Mu(bu(t),0),Mu(bu(bu(t)),1),e.rotateRight(bu(bu(t))))}else{var n=Cu(bu(bu(t)));1===wu(n)?(Mu(bu(t),0),Mu(n,0),Mu(bu(bu(t)),1),t=bu(bu(t))):(t===Cu(bu(t))&&(t=bu(t),e.rotateRight(t)),Mu(bu(t),0),Mu(bu(bu(t)),1),e.rotateLeft(bu(bu(t))))}this.root_.color=0},Su.prototype.values=function(){var t=new lu,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=Su.successor(e));)t.add(e.value);return t},Su.prototype.entrySet=function(){var t=new xu,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=Su.successor(e));)t.add(e);return t},Su.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},Su.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},Su.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},Su.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var i=t.parent,n=t;null!==i&&n===i.right;)n=i,i=i.parent;return i},Su.prototype.size=function(){return this.size_};var Pu=function(){};function Nu(){}function Ru(){this.array_=[],arguments[0]instanceof ru&&this.addAll(arguments[0])}Pu.prototype.interfaces_=function(){return[]},Pu.prototype.getClass=function(){return Pu},Nu.prototype=new vu,Ru.prototype=new Nu,Ru.prototype.contains=function(t){for(var e=0,i=this.array_.length;e<i;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},Ru.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,i=this.array_.length;e<i;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},Ru.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Ru.prototype.remove=function(t){throw new mu},Ru.prototype.size=function(){return this.array_.length},Ru.prototype.isEmpty=function(){return 0===this.array_.length},Ru.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},Ru.prototype.iterator=function(){return new Tu(this)};var Tu=function(t){this.treeSet_=t,this.position_=0};Tu.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new hu;return this.treeSet_.array_[this.position_++]},Tu.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Tu.prototype.remove=function(){throw new mu};var Lu=function(){};Lu.sort=function(){var t,e,i,n,r=arguments[0];if(1===arguments.length)n=function(t,e){return t.compareTo(e)},r.sort(n);else if(2===arguments.length)i=arguments[1],n=function(t,e){return i.compare(t,e)},r.sort(n);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),i=arguments[3],n=function(t,e){return i.compare(t,e)},e.sort(n),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},Lu.asList=function(t){for(var e=new lu,i=0,n=t.length;i<n;i++)e.add(t[i]);return e};var Ou=function(){},Au={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Au.P.get=function(){return 0},Au.L.get=function(){return 1},Au.A.get=function(){return 2},Au.FALSE.get=function(){return-1},Au.TRUE.get=function(){return-2},Au.DONTCARE.get=function(){return-3},Au.SYM_FALSE.get=function(){return"F"},Au.SYM_TRUE.get=function(){return"T"},Au.SYM_DONTCARE.get=function(){return"*"},Au.SYM_P.get=function(){return"0"},Au.SYM_L.get=function(){return"1"},Au.SYM_A.get=function(){return"2"},Ou.prototype.interfaces_=function(){return[]},Ou.prototype.getClass=function(){return Ou},Ou.toDimensionSymbol=function(t){switch(t){case Ou.FALSE:return Ou.SYM_FALSE;case Ou.TRUE:return Ou.SYM_TRUE;case Ou.DONTCARE:return Ou.SYM_DONTCARE;case Ou.P:return Ou.SYM_P;case Ou.L:return Ou.SYM_L;case Ou.A:return Ou.SYM_A}throw new el("Unknown dimension value: "+t)},Ou.toDimensionValue=function(t){switch(vl.toUpperCase(t)){case Ou.SYM_FALSE:return Ou.FALSE;case Ou.SYM_TRUE:return Ou.TRUE;case Ou.SYM_DONTCARE:return Ou.DONTCARE;case Ou.SYM_P:return Ou.P;case Ou.SYM_L:return Ou.L;case Ou.SYM_A:return Ou.A}throw new el("Unknown dimension symbol: "+t)},Object.defineProperties(Ou,Au);var Du=function(){};Du.prototype.filter=function(t){},Du.prototype.interfaces_=function(){return[]},Du.prototype.getClass=function(){return Du};var Fu=function(){};Fu.prototype.filter=function(t,e){},Fu.prototype.isDone=function(){},Fu.prototype.isGeometryChanged=function(){},Fu.prototype.interfaces_=function(){return[]},Fu.prototype.getClass=function(){return Fu};var ku=function(t){function e(e,i){if(t.call(this,i),this._geometries=e||[],t.hasNullElements(this._geometries))throw new el("geometries must not contain null elements")}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new Rl,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=0;i<this._geometries.length;i++)for(var n=this._geometries[i].getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var i=arguments[0],n=arguments[1];if(!this.isEquivalentClass(i))return!1;var r=i;if(this._geometries.length!==r._geometries.length)return!1;for(var o=0;o<this._geometries.length;o++)if(!e._geometries[o].equalsExact(r._geometries[o],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Lu.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Ou.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Ou.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){var e=arguments[0],i=new Ru(Lu.asList(this._geometries)),n=new Ru(Lu.asList(e._geometries));return this.compare(i,n)}if(2===arguments.length){for(var r=arguments[1],o=arguments[0],s=this.getNumGeometries(),a=o.getNumGeometries(),h=0;h<s&&h<a;){var l=t.getGeometryN(h),u=o.getGeometryN(h),c=l.compareToSameClass(u,r);if(0!==c)return c;h++}return h<s?1:h<a?-1:0}},e.prototype.apply=function(){var t=this;if(dl(arguments[0],Jl))for(var e=arguments[0],i=0;i<this._geometries.length;i++)t._geometries[i].apply(e);else if(dl(arguments[0],Fu)){var n=arguments[0];if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(t._geometries[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(dl(arguments[0],Du)){var o=arguments[0];o.filter(this);for(var s=0;s<this._geometries.length;s++)t._geometries[s].apply(o)}else if(dl(arguments[0],Wl)){var a=arguments[0];a.filter(this);for(var h=0;h<this._geometries.length;h++)t._geometries[h].apply(a)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),zl.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var i=0;i<this._geometries.length;i++)e._geometries[i]=this._geometries[i].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,i),e}(Kl),Gu=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Kl.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Ou.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[t-1-i]=this._geometries[i].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new zu(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Pu]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,i),e}(ku),zu=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=Ql.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=n}};zu.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},zu.prototype.getBoundary=function(){return this._geom instanceof Zu?this.boundaryLineString(this._geom):this._geom instanceof Gu?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},zu.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},zu.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},zu.prototype.computeBoundaryCoordinates=function(t){var e=this,i=new lu;this._endpointMap=new Su;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);0!==r.getNumPoints()&&(e.addEndpoint(r.getCoordinateN(0)),e.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var o=this._endpointMap.entrySet().iterator();o.hasNext();){var s=o.next(),a=s.getValue().count;e._bnRule.isInBoundary(a)&&i.add(s.getKey())}return pu.toCoordinateArray(i)},zu.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new ju,this._endpointMap.put(t,e)),e.count++},zu.prototype.interfaces_=function(){return[]},zu.prototype.getClass=function(){return zu},zu.getBoundary=function(){return 1===arguments.length?new zu(arguments[0]).getBoundary():2===arguments.length?new zu(arguments[0],arguments[1]).getBoundary():void 0};var ju=function(){this.count=null};function qu(){}function Bu(){}ju.prototype.interfaces_=function(){return[]},ju.prototype.getClass=function(){return ju};var Uu=function(){};function Xu(){}function Yu(){}function Vu(){}var Wu=function(){},Ku={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Wu.prototype.interfaces_=function(){return[]},Wu.prototype.getClass=function(){return Wu},Wu.chars=function(t,e){for(var i=new Array(e).fill(null),n=0;n<e;n++)i[n]=t;return String(i)},Wu.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new Xu,i=new qu(e);return t.printStackTrace(i),e.toString()}if(2===arguments.length){for(var n=arguments[0],r=arguments[1],o="",s=new Vu(new Bu(Wu.getStackTrace(n))),a=0;a<r;a++)try{o+=s.readLine()+Wu.NEWLINE}catch(t){if(!(t instanceof Yu))throw t;zl.shouldNeverReachHere()}return o}},Wu.split=function(t,e){for(var i=e.length,n=new lu,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);n.add(s),o=(r=r.substring(o+i)).indexOf(e)}r.length>0&&n.add(r);for(var a=new Array(n.size()).fill(null),h=0;h<a.length;h++)a[h]=n.get(h);return a},Wu.toString=function(){if(1===arguments.length){var t=arguments[0];return Wu.SIMPLE_ORDINATE_FORMAT.format(t)}},Wu.spaces=function(t){return Wu.chars(" ",t)},Ku.NEWLINE.get=function(){return Pl.getProperty("line.separator")},Ku.SIMPLE_ORDINATE_FORMAT.get=function(){return new Uu("0.#")},Object.defineProperties(Wu,Ku);var Hu=function(){};Hu.prototype.interfaces_=function(){return[]},Hu.prototype.getClass=function(){return Hu},Hu.copyCoord=function(t,e,i,n){for(var r=Math.min(t.getDimension(),i.getDimension()),o=0;o<r;o++)i.setOrdinate(n,o,t.getOrdinate(e,o))},Hu.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,Ml.X)===t.getOrdinate(e-1,Ml.X)&&t.getOrdinate(0,Ml.Y)===t.getOrdinate(e-1,Ml.Y)},Hu.isEqual=function(t,e){var i=t.size();if(i!==e.size())return!1;for(var n=Math.min(t.getDimension(),e.getDimension()),r=0;r<i;r++)for(var o=0;o<n;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||il.isNaN(s)&&il.isNaN(a)))return!1}return!0},Hu.extend=function(t,e,i){var n=t.create(i,e.getDimension()),r=e.size();if(Hu.copy(e,0,n,0,r),r>0)for(var o=r;o<i;o++)Hu.copy(e,r-1,n,o,1);return n},Hu.reverse=function(t){for(var e=t.size()-1,i=Math.trunc(e/2),n=0;n<=i;n++)Hu.swap(t,n,e-n)},Hu.swap=function(t,e,i){if(e===i)return null;for(var n=0;n<t.getDimension();n++){var r=t.getOrdinate(e,n);t.setOrdinate(e,n,t.getOrdinate(i,n)),t.setOrdinate(i,n,r)}},Hu.copy=function(t,e,i,n,r){for(var o=0;o<r;o++)Hu.copyCoord(t,e+o,i,n+o)},Hu.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var i=t.getDimension(),n=new _l;n.append("(");for(var r=0;r<e;r++){r>0&&n.append(" ");for(var o=0;o<i;o++)o>0&&n.append(","),n.append(Wu.toString(t.getOrdinate(r,o)))}return n.append(")"),n.toString()}},Hu.ensureValidRing=function(t,e){var i=e.size();return 0===i?e:i<=3?Hu.createClosedRing(t,e,4):e.getOrdinate(0,Ml.X)===e.getOrdinate(i-1,Ml.X)&&e.getOrdinate(0,Ml.Y)===e.getOrdinate(i-1,Ml.Y)?e:Hu.createClosedRing(t,e,i+1)},Hu.createClosedRing=function(t,e,i){var n=t.create(i,e.getDimension()),r=e.size();Hu.copy(e,0,n,0,r);for(var o=r;o<i;o++)Hu.copy(e,0,n,o,1);return n};var Zu=function(t){function e(e,i){t.call(this,i),this._points=null,this.init(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Rl:this._points.expandEnvelope(new Rl)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var i=arguments[0],n=arguments[1];if(!this.isEquivalentClass(i))return!1;var r=i;if(this._points.size()!==r._points.size())return!1;for(var o=0;o<this._points.size();o++)if(!e.equal(e._points.getCoordinate(o),r._points.getCoordinate(o),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=this,e=0;e<Math.trunc(this._points.size()/2);e++){var i=t._points.size()-1-e;if(!t._points.getCoordinate(e).equals(t._points.getCoordinate(i)))return t._points.getCoordinate(e).compareTo(t._points.getCoordinate(i))>0&&Hu.reverse(t._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Ou.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return Yl.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Hu.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],i=0,n=0;i<this._points.size()&&n<e._points.size();){var r=t._points.getCoordinate(i).compareTo(e._points.getCoordinate(n));if(0!==r)return r;i++,n++}return i<this._points.size()?1:n<e._points.size()?-1:0}if(2===arguments.length){var o=arguments[0];return arguments[1].compare(this._points,o._points)}},e.prototype.apply=function(){var t=this;if(dl(arguments[0],Jl))for(var e=arguments[0],i=0;i<this._points.size();i++)e.filter(t._points.getCoordinate(i));else if(dl(arguments[0],Fu)){var n=arguments[0];if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(n.filter(t._points,r),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else(dl(arguments[0],Du)||dl(arguments[0],Wl))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new zu(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new el("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Pu]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,i),e}(Kl),Ju=function(){};Ju.prototype.interfaces_=function(){return[]},Ju.prototype.getClass=function(){return Ju};var Qu=function(t){function e(e,i){t.call(this,i),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Rl;var t=new Rl;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),i))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Ou.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(dl(arguments[0],Jl)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(dl(arguments[0],Fu)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(dl(arguments[0],Du)||dl(arguments[0],Wl))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),zl.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Ju]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,i),e}(Kl),$u=function(){};$u.prototype.interfaces_=function(){return[]},$u.prototype.getClass=function(){return $u};var tc=function(t){function e(e,i,n){if(t.call(this,n),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===i&&(i=[]),t.hasNullElements(i))throw new el("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(i))throw new el("shell is empty but holes are not");this._shell=e,this._holes=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=this._shell.getCoordinates(),n=0;n<i.length;n++)t[++e]=i[n];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(Yl.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(Yl.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),i=0;i<5;i++){var n=t.getX(i);if(n!==e.getMinX()&&n!==e.getMaxX())return!1;var r=t.getY(i);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var h=t.getX(a),l=t.getY(a);if(h!==o==(l!==s))return!1;o=h,s=l}return!0},e.prototype.equalsExact=function(){var e=this;if(2===arguments.length){var i=arguments[0],n=arguments[1];if(!this.isEquivalentClass(i))return!1;var r=i,o=this._shell,s=r._shell;if(!o.equalsExact(s,n))return!1;if(this._holes.length!==r._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!e._holes[a].equalsExact(r._holes[a],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){var t=this;if(0===arguments.length){this.normalize(this._shell,!0);for(var e=0;e<this._holes.length;e++)t.normalize(t._holes[e],!1);Lu.sort(this._holes)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];if(i.isEmpty())return null;var r=new Array(i.getCoordinates().length-1).fill(null);Pl.arraycopy(i.getCoordinates(),0,r,0,r.length);var o=pu.minCoordinate(i.getCoordinates());pu.scroll(r,o),Pl.arraycopy(r,0,i.getCoordinates(),0,r.length),i.getCoordinates()[r.length]=r[0],Yl.isCCW(i.getCoordinates())===n&&pu.reverse(i.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){var t=this;if(1===arguments.length){var e=arguments[0],i=this._shell,n=e._shell;return i.compareToSameClass(n)}if(2===arguments.length){var r=arguments[1],o=arguments[0],s=this._shell,a=o._shell,h=s.compareToSameClass(a,r);if(0!==h)return h;for(var l=this.getNumInteriorRing(),u=o.getNumInteriorRing(),c=0;c<l&&c<u;){var p=t.getInteriorRingN(c),f=o.getInteriorRingN(c),d=p.compareToSameClass(f,r);if(0!==d)return d;c++}return c<l?1:c<u?-1:0}},e.prototype.apply=function(t){var e=this;if(dl(t,Jl)){this._shell.apply(t);for(var i=0;i<this._holes.length;i++)e._holes[i].apply(t)}else if(dl(t,Fu)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(e._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(dl(t,Du))t.filter(this);else if(dl(t,Wl)){t.filter(this),this._shell.apply(t);for(var r=0;r<this._holes.length;r++)e._holes[r].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var i=0;i<this._holes.length;i++)e._holes[i]=this._holes[i].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),i=new Array(this._holes.length).fill(null),n=0;n<i.length;n++)i[n]=this._holes[n].copy();return new e(t,i,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[$u]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,i),e}(Kl),ec=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Kl.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Ou.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Ju]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,i),e}(ku),ic=function(t){function e(e,i){e instanceof hl&&i instanceof mc&&(e=i.getCoordinateSequenceFactory().create(e)),t.call(this,e,i),this.validateConstruction()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Kl.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Ou.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Hu.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new el("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new el("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.MINIMUM_VALID_SIZE.get=function(){return 4},i.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,i),e}(Zu),nc=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Kl.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new lu,e=0;e<this._geometries.length;e++)for(var i=this._geometries[e].getBoundary(),n=0;n<i.getNumGeometries();n++)t.add(i.getGeometryN(n));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[$u]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,i),e}(ku),rc=function(t){this._factory=t||null,this._isUserDataCopied=!1},oc={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};rc.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},rc.prototype.edit=function(t,e){if(null===t)return null;var i=this.editInternal(t,e);return this._isUserDataCopied&&i.setUserData(t.getUserData()),i},rc.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof ku?this.editGeometryCollection(t,e):t instanceof tc?this.editPolygon(t,e):t instanceof Qu||t instanceof Zu?e.edit(t,this._factory):(zl.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},rc.prototype.editGeometryCollection=function(t,e){for(var i=e.edit(t,this._factory),n=new lu,r=0;r<i.getNumGeometries();r++){var o=this.edit(i.getGeometryN(r),e);null===o||o.isEmpty()||n.add(o)}return i.getClass()===ec?this._factory.createMultiPoint(n.toArray([])):i.getClass()===Gu?this._factory.createMultiLineString(n.toArray([])):i.getClass()===nc?this._factory.createMultiPolygon(n.toArray([])):this._factory.createGeometryCollection(n.toArray([]))},rc.prototype.editPolygon=function(t,e){var i=e.edit(t,this._factory);if(null===i&&(i=this._factory.createPolygon(null)),i.isEmpty())return i;var n=this.edit(i.getExteriorRing(),e);if(null===n||n.isEmpty())return this._factory.createPolygon();for(var r=new lu,o=0;o<i.getNumInteriorRing();o++){var s=this.edit(i.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(n,r.toArray([]))},rc.prototype.interfaces_=function(){return[]},rc.prototype.getClass=function(){return rc},rc.GeometryEditorOperation=function(){},oc.NoOpGeometryOperation.get=function(){return sc},oc.CoordinateOperation.get=function(){return ac},oc.CoordinateSequenceOperation.get=function(){return hc},Object.defineProperties(rc,oc);var sc=function(){};sc.prototype.edit=function(t,e){return t},sc.prototype.interfaces_=function(){return[rc.GeometryEditorOperation]},sc.prototype.getClass=function(){return sc};var ac=function(){};ac.prototype.edit=function(t,e){var i=this.editCoordinates(t.getCoordinates(),t);return null===i?t:t instanceof ic?e.createLinearRing(i):t instanceof Zu?e.createLineString(i):t instanceof Qu?i.length>0?e.createPoint(i[0]):e.createPoint():t},ac.prototype.interfaces_=function(){return[rc.GeometryEditorOperation]},ac.prototype.getClass=function(){return ac};var hc=function(){};hc.prototype.edit=function(t,e){return t instanceof ic?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Zu?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Qu?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},hc.prototype.interfaces_=function(){return[rc.GeometryEditorOperation]},hc.prototype.getClass=function(){return hc};var lc=function(){var t=this;if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var i=0;i<e;i++)t._coordinates[i]=new hl}else if(dl(arguments[0],Ml)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)t._coordinates[r]=n.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var o=arguments[0],s=arguments[1];this._coordinates=o,this._dimension=s,null===o&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],h=arguments[1];this._coordinates=new Array(a).fill(null),this._dimension=h;for(var l=0;l<a;l++)t._coordinates[l]=new hl}},uc={serialVersionUID:{configurable:!0}};lc.prototype.setOrdinate=function(t,e,i){switch(e){case Ml.X:this._coordinates[t].x=i;break;case Ml.Y:this._coordinates[t].y=i;break;case Ml.Z:this._coordinates[t].z=i;break;default:throw new el("invalid ordinateIndex")}},lc.prototype.size=function(){return this._coordinates.length},lc.prototype.getOrdinate=function(t,e){switch(e){case Ml.X:return this._coordinates[t].x;case Ml.Y:return this._coordinates[t].y;case Ml.Z:return this._coordinates[t].z}return il.NaN},lc.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],i=arguments[1];i.x=this._coordinates[e].x,i.y=this._coordinates[e].y,i.z=this._coordinates[e].z}},lc.prototype.getCoordinateCopy=function(t){return new hl(this._coordinates[t])},lc.prototype.getDimension=function(){return this._dimension},lc.prototype.getX=function(t){return this._coordinates[t].x},lc.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new lc(t,this._dimension)},lc.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},lc.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new lc(t,this._dimension)},lc.prototype.toString=function(){if(this._coordinates.length>0){var t=new _l(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},lc.prototype.getY=function(t){return this._coordinates[t].y},lc.prototype.toCoordinateArray=function(){return this._coordinates},lc.prototype.interfaces_=function(){return[Ml,al]},lc.prototype.getClass=function(){return lc},uc.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(lc,uc);var cc=function(){},pc={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};cc.prototype.readResolve=function(){return cc.instance()},cc.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new lc(arguments[0]);if(dl(arguments[0],Ml))return new lc(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new lc(t):new lc(t,e)}},cc.prototype.interfaces_=function(){return[cl,al]},cc.prototype.getClass=function(){return cc},cc.instance=function(){return cc.instanceObject},pc.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},pc.instanceObject.get=function(){return new cc},Object.defineProperties(cc,pc);var fc=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new lu,e=this.map_.values(),i=e.next();!i.done;)t.add(i.value),i=e.next();return t},e.prototype.entrySet=function(){var t=new xu;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(yu),dc=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof yc){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var i=arguments[0];this._modelType=t.FIXED,this.setScale(i)}else if(arguments[0]instanceof t){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}},gc={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};dc.prototype.equals=function(t){if(!(t instanceof dc))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},dc.prototype.compareTo=function(t){var e=t,i=this.getMaximumSignificantDigits(),n=e.getMaximumSignificantDigits();return new ml(i).compareTo(new ml(n))},dc.prototype.getScale=function(){return this._scale},dc.prototype.isFloating=function(){return this._modelType===dc.FLOATING||this._modelType===dc.FLOATING_SINGLE},dc.prototype.getType=function(){return this._modelType},dc.prototype.toString=function(){var t="UNKNOWN";return this._modelType===dc.FLOATING?t="Floating":this._modelType===dc.FLOATING_SINGLE?t="Floating-Single":this._modelType===dc.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},dc.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return il.isNaN(t)||this._modelType===dc.FLOATING_SINGLE?t:this._modelType===dc.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof hl){var e=arguments[0];if(this._modelType===dc.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},dc.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===dc.FLOATING?t=16:this._modelType===dc.FLOATING_SINGLE?t=6:this._modelType===dc.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},dc.prototype.setScale=function(t){this._scale=Math.abs(t)},dc.prototype.interfaces_=function(){return[al,rl]},dc.prototype.getClass=function(){return dc},dc.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},gc.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},gc.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(dc,gc);var yc=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},_c={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};yc.prototype.readResolve=function(){return yc.nameToTypeMap.get(this._name)},yc.prototype.toString=function(){return this._name},yc.prototype.interfaces_=function(){return[al]},yc.prototype.getClass=function(){return yc},_c.serialVersionUID.get=function(){return-552860263173159e4},_c.nameToTypeMap.get=function(){return new fc},Object.defineProperties(yc,_c),dc.Type=yc,dc.FIXED=new yc("FIXED"),dc.FLOATING=new yc("FLOATING"),dc.FLOATING_SINGLE=new yc("FLOATING SINGLE");var mc=function t(){this._precisionModel=new dc,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?dl(arguments[0],cl)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof dc&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},vc={serialVersionUID:{configurable:!0}};mc.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new hl(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new hl(t.getMinX(),t.getMinY()),new hl(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new hl(t.getMinX(),t.getMinY()),new hl(t.getMinX(),t.getMaxY()),new hl(t.getMaxX(),t.getMaxY()),new hl(t.getMaxX(),t.getMinY()),new hl(t.getMinX(),t.getMinY())]),null)},mc.prototype.createLineString=function(t){return t?t instanceof Array?new Zu(this.getCoordinateSequenceFactory().create(t),this):dl(t,Ml)?new Zu(t,this):void 0:new Zu(this.getCoordinateSequenceFactory().create([]),this)},mc.prototype.createMultiLineString=function(){return 0===arguments.length?new Gu(null,this):1===arguments.length?new Gu(arguments[0],this):void 0},mc.prototype.buildGeometry=function(t){for(var e=null,i=!1,n=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(i=!0),o.isGeometryCollectionOrDerived()&&(n=!0)}if(null===e)return this.createGeometryCollection();if(i||n)return this.createGeometryCollection(mc.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof tc)return this.createMultiPolygon(mc.toPolygonArray(t));if(a instanceof Zu)return this.createMultiLineString(mc.toLineStringArray(t));if(a instanceof Qu)return this.createMultiPoint(mc.toPointArray(t));zl.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},mc.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},mc.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof hl){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(dl(arguments[0],Ml))return new Qu(arguments[0],this)}},mc.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},mc.prototype.createPolygon=function(){if(0===arguments.length)return new tc(null,null,this);if(1===arguments.length){if(dl(arguments[0],Ml)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ic){var i=arguments[0];return this.createPolygon(i,null)}}else if(2===arguments.length)return new tc(arguments[0],arguments[1],this)},mc.prototype.getSRID=function(){return this._SRID},mc.prototype.createGeometryCollection=function(){return 0===arguments.length?new ku(null,this):1===arguments.length?new ku(arguments[0],this):void 0},mc.prototype.createGeometry=function(t){return new rc(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},mc.prototype.getPrecisionModel=function(){return this._precisionModel},mc.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(dl(arguments[0],Ml))return new ic(arguments[0],this)}},mc.prototype.createMultiPolygon=function(){return 0===arguments.length?new nc(null,this):1===arguments.length?new nc(arguments[0],this):void 0},mc.prototype.createMultiPoint=function(){var t=this;if(0===arguments.length)return new ec(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new ec(arguments[0],this);if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(dl(arguments[0],Ml)){var i=arguments[0];if(null===i)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(i.size()).fill(null),r=0;r<i.size();r++){var o=t.getCoordinateSequenceFactory().create(1,i.getDimension());Hu.copy(i,r,o,0,1),n[r]=t.createPoint(o)}return this.createMultiPoint(n)}}},mc.prototype.interfaces_=function(){return[al]},mc.prototype.getClass=function(){return mc},mc.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.getDefaultCoordinateSequenceFactory=function(){return cc.instance()},mc.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},vc.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(mc,vc);var xc=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Ec=function(t){this.geometryFactory=t||new mc};Ec.prototype.read=function(t){var e,i=(e="string"==typeof t?JSON.parse(t):t).type;if(!wc[i])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==xc.indexOf(i)?wc[i].apply(this,[e.coordinates]):"GeometryCollection"===i?wc[i].apply(this,[e.geometries]):wc[i].apply(this,[e])},Ec.prototype.write=function(t){var e=t.getGeometryType();if(!bc[e])throw new Error("Geometry is not supported");return bc[e].apply(this,[t])};var wc={Feature:function(t){var e={};for(var i in t)e[i]=t[i];if(t.geometry){var n=t.geometry.type;if(!wc[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=wc.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var i=0;i<t.features.length;++i)e.features.push(this.read(t.features[i]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(new hl(n[0],n[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new hl(t[0],t[1]),new hl(t[2],t[1]),new hl(t[2],t[3]),new hl(t[0],t[3]),new hl(t[0],t[1])])},Point:function(t){var e=new hl(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],i=0;i<t.length;++i)e.push(wc.Point.apply(this,[t[i]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=wc.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],i=0;i<t.length;++i)e.push(wc.LineString.apply(this,[t[i]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=wc.coordinates.apply(this,[t[0]]),i=this.geometryFactory.createLinearRing(e),n=[],r=1;r<t.length;++r){var o=t[r],s=wc.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);n.push(a)}return this.geometryFactory.createPolygon(i,n)},MultiPolygon:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(wc.Polygon.apply(this,[n]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},bc={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:bc.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=bc.Point.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],i=t.getCoordinates(),n=0;n<i.length;++n){var r=i[n];e.push(bc.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=bc.LineString.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],i=bc.LineString.apply(this,[t._shell]);e.push(i.coordinates);for(var n=0;n<t._holes.length;++n){var r=t._holes[n],o=bc.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=bc.Polygon.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=n.getGeometryType();e.push(bc[r].apply(this,[n]))}return{type:"GeometryCollection",geometries:e}}},Mc=function(t){this.geometryFactory=t||new mc,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ec(this.geometryFactory)};Mc.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===dc.FIXED&&this.reducePrecision(e),e},Mc.prototype.reducePrecision=function(t){var e,i;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,i=t.points.length;e<i;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,i=t.geometries.length;e<i;e++)this.reducePrecision(t.geometries[e])};var Cc=function(){this.parser=new Ec(this.geometryFactory)};Cc.prototype.write=function(t){return this.parser.write(t)};var Ic=function(){},Sc={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};function Pc(t){this.message=t||""}function Nc(){this.array_=[]}Ic.prototype.interfaces_=function(){return[]},Ic.prototype.getClass=function(){return Ic},Ic.opposite=function(t){return t===Ic.LEFT?Ic.RIGHT:t===Ic.RIGHT?Ic.LEFT:t},Sc.ON.get=function(){return 0},Sc.LEFT.get=function(){return 1},Sc.RIGHT.get=function(){return 2},Object.defineProperties(Ic,Sc),Pc.prototype=new Error,Pc.prototype.name="EmptyStackException",Nc.prototype=new au,Nc.prototype.add=function(t){return this.array_.push(t),!0},Nc.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},Nc.prototype.push=function(t){return this.array_.push(t),t},Nc.prototype.pop=function(t){if(0===this.array_.length)throw new Pc;return this.array_.pop()},Nc.prototype.peek=function(){if(0===this.array_.length)throw new Pc;return this.array_[this.array_.length-1]},Nc.prototype.empty=function(){return 0===this.array_.length},Nc.prototype.isEmpty=function(){return this.empty()},Nc.prototype.search=function(t){return this.array_.indexOf(t)},Nc.prototype.size=function(){return this.array_.length},Nc.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t};var Rc=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Rc.prototype.getCoordinate=function(){return this._minCoord},Rc.prototype.getRightmostSide=function(t,e){var i=this.getRightmostSideOfSegment(t,e);return i<0&&(i=this.getRightmostSideOfSegment(t,e-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),i},Rc.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();zl.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],i=t[this._minIndex+1],n=Yl.computeOrientation(this._minCoord,i,e),r=!1;(e.y<this._minCoord.y&&i.y<this._minCoord.y&&n===Yl.COUNTERCLOCKWISE||e.y>this._minCoord.y&&i.y>this._minCoord.y&&n===Yl.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Rc.prototype.getRightmostSideOfSegment=function(t,e){var i=t.getEdge().getCoordinates();if(e<0||e+1>=i.length)return-1;if(i[e].y===i[e+1].y)return-1;var n=Ic.LEFT;return i[e].y<i[e+1].y&&(n=Ic.RIGHT),n},Rc.prototype.getEdge=function(){return this._orientedDe},Rc.prototype.checkForRightmostCoordinate=function(t){for(var e=this,i=t.getEdge().getCoordinates(),n=0;n<i.length-1;n++)(null===e._minCoord||i[n].x>e._minCoord.x)&&(e._minDe=t,e._minIndex=n,e._minCoord=i[n])},Rc.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Rc.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();i.isForward()&&this.checkForRightmostCoordinate(i)}zl.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Ic.LEFT&&(this._orientedDe=this._minDe.getSym())},Rc.prototype.interfaces_=function(){return[]},Rc.prototype.getClass=function(){return Rc};var Tc=function(t){function e(i,n){t.call(this,e.msgWithCoord(i,n)),this.pt=n?new hl(n):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(kl),Lc=function(){this.array_=[]};Lc.prototype.addLast=function(t){this.array_.push(t)},Lc.prototype.removeFirst=function(){return this.array_.shift()},Lc.prototype.isEmpty=function(){return 0===this.array_.length};var Oc=function(){this._finder=null,this._dirEdgeList=new lu,this._nodes=new lu,this._rightMostCoord=null,this._env=null,this._finder=new Rc};Oc.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Oc.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Oc.prototype.computeNodeDepth=function(t){for(var e=null,i=t.getEdges().iterator();i.hasNext();){var n=i.next();if(n.isVisited()||n.getSym().isVisited()){e=n;break}}if(null===e)throw new Tc("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Oc.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Ic.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Oc.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Oc.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Ic.RIGHT)>=1&&e.getDepth(Ic.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Oc.prototype.computeDepths=function(t){var e=new xu,i=new Lc,n=t.getNode();for(i.addLast(n),e.add(n),t.setVisited(!0);!i.isEmpty();){var r=i.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(i.addLast(a),e.add(a))}}}},Oc.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Oc.prototype.getEnvelope=function(){if(null===this._env){for(var t=new Rl,e=this._dirEdgeList.iterator();e.hasNext();)for(var i=e.next().getEdge().getCoordinates(),n=0;n<i.length-1;n++)t.expandToInclude(i[n]);this._env=t}return this._env},Oc.prototype.addReachable=function(t){var e=new Nc;for(e.add(t);!e.empty();){var i=e.pop();this.add(i,e)}},Oc.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Ic.LEFT,t.getDepth(Ic.RIGHT)),e.setDepth(Ic.RIGHT,t.getDepth(Ic.LEFT))},Oc.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var i=t.getEdges().iterator();i.hasNext();){var n=i.next();this._dirEdgeList.add(n);var r=n.getSym().getNode();r.isVisited()||e.push(r)}},Oc.prototype.getNodes=function(){return this._nodes},Oc.prototype.getDirectedEdges=function(){return this._dirEdgeList},Oc.prototype.interfaces_=function(){return[rl]},Oc.prototype.getClass=function(){return Oc};var Ac=function t(){var e=this;if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var i=arguments[0];this.init(i.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Ic.ON]=n}else if(arguments[0]instanceof t){var r=arguments[0];if(this.init(r.location.length),null!==r)for(var o=0;o<this.location.length;o++)e.location[o]=r.location[o]}}else if(3===arguments.length){var s=arguments[0],a=arguments[1],h=arguments[2];this.init(3),this.location[Ic.ON]=s,this.location[Ic.LEFT]=a,this.location[Ic.RIGHT]=h}};Ac.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Ac.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==pl.NONE)return!1;return!0},Ac.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===pl.NONE&&(this.location[e]=t)},Ac.prototype.isLine=function(){return 1===this.location.length},Ac.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Ic.ON]=this.location[Ic.ON],e[Ic.LEFT]=pl.NONE,e[Ic.RIGHT]=pl.NONE,this.location=e}for(var i=0;i<this.location.length;i++)this.location[i]===pl.NONE&&i<t.location.length&&(this.location[i]=t.location[i])},Ac.prototype.getLocations=function(){return this.location},Ac.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Ic.LEFT];this.location[Ic.LEFT]=this.location[Ic.RIGHT],this.location[Ic.RIGHT]=t},Ac.prototype.toString=function(){var t=new _l;return this.location.length>1&&t.append(pl.toLocationSymbol(this.location[Ic.LEFT])),t.append(pl.toLocationSymbol(this.location[Ic.ON])),this.location.length>1&&t.append(pl.toLocationSymbol(this.location[Ic.RIGHT])),t.toString()},Ac.prototype.setLocations=function(t,e,i){this.location[Ic.ON]=t,this.location[Ic.LEFT]=e,this.location[Ic.RIGHT]=i},Ac.prototype.get=function(t){return t<this.location.length?this.location[t]:pl.NONE},Ac.prototype.isArea=function(){return this.location.length>1},Ac.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===pl.NONE)return!0;return!1},Ac.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Ic.ON,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.location[e]=i}},Ac.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(pl.NONE)},Ac.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Ac.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Ac.prototype.interfaces_=function(){return[]},Ac.prototype.getClass=function(){return Ac};var Dc=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Ac(e),this.elt[1]=new Ac(e)}else if(arguments[0]instanceof t){var i=arguments[0];this.elt[0]=new Ac(i.elt[0]),this.elt[1]=new Ac(i.elt[1])}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.elt[0]=new Ac(pl.NONE),this.elt[1]=new Ac(pl.NONE),this.elt[n].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Ac(o,s,a),this.elt[1]=new Ac(o,s,a)}else if(4===arguments.length){var h=arguments[0],l=arguments[1],u=arguments[2],c=arguments[3];this.elt[0]=new Ac(pl.NONE,pl.NONE,pl.NONE),this.elt[1]=new Ac(pl.NONE,pl.NONE,pl.NONE),this.elt[h].setLocations(l,u,c)}};Dc.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Dc.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Dc.prototype.isNull=function(t){return this.elt[t].isNull()},Dc.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.elt[e].setAllLocationsIfNull(i)}},Dc.prototype.isLine=function(t){return this.elt[t].isLine()},Dc.prototype.merge=function(t){for(var e=this,i=0;i<2;i++)null===e.elt[i]&&null!==t.elt[i]?e.elt[i]=new Ac(t.elt[i]):e.elt[i].merge(t.elt[i])},Dc.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Dc.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Ic.ON)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return this.elt[e].get(i)}},Dc.prototype.toString=function(){var t=new _l;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Dc.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Dc.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Dc.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Ic.ON,e)}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this.elt[i].setLocation(n,r)}},Dc.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Dc.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Dc.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Ac(this.elt[t].location[0]))},Dc.prototype.interfaces_=function(){return[]},Dc.prototype.getClass=function(){return Dc},Dc.toLineLabel=function(t){for(var e=new Dc(pl.NONE),i=0;i<2;i++)e.setLocation(i,t.getLocation(i));return e};var Fc=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new lu,this._pts=new lu,this._label=new Dc(pl.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new lu,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Fc.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=Yl.isCCW(this._ring.getCoordinates())},Fc.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Fc.prototype.computePoints=function(t){var e=this;this._startDe=t;var i=t,n=!0;do{if(null===i)throw new Tc("Found null DirectedEdge");if(i.getEdgeRing()===e)throw new Tc("Directed Edge visited twice during ring-building at "+i.getCoordinate());e._edges.add(i);var r=i.getLabel();zl.isTrue(r.isArea()),e.mergeLabel(r),e.addPoints(i.getEdge(),i.isForward(),n),n=!1,e.setEdgeRing(i,e),i=e.getNext(i)}while(i!==this._startDe)},Fc.prototype.getLinearRing=function(){return this._ring},Fc.prototype.getCoordinate=function(t){return this._pts.get(t)},Fc.prototype.computeMaxNodeDegree=function(){var t=this;this._maxNodeDegree=0;var e=this._startDe;do{var i=e.getNode().getEdges().getOutgoingDegree(t);i>t._maxNodeDegree&&(t._maxNodeDegree=i),e=t.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2},Fc.prototype.addPoints=function(t,e,i){var n=t.getCoordinates();if(e){var r=1;i&&(r=0);for(var o=r;o<n.length;o++)this._pts.add(n[o])}else{var s=n.length-2;i&&(s=n.length-1);for(var a=s;a>=0;a--)this._pts.add(n[a])}},Fc.prototype.isHole=function(){return this._isHole},Fc.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Fc.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!Yl.isPointInRing(t,e.getCoordinates()))return!1;for(var i=this._holes.iterator();i.hasNext();)if(i.next().containsPoint(t))return!1;return!0},Fc.prototype.addHole=function(t){this._holes.add(t)},Fc.prototype.isShell=function(){return null===this._shell},Fc.prototype.getLabel=function(){return this._label},Fc.prototype.getEdges=function(){return this._edges},Fc.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Fc.prototype.getShell=function(){return this._shell},Fc.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],i=arguments[0].getLocation(e,Ic.RIGHT);if(i===pl.NONE)return null;if(this._label.getLocation(e)===pl.NONE)return this._label.setLocation(e,i),null}},Fc.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Fc.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),i=0;i<this._holes.size();i++)e[i]=this._holes.get(i).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Fc.prototype.interfaces_=function(){return[]},Fc.prototype.getClass=function(){return Fc};var kc=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Fc),Gc=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new lu,e=this._startDe;do{if(null===e.getMinEdgeRing()){var i=new kc(e,this._geometryFactory);t.add(i)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Fc),zc=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};zc.prototype.setVisited=function(t){this._isVisited=t},zc.prototype.setInResult=function(t){this._isInResult=t},zc.prototype.isCovered=function(){return this._isCovered},zc.prototype.isCoveredSet=function(){return this._isCoveredSet},zc.prototype.setLabel=function(t){this._label=t},zc.prototype.getLabel=function(){return this._label},zc.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},zc.prototype.updateIM=function(t){zl.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},zc.prototype.isInResult=function(){return this._isInResult},zc.prototype.isVisited=function(){return this._isVisited},zc.prototype.interfaces_=function(){return[]},zc.prototype.getClass=function(){return zc};var jc=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],i=arguments[1];this._coord=e,this._edges=i,this._label=new Dc(0,pl.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var i=pl.NONE;if(i=this._label.getLocation(e),!t.isNull(e)){var n=t.getLocation(e);i!==pl.BOUNDARY&&(i=n)}return i},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],i=arguments[1];null===this._label?this._label=new Dc(e,i):this._label.setLocation(e,i)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){var t=this;if(arguments[0]instanceof e){var i=arguments[0];this.mergeLabel(i._label)}else if(arguments[0]instanceof Dc)for(var n=arguments[0],r=0;r<2;r++){var o=t.computeMergedLocation(n,r);t._label.getLocation(r)===pl.NONE&&t._label.setLocation(r,o)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=pl.NONE;null!==this._label&&(e=this._label.getLocation(t));var i=null;switch(e){case pl.BOUNDARY:i=pl.INTERIOR;break;case pl.INTERIOR:default:i=pl.BOUNDARY}this._label.setLocation(t,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(zc),qc=function(){this.nodeMap=new Su,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};qc.prototype.find=function(t){return this.nodeMap.get(t)},qc.prototype.addNode=function(){if(arguments[0]instanceof hl){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof jc){var i=arguments[0],n=this.nodeMap.get(i.getCoordinate());return null===n?(this.nodeMap.put(i.getCoordinate(),i),i):(n.mergeLabel(i),n)}},qc.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},qc.prototype.iterator=function(){return this.nodeMap.values().iterator()},qc.prototype.values=function(){return this.nodeMap.values()},qc.prototype.getBoundaryNodes=function(t){for(var e=new lu,i=this.iterator();i.hasNext();){var n=i.next();n.getLabel().getLocation(t)===pl.BOUNDARY&&e.add(n)}return e},qc.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},qc.prototype.interfaces_=function(){return[]},qc.prototype.getClass=function(){return qc};var Bc=function(){},Uc={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Bc.prototype.interfaces_=function(){return[]},Bc.prototype.getClass=function(){return Bc},Bc.isNorthern=function(t){return t===Bc.NE||t===Bc.NW},Bc.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Bc.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var i=t<e?t:e;return 0===i&&3===(t>e?t:e)?3:i},Bc.isInHalfPlane=function(t,e){return e===Bc.SE?t===Bc.SE||t===Bc.SW:t===e||t===e+1},Bc.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new el("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Bc.NE:Bc.SE:e>=0?Bc.NW:Bc.SW}if(arguments[0]instanceof hl&&arguments[1]instanceof hl){var i=arguments[0],n=arguments[1];if(n.x===i.x&&n.y===i.y)throw new el("Cannot compute the quadrant for two identical points "+i);return n.x>=i.x?n.y>=i.y?Bc.NE:Bc.SE:n.y>=i.y?Bc.NW:Bc.SW}},Uc.NE.get=function(){return 0},Uc.NW.get=function(){return 1},Uc.SW.get=function(){return 2},Uc.SE.get=function(){return 3},Object.defineProperties(Bc,Uc);var Xc=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=null;this._edge=e,this.init(i,n),this._label=r}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],h=arguments[3];this._edge=o,this.init(s,a),this._label=h}};Xc.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Yl.computeOrientation(t._p0,t._p1,this._p1)},Xc.prototype.getDy=function(){return this._dy},Xc.prototype.getCoordinate=function(){return this._p0},Xc.prototype.setNode=function(t){this._node=t},Xc.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),n=i.lastIndexOf("."),r=i.substring(n+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},Xc.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},Xc.prototype.getDirectedCoordinate=function(){return this._p1},Xc.prototype.getDx=function(){return this._dx},Xc.prototype.getLabel=function(){return this._label},Xc.prototype.getEdge=function(){return this._edge},Xc.prototype.getQuadrant=function(){return this._quadrant},Xc.prototype.getNode=function(){return this._node},Xc.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),i=e.lastIndexOf(".");return"  "+e.substring(i+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},Xc.prototype.computeLabel=function(t){},Xc.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Bc.quadrant(this._dx,this._dy),zl.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},Xc.prototype.interfaces_=function(){return[rl]},Xc.prototype.getClass=function(){return Xc};var Yc=function(t){function e(){var e=arguments[0],i=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=i,i)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var n=e.getNumPoints()-1;this.init(e.getCoordinate(n),e.getCoordinate(n-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Dc(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Tc("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=this,e=!0,i=0;i<2;i++)t._label.isArea(i)&&t._label.getLocation(i,Ic.LEFT)===pl.INTERIOR&&t._label.getLocation(i,Ic.RIGHT)===pl.INTERIOR||(e=!1);return e},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Ic.LEFT]+"/"+this._depth[Ic.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,pl.EXTERIOR),i=!this._label.isArea(1)||this._label.allPositionsEqual(1,pl.EXTERIOR);return t&&e&&i},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var i=this.getEdge().getDepthDelta();this._isForward||(i=-i);var n=1;t===Ic.LEFT&&(n=-1);var r=Ic.opposite(t),o=e+i*n;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===pl.EXTERIOR&&e===pl.INTERIOR?1:t===pl.INTERIOR&&e===pl.EXTERIOR?-1:0},e}(Xc),Vc=function(){};Vc.prototype.createNode=function(t){return new jc(t,null)},Vc.prototype.interfaces_=function(){return[]},Vc.prototype.getClass=function(){return Vc};var Wc=function(){if(this._edges=new lu,this._nodes=null,this._edgeEndList=new lu,0===arguments.length)this._nodes=new qc(new Vc);else if(1===arguments.length){var t=arguments[0];this._nodes=new qc(t)}};Wc.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var i=this._edges.get(e);i.print(t),i.eiList.print(t)}},Wc.prototype.find=function(t){return this._nodes.find(t)},Wc.prototype.addNode=function(){if(arguments[0]instanceof jc){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof hl){var e=arguments[0];return this._nodes.addNode(e)}},Wc.prototype.getNodeIterator=function(){return this._nodes.iterator()},Wc.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Wc.prototype.debugPrintln=function(t){Pl.out.println(t)},Wc.prototype.isBoundaryNode=function(t,e){var i=this._nodes.find(e);if(null===i)return!1;var n=i.getLabel();return null!==n&&n.getLocation(t)===pl.BOUNDARY},Wc.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Wc.prototype.matchInSameDirection=function(t,e,i,n){return!!t.equals(i)&&Yl.computeOrientation(t,e,n)===Yl.COLLINEAR&&Bc.quadrant(t,e)===Bc.quadrant(i,n)},Wc.prototype.getEdgeEnds=function(){return this._edgeEndList},Wc.prototype.debugPrint=function(t){Pl.out.print(t)},Wc.prototype.getEdgeIterator=function(){return this._edges.iterator()},Wc.prototype.findEdgeInSameDirection=function(t,e){for(var i=this,n=0;n<this._edges.size();n++){var r=i._edges.get(n),o=r.getCoordinates();if(i.matchInSameDirection(t,e,o[0],o[1]))return r;if(i.matchInSameDirection(t,e,o[o.length-1],o[o.length-2]))return r}return null},Wc.prototype.insertEdge=function(t){this._edges.add(t)},Wc.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var i=e.next();if(i.getEdge()===t)return i}return null},Wc.prototype.addEdges=function(t){for(var e=this,i=t.iterator();i.hasNext();){var n=i.next();e._edges.add(n);var r=new Yc(n,!0),o=new Yc(n,!1);r.setSym(o),o.setSym(r),e.add(r),e.add(o)}},Wc.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Wc.prototype.getNodes=function(){return this._nodes.values()},Wc.prototype.findEdge=function(t,e){for(var i=0;i<this._edges.size();i++){var n=this._edges.get(i),r=n.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return n}return null},Wc.prototype.interfaces_=function(){return[]},Wc.prototype.getClass=function(){return Wc},Wc.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var Kc=function(){this._geometryFactory=null,this._shellList=new lu;var t=arguments[0];this._geometryFactory=t};Kc.prototype.sortShellsAndHoles=function(t,e,i){for(var n=t.iterator();n.hasNext();){var r=n.next();r.isHole()?i.add(r):e.add(r)}},Kc.prototype.computePolygons=function(t){for(var e=new lu,i=t.iterator();i.hasNext();){var n=i.next().toPolygon(this._geometryFactory);e.add(n)}return e},Kc.prototype.placeFreeHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();if(null===n.getShell()){var r=this.findEdgeRingContaining(n,t);if(null===r)throw new Tc("unable to assign hole to a shell",n.getCoordinate(0));n.setShell(r)}}},Kc.prototype.buildMinimalEdgeRings=function(t,e,i){for(var n=new lu,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):i.addAll(s)}else n.add(o)}return n},Kc.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Kc.prototype.buildMaximalEdgeRings=function(t){for(var e=new lu,i=t.iterator();i.hasNext();){var n=i.next();if(n.isInResult()&&n.getLabel().isArea()&&null===n.getEdgeRing()){var r=new Gc(n,this._geometryFactory);e.add(r),r.setInResult()}}return e},Kc.prototype.placePolygonHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();n.isHole()&&n.setShell(t)}},Kc.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Kc.prototype.findEdgeRingContaining=function(t,e){for(var i=t.getLinearRing(),n=i.getEnvelopeInternal(),r=i.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var h=a.next(),l=h.getLinearRing(),u=l.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var c=!1;u.contains(n)&&Yl.isPointInRing(r,l.getCoordinates())&&(c=!0),c&&(null===o||s.contains(u))&&(o=h)}return o},Kc.prototype.findShell=function(t){for(var e=0,i=null,n=t.iterator();n.hasNext();){var r=n.next();r.isHole()||(i=r,e++)}return zl.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),i},Kc.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],i=arguments[1];Wc.linkResultDirectedEdges(i);var n=this.buildMaximalEdgeRings(e),r=new lu,o=this.buildMinimalEdgeRings(n,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},Kc.prototype.interfaces_=function(){return[]},Kc.prototype.getClass=function(){return Kc};var Hc=function(){};Hc.prototype.getBounds=function(){},Hc.prototype.interfaces_=function(){return[]},Hc.prototype.getClass=function(){return Hc};var Zc=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Zc.prototype.getItem=function(){return this._item},Zc.prototype.getBounds=function(){return this._bounds},Zc.prototype.interfaces_=function(){return[Hc,al]},Zc.prototype.getClass=function(){return Zc};var Jc=function(){this._size=null,this._items=null,this._size=0,this._items=new lu,this._items.add(null)};Jc.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Jc.prototype.size=function(){return this._size},Jc.prototype.reorder=function(t){for(var e=this,i=null,n=this._items.get(t);2*t<=this._size&&((i=2*t)!==e._size&&e._items.get(i+1).compareTo(e._items.get(i))<0&&i++,e._items.get(i).compareTo(n)<0);t=i)e._items.set(t,e._items.get(i));this._items.set(t,n)},Jc.prototype.clear=function(){this._size=0,this._items.clear()},Jc.prototype.isEmpty=function(){return 0===this._size},Jc.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Jc.prototype.interfaces_=function(){return[]},Jc.prototype.getClass=function(){return Jc};var Qc=function(){};Qc.prototype.visitItem=function(t){},Qc.prototype.interfaces_=function(){return[]},Qc.prototype.getClass=function(){return Qc};var $c=function(){};$c.prototype.insert=function(t,e){},$c.prototype.remove=function(t,e){},$c.prototype.query=function(){},$c.prototype.interfaces_=function(){return[]},$c.prototype.getClass=function(){return $c};var tp=function(){if(this._childBoundables=new lu,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},ep={serialVersionUID:{configurable:!0}};tp.prototype.getLevel=function(){return this._level},tp.prototype.size=function(){return this._childBoundables.size()},tp.prototype.getChildBoundables=function(){return this._childBoundables},tp.prototype.addChildBoundable=function(t){zl.isTrue(null===this._bounds),this._childBoundables.add(t)},tp.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},tp.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},tp.prototype.interfaces_=function(){return[Hc,al]},tp.prototype.getClass=function(){return tp},ep.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(tp,ep);var ip=function(){};ip.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},ip.min=function(t){return ip.sort(t),t.get(0)},ip.sort=function(t,e){var i=t.toArray();e?Lu.sort(i,e):Lu.sort(i);for(var n=t.iterator(),r=0,o=i.length;r<o;r++)n.next(),n.set(i[r])},ip.singletonList=function(t){var e=new lu;return e.add(t),e};var np=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],i=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=i,this._distance=this.distance()};np.prototype.expandToQueue=function(t,e){var i=np.isComposite(this._boundable1),n=np.isComposite(this._boundable2);if(i&&n)return np.area(this._boundable1)>np.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(i)return this.expand(this._boundable1,this._boundable2,t,e),null;if(n)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new el("neither boundable is composite")},np.prototype.isLeaves=function(){return!(np.isComposite(this._boundable1)||np.isComposite(this._boundable2))},np.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},np.prototype.expand=function(t,e,i,n){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new np(o,e,this._itemDistance);s.getDistance()<n&&i.add(s)}},np.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},np.prototype.getDistance=function(){return this._distance},np.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},np.prototype.interfaces_=function(){return[rl]},np.prototype.getClass=function(){return np},np.area=function(t){return t.getBounds().getArea()},np.isComposite=function(t){return t instanceof tp};var rp=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new lu,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var i=arguments[0];zl.isTrue(i>1,"Node capacity must be greater than 1"),this._nodeCapacity=i}},op={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};rp.prototype.getNodeCapacity=function(){return this._nodeCapacity},rp.prototype.lastNode=function(t){return t.get(t.size()-1)},rp.prototype.size=function(){var t=this;if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var e=0,i=arguments[0].getChildBoundables().iterator();i.hasNext();){var n=i.next();n instanceof tp?e+=t.size(n):n instanceof Zc&&(e+=1)}return e}},rp.prototype.removeItem=function(t,e){for(var i=null,n=t.getChildBoundables().iterator();n.hasNext();){var r=n.next();r instanceof Zc&&r.getItem()===e&&(i=r)}return null!==i&&(t.getChildBoundables().remove(i),!0)},rp.prototype.itemsTree=function(){var t=this;if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new lu:e}if(1===arguments.length){for(var i=arguments[0],n=new lu,r=i.getChildBoundables().iterator();r.hasNext();){var o=r.next();if(o instanceof tp){var s=t.itemsTree(o);null!==s&&n.add(s)}else o instanceof Zc?n.add(o.getItem()):zl.shouldNeverReachHere()}return n.size()<=0?null:n}},rp.prototype.insert=function(t,e){zl.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Zc(t,e))},rp.prototype.boundablesAtLevel=function(){var t=this;if(1===arguments.length){var e=arguments[0],i=new lu;return this.boundablesAtLevel(e,this._root,i),i}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];if(zl.isTrue(n>-2),r.getLevel()===n)return o.add(r),null;for(var s=r.getChildBoundables().iterator();s.hasNext();){var a=s.next();a instanceof tp?t.boundablesAtLevel(n,a,o):(zl.isTrue(a instanceof Zc),-1===n&&o.add(a))}return null}},rp.prototype.query=function(){var t=this;if(1===arguments.length){var e=arguments[0];this.build();var i=new lu;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,i),i}if(2===arguments.length){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r)}else if(3===arguments.length)if(dl(arguments[2],Qc)&&arguments[0]instanceof Object&&arguments[1]instanceof tp)for(var o=arguments[0],s=arguments[2],a=arguments[1].getChildBoundables(),h=0;h<a.size();h++){var l=a.get(h);t.getIntersectsOp().intersects(l.getBounds(),o)&&(l instanceof tp?t.query(o,l,s):l instanceof Zc?s.visitItem(l.getItem()):zl.shouldNeverReachHere())}else if(dl(arguments[2],au)&&arguments[0]instanceof Object&&arguments[1]instanceof tp)for(var u=arguments[0],c=arguments[2],p=arguments[1].getChildBoundables(),f=0;f<p.size();f++){var d=p.get(f);t.getIntersectsOp().intersects(d.getBounds(),u)&&(d instanceof tp?t.query(u,d,c):d instanceof Zc?c.add(d.getItem()):zl.shouldNeverReachHere())}},rp.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},rp.prototype.getRoot=function(){return this.build(),this._root},rp.prototype.remove=function(){var t=this;if(2===arguments.length){var e=arguments[0],i=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,i)}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=this.removeItem(r,o);if(s)return!0;for(var a=null,h=r.getChildBoundables().iterator();h.hasNext();){var l=h.next();if(t.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof tp&&(s=t.remove(n,l,o))){a=l;break}}return null!==a&&a.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(a),s}},rp.prototype.createHigherLevels=function(t,e){zl.isTrue(!t.isEmpty());var i=this.createParentBoundables(t,e+1);return 1===i.size()?i.get(0):this.createHigherLevels(i,e+1)},rp.prototype.depth=function(){var t=this;if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=0,i=arguments[0].getChildBoundables().iterator();i.hasNext();){var n=i.next();if(n instanceof tp){var r=t.depth(n);r>e&&(e=r)}}return e+1}},rp.prototype.createParentBoundables=function(t,e){var i=this;zl.isTrue(!t.isEmpty());var n=new lu;n.add(this.createNode(e));var r=new lu(t);ip.sort(r,this.getComparator());for(var o=r.iterator();o.hasNext();){var s=o.next();i.lastNode(n).getChildBoundables().size()===i.getNodeCapacity()&&n.add(i.createNode(e)),i.lastNode(n).addChildBoundable(s)}return n},rp.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},rp.prototype.interfaces_=function(){return[al]},rp.prototype.getClass=function(){return rp},rp.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},op.IntersectsOp.get=function(){return sp},op.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},op.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(rp,op);var sp=function(){},ap=function(){};ap.prototype.distance=function(t,e){},ap.prototype.interfaces_=function(){return[]},ap.prototype.getClass=function(){return ap};var hp=function(t){function e(i){i=i||e.DEFAULT_NODE_CAPACITY,t.call(this,i)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(t,e){zl.isTrue(t.length>0);for(var i=new lu,n=0;n<t.length;n++)i.addAll(this.createParentBoundablesFromVerticalSlice(t[n],e));return i},e.prototype.createNode=function(t){return new lp(t)},e.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],i=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,i)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(t,e){for(var i=Math.trunc(Math.ceil(t.size()/e)),n=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){n[o]=new lu;for(var s=0;r.hasNext()&&s<i;){var a=r.next();n[o].add(a),s++}}return n},e.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var i=arguments[0],n=arguments[1];t.prototype.query.call(this,i,n)}else if(3===arguments.length)if(dl(arguments[2],Qc)&&arguments[0]instanceof Object&&arguments[1]instanceof tp){var r=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,r,o,s)}else if(dl(arguments[2],au)&&arguments[0]instanceof Object&&arguments[1]instanceof tp){var a=arguments[0],h=arguments[1],l=arguments[2];t.prototype.query.call(this,a,h,l)}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(e,i){return t.prototype.createParentBoundables.call(this,e,i)},e.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return t.prototype.remove.call(this,e,i)}return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(t,i){zl.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new lu(t);ip.sort(r,e.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(o,i)},e.prototype.nearestNeighbour=function(){if(1===arguments.length){if(dl(arguments[0],ap)){var t=arguments[0],i=new np(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(i)}if(arguments[0]instanceof np){var n=arguments[0];return this.nearestNeighbour(n,il.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof e&&dl(arguments[1],ap)){var r=arguments[0],o=arguments[1],s=new np(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof np&&"number"==typeof arguments[1]){var a=arguments[0],h=arguments[1],l=null,u=new Jc;for(u.add(a);!u.isEmpty()&&h>0;){var c=u.poll(),p=c.getDistance();if(p>=h)break;c.isLeaves()?(h=p,l=c):c.expandToQueue(u,h)}return[l.getBoundable(0).getItem(),l.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[2],d=new Zc(arguments[0],arguments[1]),g=new np(this.getRoot(),d,f);return this.nearestNeighbour(g)[0]}},e.prototype.interfaces_=function(){return[$c,al]},e.prototype.getClass=function(){return e},e.centreX=function(t){return e.avg(t.getMinX(),t.getMaxX())},e.avg=function(t,e){return(t+e)/2},e.centreY=function(t){return e.avg(t.getMinY(),t.getMaxY())},i.STRtreeNode.get=function(){return lp},i.serialVersionUID.get=function(){return 0x39920f7d5f261e0},i.xComparator.get=function(){return{interfaces_:function(){return[sl]},compare:function(i,n){return t.compareDoubles(e.centreX(i.getBounds()),e.centreX(n.getBounds()))}}},i.yComparator.get=function(){return{interfaces_:function(){return[sl]},compare:function(i,n){return t.compareDoubles(e.centreY(i.getBounds()),e.centreY(n.getBounds()))}}},i.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},i.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,i),e}(rp),lp=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var i=e.next();null===t?t=new Rl(i.getBounds()):t.expandToInclude(i.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(tp),up=function(){};up.prototype.interfaces_=function(){return[]},up.prototype.getClass=function(){return up},up.relativeSign=function(t,e){return t<e?-1:t>e?1:0},up.compare=function(t,e,i){if(e.equals2D(i))return 0;var n=up.relativeSign(e.x,i.x),r=up.relativeSign(e.y,i.y);switch(t){case 0:return up.compareValue(n,r);case 1:return up.compareValue(r,n);case 2:return up.compareValue(r,-n);case 3:return up.compareValue(-n,r);case 4:return up.compareValue(-n,-r);case 5:return up.compareValue(-r,-n);case 6:return up.compareValue(-r,n);case 7:return up.compareValue(n,-r)}return zl.shouldNeverReachHere("invalid octant value"),0},up.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var cp=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._segString=t,this.coord=new hl(e),this.segmentIndex=i,this._segmentOctant=n,this._isInterior=!e.equals2D(t.getCoordinate(i))};cp.prototype.getCoordinate=function(){return this.coord},cp.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},cp.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:up.compare(this._segmentOctant,this.coord,e.coord)},cp.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},cp.prototype.isInterior=function(){return this._isInterior},cp.prototype.interfaces_=function(){return[rl]},cp.prototype.getClass=function(){return cp};var pp=function(){this._nodeMap=new Su,this._edge=null;var t=arguments[0];this._edge=t};pp.prototype.getSplitCoordinates=function(){var t=new cu;this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next();this.addEdgeCoordinates(i,n,t),i=n}return t.toCoordinateArray()},pp.prototype.addCollapsedNodes=function(){var t=new lu;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var i=e.next().intValue();this.add(this._edge.getCoordinate(i),i)}},pp.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},pp.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var i=this._edge.getCoordinate(e),n=this._edge.getCoordinate(e+2);i.equals2D(n)&&t.add(new ml(e+1))}},pp.prototype.addEdgeCoordinates=function(t,e,i){var n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);i.add(new hl(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)i.add(this._edge.getCoordinate(o));r&&i.add(new hl(e.coord))},pp.prototype.iterator=function(){return this._nodeMap.values().iterator()},pp.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}},pp.prototype.findCollapseIndex=function(t,e,i){if(!t.coord.equals2D(e.coord))return!1;var n=e.segmentIndex-t.segmentIndex;return e.isInterior()||n--,1===n&&(i[0]=t.segmentIndex+1,!0)},pp.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),i=this.iterator(),n=i.next();i.hasNext();){var r=i.next();this.findCollapseIndex(n,r,e)&&t.add(new ml(e[0])),n=r}},pp.prototype.getEdge=function(){return this._edge},pp.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},pp.prototype.createSplitEdge=function(t,e){var i=e.segmentIndex-t.segmentIndex+2,n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);r||i--;var o=new Array(i).fill(null),s=0;o[s++]=new hl(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new hl(e.coord)),new yp(o,this._edge.getData())},pp.prototype.add=function(t,e){var i=new cp(this._edge,t,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(i);return null!==n?(zl.isTrue(n.coord.equals2D(t),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(i,i),i)},pp.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),i=t.get(0).getCoordinate(0);if(!i.equals2D(e[0]))throw new kl("bad split edge start point at "+i);var n=t.get(t.size()-1).getCoordinates(),r=n[n.length-1];if(!r.equals2D(e[e.length-1]))throw new kl("bad split edge end point at "+r)},pp.prototype.interfaces_=function(){return[]},pp.prototype.getClass=function(){return pp};var fp=function(){};fp.prototype.interfaces_=function(){return[]},fp.prototype.getClass=function(){return fp},fp.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new el("Cannot compute the octant for point ( "+t+", "+e+" )");var i=Math.abs(t),n=Math.abs(e);return t>=0?e>=0?i>=n?0:1:i>=n?7:6:e>=0?i>=n?3:2:i>=n?4:5}if(arguments[0]instanceof hl&&arguments[1]instanceof hl){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new el("Cannot compute the octant for two identical points "+r);return fp.octant(s,a)}};var dp=function(){};dp.prototype.getCoordinates=function(){},dp.prototype.size=function(){},dp.prototype.getCoordinate=function(t){},dp.prototype.isClosed=function(){},dp.prototype.setData=function(t){},dp.prototype.getData=function(){},dp.prototype.interfaces_=function(){return[]},dp.prototype.getClass=function(){return dp};var gp=function(){};gp.prototype.addIntersection=function(t,e){},gp.prototype.interfaces_=function(){return[dp]},gp.prototype.getClass=function(){return gp};var yp=function(){this._nodeList=new pp(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};yp.prototype.getCoordinates=function(){return this._pts},yp.prototype.size=function(){return this._pts.length},yp.prototype.getCoordinate=function(t){return this._pts[t]},yp.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},yp.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},yp.prototype.setData=function(t){this._data=t},yp.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:fp.octant(t,e)},yp.prototype.getData=function(){return this._data},yp.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var i=arguments[1],n=arguments[3],r=new hl(arguments[0].getIntersection(n));this.addIntersection(r,i)}},yp.prototype.toString=function(){return Fl.toLineString(new lc(this._pts))},yp.prototype.getNodeList=function(){return this._nodeList},yp.prototype.addIntersectionNode=function(t,e){var i=e,n=i+1;if(n<this._pts.length){var r=this._pts[n];t.equals2D(r)&&(i=n)}return this._nodeList.add(t,i)},yp.prototype.addIntersections=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)},yp.prototype.interfaces_=function(){return[gp]},yp.prototype.getClass=function(){return yp},yp.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new lu;return yp.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var i=arguments[1],n=arguments[0].iterator();n.hasNext();)n.next().getNodeList().addSplitEdges(i)};var _p=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new hl,this.p1=new hl;else if(1===arguments.length){var t=arguments[0];this.p0=new hl(t.p0),this.p1=new hl(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=arguments[3];this.p0=new hl(e,i),this.p1=new hl(n,r)}},mp={serialVersionUID:{configurable:!0}};_p.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},_p.prototype.orientationIndex=function(){if(arguments[0]instanceof _p){var t=arguments[0],e=Yl.orientationIndex(this.p0,this.p1,t.p0),i=Yl.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&i>=0||e<=0&&i<=0?Math.max(e,i):0}if(arguments[0]instanceof hl){var n=arguments[0];return Yl.orientationIndex(this.p0,this.p1,n)}},_p.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},_p.prototype.isVertical=function(){return this.p0.x===this.p1.x},_p.prototype.equals=function(t){if(!(t instanceof _p))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},_p.prototype.intersection=function(t){var e=new Bl;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},_p.prototype.project=function(){if(arguments[0]instanceof hl){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new hl(t);var e=this.projectionFactor(t),i=new hl;return i.x=this.p0.x+e*(this.p1.x-this.p0.x),i.y=this.p0.y+e*(this.p1.y-this.p0.y),i}if(arguments[0]instanceof _p){var n=arguments[0],r=this.projectionFactor(n.p0),o=this.projectionFactor(n.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var s=this.project(n.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(n.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new _p(s,a)}},_p.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},_p.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},_p.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},_p.prototype.distancePerpendicular=function(t){return Yl.distancePointLinePerpendicular(t,this.p0,this.p1)},_p.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},_p.prototype.midPoint=function(){return _p.midPoint(this.p0,this.p1)},_p.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,n=e*e+i*i;return n<=0?il.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*i)/n},_p.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var i=new Array(2).fill(null),n=il.MAX_VALUE,r=null,o=this.closestPoint(t.p0);n=o.distance(t.p0),i[0]=o,i[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<n&&(n=r,i[0]=s,i[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<n&&(n=r,i[0]=this.p0,i[1]=a);var h=t.closestPoint(this.p1);return(r=h.distance(this.p1))<n&&(n=r,i[0]=this.p1,i[1]=h),i},_p.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},_p.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},_p.prototype.getLength=function(){return this.p0.distance(this.p1)},_p.prototype.compareTo=function(t){var e=t,i=this.p0.compareTo(e.p0);return 0!==i?i:this.p1.compareTo(e.p1)},_p.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},_p.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},_p.prototype.lineIntersection=function(t){try{return Nl.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof Sl))throw t}return null},_p.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},_p.prototype.pointAlongOffset=function(t,e){var i=this.p0.x+t*(this.p1.x-this.p0.x),n=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,h=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,h=e*o/s}return new hl(i-h,n+a)},_p.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=i.x,this.p1.y=i.y}},_p.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||il.isNaN(e))&&(e=1),e},_p.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},_p.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},_p.prototype.distance=function(){if(arguments[0]instanceof _p){var t=arguments[0];return Yl.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof hl){var e=arguments[0];return Yl.distancePointLine(e,this.p0,this.p1)}},_p.prototype.pointAlong=function(t){var e=new hl;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},_p.prototype.hashCode=function(){var t=il.doubleToLongBits(this.p0.x);t^=31*il.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),i=il.doubleToLongBits(this.p1.x);return i^=31*il.doubleToLongBits(this.p1.y),e^Math.trunc(i)^Math.trunc(i>>32)},_p.prototype.interfaces_=function(){return[rl,al]},_p.prototype.getClass=function(){return _p},_p.midPoint=function(t,e){return new hl((t.x+e.x)/2,(t.y+e.y)/2)},mp.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(_p,mp);var vp=function(){this.tempEnv1=new Rl,this.tempEnv2=new Rl,this._overlapSeg1=new _p,this._overlapSeg2=new _p};vp.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],i=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},vp.prototype.interfaces_=function(){return[]},vp.prototype.getClass=function(){return vp};var xp=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._pts=t,this._start=e,this._end=i,this._context=n};xp.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},xp.prototype.computeSelect=function(t,e,i,n){var r=this._pts[e],o=this._pts[i];if(n.tempEnv1.init(r,o),i-e==1)return n.select(this,e),null;if(!t.intersects(n.tempEnv1))return null;var s=Math.trunc((e+i)/2);e<s&&this.computeSelect(t,e,s,n),s<i&&this.computeSelect(t,s,i,n)},xp.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,i=this._start;i<=this._end;i++)t[e++]=this._pts[i];return t},xp.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},xp.prototype.setId=function(t){this._id=t},xp.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},xp.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Rl(t,e)}return this._env},xp.prototype.getEndIndex=function(){return this._end},xp.prototype.getStartIndex=function(){return this._start},xp.prototype.getContext=function(){return this._context},xp.prototype.getId=function(){return this._id},xp.prototype.computeOverlapsInternal=function(t,e,i,n,r,o){var s=this._pts[t],a=this._pts[e],h=i._pts[n],l=i._pts[r];if(e-t==1&&r-n==1)return o.overlap(this,t,i,n),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(h,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var u=Math.trunc((t+e)/2),c=Math.trunc((n+r)/2);t<u&&(n<c&&this.computeOverlapsInternal(t,u,i,n,c,o),c<r&&this.computeOverlapsInternal(t,u,i,c,r,o)),u<e&&(n<c&&this.computeOverlapsInternal(u,e,i,n,c,o),c<r&&this.computeOverlapsInternal(u,e,i,c,r,o))},xp.prototype.interfaces_=function(){return[]},xp.prototype.getClass=function(){return xp};var Ep=function(){};Ep.prototype.interfaces_=function(){return[]},Ep.prototype.getClass=function(){return Ep},Ep.getChainStartIndices=function(t){var e=0,i=new lu;i.add(new ml(e));do{var n=Ep.findChainEnd(t,e);i.add(new ml(n)),e=n}while(e<t.length-1);return Ep.toIntArray(i)},Ep.findChainEnd=function(t,e){for(var i=e;i<t.length-1&&t[i].equals2D(t[i+1]);)i++;if(i>=t.length-1)return t.length-1;for(var n=Bc.quadrant(t[i],t[i+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Bc.quadrant(t[r-1],t[r])===n);)r++;return r-1},Ep.getChains=function(){if(1===arguments.length){var t=arguments[0];return Ep.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],i=arguments[1],n=new lu,r=Ep.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new xp(e,r[o],r[o+1],i);n.add(s)}return n}},Ep.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var wp=function(){};wp.prototype.computeNodes=function(t){},wp.prototype.getNodedSubstrings=function(){},wp.prototype.interfaces_=function(){return[]},wp.prototype.getClass=function(){return wp};var bp=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};bp.prototype.setSegmentIntersector=function(t){this._segInt=t},bp.prototype.interfaces_=function(){return[wp]},bp.prototype.getClass=function(){return bp};var Mp=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new lu,this._index=new hp,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return yp.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=this,i=Ep.getChains(t.getCoordinates(),t).iterator();i.hasNext();){var n=i.next();n.setId(e._idCounter++),e._index.insert(n.getEnvelope(),n),e._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=this,e=new Cp(this._segInt),i=this._monoChains.iterator();i.hasNext();)for(var n=i.next(),r=t._index.query(n.getEnvelope()).iterator();r.hasNext();){var o=r.next();if(o.getId()>n.getId()&&(n.computeOverlaps(o,e),t._nOverlaps++),t._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.SegmentOverlapAction.get=function(){return Cp},Object.defineProperties(e,i),e}(bp),Cp=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[0].getContext(),o=i.getContext();this._si.processIntersections(r,e,o,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(vp),Ip=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.setQuadrantSegments(i),this.setEndCapStyle(n)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},Sp={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Ip.prototype.getEndCapStyle=function(){return this._endCapStyle},Ip.prototype.isSingleSided=function(){return this._isSingleSided},Ip.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=Ip.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Ip.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Ip.JOIN_ROUND&&(this._quadrantSegments=Ip.DEFAULT_QUADRANT_SEGMENTS)},Ip.prototype.getJoinStyle=function(){return this._joinStyle},Ip.prototype.setJoinStyle=function(t){this._joinStyle=t},Ip.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},Ip.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Ip.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Ip.prototype.setEndCapStyle=function(t){this._endCapStyle=t},Ip.prototype.getMitreLimit=function(){return this._mitreLimit},Ip.prototype.setMitreLimit=function(t){this._mitreLimit=t},Ip.prototype.setSingleSided=function(t){this._isSingleSided=t},Ip.prototype.interfaces_=function(){return[]},Ip.prototype.getClass=function(){return Ip},Ip.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Sp.CAP_ROUND.get=function(){return 1},Sp.CAP_FLAT.get=function(){return 2},Sp.CAP_SQUARE.get=function(){return 3},Sp.JOIN_ROUND.get=function(){return 1},Sp.JOIN_MITRE.get=function(){return 2},Sp.JOIN_BEVEL.get=function(){return 3},Sp.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Sp.DEFAULT_MITRE_LIMIT.get=function(){return 5},Sp.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(Ip,Sp);var Pp=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Yl.COUNTERCLOCKWISE,this._inputLine=t||null},Np={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Pp.prototype.isDeletable=function(t,e,i,n){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[i];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,n)&&this.isShallowSampled(r,o,t,i,n)},Pp.prototype.deleteShallowConcavities=function(){for(var t=this,e=1,i=this.findNextNonDeletedIndex(e),n=this.findNextNonDeletedIndex(i),r=!1;n<this._inputLine.length;){var o=!1;t.isDeletable(e,i,n,t._distanceTol)&&(t._isDeleted[i]=Pp.DELETE,o=!0,r=!0),e=o?n:i,i=t.findNextNonDeletedIndex(e),n=t.findNextNonDeletedIndex(i)}return r},Pp.prototype.isShallowConcavity=function(t,e,i,n){return Yl.computeOrientation(t,e,i)===this._angleOrientation&&Yl.distancePointLine(e,t,i)<n},Pp.prototype.isShallowSampled=function(t,e,i,n,r){var o=Math.trunc((n-i)/Pp.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=i;s<n;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Pp.prototype.isConcave=function(t,e,i){return Yl.computeOrientation(t,e,i)===this._angleOrientation},Pp.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Yl.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Pp.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Pp.DELETE;)e++;return e},Pp.prototype.isShallow=function(t,e,i,n){return Yl.distancePointLine(e,t,i)<n},Pp.prototype.collapseLine=function(){for(var t=new cu,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Pp.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Pp.prototype.interfaces_=function(){return[]},Pp.prototype.getClass=function(){return Pp},Pp.simplify=function(t,e){return new Pp(t).simplify(e)},Np.INIT.get=function(){return 0},Np.DELETE.get=function(){return 1},Np.KEEP.get=function(){return 1},Np.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Pp,Np);var Rp=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new lu},Tp={COORDINATE_ARRAY_TYPE:{configurable:!0}};Rp.prototype.getCoordinates=function(){return this._ptList.toArray(Rp.COORDINATE_ARRAY_TYPE)},Rp.prototype.setPrecisionModel=function(t){this._precisionModel=t},Rp.prototype.addPt=function(t){var e=new hl(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Rp.prototype.revere=function(){},Rp.prototype.addPts=function(t,e){if(e)for(var i=0;i<t.length;i++)this.addPt(t[i]);else for(var n=t.length-1;n>=0;n--)this.addPt(t[n])},Rp.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Rp.prototype.toString=function(){return(new mc).createLineString(this.getCoordinates()).toString()},Rp.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new hl(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Rp.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Rp.prototype.interfaces_=function(){return[]},Rp.prototype.getClass=function(){return Rp},Tp.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Rp,Tp);var Lp=function(){},Op={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Lp.prototype.interfaces_=function(){return[]},Lp.prototype.getClass=function(){return Lp},Lp.toDegrees=function(t){return 180*t/Math.PI},Lp.normalize=function(t){for(;t>Math.PI;)t-=Lp.PI_TIMES_2;for(;t<=-Math.PI;)t+=Lp.PI_TIMES_2;return t},Lp.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],i=arguments[1],n=i.x-e.x,r=i.y-e.y;return Math.atan2(r,n)}},Lp.isAcute=function(t,e,i){var n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)>0},Lp.isObtuse=function(t,e,i){var n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)<0},Lp.interiorAngle=function(t,e,i){var n=Lp.angle(e,t),r=Lp.angle(e,i);return Math.abs(r-n)},Lp.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Lp.PI_TIMES_2;t>=Lp.PI_TIMES_2&&(t=0)}else{for(;t>=Lp.PI_TIMES_2;)t-=Lp.PI_TIMES_2;t<0&&(t=0)}return t},Lp.angleBetween=function(t,e,i){var n=Lp.angle(e,t),r=Lp.angle(e,i);return Lp.diff(n,r)},Lp.diff=function(t,e){var i=null;return(i=t<e?e-t:t-e)>Math.PI&&(i=2*Math.PI-i),i},Lp.toRadians=function(t){return t*Math.PI/180},Lp.getTurn=function(t,e){var i=Math.sin(e-t);return i>0?Lp.COUNTERCLOCKWISE:i<0?Lp.CLOCKWISE:Lp.NONE},Lp.angleBetweenOriented=function(t,e,i){var n=Lp.angle(e,t),r=Lp.angle(e,i)-n;return r<=-Math.PI?r+Lp.PI_TIMES_2:r>Math.PI?r-Lp.PI_TIMES_2:r},Op.PI_TIMES_2.get=function(){return 2*Math.PI},Op.PI_OVER_2.get=function(){return Math.PI/2},Op.PI_OVER_4.get=function(){return Math.PI/4},Op.COUNTERCLOCKWISE.get=function(){return Yl.COUNTERCLOCKWISE},Op.CLOCKWISE.get=function(){return Yl.CLOCKWISE},Op.NONE.get=function(){return Yl.COLLINEAR},Object.defineProperties(Lp,Op);var Ap=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new _p,this._seg1=new _p,this._offset0=new _p,this._offset1=new _p,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],i=arguments[1],n=arguments[2];this._precisionModel=e,this._bufParams=i,this._li=new Bl,this._filletAngleQuantum=Math.PI/2/i.getQuadrantSegments(),i.getQuadrantSegments()>=8&&i.getJoinStyle()===Ip.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)},Dp={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Ap.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var i=Yl.computeOrientation(this._s0,this._s1,this._s2),n=i===Yl.CLOCKWISE&&this._side===Ic.LEFT||i===Yl.COUNTERCLOCKWISE&&this._side===Ic.RIGHT;0===i?this.addCollinear(e):n?this.addOutsideTurn(i,e):this.addInsideTurn(i,e)},Ap.prototype.addLineEndCap=function(t,e){var i=new _p(t,e),n=new _p;this.computeOffsetSegment(i,Ic.LEFT,this._distance,n);var r=new _p;this.computeOffsetSegment(i,Ic.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case Ip.CAP_ROUND:this._segList.addPt(n.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,Yl.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case Ip.CAP_FLAT:this._segList.addPt(n.p1),this._segList.addPt(r.p1);break;case Ip.CAP_SQUARE:var h=new hl;h.x=Math.abs(this._distance)*Math.cos(a),h.y=Math.abs(this._distance)*Math.sin(a);var l=new hl(n.p1.x+h.x,n.p1.y+h.y),u=new hl(r.p1.x+h.x,r.p1.y+h.y);this._segList.addPt(l),this._segList.addPt(u)}},Ap.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Ap.prototype.addMitreJoin=function(t,e,i,n){var r=!0,o=null;try{o=Nl.intersection(e.p0,e.p1,i.p0,i.p1),(n<=0?1:o.distance(t)/Math.abs(n))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof Sl))throw t;o=new hl(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,i,n,this._bufParams.getMitreLimit())},Ap.prototype.addFilletCorner=function(t,e,i,n,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),h=i.x-t.x,l=i.y-t.y,u=Math.atan2(l,h);n===Yl.CLOCKWISE?a<=u&&(a+=2*Math.PI):a>=u&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,u,n,r),this._segList.addPt(i)},Ap.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Ap.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Ip.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Ip.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Ap.prototype.createSquare=function(t){this._segList.addPt(new hl(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new hl(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new hl(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new hl(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Ap.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Ap.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Ap.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Ap.prototype.initSideSegments=function(t,e,i){this._s1=t,this._s2=e,this._side=i,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)},Ap.prototype.addLimitedMitreJoin=function(t,e,i,n){var r=this._seg0.p1,o=Lp.angle(r,this._seg0.p0),s=Lp.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Lp.normalize(o+s),h=Lp.normalize(a+Math.PI),l=n*i,u=i-l*Math.abs(Math.sin(s)),c=r.x+l*Math.cos(h),p=r.y+l*Math.sin(h),f=new hl(c,p),d=new _p(r,f),g=d.pointAlongOffset(1,u),y=d.pointAlongOffset(1,-u);this._side===Ic.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},Ap.prototype.computeOffsetSegment=function(t,e,i,n){var r=e===Ic.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),h=r*i*o/a,l=r*i*s/a;n.p0.x=t.p0.x-l,n.p0.y=t.p0.y+h,n.p1.x=t.p1.x-l,n.p1.y=t.p1.y+h},Ap.prototype.addFilletArc=function(t,e,i,n,r){var o=n===Yl.CLOCKWISE?-1:1,s=Math.abs(e-i),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var h=s/a,l=0,u=new hl;l<s;){var c=e+o*l;u.x=t.x+r*Math.cos(c),u.y=t.y+r*Math.sin(c),this._segList.addPt(u),l+=h}},Ap.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Ap.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new hl((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var n=new hl((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Ap.prototype.createCircle=function(t){var e=new hl(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Ap.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Ap.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Rp,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Ap.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Ap.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Ip.JOIN_BEVEL||this._bufParams.getJoinStyle()===Ip.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Yl.CLOCKWISE,this._distance))},Ap.prototype.closeRing=function(){this._segList.closeRing()},Ap.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Ap.prototype.interfaces_=function(){return[]},Ap.prototype.getClass=function(){return Ap},Dp.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Dp.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Dp.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Dp.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Ap,Dp);var Fp=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Fp.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var i=e<0,n=Math.abs(e),r=this.getSegGen(n);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,i,r);var o=r.getCoordinates();return i&&pu.reverse(o),o},Fp.prototype.computeSingleSidedBufferCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);if(e){i.addSegments(t,!0);var r=Pp.simplify(t,-n),o=r.length-1;i.initSideSegments(r[o],r[o-1],Ic.LEFT),i.addFirstSegment();for(var s=o-2;s>=0;s--)i.addNextSegment(r[s],!0)}else{i.addSegments(t,!1);var a=Pp.simplify(t,n),h=a.length-1;i.initSideSegments(a[0],a[1],Ic.LEFT),i.addFirstSegment();for(var l=2;l<=h;l++)i.addNextSegment(a[l],!0)}i.addLastSegment(),i.closeRing()},Fp.prototype.computeRingBufferCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);e===Ic.RIGHT&&(n=-n);var r=Pp.simplify(t,n),o=r.length-1;i.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;i.addNextSegment(r[s],a)}i.closeRing()},Fp.prototype.computeLineBufferCurve=function(t,e){var i=this.simplifyTolerance(this._distance),n=Pp.simplify(t,i),r=n.length-1;e.initSideSegments(n[0],n[1],Ic.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(n[o],!0);e.addLastSegment(),e.addLineEndCap(n[r-1],n[r]);var s=Pp.simplify(t,-i),a=s.length-1;e.initSideSegments(s[a],s[a-1],Ic.LEFT);for(var h=a-2;h>=0;h--)e.addNextSegment(s[h],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},Fp.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case Ip.CAP_ROUND:e.createCircle(t);break;case Ip.CAP_SQUARE:e.createSquare(t)}},Fp.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var i=Math.abs(e),n=this.getSegGen(i);if(t.length<=1)this.computePointCurve(t[0],n);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,n)}else this.computeLineBufferCurve(t,n);return n.getCoordinates()},Fp.prototype.getBufferParameters=function(){return this._bufParams},Fp.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Fp.prototype.getRingCurve=function(t,e,i){if(this._distance=i,t.length<=2)return this.getLineCurve(t,i);if(0===i)return Fp.copyCoordinates(t);var n=this.getSegGen(i);return this.computeRingBufferCurve(t,e,n),n.getCoordinates()},Fp.prototype.computeOffsetCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);if(e){var r=Pp.simplify(t,-n),o=r.length-1;i.initSideSegments(r[o],r[o-1],Ic.LEFT),i.addFirstSegment();for(var s=o-2;s>=0;s--)i.addNextSegment(r[s],!0)}else{var a=Pp.simplify(t,n),h=a.length-1;i.initSideSegments(a[0],a[1],Ic.LEFT),i.addFirstSegment();for(var l=2;l<=h;l++)i.addNextSegment(a[l],!0)}i.addLastSegment()},Fp.prototype.getSegGen=function(t){return new Ap(this._precisionModel,this._bufParams,t)},Fp.prototype.interfaces_=function(){return[]},Fp.prototype.getClass=function(){return Fp},Fp.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),i=0;i<e.length;i++)e[i]=new hl(t[i]);return e};var kp=function(){this._subgraphs=null,this._seg=new _p,this._cga=new Yl;var t=arguments[0];this._subgraphs=t},Gp={DepthSegment:{configurable:!0}};kp.prototype.findStabbedSegments=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],i=new lu,n=this._subgraphs.iterator();n.hasNext();){var r=n.next(),o=r.getEnvelope();e.y<o.getMinY()||e.y>o.getMaxY()||t.findStabbedSegments(e,r.getDirectedEdges(),i)}return i}if(3===arguments.length)if(dl(arguments[2],au)&&arguments[0]instanceof hl&&arguments[1]instanceof Yc){for(var s=arguments[0],a=arguments[1],h=arguments[2],l=a.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(t._seg.p0=l[u],t._seg.p1=l[u+1],t._seg.p0.y>t._seg.p1.y&&t._seg.reverse(),!(Math.max(t._seg.p0.x,t._seg.p1.x)<s.x||t._seg.isHorizontal()||s.y<t._seg.p0.y||s.y>t._seg.p1.y||Yl.computeOrientation(t._seg.p0,t._seg.p1,s)===Yl.RIGHT)){var c=a.getDepth(Ic.LEFT);t._seg.p0.equals(l[u])||(c=a.getDepth(Ic.RIGHT));var p=new zp(t._seg,c);h.add(p)}}else if(dl(arguments[2],au)&&arguments[0]instanceof hl&&dl(arguments[1],au))for(var f=arguments[0],d=arguments[2],g=arguments[1].iterator();g.hasNext();){var y=g.next();y.isForward()&&t.findStabbedSegments(f,y,d)}},kp.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:ip.min(e)._leftDepth},kp.prototype.interfaces_=function(){return[]},kp.prototype.getClass=function(){return kp},Gp.DepthSegment.get=function(){return zp},Object.defineProperties(kp,Gp);var zp=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new _p(t),this._leftDepth=e};zp.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var i=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==i||0!=(i=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?i:this._upwardSeg.compareTo(e._upwardSeg)},zp.prototype.compareX=function(t,e){var i=t.p0.compareTo(e.p0);return 0!==i?i:t.p1.compareTo(e.p1)},zp.prototype.toString=function(){return this._upwardSeg.toString()},zp.prototype.interfaces_=function(){return[rl]},zp.prototype.getClass=function(){return zp};var jp=function(t,e,i){this.p0=t||null,this.p1=e||null,this.p2=i||null};jp.prototype.area=function(){return jp.area(this.p0,this.p1,this.p2)},jp.prototype.signedArea=function(){return jp.signedArea(this.p0,this.p1,this.p2)},jp.prototype.interpolateZ=function(t){if(null===t)throw new el("Supplied point is null.");return jp.interpolateZ(t,this.p0,this.p1,this.p2)},jp.prototype.longestSideLength=function(){return jp.longestSideLength(this.p0,this.p1,this.p2)},jp.prototype.isAcute=function(){return jp.isAcute(this.p0,this.p1,this.p2)},jp.prototype.circumcentre=function(){return jp.circumcentre(this.p0,this.p1,this.p2)},jp.prototype.area3D=function(){return jp.area3D(this.p0,this.p1,this.p2)},jp.prototype.centroid=function(){return jp.centroid(this.p0,this.p1,this.p2)},jp.prototype.inCentre=function(){return jp.inCentre(this.p0,this.p1,this.p2)},jp.prototype.interfaces_=function(){return[]},jp.prototype.getClass=function(){return jp},jp.area=function(t,e,i){return Math.abs(((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2)},jp.signedArea=function(t,e,i){return((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2},jp.det=function(t,e,i,n){return t*n-e*i},jp.interpolateZ=function(t,e,i,n){var r=e.x,o=e.y,s=i.x-r,a=n.x-r,h=i.y-o,l=n.y-o,u=s*l-a*h,c=t.x-r,p=t.y-o,f=(l*c-a*p)/u,d=(-h*c+s*p)/u;return e.z+f*(i.z-e.z)+d*(n.z-e.z)},jp.longestSideLength=function(t,e,i){var n=t.distance(e),r=e.distance(i),o=i.distance(t),s=n;return r>s&&(s=r),o>s&&(s=o),s},jp.isAcute=function(t,e,i){return!!Lp.isAcute(t,e,i)&&!!Lp.isAcute(e,i,t)&&!!Lp.isAcute(i,t,e)},jp.circumcentre=function(t,e,i){var n=i.x,r=i.y,o=t.x-n,s=t.y-r,a=e.x-n,h=e.y-r,l=2*jp.det(o,s,a,h),u=jp.det(s,o*o+s*s,h,a*a+h*h),c=jp.det(o,o*o+s*s,a,a*a+h*h);return new hl(n-u/l,r+c/l)},jp.perpendicularBisector=function(t,e){var i=e.x-t.x,n=e.y-t.y,r=new Nl(t.x+i/2,t.y+n/2,1),o=new Nl(t.x-n+i/2,t.y+i+n/2,1);return new Nl(r,o)},jp.angleBisector=function(t,e,i){var n=e.distance(t),r=n/(n+e.distance(i)),o=i.x-t.x,s=i.y-t.y;return new hl(t.x+r*o,t.y+r*s)},jp.area3D=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=i.x-t.x,a=i.y-t.y,h=i.z-t.z,l=r*h-o*a,u=o*s-n*h,c=n*a-r*s,p=l*l+u*u+c*c;return Math.sqrt(p)/2},jp.centroid=function(t,e,i){var n=(t.x+e.x+i.x)/3,r=(t.y+e.y+i.y)/3;return new hl(n,r)},jp.inCentre=function(t,e,i){var n=e.distance(i),r=t.distance(i),o=t.distance(e),s=n+r+o,a=(n*t.x+r*e.x+o*i.x)/s,h=(n*t.y+r*e.y+o*i.y)/s;return new hl(a,h)};var qp=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new lu;var t=arguments[0],e=arguments[1],i=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=i};qp.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,pl.EXTERIOR,pl.INTERIOR)},qp.prototype.addPolygon=function(t){var e=this,i=this._distance,n=Ic.LEFT;this._distance<0&&(i=-this._distance,n=Ic.RIGHT);var r=t.getExteriorRing(),o=pu.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&o.length<3)return null;this.addPolygonRing(o,i,n,pl.EXTERIOR,pl.INTERIOR);for(var s=0;s<t.getNumInteriorRing();s++){var a=t.getInteriorRingN(s),h=pu.removeRepeatedPoints(a.getCoordinates());e._distance>0&&e.isErodedCompletely(a,-e._distance)||e.addPolygonRing(h,i,Ic.opposite(n),pl.INTERIOR,pl.EXTERIOR)}},qp.prototype.isTriangleErodedCompletely=function(t,e){var i=new jp(t[0],t[1],t[2]),n=i.inCentre();return Yl.distancePointLine(n,i.p0,i.p1)<Math.abs(e)},qp.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=pu.removeRepeatedPoints(t.getCoordinates()),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,pl.EXTERIOR,pl.INTERIOR)},qp.prototype.addCurve=function(t,e,i){if(null===t||t.length<2)return null;var n=new yp(t,new Dc(0,pl.BOUNDARY,e,i));this._curveList.add(n)},qp.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},qp.prototype.addPolygonRing=function(t,e,i,n,r){if(0===e&&t.length<ic.MINIMUM_VALID_SIZE)return null;var o=n,s=r;t.length>=ic.MINIMUM_VALID_SIZE&&Yl.isCCW(t)&&(o=r,s=n,i=Ic.opposite(i));var a=this._curveBuilder.getRingCurve(t,i,e);this.addCurve(a,o,s)},qp.prototype.add=function(t){if(t.isEmpty())return null;t instanceof tc?this.addPolygon(t):t instanceof Zu?this.addLineString(t):t instanceof Qu?this.addPoint(t):(t instanceof ec||t instanceof Gu||t instanceof nc||t instanceof ku)&&this.addCollection(t)},qp.prototype.isErodedCompletely=function(t,e){var i=t.getCoordinates();if(i.length<4)return e<0;if(4===i.length)return this.isTriangleErodedCompletely(i,e);var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>r},qp.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}},qp.prototype.interfaces_=function(){return[]},qp.prototype.getClass=function(){return qp};var Bp=function(){};Bp.prototype.locate=function(t){},Bp.prototype.interfaces_=function(){return[]},Bp.prototype.getClass=function(){return Bp};var Up=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Up.prototype.next=function(){if(this._atStart)return this._atStart=!1,Up.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new hu;var t=this._parent.getGeometryN(this._index++);return t instanceof ku?(this._subcollectionIterator=new Up(t),this._subcollectionIterator.next()):t},Up.prototype.remove=function(){throw new Error(this.getClass().getName())},Up.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Up.prototype.interfaces_=function(){return[su]},Up.prototype.getClass=function(){return Up},Up.isAtomic=function(t){return!(t instanceof ku)};var Xp=function(){this._geom=null;var t=arguments[0];this._geom=t};Xp.prototype.locate=function(t){return Xp.locate(t,this._geom)},Xp.prototype.interfaces_=function(){return[Bp]},Xp.prototype.getClass=function(){return Xp},Xp.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&Yl.isPointInRing(t,e.getCoordinates())},Xp.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var i=e.getExteriorRing();if(!Xp.isPointInRing(t,i))return!1;for(var n=0;n<e.getNumInteriorRing();n++){var r=e.getInteriorRingN(n);if(Xp.isPointInRing(t,r))return!1}return!0},Xp.containsPoint=function(t,e){if(e instanceof tc)return Xp.containsPointInPolygon(t,e);if(e instanceof ku)for(var i=new Up(e);i.hasNext();){var n=i.next();if(n!==e&&Xp.containsPoint(t,n))return!0}return!1},Xp.locate=function(t,e){return e.isEmpty()?pl.EXTERIOR:Xp.containsPoint(t,e)?pl.INTERIOR:pl.EXTERIOR};var Yp=function(){this._edgeMap=new Su,this._edgeList=null,this._ptInAreaLocation=[pl.NONE,pl.NONE]};Yp.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),i=e-1;return 0===e&&(i=this._edgeList.size()-1),this._edgeList.get(i)},Yp.prototype.propagateSideLabels=function(t){for(var e=pl.NONE,i=this.iterator();i.hasNext();){var n=i.next().getLabel();n.isArea(t)&&n.getLocation(t,Ic.LEFT)!==pl.NONE&&(e=n.getLocation(t,Ic.LEFT))}if(e===pl.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Ic.ON)===pl.NONE&&a.setLocation(t,Ic.ON,r),a.isArea(t)){var h=a.getLocation(t,Ic.LEFT),l=a.getLocation(t,Ic.RIGHT);if(l!==pl.NONE){if(l!==r)throw new Tc("side location conflict",s.getCoordinate());h===pl.NONE&&zl.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=h}else zl.isTrue(a.getLocation(t,Ic.LEFT)===pl.NONE,"found single null side"),a.setLocation(t,Ic.RIGHT,r),a.setLocation(t,Ic.LEFT,r)}}},Yp.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Yp.prototype.print=function(t){Pl.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Yp.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Yp.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var i=e.size()-1,n=e.get(i).getLabel().getLocation(t,Ic.LEFT);zl.isTrue(n!==pl.NONE,"Found unlabelled area edge");for(var r=n,o=this.iterator();o.hasNext();){var s=o.next().getLabel();zl.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Ic.LEFT),h=s.getLocation(t,Ic.RIGHT);if(a===h)return!1;if(h!==r)return!1;r=a}return!0},Yp.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Yp.prototype.iterator=function(){return this.getEdges().iterator()},Yp.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new lu(this._edgeMap.values())),this._edgeList},Yp.prototype.getLocation=function(t,e,i){return this._ptInAreaLocation[t]===pl.NONE&&(this._ptInAreaLocation[t]=Xp.locate(e,i[t].getGeometry())),this._ptInAreaLocation[t]},Yp.prototype.toString=function(){var t=new _l;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var i=e.next();t.append(i),t.append("\n")}return t.toString()},Yp.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Yp.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],i=this.iterator();i.hasNext();)for(var n=i.next().getLabel(),r=0;r<2;r++)n.isLine(r)&&n.getLocation(r)===pl.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),h=0;h<2;h++)if(a.isAnyNull(h)){var l=pl.NONE;if(e[h])l=pl.EXTERIOR;else{var u=s.getCoordinate();l=this.getLocation(h,u,t)}a.setAllLocationsIfNull(h,l)}},Yp.prototype.getDegree=function(){return this._edgeMap.size()},Yp.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Yp.prototype.interfaces_=function(){return[]},Yp.prototype.getClass=function(){return Yp};var Vp=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){var t=this;this.getResultAreaEdges();for(var e=null,i=null,n=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var o=t._resultAreaEdgeList.get(r),s=o.getSym();if(o.getLabel().isArea())switch(null===e&&o.isInResult()&&(e=o),n){case t._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;i=s,n=t._LINKING_TO_OUTGOING;break;case t._LINKING_TO_OUTGOING:if(!o.isInResult())continue;i.setNext(o),n=t._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===e)throw new Tc("no outgoing dirEdge found",this.getCoordinate());zl.isTrue(e.isInResult(),"unable to link last incoming dirEdge"),i.setNext(e)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var i=t.get(0);if(1===e)return i;var n=t.get(e-1),r=i.getQuadrant(),o=n.getQuadrant();return Bc.isNorthern(r)&&Bc.isNorthern(o)?i:Bc.isNorthern(r)||Bc.isNorthern(o)?0!==i.getDy()?i:0!==n.getDy()?n:(zl.shouldNeverReachHere("found two horizontal edges incident on node"),null):n},e.prototype.print=function(t){Pl.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var i=e.next();t.print("out "),i.print(t),t.println(),t.print("in "),i.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new lu;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var i=e.next().getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,i=this._edgeList.size()-1;i>=0;i--){var n=this._edgeList.get(i),r=n.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=n}e.setNext(t)},e.prototype.computeDepths=function(){var t=this;if(1===arguments.length){var e=arguments[0],i=this.findIndex(e),n=e.getDepth(Ic.LEFT),r=e.getDepth(Ic.RIGHT),o=this.computeDepths(i+1,this._edgeList.size(),n);if(this.computeDepths(0,i,o)!==r)throw new Tc("depth mismatch at "+e.getCoordinate())}else if(3===arguments.length){for(var s=arguments[1],a=arguments[2],h=arguments[0];h<s;h++){var l=t._edgeList.get(h);l.setEdgeDepths(Ic.RIGHT,a),a=l.getDepth(Ic.LEFT)}return a}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=this,i=null,n=null,r=this._SCANNING_FOR_INCOMING,o=this._resultAreaEdgeList.size()-1;o>=0;o--){var s=e._resultAreaEdgeList.get(o),a=s.getSym();switch(null===i&&s.getEdgeRing()===t&&(i=s),r){case e._SCANNING_FOR_INCOMING:if(a.getEdgeRing()!==t)continue;n=a,r=e._LINKING_TO_OUTGOING;break;case e._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;n.setNextMin(s),r=e._SCANNING_FOR_INCOMING}}r===this._LINKING_TO_OUTGOING&&(zl.isTrue(null!==i,"found null for first outgoing dirEdge"),zl.isTrue(i.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(i))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var i=arguments[0],n=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===i&&n++;return n}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=pl.NONE,e=this.iterator();e.hasNext();){var i=e.next(),n=i.getSym();if(!i.isLineEdge()){if(i.isInResult()){t=pl.INTERIOR;break}if(n.isInResult()){t=pl.EXTERIOR;break}}}if(t===pl.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===pl.INTERIOR):(s.isInResult()&&(r=pl.EXTERIOR),a.isInResult()&&(r=pl.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Dc(pl.NONE);for(var i=this.iterator();i.hasNext();)for(var n=i.next().getEdge().getLabel(),r=0;r<2;r++){var o=n.getLocation(r);o!==pl.INTERIOR&&o!==pl.BOUNDARY||this._label.setLocation(r,pl.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Yp),Wp=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new jc(t,new Vp)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Vc),Kp=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Kp.prototype.compareTo=function(t){var e=t;return Kp.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Kp.prototype.interfaces_=function(){return[rl]},Kp.prototype.getClass=function(){return Kp},Kp.orientation=function(t){return 1===pu.increasingDirection(t)},Kp.compareOriented=function(t,e,i,n){for(var r=e?1:-1,o=n?1:-1,s=e?t.length:-1,a=n?i.length:-1,h=e?0:t.length-1,l=n?0:i.length-1;;){var u=t[h].compareTo(i[l]);if(0!==u)return u;var c=(h+=r)===s,p=(l+=o)===a;if(c&&!p)return-1;if(!c&&p)return 1;if(c&&p)return 0}};var Hp=function(){this._edges=new lu,this._ocaMap=new Su};Hp.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var i=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var n=i.getCoordinates(),r=0;r<n.length;r++)r>0&&t.print(","),t.print(n[r].x+" "+n[r].y);t.println(")")}t.print(")  ")},Hp.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Hp.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Hp.prototype.iterator=function(){return this._edges.iterator()},Hp.prototype.getEdges=function(){return this._edges},Hp.prototype.get=function(t){return this._edges.get(t)},Hp.prototype.findEqualEdge=function(t){var e=new Kp(t.getCoordinates());return this._ocaMap.get(e)},Hp.prototype.add=function(t){this._edges.add(t);var e=new Kp(t.getCoordinates());this._ocaMap.put(e,t)},Hp.prototype.interfaces_=function(){return[]},Hp.prototype.getClass=function(){return Hp};var Zp=function(){};Zp.prototype.processIntersections=function(t,e,i,n){},Zp.prototype.isDone=function(){},Zp.prototype.interfaces_=function(){return[]},Zp.prototype.getClass=function(){return Zp};var Jp=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Jp.prototype.isTrivialIntersection=function(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(Jp.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&n===r||0===n&&e===r)return!0}}return!1},Jp.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Jp.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Jp.prototype.getLineIntersector=function(){return this._li},Jp.prototype.hasProperIntersection=function(){return this._hasProper},Jp.prototype.processIntersections=function(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Jp.prototype.hasIntersection=function(){return this._hasIntersection},Jp.prototype.isDone=function(){return!1},Jp.prototype.hasInteriorIntersection=function(){return this._hasInterior},Jp.prototype.interfaces_=function(){return[Zp]},Jp.prototype.getClass=function(){return Jp},Jp.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Qp=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],i=arguments[2];this.coord=new hl(t),this.segmentIndex=e,this.dist=i};Qp.prototype.getSegmentIndex=function(){return this.segmentIndex},Qp.prototype.getCoordinate=function(){return this.coord},Qp.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Qp.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Qp.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Qp.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Qp.prototype.getDistance=function(){return this.dist},Qp.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Qp.prototype.interfaces_=function(){return[rl]},Qp.prototype.getClass=function(){return Qp};var $p=function(){this._nodeMap=new Su,this.edge=null;var t=arguments[0];this.edge=t};$p.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},$p.prototype.iterator=function(){return this._nodeMap.values().iterator()},$p.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}},$p.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},$p.prototype.createSplitEdge=function(t,e){var i=e.segmentIndex-t.segmentIndex+2,n=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(n);r||i--;var o=new Array(i).fill(null),s=0;o[s++]=new hl(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new of(o,new Dc(this.edge._label))},$p.prototype.add=function(t,e,i){var n=new Qp(t,e,i),r=this._nodeMap.get(n);return null!==r?r:(this._nodeMap.put(n,n),n)},$p.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},$p.prototype.interfaces_=function(){return[]},$p.prototype.getClass=function(){return $p};var tf=function(){};tf.prototype.getChainStartIndices=function(t){var e=0,i=new lu;i.add(new ml(e));do{var n=this.findChainEnd(t,e);i.add(new ml(n)),e=n}while(e<t.length-1);return tf.toIntArray(i)},tf.prototype.findChainEnd=function(t,e){for(var i=Bc.quadrant(t[e],t[e+1]),n=e+1;n<t.length&&Bc.quadrant(t[n-1],t[n])===i;)n++;return n-1},tf.prototype.interfaces_=function(){return[]},tf.prototype.getClass=function(){return tf},tf.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var ef=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Rl,this.env2=new Rl;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new tf;this.startIndex=e.getChainStartIndices(this.pts)};ef.prototype.getCoordinates=function(){return this.pts},ef.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e>i?e:i},ef.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e<i?e:i},ef.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[i],e.startIndex[i+1],n)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],h=arguments[4],l=arguments[5],u=this.pts[r],c=this.pts[o],p=s.pts[a],f=s.pts[h];if(o-r==1&&h-a==1)return l.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(u,c),this.env2.init(p,f),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((a+h)/2);r<d&&(a<g&&this.computeIntersectsForChain(r,d,s,a,g,l),g<h&&this.computeIntersectsForChain(r,d,s,g,h,l)),d<o&&(a<g&&this.computeIntersectsForChain(d,o,s,a,g,l),g<h&&this.computeIntersectsForChain(d,o,s,g,h,l))}},ef.prototype.getStartIndexes=function(){return this.startIndex},ef.prototype.computeIntersects=function(t,e){for(var i=0;i<this.startIndex.length-1;i++)for(var n=0;n<t.startIndex.length-1;n++)this.computeIntersectsForChain(i,t,n,e)},ef.prototype.interfaces_=function(){return[]},ef.prototype.getClass=function(){return ef};var nf=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var i=0;i<3;i++)this._depth[e][i]=t.NULL_VALUE},rf={NULL_VALUE:{configurable:!0}};nf.prototype.getDepth=function(t,e){return this._depth[t][e]},nf.prototype.setDepth=function(t,e,i){this._depth[t][e]=i},nf.prototype.isNull=function(){var t=this;if(0===arguments.length){for(var e=0;e<2;e++)for(var i=0;i<3;i++)if(t._depth[e][i]!==nf.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===nf.NULL_VALUE}if(2===arguments.length){var r=arguments[0],o=arguments[1];return this._depth[r][o]===nf.NULL_VALUE}},nf.prototype.normalize=function(){for(var t=this,e=0;e<2;e++)if(!t.isNull(e)){var i=t._depth[e][1];t._depth[e][2]<i&&(i=t._depth[e][2]),i<0&&(i=0);for(var n=1;n<3;n++){var r=0;t._depth[e][n]>i&&(r=1),t._depth[e][n]=r}}},nf.prototype.getDelta=function(t){return this._depth[t][Ic.RIGHT]-this._depth[t][Ic.LEFT]},nf.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?pl.EXTERIOR:pl.INTERIOR},nf.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},nf.prototype.add=function(){var t=this;if(1===arguments.length)for(var e=arguments[0],i=0;i<2;i++)for(var n=1;n<3;n++){var r=e.getLocation(i,n);r!==pl.EXTERIOR&&r!==pl.INTERIOR||(t.isNull(i,n)?t._depth[i][n]=nf.depthAtLocation(r):t._depth[i][n]+=nf.depthAtLocation(r))}else if(3===arguments.length){var o=arguments[0],s=arguments[1];arguments[2]===pl.INTERIOR&&this._depth[o][s]++}},nf.prototype.interfaces_=function(){return[]},nf.prototype.getClass=function(){return nf},nf.depthAtLocation=function(t){return t===pl.EXTERIOR?0:t===pl.INTERIOR?1:nf.NULL_VALUE},rf.NULL_VALUE.get=function(){return-1},Object.defineProperties(nf,rf);var of=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new $p(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new nf,this._depthDelta=0,1===arguments.length){var i=arguments[0];e.call(this,i,null)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.pts=n,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Dc.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var i=t;if(this.pts.length!==i.pts.length)return!1;for(var n=!0,r=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(i.pts[s])||(n=!1),this.pts[s].equals2D(i.pts[--o])||(r=!1),!n&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new ef(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new Rl;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,i,n){var r=new hl(t.getIntersection(n)),o=e,s=t.getEdgeDistance(i,n),a=o+1;if(a<this.pts.length){var h=this.pts[a];r.equals2D(h)&&(o=a,s=0)}this.eiList.add(r,o,s)},e.prototype.toString=function(){var t=new _l;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],i=arguments[1];i.setAtLeastIfValid(e.getLocation(0,Ic.ON),e.getLocation(1,Ic.ON),1),e.isArea()&&(i.setAtLeastIfValid(e.getLocation(0,Ic.LEFT),e.getLocation(1,Ic.LEFT),2),i.setAtLeastIfValid(e.getLocation(0,Ic.RIGHT),e.getLocation(1,Ic.RIGHT),2))},e}(zc),sf=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Hp,this._bufParams=t||null};sf.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},sf.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new Dc(t.getLabel())).flip(),i.merge(n);var r=sf.depthDelta(n),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(sf.depthDelta(t.getLabel()))},sf.prototype.buildSubgraphs=function(t,e){for(var i=new lu,n=t.iterator();n.hasNext();){var r=n.next(),o=r.getRightmostCoordinate(),s=new kp(i).getDepth(o);r.computeDepth(s),r.findResultEdges(),i.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},sf.prototype.createSubgraphs=function(t){for(var e=new lu,i=t.getNodes().iterator();i.hasNext();){var n=i.next();if(!n.isVisited()){var r=new Oc;r.create(n),e.add(r)}}return ip.sort(e,ip.reverseOrder()),e},sf.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},sf.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new Mp,i=new Bl;return i.setPrecisionModel(t),e.setSegmentIntersector(new Jp(i)),e},sf.prototype.buffer=function(t,e){var i=this._workingPrecisionModel;null===i&&(i=t.getPrecisionModel()),this._geomFact=t.getFactory();var n=new Fp(i,this._bufParams),r=new qp(t,e,n).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,i),this._graph=new Wc(new Wp),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new Kc(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},sf.prototype.computeNodedEdges=function(t,e){var i=this.getNoder(e);i.computeNodes(t);for(var n=i.getNodedSubstrings().iterator();n.hasNext();){var r=n.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new of(r.getCoordinates(),new Dc(s));this.insertUniqueEdge(a)}}},sf.prototype.setNoder=function(t){this._workingNoder=t},sf.prototype.interfaces_=function(){return[]},sf.prototype.getClass=function(){return sf},sf.depthDelta=function(t){var e=t.getLocation(0,Ic.LEFT),i=t.getLocation(0,Ic.RIGHT);return e===pl.INTERIOR&&i===pl.EXTERIOR?1:e===pl.EXTERIOR&&i===pl.INTERIOR?-1:0},sf.convertSegStrings=function(t){for(var e=new mc,i=new lu;t.hasNext();){var n=t.next(),r=e.createLineString(n.getCoordinates());i.add(r)}return e.buildGeometry(i)};var af=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._noder=i,this._scaleFactor=n,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};af.prototype.rescale=function(){var t=this;if(dl(arguments[0],ru))for(var e=arguments[0].iterator();e.hasNext();){var i=e.next();t.rescale(i.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/t._scaleFactor+t._offsetX,n[r].y=n[r].y/t._scaleFactor+t._offsetY;2===n.length&&n[0].equals2D(n[1])&&Pl.out.println(n)}},af.prototype.scale=function(){var t=this;if(dl(arguments[0],ru)){for(var e=arguments[0],i=new lu,n=e.iterator();n.hasNext();){var r=n.next();i.add(new yp(t.scale(r.getCoordinates()),r.getData()))}return i}if(arguments[0]instanceof Array){for(var o=arguments[0],s=new Array(o.length).fill(null),a=0;a<o.length;a++)s[a]=new hl(Math.round((o[a].x-t._offsetX)*t._scaleFactor),Math.round((o[a].y-t._offsetY)*t._scaleFactor),o[a].z);return pu.removeRepeatedPoints(s)}},af.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},af.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},af.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},af.prototype.interfaces_=function(){return[wp]},af.prototype.getClass=function(){return af};var hf=function(){this._li=new Bl,this._segStrings=null;var t=arguments[0];this._segStrings=t},lf={fact:{configurable:!0}};hf.prototype.checkEndPtVertexIntersections=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next().getCoordinates();t.checkEndPtVertexIntersections(i[0],t._segStrings),t.checkEndPtVertexIntersections(i[i.length-1],t._segStrings)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var o=r.next().getCoordinates(),s=1;s<o.length-1;s++)if(o[s].equals(n))throw new kl("found endpt/interior pt intersection at index "+s+" :pt "+n)},hf.prototype.checkInteriorIntersections=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();)for(var i=e.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();t.checkInteriorIntersections(i,r)}else if(2===arguments.length)for(var o=arguments[0],s=arguments[1],a=o.getCoordinates(),h=s.getCoordinates(),l=0;l<a.length-1;l++)for(var u=0;u<h.length-1;u++)t.checkInteriorIntersections(o,l,s,u);else if(4===arguments.length){var c=arguments[0],p=arguments[1],f=arguments[2],d=arguments[3];if(c===f&&p===d)return null;var g=c.getCoordinates()[p],y=c.getCoordinates()[p+1],_=f.getCoordinates()[d],m=f.getCoordinates()[d+1];if(this._li.computeIntersection(g,y,_,m),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,g,y)||this.hasInteriorIntersection(this._li,_,m)))throw new kl("found non-noded intersection at "+g+"-"+y+" and "+_+"-"+m)}},hf.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},hf.prototype.checkCollapses=function(){var t=this;if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var i=e.next();t.checkCollapses(i)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)t.checkCollapse(n[r],n[r+1],n[r+2])},hf.prototype.hasInteriorIntersection=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++){var r=t.getIntersection(n);if(!r.equals(e)&&!r.equals(i))return!0}return!1},hf.prototype.checkCollapse=function(t,e,i){if(t.equals(i))throw new kl("found non-noded collapse at "+hf.fact.createLineString([t,e,i]))},hf.prototype.interfaces_=function(){return[]},hf.prototype.getClass=function(){return hf},lf.fact.get=function(){return new mc},Object.defineProperties(hf,lf);var uf=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=i,e<=0)throw new el("Scale factor must be non-zero");1!==e&&(this._pt=new hl(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new hl,this._p1Scaled=new hl),this.initCorners(this._pt)},cf={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};uf.prototype.intersectsScaled=function(t,e){var i=Math.min(t.x,e.x),n=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<i||this._minx>n||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return zl.isTrue(!(s&&a),"Found bad envelope test"),a},uf.prototype.initCorners=function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new hl(this._maxx,this._maxy),this._corner[1]=new hl(this._minx,this._maxy),this._corner[2]=new hl(this._minx,this._miny),this._corner[3]=new hl(this._maxx,this._miny)},uf.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},uf.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},uf.prototype.getCoordinate=function(){return this._originalPt},uf.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},uf.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=uf.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Rl(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},uf.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},uf.prototype.intersectsToleranceSquare=function(t,e){var i=!1,n=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||i&&n||t.equals(this._pt)||e.equals(this._pt)))))},uf.prototype.addSnappedNode=function(t,e){var i=t.getCoordinate(e),n=t.getCoordinate(e+1);return!!this.intersects(i,n)&&(t.addIntersection(this.getCoordinate(),e),!0)},uf.prototype.interfaces_=function(){return[]},uf.prototype.getClass=function(){return uf},cf.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(uf,cf);var pf=function(){this.tempEnv1=new Rl,this.selectedSegment=new _p};pf.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},pf.prototype.interfaces_=function(){return[]},pf.prototype.getClass=function(){return pf};var ff=function(){this._index=null;var t=arguments[0];this._index=t},df={HotPixelSnapAction:{configurable:!0}};ff.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=e.getSafeEnvelope(),o=new gf(e,i,n);return this._index.query(r,{interfaces_:function(){return[Qc]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},ff.prototype.interfaces_=function(){return[]},ff.prototype.getClass=function(){return ff},df.HotPixelSnapAction.get=function(){return gf},Object.defineProperties(ff,df);var gf=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],i=arguments[1],n=arguments[2];this._hotPixel=e,this._parentEdge=i,this._hotPixelVertexIndex=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[1],i=arguments[0].getContext();if(null!==this._parentEdge&&i===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(i,e)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pf),yf=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new lu};yf.prototype.processIntersections=function(t,e,i,n){if(t===i&&e===n)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var h=0;h<this._li.getIntersectionNum();h++)this._interiorIntersections.add(this._li.getIntersection(h));t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1)}},yf.prototype.isDone=function(){return!1},yf.prototype.getInteriorIntersections=function(){return this._interiorIntersections},yf.prototype.interfaces_=function(){return[Zp]},yf.prototype.getClass=function(){return yf};var _f=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new Bl,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};_f.prototype.checkCorrectness=function(t){var e=yp.getNodedSubstrings(t),i=new hf(e);try{i.checkValid()}catch(t){if(!(t instanceof Il))throw t;t.printStackTrace()}},_f.prototype.getNodedSubstrings=function(){return yp.getNodedSubstrings(this._nodedSegStrings)},_f.prototype.snapRound=function(t,e){var i=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(i),this.computeVertexSnaps(t)},_f.prototype.findInteriorIntersections=function(t,e){var i=new yf(e);return this._noder.setSegmentIntersector(i),this._noder.computeNodes(t),i.getInteriorIntersections()},_f.prototype.computeVertexSnaps=function(){var t=this;if(dl(arguments[0],ru))for(var e=arguments[0].iterator();e.hasNext();){var i=e.next();t.computeVertexSnaps(i)}else if(arguments[0]instanceof yp)for(var n=arguments[0],r=n.getCoordinates(),o=0;o<r.length;o++){var s=new uf(r[o],t._scaleFactor,t._li);t._pointSnapper.snap(s,n,o)&&n.addIntersection(r[o],o)}},_f.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new Mp,this._pointSnapper=new ff(this._noder.getIndex()),this.snapRound(t,this._li)},_f.prototype.computeIntersectionSnaps=function(t){for(var e=this,i=t.iterator();i.hasNext();){var n=i.next(),r=new uf(n,e._scaleFactor,e._li);e._pointSnapper.snap(r)}},_f.prototype.interfaces_=function(){return[wp]},_f.prototype.getClass=function(){return _f};var mf=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Ip,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._argGeom=e,this._bufParams=i}},vf={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};mf.prototype.bufferFixedPrecision=function(t){var e=new af(new _f(new dc(1)),t.getScale()),i=new sf(this._bufParams);i.setWorkingPrecisionModel(t),i.setNoder(e),this._resultGeometry=i.buffer(this._argGeom,this._distance)},mf.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=mf.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Tc))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var i=arguments[0],n=mf.precisionScaleFactor(this._argGeom,this._distance,i),r=new dc(n);this.bufferFixedPrecision(r)}},mf.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===dc.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},mf.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},mf.prototype.bufferOriginalPrecision=function(){try{var t=new sf(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof kl))throw t;this._saveException=t}},mf.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},mf.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},mf.prototype.interfaces_=function(){return[]},mf.prototype.getClass=function(){return mf},mf.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new mf(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Kl&&"number"==typeof arguments[1]){var e=arguments[1],i=arguments[2],n=new mf(arguments[0]);return n.setQuadrantSegments(i),n.getResultGeometry(e)}if(arguments[2]instanceof Ip&&arguments[0]instanceof Kl&&"number"==typeof arguments[1]){var r=arguments[1];return new mf(arguments[0],arguments[2]).getResultGeometry(r)}}else if(4===arguments.length){var o=arguments[1],s=arguments[2],a=arguments[3],h=new mf(arguments[0]);return h.setQuadrantSegments(s),h.setEndCapStyle(a),h.getResultGeometry(o)}},mf.precisionScaleFactor=function(t,e,i){var n=t.getEnvelopeInternal(),r=gl.max(Math.abs(n.getMaxX()),Math.abs(n.getMaxY()),Math.abs(n.getMinX()),Math.abs(n.getMinY()))+2*(e>0?e:0),o=i-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},vf.CAP_ROUND.get=function(){return Ip.CAP_ROUND},vf.CAP_BUTT.get=function(){return Ip.CAP_FLAT},vf.CAP_FLAT.get=function(){return Ip.CAP_FLAT},vf.CAP_SQUARE.get=function(){return Ip.CAP_SQUARE},vf.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(mf,vf);var xf=function(){this._pt=[new hl,new hl],this._distance=il.NaN,this._isNull=!0};xf.prototype.getCoordinates=function(){return this._pt},xf.prototype.getCoordinate=function(t){return this._pt[t]},xf.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n<this._distance&&this.initialize(e,i,n)}},xf.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(n),this._distance=r,this._isNull=!1}},xf.prototype.getDistance=function(){return this._distance},xf.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n>this._distance&&this.initialize(e,i,n)}},xf.prototype.interfaces_=function(){return[]},xf.prototype.getClass=function(){return xf};var Ef=function(){};Ef.prototype.interfaces_=function(){return[]},Ef.prototype.getClass=function(){return Ef},Ef.computeDistance=function(){if(arguments[2]instanceof xf&&arguments[0]instanceof Zu&&arguments[1]instanceof hl)for(var t=arguments[1],e=arguments[2],i=arguments[0].getCoordinates(),n=new _p,r=0;r<i.length-1;r++){n.setCoordinates(i[r],i[r+1]);var o=n.closestPoint(t);e.setMinimum(o,t)}else if(arguments[2]instanceof xf&&arguments[0]instanceof tc&&arguments[1]instanceof hl){var s=arguments[0],a=arguments[1],h=arguments[2];Ef.computeDistance(s.getExteriorRing(),a,h);for(var l=0;l<s.getNumInteriorRing();l++)Ef.computeDistance(s.getInteriorRingN(l),a,h)}else if(arguments[2]instanceof xf&&arguments[0]instanceof Kl&&arguments[1]instanceof hl){var u=arguments[0],c=arguments[1],p=arguments[2];if(u instanceof Zu)Ef.computeDistance(u,c,p);else if(u instanceof tc)Ef.computeDistance(u,c,p);else if(u instanceof ku)for(var f=u,d=0;d<f.getNumGeometries();d++){var g=f.getGeometryN(d);Ef.computeDistance(g,c,p)}else p.setMinimum(u.getCoordinate(),c)}else if(arguments[2]instanceof xf&&arguments[0]instanceof _p&&arguments[1]instanceof hl){var y=arguments[1],_=arguments[2],m=arguments[0].closestPoint(y);_.setMinimum(m,y)}};var wf=function(t){this._maxPtDist=new xf,this._inputGeom=t||null},bf={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};wf.prototype.computeMaxMidpointDistance=function(t){var e=new Cf(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},wf.prototype.computeMaxVertexDistance=function(t){var e=new Mf(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},wf.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},wf.prototype.getDistancePoints=function(){return this._maxPtDist},wf.prototype.interfaces_=function(){return[]},wf.prototype.getClass=function(){return wf},bf.MaxPointDistanceFilter.get=function(){return Mf},bf.MaxMidpointDistanceFilter.get=function(){return Cf},Object.defineProperties(wf,bf);var Mf=function(t){this._maxPtDist=new xf,this._minPtDist=new xf,this._geom=t||null};Mf.prototype.filter=function(t){this._minPtDist.initialize(),Ef.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Mf.prototype.getMaxPointDistance=function(){return this._maxPtDist},Mf.prototype.interfaces_=function(){return[Jl]},Mf.prototype.getClass=function(){return Mf};var Cf=function(t){this._maxPtDist=new xf,this._minPtDist=new xf,this._geom=t||null};Cf.prototype.filter=function(t,e){if(0===e)return null;var i=t.getCoordinate(e-1),n=t.getCoordinate(e),r=new hl((i.x+n.x)/2,(i.y+n.y)/2);this._minPtDist.initialize(),Ef.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Cf.prototype.isDone=function(){return!1},Cf.prototype.isGeometryChanged=function(){return!1},Cf.prototype.getMaxPointDistance=function(){return this._maxPtDist},Cf.prototype.interfaces_=function(){return[Fu]},Cf.prototype.getClass=function(){return Cf};var If=function(t){this._comps=t||null};If.prototype.filter=function(t){t instanceof tc&&this._comps.add(t)},If.prototype.interfaces_=function(){return[Du]},If.prototype.getClass=function(){return If},If.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return If.getPolygons(t,new lu)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e instanceof tc?i.add(e):e instanceof ku&&e.apply(new If(i)),i}};var Sf=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._lines=e,this._isForcedToLineString=i}};Sf.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ic){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Zu&&this._lines.add(t)},Sf.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Sf.prototype.interfaces_=function(){return[Wl]},Sf.prototype.getClass=function(){return Sf},Sf.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Sf.getLines(t))}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e.getFactory().buildGeometry(Sf.getLines(e,i))}},Sf.getLines=function(){if(1===arguments.length){var t=arguments[0];return Sf.getLines(t,!1)}if(2===arguments.length){if(dl(arguments[0],ru)&&dl(arguments[1],ru)){for(var e=arguments[1],i=arguments[0].iterator();i.hasNext();){var n=i.next();Sf.getLines(n,e)}return e}if(arguments[0]instanceof Kl&&"boolean"==typeof arguments[1]){var r=arguments[0],o=arguments[1],s=new lu;return r.apply(new Sf(s,o)),s}if(arguments[0]instanceof Kl&&dl(arguments[1],ru)){var a=arguments[0],h=arguments[1];return a instanceof Zu?h.add(a):a.apply(new Sf(h)),h}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&dl(arguments[0],ru)&&dl(arguments[1],ru)){for(var l=arguments[1],u=arguments[2],c=arguments[0].iterator();c.hasNext();){var p=c.next();Sf.getLines(p,l,u)}return l}if("boolean"==typeof arguments[2]&&arguments[0]instanceof Kl&&dl(arguments[1],ru)){var f=arguments[1],d=arguments[2];return arguments[0].apply(new Sf(f,d)),f}}};var Pf=function(){if(this._boundaryRule=Ql.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new el("Rule must be non-null");this._boundaryRule=t}};Pf.prototype.locateInternal=function(){var t=this;if(arguments[0]instanceof hl&&arguments[1]instanceof tc){var e=arguments[0],i=arguments[1];if(i.isEmpty())return pl.EXTERIOR;var n=i.getExteriorRing(),r=this.locateInPolygonRing(e,n);if(r===pl.EXTERIOR)return pl.EXTERIOR;if(r===pl.BOUNDARY)return pl.BOUNDARY;for(var o=0;o<i.getNumInteriorRing();o++){var s=i.getInteriorRingN(o),a=t.locateInPolygonRing(e,s);if(a===pl.INTERIOR)return pl.EXTERIOR;if(a===pl.BOUNDARY)return pl.BOUNDARY}return pl.INTERIOR}if(arguments[0]instanceof hl&&arguments[1]instanceof Zu){var h=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(h))return pl.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!h.equals(u[0])&&!h.equals(u[u.length-1])?Yl.isOnLine(h,u)?pl.INTERIOR:pl.EXTERIOR:pl.BOUNDARY}if(arguments[0]instanceof hl&&arguments[1]instanceof Qu){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?pl.INTERIOR:pl.EXTERIOR}},Pf.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Yl.locatePointInRing(t,e.getCoordinates()):pl.EXTERIOR},Pf.prototype.intersects=function(t,e){return this.locate(t,e)!==pl.EXTERIOR},Pf.prototype.updateLocationInfo=function(t){t===pl.INTERIOR&&(this._isIn=!0),t===pl.BOUNDARY&&this._numBoundaries++},Pf.prototype.computeLocation=function(t,e){var i=this;if(e instanceof Qu&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Zu)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof tc)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Gu)for(var n=e,r=0;r<n.getNumGeometries();r++){var o=n.getGeometryN(r);i.updateLocationInfo(i.locateInternal(t,o))}else if(e instanceof nc)for(var s=e,a=0;a<s.getNumGeometries();a++){var h=s.getGeometryN(a);i.updateLocationInfo(i.locateInternal(t,h))}else if(e instanceof ku)for(var l=new Up(e);l.hasNext();){var u=l.next();u!==e&&i.computeLocation(t,u)}},Pf.prototype.locate=function(t,e){return e.isEmpty()?pl.EXTERIOR:e instanceof Zu||e instanceof tc?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?pl.BOUNDARY:this._numBoundaries>0||this._isIn?pl.INTERIOR:pl.EXTERIOR)},Pf.prototype.interfaces_=function(){return[]},Pf.prototype.getClass=function(){return Pf};var Nf=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)t.call(this,arguments[0],t.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2];this._component=e,this._segIndex=i,this._pt=n}},Rf={INSIDE_AREA:{configurable:!0}};Nf.prototype.isInsideArea=function(){return this._segIndex===Nf.INSIDE_AREA},Nf.prototype.getCoordinate=function(){return this._pt},Nf.prototype.getGeometryComponent=function(){return this._component},Nf.prototype.getSegmentIndex=function(){return this._segIndex},Nf.prototype.interfaces_=function(){return[]},Nf.prototype.getClass=function(){return Nf},Rf.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Nf,Rf);var Tf=function(t){this._pts=t||null};Tf.prototype.filter=function(t){t instanceof Qu&&this._pts.add(t)},Tf.prototype.interfaces_=function(){return[Du]},Tf.prototype.getClass=function(){return Tf},Tf.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Qu?ip.singletonList(t):Tf.getPoints(t,new lu)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e instanceof Qu?i.add(e):e instanceof ku&&e.apply(new Tf(i)),i}};var Lf=function(){this._locations=null;var t=arguments[0];this._locations=t};Lf.prototype.filter=function(t){(t instanceof Qu||t instanceof Zu||t instanceof tc)&&this._locations.add(new Nf(t,0,t.getCoordinate()))},Lf.prototype.interfaces_=function(){return[Du]},Lf.prototype.getClass=function(){return Lf},Lf.getLocations=function(t){var e=new lu;return t.apply(new Lf(e)),e};var Of=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Pf,this._minDistanceLocation=null,this._minDistance=il.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=n,this._terminateDistance=r}};Of.prototype.computeContainmentDistance=function(){var t=this;if(0===arguments.length){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(2===arguments.length){var i=arguments[0],n=arguments[1],r=1-i,o=If.getPolygons(this._geom[i]);if(o.size()>0){var s=Lf.getLocations(this._geom[r]);if(this.computeContainmentDistance(s,o,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[r]=n[0],this._minDistanceLocation[i]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&dl(arguments[0],au)&&dl(arguments[1],au)){for(var a=arguments[0],h=arguments[1],l=arguments[2],u=0;u<a.size();u++)for(var c=a.get(u),p=0;p<h.size();p++)if(t.computeContainmentDistance(c,h.get(p),l),t._minDistance<=t._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Nf&&arguments[1]instanceof tc){var f=arguments[0],d=arguments[1],g=arguments[2],y=f.getCoordinate();if(pl.EXTERIOR!==this._ptLocator.locate(y,d))return this._minDistance=0,g[0]=f,g[1]=new Nf(d,y),null}},Of.prototype.computeMinDistanceLinesPoints=function(t,e,i){for(var n=this,r=0;r<t.size();r++)for(var o=t.get(r),s=0;s<e.size();s++){var a=e.get(s);if(n.computeMinDistance(o,a,i),n._minDistance<=n._terminateDistance)return null}},Of.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Sf.getLines(this._geom[0]),i=Sf.getLines(this._geom[1]),n=Tf.getPoints(this._geom[0]),r=Tf.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(i,n,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(n,r,t),void this.updateMinDistance(t,!1))))},Of.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Of.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Of.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Of.prototype.computeMinDistance=function(){var t=this;if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Zu&&arguments[1]instanceof Qu){var e=arguments[0],i=arguments[1],n=arguments[2];if(e.getEnvelopeInternal().distance(i.getEnvelopeInternal())>this._minDistance)return null;for(var r=e.getCoordinates(),o=i.getCoordinate(),s=0;s<r.length-1;s++){var a=Yl.distancePointLine(o,r[s],r[s+1]);if(a<t._minDistance){t._minDistance=a;var h=new _p(r[s],r[s+1]).closestPoint(o);n[0]=new Nf(e,s,h),n[1]=new Nf(i,0,o)}if(t._minDistance<=t._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Zu&&arguments[1]instanceof Zu){var l=arguments[0],u=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var p=l.getCoordinates(),f=u.getCoordinates(),d=0;d<p.length-1;d++)for(var g=0;g<f.length-1;g++){var y=Yl.distanceLineLine(p[d],p[d+1],f[g],f[g+1]);if(y<t._minDistance){t._minDistance=y;var _=new _p(p[d],p[d+1]),m=new _p(f[g],f[g+1]),v=_.closestPoints(m);c[0]=new Nf(l,d,v[0]),c[1]=new Nf(u,g,v[1])}if(t._minDistance<=t._terminateDistance)return null}}},Of.prototype.computeMinDistancePoints=function(t,e,i){for(var n=this,r=0;r<t.size();r++)for(var o=t.get(r),s=0;s<e.size();s++){var a=e.get(s),h=o.getCoordinate().distance(a.getCoordinate());if(h<n._minDistance&&(n._minDistance=h,i[0]=new Nf(o,0,o.getCoordinate()),i[1]=new Nf(a,0,a.getCoordinate())),n._minDistance<=n._terminateDistance)return null}},Of.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new el("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Of.prototype.computeMinDistanceLines=function(t,e,i){for(var n=this,r=0;r<t.size();r++)for(var o=t.get(r),s=0;s<e.size();s++){var a=e.get(s);if(n.computeMinDistance(o,a,i),n._minDistance<=n._terminateDistance)return null}},Of.prototype.interfaces_=function(){return[]},Of.prototype.getClass=function(){return Of},Of.distance=function(t,e){return new Of(t,e).distance()},Of.isWithinDistance=function(t,e,i){return new Of(t,e,i).distance()<=i},Of.nearestPoints=function(t,e){return new Of(t,e).nearestPoints()};var Af=function(){this._pt=[new hl,new hl],this._distance=il.NaN,this._isNull=!0};Af.prototype.getCoordinates=function(){return this._pt},Af.prototype.getCoordinate=function(t){return this._pt[t]},Af.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n<this._distance&&this.initialize(e,i,n)}},Af.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(n),this._distance=r,this._isNull=!1}},Af.prototype.toString=function(){return Fl.toLineString(this._pt[0],this._pt[1])},Af.prototype.getDistance=function(){return this._distance},Af.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n>this._distance&&this.initialize(e,i,n)}},Af.prototype.interfaces_=function(){return[]},Af.prototype.getClass=function(){return Af};var Df=function(){};Df.prototype.interfaces_=function(){return[]},Df.prototype.getClass=function(){return Df},Df.computeDistance=function(){if(arguments[2]instanceof Af&&arguments[0]instanceof Zu&&arguments[1]instanceof hl)for(var t=arguments[0],e=arguments[1],i=arguments[2],n=new _p,r=t.getCoordinates(),o=0;o<r.length-1;o++){n.setCoordinates(r[o],r[o+1]);var s=n.closestPoint(e);i.setMinimum(s,e)}else if(arguments[2]instanceof Af&&arguments[0]instanceof tc&&arguments[1]instanceof hl){var a=arguments[0],h=arguments[1],l=arguments[2];Df.computeDistance(a.getExteriorRing(),h,l);for(var u=0;u<a.getNumInteriorRing();u++)Df.computeDistance(a.getInteriorRingN(u),h,l)}else if(arguments[2]instanceof Af&&arguments[0]instanceof Kl&&arguments[1]instanceof hl){var c=arguments[0],p=arguments[1],f=arguments[2];if(c instanceof Zu)Df.computeDistance(c,p,f);else if(c instanceof tc)Df.computeDistance(c,p,f);else if(c instanceof ku)for(var d=c,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);Df.computeDistance(y,p,f)}else f.setMinimum(c.getCoordinate(),p)}else if(arguments[2]instanceof Af&&arguments[0]instanceof _p&&arguments[1]instanceof hl){var _=arguments[1],m=arguments[2],v=arguments[0].closestPoint(_);m.setMinimum(v,_)}};var Ff=function(){this._g0=null,this._g1=null,this._ptDist=new Af,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},kf={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ff.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Ff.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new el("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Ff.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Ff.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Ff.prototype.computeOrientedDistance=function(t,e,i){var n=new Gf(e);if(t.apply(n),i.setMaximum(n.getMaxPointDistance()),this._densifyFrac>0){var r=new zf(e,this._densifyFrac);t.apply(r),i.setMaximum(r.getMaxPointDistance())}},Ff.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Ff.prototype.interfaces_=function(){return[]},Ff.prototype.getClass=function(){return Ff},Ff.distance=function(){if(2===arguments.length)return new Ff(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new Ff(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},kf.MaxPointDistanceFilter.get=function(){return Gf},kf.MaxDensifiedByFractionDistanceFilter.get=function(){return zf},Object.defineProperties(Ff,kf);var Gf=function(){this._maxPtDist=new Af,this._minPtDist=new Af,this._euclideanDist=new Df,this._geom=null;var t=arguments[0];this._geom=t};Gf.prototype.filter=function(t){this._minPtDist.initialize(),Df.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Gf.prototype.getMaxPointDistance=function(){return this._maxPtDist},Gf.prototype.interfaces_=function(){return[Jl]},Gf.prototype.getClass=function(){return Gf};var zf=function(){this._maxPtDist=new Af,this._minPtDist=new Af,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};zf.prototype.filter=function(t,e){var i=this;if(0===e)return null;for(var n=t.getCoordinate(e-1),r=t.getCoordinate(e),o=(r.x-n.x)/this._numSubSegs,s=(r.y-n.y)/this._numSubSegs,a=0;a<this._numSubSegs;a++){var h=n.x+a*o,l=n.y+a*s,u=new hl(h,l);i._minPtDist.initialize(),Df.computeDistance(i._geom,u,i._minPtDist),i._maxPtDist.setMaximum(i._minPtDist)}},zf.prototype.isDone=function(){return!1},zf.prototype.isGeometryChanged=function(){return!1},zf.prototype.getMaxPointDistance=function(){return this._maxPtDist},zf.prototype.interfaces_=function(){return[Fu]},zf.prototype.getClass=function(){return zf};var jf=function(t,e,i){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=i||null},qf={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};jf.prototype.checkMaximumDistance=function(t,e,i){var n=new Ff(e,t);if(n.setDensifyFraction(.25),this._maxDistanceFound=n.orientedDistance(),this._maxDistanceFound>i){this._isValid=!1;var r=n.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Fl.toLineString(r[0],r[1])+")"}},jf.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=jf.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),jf.VERBOSE&&Pl.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},jf.prototype.checkNegativeValid=function(){if(!(this._input instanceof tc||this._input instanceof nc||this._input instanceof ku))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},jf.prototype.getErrorIndicator=function(){return this._errorIndicator},jf.prototype.checkMinimumDistance=function(t,e,i){var n=new Of(t,e,i);if(this._minDistanceFound=n.distance(),this._minDistanceFound<i){this._isValid=!1;var r=n.nearestPoints();this._errorLocation=n.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Fl.toLineString(r[0],r[1])+" )"}},jf.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},jf.prototype.getErrorLocation=function(){return this._errorLocation},jf.prototype.getPolygonLines=function(t){for(var e=new lu,i=new Sf(e),n=If.getPolygons(t).iterator();n.hasNext();)n.next().apply(i);return t.getFactory().buildGeometry(e)},jf.prototype.getErrorMessage=function(){return this._errMsg},jf.prototype.interfaces_=function(){return[]},jf.prototype.getClass=function(){return jf},qf.VERBOSE.get=function(){return!1},qf.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(jf,qf);var Bf=function(t,e,i){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=i||null},Uf={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Bf.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Bf.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Bf.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new Rl(this._input.getEnvelopeInternal());e.expandBy(this._distance);var i=new Rl(this._result.getEnvelopeInternal());i.expandBy(t),i.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(i)),this.report("Envelope")},Bf.prototype.checkDistance=function(){var t=new jf(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Bf.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Bf.prototype.checkPolygonal=function(){this._result instanceof tc||this._result instanceof nc||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Bf.prototype.getErrorIndicator=function(){return this._errorIndicator},Bf.prototype.getErrorLocation=function(){return this._errorLocation},Bf.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Bf.prototype.report=function(t){if(!Bf.VERBOSE)return null;Pl.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Bf.prototype.getErrorMessage=function(){return this._errorMsg},Bf.prototype.interfaces_=function(){return[]},Bf.prototype.getClass=function(){return Bf},Bf.isValidMsg=function(t,e,i){var n=new Bf(t,e,i);return n.isValid()?null:n.getErrorMessage()},Bf.isValid=function(t,e,i){return!!new Bf(t,e,i).isValid()},Uf.VERBOSE.get=function(){return!1},Uf.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Bf,Uf);var Xf=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Xf.prototype.getCoordinates=function(){return this._pts},Xf.prototype.size=function(){return this._pts.length},Xf.prototype.getCoordinate=function(t){return this._pts[t]},Xf.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Xf.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:fp.octant(this.getCoordinate(t),this.getCoordinate(t+1))},Xf.prototype.setData=function(t){this._data=t},Xf.prototype.getData=function(){return this._data},Xf.prototype.toString=function(){return Fl.toLineString(new lc(this._pts))},Xf.prototype.interfaces_=function(){return[dp]},Xf.prototype.getClass=function(){return Xf};var Yf=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new lu,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Yf.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Yf.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Yf.prototype.getIntersectionSegments=function(){return this._intSegments},Yf.prototype.count=function(){return this._intersectionCount},Yf.prototype.getIntersections=function(){return this._intersections},Yf.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Yf.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Yf.prototype.processIntersections=function(t,e,i,n){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===i&&e===n)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(i,n))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Yf.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Yf.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Yf.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Yf.prototype.interfaces_=function(){return[Zp]},Yf.prototype.getClass=function(){return Yf},Yf.createAllIntersectionsFinder=function(t){var e=new Yf(t);return e.setFindAllIntersections(!0),e},Yf.createAnyIntersectionFinder=function(t){return new Yf(t)},Yf.createIntersectionCounter=function(t){var e=new Yf(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Vf=function(){this._li=new Bl,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Vf.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Vf.prototype.getIntersections=function(){return this._segInt.getIntersections()},Vf.prototype.isValid=function(){return this.execute(),this._isValid},Vf.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Vf.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Yf(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new Mp;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Vf.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Tc(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Vf.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Fl.toLineString(t[0],t[1])+" and "+Fl.toLineString(t[2],t[3])},Vf.prototype.interfaces_=function(){return[]},Vf.prototype.getClass=function(){return Vf},Vf.computeIntersections=function(t){var e=new Vf(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Wf=function t(){this._nv=null;var e=arguments[0];this._nv=new Vf(t.toSegmentStrings(e))};Wf.prototype.checkValid=function(){this._nv.checkValid()},Wf.prototype.interfaces_=function(){return[]},Wf.prototype.getClass=function(){return Wf},Wf.toSegmentStrings=function(t){for(var e=new lu,i=t.iterator();i.hasNext();){var n=i.next();e.add(new Xf(n.getCoordinates(),n))}return e},Wf.checkValid=function(t){new Wf(t).checkValid()};var Kf=function(t){this._mapOp=t};Kf.prototype.map=function(t){for(var e=new lu,i=0;i<t.getNumGeometries();i++){var n=this._mapOp.map(t.getGeometryN(i));n.isEmpty()||e.add(n)}return t.getFactory().createGeometryCollection(mc.toGeometryArray(e))},Kf.prototype.interfaces_=function(){return[]},Kf.prototype.getClass=function(){return Kf},Kf.map=function(t,e){return new Kf(e).map(t)};var Hf=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new lu,this._resultLineList=new lu;var t=arguments[0],e=arguments[1],i=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=i};Hf.prototype.collectLines=function(t){for(var e=this,i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var n=i.next();e.collectLineEdge(n,t,e._lineEdgesList),e.collectBoundaryTouchEdge(n,t,e._lineEdgesList)}},Hf.prototype.labelIsolatedLine=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,i)},Hf.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Hf.prototype.collectLineEdge=function(t,e,i){var n=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Nd.isResultOfOp(n,e)||r.isCovered()||(i.add(r),t.setVisitedEdge(!0)))},Hf.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var i=e.next(),n=i.getEdge();if(i.isLineEdge()&&!n.isCoveredSet()){var r=this._op.isCoveredByA(i.getCoordinate());n.setCovered(r)}}},Hf.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),n=i.getLabel();i.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(i,0):this.labelIsolatedLine(i,1))}},Hf.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var i=e.next(),n=this._geometryFactory.createLineString(i.getCoordinates());this._resultLineList.add(n),i.setInResult(!0)}},Hf.prototype.collectBoundaryTouchEdge=function(t,e,i){var n=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(zl.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Nd.isResultOfOp(n,e)&&e===Nd.INTERSECTION&&(i.add(t.getEdge()),t.setVisitedEdge(!0))))},Hf.prototype.interfaces_=function(){return[]},Hf.prototype.getClass=function(){return Hf};var Zf=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new lu;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Zf.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var i=this._geometryFactory.createPoint(e);this._resultPointList.add(i)}},Zf.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var i=e.next();if(!(i.isInResult()||i.isIncidentEdgeInResult()||0!==i.getEdges().getDegree()&&t!==Nd.INTERSECTION)){var n=i.getLabel();Nd.isResultOfOp(n,t)&&this.filterCoveredNodeToPoint(i)}}},Zf.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Zf.prototype.interfaces_=function(){return[]},Zf.prototype.getClass=function(){return Zf};var Jf=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Jf.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Jf.prototype.transformPolygon=function(t,e){var i=!0,n=this.transformLinearRing(t.getExteriorRing(),t);null!==n&&n instanceof ic&&!n.isEmpty()||(i=!1);for(var r=new lu,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ic||(i=!1),r.add(s))}if(i)return this._factory.createPolygon(n,r.toArray([]));var a=new lu;return null!==n&&a.add(n),a.addAll(r),this._factory.buildGeometry(a)},Jf.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Jf.prototype.getInputGeometry=function(){return this._inputGeom},Jf.prototype.transformMultiLineString=function(t,e){for(var i=new lu,n=0;n<t.getNumGeometries();n++){var r=this.transformLineString(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Jf.prototype.transformCoordinates=function(t,e){return this.copy(t)},Jf.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Jf.prototype.transformMultiPoint=function(t,e){for(var i=new lu,n=0;n<t.getNumGeometries();n++){var r=this.transformPoint(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Jf.prototype.transformMultiPolygon=function(t,e){for(var i=new lu,n=0;n<t.getNumGeometries();n++){var r=this.transformPolygon(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},Jf.prototype.copy=function(t){return t.copy()},Jf.prototype.transformGeometryCollection=function(t,e){for(var i=new lu,n=0;n<t.getNumGeometries();n++){var r=this.transform(t.getGeometryN(n));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||i.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(mc.toGeometryArray(i)):this._factory.buildGeometry(i)},Jf.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Qu)return this.transformPoint(t,null);if(t instanceof ec)return this.transformMultiPoint(t,null);if(t instanceof ic)return this.transformLinearRing(t,null);if(t instanceof Zu)return this.transformLineString(t,null);if(t instanceof Gu)return this.transformMultiLineString(t,null);if(t instanceof tc)return this.transformPolygon(t,null);if(t instanceof nc)return this.transformMultiPolygon(t,null);if(t instanceof ku)return this.transformGeometryCollection(t,null);throw new el("Unknown Geometry subtype: "+t.getClass().getName())},Jf.prototype.transformLinearRing=function(t,e){var i=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===i)return this._factory.createLinearRing(null);var n=i.size();return n>0&&n<4&&!this._preserveType?this._factory.createLineString(i):this._factory.createLinearRing(i)},Jf.prototype.interfaces_=function(){return[]},Jf.prototype.getClass=function(){return Jf};var Qf=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new _p,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Zu&&"number"==typeof arguments[1]){var e=arguments[1];t.call(this,arguments[0].getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],n=arguments[1];this._srcPts=i,this._isClosed=t.isClosed(i),this._snapTolerance=n}};Qf.prototype.snapVertices=function(t,e){for(var i=this._isClosed?t.size()-1:t.size(),n=0;n<i;n++){var r=t.get(n),o=this.findSnapForVertex(r,e);null!==o&&(t.set(n,new hl(o)),0===n&&this._isClosed&&t.set(t.size()-1,new hl(o)))}},Qf.prototype.findSnapForVertex=function(t,e){for(var i=0;i<e.length;i++){if(t.equals2D(e[i]))return null;if(t.distance(e[i])<this._snapTolerance)return e[i]}return null},Qf.prototype.snapTo=function(t){var e=new cu(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Qf.prototype.snapSegments=function(t,e){if(0===e.length)return null;var i=e.length;e[0].equals2D(e[e.length-1])&&(i=e.length-1);for(var n=0;n<i;n++){var r=e[n],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new hl(r),!1)}},Qf.prototype.findSegmentIndexToSnap=function(t,e){for(var i=this,n=il.MAX_VALUE,r=-1,o=0;o<e.size()-1;o++){if(i._seg.p0=e.get(o),i._seg.p1=e.get(o+1),i._seg.p0.equals2D(t)||i._seg.p1.equals2D(t)){if(i._allowSnappingToSourceVertices)continue;return-1}var s=i._seg.distance(t);s<i._snapTolerance&&s<n&&(n=s,r=o)}return r},Qf.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Qf.prototype.interfaces_=function(){return[]},Qf.prototype.getClass=function(){return Qf},Qf.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var $f=function(t){this._srcGeom=t||null},td={SNAP_PRECISION_FACTOR:{configurable:!0}};$f.prototype.snapTo=function(t,e){var i=this.extractTargetCoordinates(t);return new ed(e,i).transform(this._srcGeom)},$f.prototype.snapToSelf=function(t,e){var i=this.extractTargetCoordinates(this._srcGeom),n=new ed(t,i,!0).transform(this._srcGeom),r=n;return e&&dl(r,$u)&&(r=n.buffer(0)),r},$f.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},$f.prototype.extractTargetCoordinates=function(t){for(var e=new Ru,i=t.getCoordinates(),n=0;n<i.length;n++)e.add(i[n]);return e.toArray(new Array(0).fill(null))},$f.prototype.computeMinimumSegmentLength=function(t){for(var e=il.MAX_VALUE,i=0;i<t.length-1;i++){var n=t[i].distance(t[i+1]);n<e&&(e=n)}return e},$f.prototype.interfaces_=function(){return[]},$f.prototype.getClass=function(){return $f},$f.snap=function(t,e,i){var n=new Array(2).fill(null),r=new $f(t);n[0]=r.snapTo(e,i);var o=new $f(e);return n[1]=o.snapTo(n[0],i),n},$f.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=$f.computeSizeBasedSnapTolerance(t),i=t.getPrecisionModel();if(i.getType()===dc.FIXED){var n=1/i.getScale()*2/1.415;n>e&&(e=n)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min($f.computeOverlaySnapTolerance(r),$f.computeOverlaySnapTolerance(o))}},$f.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*$f.SNAP_PRECISION_FACTOR},$f.snapToSelf=function(t,e,i){return new $f(t).snapToSelf(e,i)},td.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties($f,td);var ed=function(t){function e(e,i,n){t.call(this),this._snapTolerance=e||null,this._snapPts=i||null,this._isSelfSnap=void 0!==n&&n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var i=new Qf(t,this._snapTolerance);return i.setAllowSnappingToSourceVertices(this._isSelfSnap),i.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var i=t.toCoordinateArray(),n=this.snapLine(i,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Jf),id=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};id.prototype.getCommon=function(){return il.longBitsToDouble(this._commonBits)},id.prototype.add=function(t){var e=il.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=id.signExpBits(this._commonBits),this._isFirst=!1,null):id.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=id.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=id.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},id.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=il.longBitsToDouble(t),i="0000000000000000000000000000000000000000000000000000000000000000"+il.toBinaryString(t),n=i.substring(i.length-64);return n.substring(0,1)+"  "+n.substring(1,12)+"(exp) "+n.substring(12)+" [ "+e+" ]"}},id.prototype.interfaces_=function(){return[]},id.prototype.getClass=function(){return id},id.getBit=function(t,e){return 0!=(t&1<<e)?1:0},id.signExpBits=function(t){return t>>52},id.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},id.numCommonMostSigMantissaBits=function(t,e){for(var i=0,n=52;n>=0;n--){if(id.getBit(t,n)!==id.getBit(e,n))return i;i++}return 52};var nd=function(){this._commonCoord=null,this._ccFilter=new od},rd={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};nd.prototype.addCommonBits=function(t){var e=new sd(this._commonCoord);t.apply(e),t.geometryChanged()},nd.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new hl(this._commonCoord);e.x=-e.x,e.y=-e.y;var i=new sd(e);return t.apply(i),t.geometryChanged(),t},nd.prototype.getCommonCoordinate=function(){return this._commonCoord},nd.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},nd.prototype.interfaces_=function(){return[]},nd.prototype.getClass=function(){return nd},rd.CommonCoordinateFilter.get=function(){return od},rd.Translater.get=function(){return sd},Object.defineProperties(nd,rd);var od=function(){this._commonBitsX=new id,this._commonBitsY=new id};od.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},od.prototype.getCommonCoordinate=function(){return new hl(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},od.prototype.interfaces_=function(){return[Jl]},od.prototype.getClass=function(){return od};var sd=function(){this.trans=null;var t=arguments[0];this.trans=t};sd.prototype.filter=function(t,e){var i=t.getOrdinate(e,0)+this.trans.x,n=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,i),t.setOrdinate(e,1,n)},sd.prototype.isDone=function(){return!1},sd.prototype.isGeometryChanged=function(){return!0},sd.prototype.interfaces_=function(){return[Fu]},sd.prototype.getClass=function(){return sd};var ad=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};ad.prototype.selfSnap=function(t){return new $f(t).snapTo(t,this._snapTolerance)},ad.prototype.removeCommonBits=function(t){this._cbr=new nd,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},ad.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},ad.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),i=Nd.overlayOp(e[0],e[1],t);return this.prepareResult(i)},ad.prototype.checkValid=function(t){t.isValid()||Pl.out.println("Snapped geometry is invalid")},ad.prototype.computeSnapTolerance=function(){this._snapTolerance=$f.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},ad.prototype.snap=function(t){var e=this.removeCommonBits(t);return $f.snap(e[0],e[1],this._snapTolerance)},ad.prototype.interfaces_=function(){return[]},ad.prototype.getClass=function(){return ad},ad.overlayOp=function(t,e,i){return new ad(t,e).getResultGeometry(i)},ad.union=function(t,e){return ad.overlayOp(t,e,Nd.UNION)},ad.intersection=function(t,e){return ad.overlayOp(t,e,Nd.INTERSECTION)},ad.symDifference=function(t,e){return ad.overlayOp(t,e,Nd.SYMDIFFERENCE)},ad.difference=function(t,e){return ad.overlayOp(t,e,Nd.DIFFERENCE)};var hd=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};hd.prototype.getResultGeometry=function(t){var e=null,i=!1,n=null;try{e=Nd.overlayOp(this._geom[0],this._geom[1],t),i=!0}catch(t){if(!(t instanceof kl))throw t;n=t}if(!i)try{e=ad.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof kl?n:t}return e},hd.prototype.interfaces_=function(){return[]},hd.prototype.getClass=function(){return hd},hd.overlayOp=function(t,e,i){return new hd(t,e).getResultGeometry(i)},hd.union=function(t,e){return hd.overlayOp(t,e,Nd.UNION)},hd.intersection=function(t,e){return hd.overlayOp(t,e,Nd.INTERSECTION)},hd.symDifference=function(t,e){return hd.overlayOp(t,e,Nd.SYMDIFFERENCE)},hd.difference=function(t,e){return hd.overlayOp(t,e,Nd.DIFFERENCE)};var ld=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};ld.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},ld.prototype.interfaces_=function(){return[]},ld.prototype.getClass=function(){return ld};var ud=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],i=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=i}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=n,this._xValue=r,this._obj=o}},cd={INSERT:{configurable:!0},DELETE:{configurable:!0}};ud.prototype.isDelete=function(){return this._eventType===ud.DELETE},ud.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ud.prototype.getObject=function(){return this._obj},ud.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ud.prototype.getInsertEvent=function(){return this._insertEvent},ud.prototype.isInsert=function(){return this._eventType===ud.INSERT},ud.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ud.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ud.prototype.interfaces_=function(){return[rl]},ud.prototype.getClass=function(){return ud},cd.INSERT.get=function(){return 1},cd.DELETE.get=function(){return 2},Object.defineProperties(ud,cd);var pd=function(){};pd.prototype.interfaces_=function(){return[]},pd.prototype.getClass=function(){return pd};var fd=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],i=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=i};fd.prototype.isTrivialIntersection=function(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(fd.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&n===r||0===n&&e===r)return!0}}return!1},fd.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},fd.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},fd.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},fd.prototype.isBoundaryPointInternal=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next().getCoordinate();if(t.isIntersection(n))return!0}return!1},fd.prototype.hasProperIntersection=function(){return this._hasProper},fd.prototype.hasIntersection=function(){return this._hasIntersection},fd.prototype.isDone=function(){return this._isDone},fd.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},fd.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},fd.prototype.addIntersections=function(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),i.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},fd.prototype.interfaces_=function(){return[]},fd.prototype.getClass=function(){return fd},fd.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var dd=function(t){function e(){t.call(this),this.events=new lu,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){ip.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){var t=this;if(1===arguments.length){var e=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var i=0;i<this.events.size();i++){var n=t.events.get(i);if(n.isInsert()&&t.processOverlaps(i,n.getDeleteEventIndex(),n,e),e.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof fd&&dl(arguments[0],au)&&dl(arguments[1],au)){var r=arguments[0],o=arguments[1],s=arguments[2];this.addEdges(r,r),this.addEdges(o,o),this.computeIntersections(s)}else if("boolean"==typeof arguments[2]&&dl(arguments[0],au)&&arguments[1]instanceof fd){var a=arguments[0],h=arguments[1];arguments[2]?this.addEdges(a,null):this.addEdges(a),this.computeIntersections(h)}},e.prototype.addEdge=function(t,e){for(var i=t.getMonotoneChainEdge(),n=i.getStartIndexes(),r=0;r<n.length-1;r++){var o=new ld(i,r),s=new ud(e,i.getMinX(r),o);this.events.add(s),this.events.add(new ud(i.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,i,n){for(var r=i.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();i.isSameLabel(s)||(r.computeIntersections(a,n),this.nOverlaps++)}}},e.prototype.addEdges=function(){var t=this;if(1===arguments.length)for(var e=arguments[0].iterator();e.hasNext();){var i=e.next();t.addEdge(i,i)}else if(2===arguments.length)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();){var o=r.next();t.addEdge(o,n)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pd),gd=function(){this._min=il.POSITIVE_INFINITY,this._max=il.NEGATIVE_INFINITY},yd={NodeComparator:{configurable:!0}};gd.prototype.getMin=function(){return this._min},gd.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},gd.prototype.getMax=function(){return this._max},gd.prototype.toString=function(){return Fl.toLineString(new hl(this._min,0),new hl(this._max,0))},gd.prototype.interfaces_=function(){return[]},gd.prototype.getClass=function(){return gd},yd.NodeComparator.get=function(){return _d},Object.defineProperties(gd,yd);var _d=function(){};_d.prototype.compare=function(t,e){var i=t,n=e,r=(i._min+i._max)/2,o=(n._min+n._max)/2;return r<o?-1:r>o?1:0},_d.prototype.interfaces_=function(){return[sl]},_d.prototype.getClass=function(){return _d};var md=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],i=arguments[1],n=arguments[2];this._min=e,this._max=i,this._item=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,i){if(!this.intersects(t,e))return null;i.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(gd),vd=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],i=arguments[1];this._node1=e,this._node2=i,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,i){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,i),null!==this._node2&&this._node2.query(t,e,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(gd),xd=function(){this._leaves=new lu,this._root=null,this._level=0};xd.prototype.buildTree=function(){ip.sort(this._leaves,new gd.NodeComparator);for(var t=this._leaves,e=null,i=new lu;;){if(this.buildLevel(t,i),1===i.size())return i.get(0);e=t,t=i,i=e}},xd.prototype.insert=function(t,e,i){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new md(t,e,i))},xd.prototype.query=function(t,e,i){this.init(),this._root.query(t,e,i)},xd.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},xd.prototype.printNode=function(t){Pl.out.println(Fl.toLineString(new hl(t._min,this._level),new hl(t._max,this._level)))},xd.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},xd.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var i=0;i<t.size();i+=2){var n=t.get(i);if(null===(i+1<t.size()?t.get(i):null))e.add(n);else{var r=new vd(t.get(i),t.get(i+1));e.add(r)}}},xd.prototype.interfaces_=function(){return[]},xd.prototype.getClass=function(){return xd};var Ed=function(){this._items=new lu};Ed.prototype.visitItem=function(t){this._items.add(t)},Ed.prototype.getItems=function(){return this._items},Ed.prototype.interfaces_=function(){return[Qc]},Ed.prototype.getClass=function(){return Ed};var wd=function(){this._index=null;var t=arguments[0];if(!dl(t,$u))throw new el("Argument must be Polygonal");this._index=new Cd(t)},bd={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};wd.prototype.locate=function(t){var e=new Xl(t),i=new Md(e);return this._index.query(t.y,t.y,i),e.getLocation()},wd.prototype.interfaces_=function(){return[Bp]},wd.prototype.getClass=function(){return wd},bd.SegmentVisitor.get=function(){return Md},bd.IntervalIndexedGeometry.get=function(){return Cd},Object.defineProperties(wd,bd);var Md=function(){this._counter=null;var t=arguments[0];this._counter=t};Md.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},Md.prototype.interfaces_=function(){return[Qc]},Md.prototype.getClass=function(){return Md};var Cd=function(){this._index=new xd;var t=arguments[0];this.init(t)};Cd.prototype.init=function(t){for(var e=Sf.getLines(t).iterator();e.hasNext();){var i=e.next().getCoordinates();this.addLine(i)}},Cd.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var i=new _p(t[e-1],t[e]),n=Math.min(i.p0.y,i.p1.y),r=Math.max(i.p0.y,i.p1.y);this._index.insert(n,r,i)}},Cd.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new Ed;return this._index.query(t,e,i),i.getItems()}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._index.query(n,r,o)}},Cd.prototype.interfaces_=function(){return[]},Cd.prototype.getClass=function(){return Cd};var Id=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new fc,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Pf,2===arguments.length){var e=arguments[0],i=arguments[1],n=Ql.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=i,this._boundaryNodeRule=n,null!==i&&this.add(i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,i){var n=this._nodes.addNode(i).getLabel(),r=1;n.getLocation(t,Ic.ON)===pl.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);n.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var i=arguments[1],n=arguments[2],r=new fd(arguments[0],!0,!1);r.setIsDoneIfProperInt(n);var o=this.createEdgeSetIntersector(),s=this._parentGeom instanceof ic||this._parentGeom instanceof tc||this._parentGeom instanceof nc,a=i||!s;return o.computeIntersections(this._edges,r,a),this.addSelfIntersectionNodes(this._argIndex),r}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,i){var n=new fd(e,i,!0);return n.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,n),n},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Qu){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,pl.INTERIOR)}else if(arguments[0]instanceof hl){var e=arguments[0];this.insertPoint(this._argIndex,e,pl.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),pl.EXTERIOR,pl.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var i=t.getInteriorRingN(e);this.addPolygonRing(i,pl.INTERIOR,pl.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],pl.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],pl.BOUNDARY)},e.prototype.addLineString=function(t){var e=pu.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var i=new of(e,new Dc(this._argIndex,pl.INTERIOR));this._lineEdgeMap.put(t,i),this.insertEdge(i),zl.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),i=0,n=t.iterator();n.hasNext();){var r=n.next();e[i++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,i){if(this.isBoundaryNode(t,e))return null;i===pl.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,i)},e.prototype.addPolygonRing=function(t,e,i){if(t.isEmpty())return null;var n=pu.removeRepeatedPoints(t.getCoordinates());if(n.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=n[0],null;var r=e,o=i;Yl.isCCW(n)&&(r=i,o=e);var s=new of(n,new Dc(this._argIndex,pl.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,n[0],pl.BOUNDARY)},e.prototype.insertPoint=function(t,e,i){var n=this._nodes.addNode(e),r=n.getLabel();null===r?n._label=new Dc(t,i):r.setLocation(t,i)},e.prototype.createEdgeSetIntersector=function(){return new dd},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var i=e.next(),n=i.getLabel().getLocation(t),r=i.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,n)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof nc&&(this._useBoundaryDeterminationRule=!1),e instanceof tc)this.addPolygon(e);else if(e instanceof Zu)this.addLineString(e);else if(e instanceof Qu)this.addPoint(e);else if(e instanceof ec)this.addCollection(e);else if(e instanceof Gu)this.addCollection(e);else if(e instanceof nc)this.addCollection(e);else{if(!(e instanceof ku))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}},e.prototype.locate=function(t){return dl(this._parentGeom,$u)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new wd(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?pl.BOUNDARY:pl.INTERIOR},e}(Wc),Sd=function(){if(this._li=new Bl,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Id(0,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1],n=Ql.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Id(0,e,n),this._arg[1]=new Id(1,i,n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Id(0,r,s),this._arg[1]=new Id(1,o,s)}};Sd.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Sd.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Sd.prototype.interfaces_=function(){return[]},Sd.prototype.getClass=function(){return Sd};var Pd=function(){};Pd.prototype.interfaces_=function(){return[]},Pd.prototype.getClass=function(){return Pd},Pd.map=function(){if(arguments[0]instanceof Kl&&dl(arguments[1],Pd.MapOp)){for(var t=arguments[0],e=arguments[1],i=new lu,n=0;n<t.getNumGeometries();n++){var r=e.map(t.getGeometryN(n));null!==r&&i.add(r)}return t.getFactory().buildGeometry(i)}if(dl(arguments[0],ru)&&dl(arguments[1],Pd.MapOp)){for(var o=arguments[0],s=arguments[1],a=new lu,h=o.iterator();h.hasNext();){var l=h.next(),u=s.map(l);null!==u&&a.add(u)}return a}},Pd.MapOp=function(){};var Nd=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i),this._ptLocator=new Pf,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Hp,this._resultPolyList=new lu,this._resultLineList=new lu,this._resultPointList=new lu,this._graph=new Wc(new Wp),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new Dc(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(i),r.add(n),i.merge(n)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),i=e.getSym();e.isInResult()&&i.isInResult()&&(e.setInResult(!1),i.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,i,n,r){var o=new lu;return o.addAll(t),o.addAll(i),o.addAll(n),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();if(this._ptLocator.locate(t,n)!==pl.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new lu,e=this._edgeList.iterator();e.hasNext();){var i=e.next();i.isCollapsed()&&(e.remove(),t.add(i.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getEdges().getLabel();e.getLabel().merge(i)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this.insertUniqueEdge(i)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new lu;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Wf.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var i=new Kc(this._geomFact);i.add(this._graph),this._resultPolyList=i.getPolygons();var n=new Hf(this,this._geomFact,this._ptLocator);this._resultLineList=n.build(t);var r=new Zf(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,i)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var i=e.next();this._graph.addNode(i.getCoordinate()).setLabel(t,i.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var n=i.next(),r=n.getLabel();r.isArea()&&!n.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Ic.RIGHT),r.getLocation(1,Ic.RIGHT),t)&&n.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),i=e.getLabel(),n=e.getDepth();if(!n.isNull()){n.normalize();for(var r=0;r<2;r++)i.isNull(r)||!i.isArea()||n.isNull(r)||(0===n.getDelta(r)?i.toLine(r):(zl.isTrue(!n.isNull(r,Ic.LEFT),"depth of LEFT side has not been initialized"),i.setLocation(r,Ic.LEFT,n.getLocation(r,Ic.LEFT)),zl.isTrue(!n.isNull(r,Ic.RIGHT),"depth of RIGHT side has not been initialized"),i.setLocation(r,Ic.RIGHT,n.getLocation(r,Ic.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getLabel();e.isIsolated()&&(i.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(i)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Sd);Nd.overlayOp=function(t,e,i){return new Nd(t,e).getResultGeometry(i)},Nd.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Nd.createEmptyResult(Nd.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var i=e;return Kf.map(t,{interfaces_:function(){return[Pd.MapOp]},map:function(t){return t.intersection(i)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),hd.overlayOp(t,e,Nd.INTERSECTION)},Nd.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Nd.createEmptyResult(Nd.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),hd.overlayOp(t,e,Nd.SYMDIFFERENCE)},Nd.resultDimension=function(t,e,i){var n=e.getDimension(),r=i.getDimension(),o=-1;switch(t){case Nd.INTERSECTION:o=Math.min(n,r);break;case Nd.UNION:o=Math.max(n,r);break;case Nd.DIFFERENCE:o=n;break;case Nd.SYMDIFFERENCE:o=Math.max(n,r)}return o},Nd.createEmptyResult=function(t,e,i,n){var r=null;switch(Nd.resultDimension(t,e,i)){case-1:r=n.createGeometryCollection(new Array(0).fill(null));break;case 0:r=n.createPoint();break;case 1:r=n.createLineString();break;case 2:r=n.createPolygon()}return r},Nd.difference=function(t,e){return t.isEmpty()?Nd.createEmptyResult(Nd.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),hd.overlayOp(t,e,Nd.DIFFERENCE))},Nd.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=t.getLocation(0),n=t.getLocation(1);return Nd.isResultOfOp(i,n,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===pl.BOUNDARY&&(r=pl.INTERIOR),o===pl.BOUNDARY&&(o=pl.INTERIOR),s){case Nd.INTERSECTION:return r===pl.INTERIOR&&o===pl.INTERIOR;case Nd.UNION:return r===pl.INTERIOR||o===pl.INTERIOR;case Nd.DIFFERENCE:return r===pl.INTERIOR&&o!==pl.INTERIOR;case Nd.SYMDIFFERENCE:return r===pl.INTERIOR&&o!==pl.INTERIOR||r!==pl.INTERIOR&&o===pl.INTERIOR}return!1}},Nd.INTERSECTION=1,Nd.UNION=2,Nd.DIFFERENCE=3,Nd.SYMDIFFERENCE=4;var Rd=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Pf,this._seg=new _p;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Rd.prototype.isWithinToleranceOfBoundary=function(t){for(var e=this,i=0;i<this._linework.getNumGeometries();i++)for(var n=e._linework.getGeometryN(i).getCoordinateSequence(),r=0;r<n.size()-1;r++)if(n.getCoordinate(r,e._seg.p0),n.getCoordinate(r+1,e._seg.p1),e._seg.distance(t)<=e._boundaryDistanceTolerance)return!0;return!1},Rd.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?pl.BOUNDARY:this._ptLocator.locate(t,this._g)},Rd.prototype.extractLinework=function(t){var e=new Td;t.apply(e);var i=e.getLinework(),n=mc.toLineStringArray(i);return t.getFactory().createMultiLineString(n)},Rd.prototype.interfaces_=function(){return[]},Rd.prototype.getClass=function(){return Rd};var Td=function(){this._linework=null,this._linework=new lu};Td.prototype.getLinework=function(){return this._linework},Td.prototype.filter=function(t){if(t instanceof tc){var e=t;this._linework.add(e.getExteriorRing());for(var i=0;i<e.getNumInteriorRing();i++)this._linework.add(e.getInteriorRingN(i))}},Td.prototype.interfaces_=function(){return[Du]},Td.prototype.getClass=function(){return Td};var Ld=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Ld.prototype.extractPoints=function(t,e,i){for(var n=t.getCoordinates(),r=0;r<n.length-1;r++)this.computeOffsetPoints(n[r],n[r+1],e,i)},Ld.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Ld.prototype.getPoints=function(t){for(var e=new lu,i=Sf.getLines(this._g).iterator();i.hasNext();){var n=i.next();this.extractPoints(n,t,e)}return e},Ld.prototype.computeOffsetPoints=function(t,e,i,n){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=i*r/s,h=i*o/s,l=(e.x+t.x)/2,u=(e.y+t.y)/2;if(this._doLeft){var c=new hl(l-h,u+a);n.add(c)}if(this._doRight){var p=new hl(l+h,u-a);n.add(p)}},Ld.prototype.interfaces_=function(){return[]},Ld.prototype.getClass=function(){return Ld};var Od=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new lu;var e=arguments[0],i=arguments[1],n=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,i),this._geom=[e,i,n],this._locFinder=[new Rd(this._geom[0],this._boundaryDistanceTolerance),new Rd(this._geom[1],this._boundaryDistanceTolerance),new Rd(this._geom[2],this._boundaryDistanceTolerance)]},Ad={TOLERANCE:{configurable:!0}};Od.prototype.reportResult=function(t,e,i){Pl.out.println("Overlay result invalid - A:"+pl.toLocationSymbol(e[0])+" B:"+pl.toLocationSymbol(e[1])+" expected:"+(i?"i":"e")+" actual:"+pl.toLocationSymbol(e[2]))},Od.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Od.prototype.checkValid=function(){var t=this;if(1===arguments.length){for(var e=arguments[0],i=0;i<this._testCoords.size();i++){var n=t._testCoords.get(i);if(!t.checkValid(e,n))return t._invalidLocation=n,!1}return!0}if(2===arguments.length){var r=arguments[0],o=arguments[1];return this._location[0]=this._locFinder[0].getLocation(o),this._location[1]=this._locFinder[1].getLocation(o),this._location[2]=this._locFinder[2].getLocation(o),!!Od.hasLocation(this._location,pl.BOUNDARY)||this.isValidResult(r,this._location)}},Od.prototype.addTestPts=function(t){var e=new Ld(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Od.prototype.isValidResult=function(t,e){var i=Nd.isResultOfOp(e[0],e[1],t),n=!(i^e[2]===pl.INTERIOR);return n||this.reportResult(t,e,i),n},Od.prototype.getInvalidLocation=function(){return this._invalidLocation},Od.prototype.interfaces_=function(){return[]},Od.prototype.getClass=function(){return Od},Od.hasLocation=function(t,e){for(var i=0;i<3;i++)if(t[i]===e)return!0;return!1},Od.computeBoundaryDistanceTolerance=function(t,e){return Math.min($f.computeSizeBasedSnapTolerance(t),$f.computeSizeBasedSnapTolerance(e))},Od.isValid=function(t,e,i,n){return new Od(t,e,n).isValid(i)},Ad.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Od,Ad);var Dd=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Dd.prototype.extractElements=function(t,e){if(null===t)return null;for(var i=0;i<t.getNumGeometries();i++){var n=t.getGeometryN(i);this._skipEmpty&&n.isEmpty()||e.add(n)}},Dd.prototype.combine=function(){for(var t=new lu,e=this._inputGeoms.iterator();e.hasNext();){var i=e.next();this.extractElements(i,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Dd.prototype.interfaces_=function(){return[]},Dd.prototype.getClass=function(){return Dd},Dd.combine=function(){if(1===arguments.length)return new Dd(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Dd(Dd.createList(t,e)).combine()}if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];return new Dd(Dd.createList(i,n,r)).combine()}},Dd.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Dd.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new lu;return i.add(t),i.add(e),i}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=new lu;return s.add(n),s.add(r),s.add(o),s}};var Fd=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new lu)},kd={STRTREE_NODE_CAPACITY:{configurable:!0}};Fd.prototype.reduceToGeometries=function(t){for(var e=new lu,i=t.iterator();i.hasNext();){var n=i.next(),r=null;dl(n,au)?r=this.unionTree(n):n instanceof Kl&&(r=n),e.add(r)}return e},Fd.prototype.extractByEnvelope=function(t,e,i){for(var n=new lu,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?n.add(o):i.add(o)}return this._geomFactory.buildGeometry(n)},Fd.prototype.unionOptimized=function(t,e){var i=t.getEnvelopeInternal(),n=e.getEnvelopeInternal();if(!i.intersects(n))return Dd.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=i.intersection(n);return this.unionUsingEnvelopeIntersection(t,e,r)},Fd.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new hp(Fd.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var i=e.next();t.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var n=t.itemsTree();return this.unionTree(n)},Fd.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2];if(n-i<=1){var r=Fd.getGeometry(e,i);return this.unionSafe(r,null)}if(n-i==2)return this.unionSafe(Fd.getGeometry(e,i),Fd.getGeometry(e,i+1));var o=Math.trunc((n+i)/2),s=this.binaryUnion(e,i,o),a=this.binaryUnion(e,o,n);return this.unionSafe(s,a)}},Fd.prototype.repeatedUnion=function(t){for(var e=null,i=t.iterator();i.hasNext();){var n=i.next();e=null===e?n.copy():e.union(n)}return e},Fd.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Fd.prototype.unionActual=function(t,e){return Fd.restrictToPolygons(t.union(e))},Fd.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Fd.prototype.unionUsingEnvelopeIntersection=function(t,e,i){var n=new lu,r=this.extractByEnvelope(i,t,n),o=this.extractByEnvelope(i,e,n),s=this.unionActual(r,o);return n.add(s),Dd.combine(n)},Fd.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e.getFactory().createGeometryCollection([e,i]).buffer(0)}},Fd.prototype.interfaces_=function(){return[]},Fd.prototype.getClass=function(){return Fd},Fd.restrictToPolygons=function(t){if(dl(t,$u))return t;var e=If.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(mc.toPolygonArray(e))},Fd.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Fd.union=function(t){return new Fd(t).union()},kd.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Fd,kd);var Gd=function(){};function zd(){return new jd}function jd(){this.reset()}Gd.prototype.interfaces_=function(){return[]},Gd.prototype.getClass=function(){return Gd},Gd.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Nd.createEmptyResult(Nd.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),hd.overlayOp(t,e,Nd.UNION)},jd.prototype={constructor:jd,reset:function(){this.s=this.t=0},add:function(t){Bd(qd,t,this.t),Bd(this,qd.s,this.s),this.s?this.t+=qd.t:this.s=qd.t},valueOf:function(){return this.s}};var qd=new jd;function Bd(t,e,i){var n=t.s=e+i,r=n-e,o=n-r;t.t=e-o+(i-r)}var Ud=1e-6,Xd=Math.PI,Yd=Xd/2,Vd=Xd/4,Wd=2*Xd,Kd=180/Xd,Hd=Xd/180,Zd=Math.abs,Jd=Math.atan,Qd=Math.atan2,$d=Math.cos,tg=Math.sin,eg=Math.sqrt;function ig(t){return t>1?0:t<-1?Xd:Math.acos(t)}function ng(t){return t>1?Yd:t<-1?-Yd:Math.asin(t)}function rg(){}function og(t,e){t&&lg.hasOwnProperty(t.type)&&lg[t.type](t,e)}var sg,ag,hg={Feature:function(t,e){og(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)og(i[n].geometry,e)}},lg={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){ug(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)ug(i[n],e,0)},Polygon:function(t,e){cg(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)cg(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)og(i[n],e)}};function ug(t,e,i){var n,r=-1,o=t.length-i;for(e.lineStart();++r<o;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function cg(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)ug(t[i],e,1);e.polygonEnd()}function pg(t){return[Qd(t[1],t[0]),ng(t[2])]}function fg(t){var e=t[0],i=t[1],n=$d(i);return[n*$d(e),n*tg(e),tg(i)]}function dg(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function gg(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function yg(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function _g(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function mg(t){var e=eg(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function vg(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i}function xg(t,e){return[t>Xd?t-Wd:t<-Xd?t+Wd:t,e]}function Eg(t){return function(e,i){return[(e+=t)>Xd?e-Wd:e<-Xd?e+Wd:e,i]}}function wg(t){var e=Eg(t);return e.invert=Eg(-t),e}function bg(t,e){var i=$d(t),n=tg(t),r=$d(e),o=tg(e);function s(t,e){var s=$d(e),a=$d(t)*s,h=tg(t)*s,l=tg(e),u=l*i+a*n;return[Qd(h*r-u*o,a*i-l*n),ng(u*r+h*o)]}return s.invert=function(t,e){var s=$d(e),a=$d(t)*s,h=tg(t)*s,l=tg(e),u=l*r-h*o;return[Qd(h*r+l*o,a*i+u*n),ng(u*i-a*n)]},s}function Mg(t,e){(e=fg(e))[0]-=t,mg(e);var i=ig(-e[1]);return((-e[2]<0?-i:i)+Wd-Ud)%Wd}function Cg(){var t,e=[];return{point:function(e,i){t.push([e,i])},lineStart:function(){e.push(t=[])},lineEnd:rg,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function Ig(t,e){return Zd(t[0]-e[0])<Ud&&Zd(t[1]-e[1])<Ud}function Sg(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function Pg(t,e,i,n,r){var o,s,a=[],h=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,n=t[0],s=t[e];if(Ig(n,s)){for(r.lineStart(),o=0;o<e;++o)r.point((n=t[o])[0],n[1]);r.lineEnd()}else a.push(i=new Sg(n,t,null,!0)),h.push(i.o=new Sg(n,null,i,!1)),a.push(i=new Sg(s,t,null,!1)),h.push(i.o=new Sg(s,null,i,!0))}})),a.length){for(h.sort(e),Ng(a),Ng(h),o=0,s=h.length;o<s;++o)h[o].e=i=!i;for(var l,u,c=a[0];;){for(var p=c,f=!0;p.v;)if((p=p.n)===c)return;l=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(o=0,s=l.length;o<s;++o)r.point((u=l[o])[0],u[1]);else n(p.x,p.n.x,1,r);p=p.n}else{if(f)for(l=p.p.z,o=l.length-1;o>=0;--o)r.point((u=l[o])[0],u[1]);else n(p.x,p.p.x,-1,r);p=p.p}l=(p=p.o).z,f=!f}while(!p.v);r.lineEnd()}}}function Ng(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function Rg(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Tg(t){for(var e,i,n,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(i=new Array(s);--r>=0;)for(e=(n=t[r]).length;--e>=0;)i[--s]=n[e];return i}zd(),zd(),zd(),xg.invert=xg,1===(sg=Rg).length&&(ag=sg,sg=function(t,e){return Rg(ag(t),e)});var Lg=1e9,Og=-Lg;function Ag(t,e,i,n){function r(r,o){return t<=r&&r<=i&&e<=o&&o<=n}function o(r,o,a,l){var u=0,c=0;if(null==r||(u=s(r,a))!==(c=s(o,a))||h(r,o)<0^a>0)do{l.point(0===u||3===u?t:i,u>1?n:e)}while((u=(u+a+4)%4)!==c);else l.point(o[0],o[1])}function s(n,r){return Zd(n[0]-t)<Ud?r>0?0:3:Zd(n[0]-i)<Ud?r>0?2:1:Zd(n[1]-e)<Ud?r>0?1:0:r>0?3:2}function a(t,e){return h(t.x,e.x)}function h(t,e){var i=s(t,1),n=s(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(s){var h,l,u,c,p,f,d,g,y,_,m,v=s,x=Cg(),E={point:w,lineStart:function(){E.point=b,l&&l.push(u=[]),_=!0,y=!1,d=g=NaN},lineEnd:function(){h&&(b(c,p),f&&y&&x.rejoin(),h.push(x.result())),E.point=w,y&&v.lineEnd()},polygonStart:function(){v=x,h=[],l=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,r=l.length;i<r;++i)for(var o,s,a=l[i],h=1,u=a.length,c=a[0],p=c[0],f=c[1];h<u;++h)o=p,s=f,p=(c=a[h])[0],f=c[1],s<=n?f>n&&(p-o)*(n-s)>(f-s)*(t-o)&&++e:f<=n&&(p-o)*(n-s)<(f-s)*(t-o)&&--e;return e}(),i=m&&e,r=(h=Tg(h)).length;(i||r)&&(s.polygonStart(),i&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&Pg(h,a,e,o,s),s.polygonEnd()),v=s,h=l=u=null}};function w(t,e){r(t,e)&&v.point(t,e)}function b(o,s){var a=r(o,s);if(l&&u.push([o,s]),_)c=o,p=s,f=a,_=!1,a&&(v.lineStart(),v.point(o,s));else if(a&&y)v.point(o,s);else{var h=[d=Math.max(Og,Math.min(Lg,d)),g=Math.max(Og,Math.min(Lg,g))],x=[o=Math.max(Og,Math.min(Lg,o)),s=Math.max(Og,Math.min(Lg,s))];!function(t,e,i,n,r,o){var s,a=t[0],h=t[1],l=0,u=1,c=e[0]-a,p=e[1]-h;if(s=i-a,c||!(s>0)){if(s/=c,c<0){if(s<l)return;s<u&&(u=s)}else if(c>0){if(s>u)return;s>l&&(l=s)}if(s=r-a,c||!(s<0)){if(s/=c,c<0){if(s>u)return;s>l&&(l=s)}else if(c>0){if(s<l)return;s<u&&(u=s)}if(s=n-h,p||!(s>0)){if(s/=p,p<0){if(s<l)return;s<u&&(u=s)}else if(p>0){if(s>u)return;s>l&&(l=s)}if(s=o-h,p||!(s<0)){if(s/=p,p<0){if(s>u)return;s>l&&(l=s)}else if(p>0){if(s<l)return;s<u&&(u=s)}return l>0&&(t[0]=a+l*c,t[1]=h+l*p),u<1&&(e[0]=a+u*c,e[1]=h+u*p),!0}}}}}(h,x,t,e,i,n)?a&&(v.lineStart(),v.point(o,s),m=!1):(y||(v.lineStart(),v.point(h[0],h[1])),v.point(x[0],x[1]),a||v.lineEnd(),m=!1)}d=o,g=s,y=a}return E}}var Dg=zd();function Fg(t){return t}zd(),zd(),zd();var kg=1/0,Gg=kg,zg=-kg,jg=zg,qg={point:function(t,e){t<kg&&(kg=t),t>zg&&(zg=t),e<Gg&&(Gg=e),e>jg&&(jg=e)},lineStart:rg,lineEnd:rg,polygonStart:rg,polygonEnd:rg,result:function(){var t=[[kg,Gg],[zg,jg]];return zg=jg=-(Gg=kg=1/0),t}};function Bg(t,e,i,n){return function(r,o){var s,a,h,l=e(o),u=r.invert(n[0],n[1]),c=Cg(),p=e(c),f=!1,d={point:g,lineStart:_,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=x,d.lineEnd=E,a=[],s=[]},polygonEnd:function(){d.point=g,d.lineStart=_,d.lineEnd=m,a=Tg(a);var t=function(t,e){var i=e[0],n=e[1],r=[tg(i),-$d(i),0],o=0,s=0;Dg.reset();for(var a=0,h=t.length;a<h;++a)if(u=(l=t[a]).length)for(var l,u,c=l[u-1],p=c[0],f=c[1]/2+Vd,d=tg(f),g=$d(f),y=0;y<u;++y,p=m,d=x,g=E,c=_){var _=l[y],m=_[0],v=_[1]/2+Vd,x=tg(v),E=$d(v),w=m-p,b=w>=0?1:-1,M=b*w,C=M>Xd,I=d*x;if(Dg.add(Qd(I*b*tg(M),g*E+I*$d(M))),o+=C?w+b*Wd:w,C^p>=i^m>=i){var S=gg(fg(c),fg(_));mg(S);var P=gg(r,S);mg(P);var N=(C^w>=0?-1:1)*ng(P[2]);(n>N||n===N&&(S[0]||S[1]))&&(s+=C^w>=0?1:-1)}}return(o<-1e-6||o<Ud&&Dg<-1e-6)^1&s}(s,u);a.length?(f||(o.polygonStart(),f=!0),Pg(a,Xg,t,i,o)):t&&(f||(o.polygonStart(),f=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),f&&(o.polygonEnd(),f=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function g(e,i){var n=r(e,i);t(e=n[0],i=n[1])&&o.point(e,i)}function y(t,e){var i=r(t,e);l.point(i[0],i[1])}function _(){d.point=y,l.lineStart()}function m(){d.point=g,l.lineEnd()}function v(t,e){h.push([t,e]);var i=r(t,e);p.point(i[0],i[1])}function x(){p.lineStart(),h=[]}function E(){v(h[0][0],h[0][1]),p.lineEnd();var t,e,i,n,r=p.clean(),l=c.result(),u=l.length;if(h.pop(),s.push(h),h=null,u)if(1&r){if((e=(i=l[0]).length-1)>0){for(f||(o.polygonStart(),f=!0),o.lineStart(),t=0;t<e;++t)o.point((n=i[t])[0],n[1]);o.lineEnd()}}else u>1&&2&r&&l.push(l.pop().concat(l.shift())),a.push(l.filter(Ug))}return d}}function Ug(t){return t.length>1}function Xg(t,e){return((t=t.x)[0]<0?t[1]-Yd-Ud:Yd-t[1])-((e=e.x)[0]<0?e[1]-Yd-Ud:Yd-e[1])}zd();var Yg=Bg((function(){return!0}),(function(t){var e,i=NaN,n=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?Xd:-Xd,h=Zd(o-i);Zd(h-Xd)<Ud?(t.point(i,n=(n+s)/2>0?Yd:-Yd),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(o,n),e=0):r!==a&&h>=Xd&&(Zd(i-r)<Ud&&(i-=r*Ud),Zd(o-a)<Ud&&(o-=a*Ud),n=function(t,e,i,n){var r,o,s=tg(t-i);return Zd(s)>Ud?Jd((tg(e)*(o=$d(n))*tg(i)-tg(n)*(r=$d(e))*tg(t))/(r*o*s)):(e+n)/2}(i,n,o,s),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),e=0),t.point(i=o,n=s),r=a},lineEnd:function(){t.lineEnd(),i=n=NaN},clean:function(){return 2-e}}}),(function(t,e,i,n){var r;if(null==t)r=i*Yd,n.point(-Xd,r),n.point(0,r),n.point(Xd,r),n.point(Xd,0),n.point(Xd,-r),n.point(0,-r),n.point(-Xd,-r),n.point(-Xd,0),n.point(-Xd,r);else if(Zd(t[0]-e[0])>Ud){var o=t[0]<e[0]?Xd:-Xd;r=i*o/2,n.point(-o,r),n.point(0,r),n.point(o,r)}else n.point(e[0],e[1])}),[-Xd,-Yd]);function Vg(t,e){var i=$d(t),n=i>0,r=Zd(i)>Ud;function o(t,e){return $d(t)*$d(e)>i}function s(t,e,n){var r=[1,0,0],o=gg(fg(t),fg(e)),s=dg(o,o),a=o[0],h=s-a*a;if(!h)return!n&&t;var l=i*s/h,u=-i*a/h,c=gg(r,o),p=_g(r,l);yg(p,_g(o,u));var f=c,d=dg(p,f),g=dg(f,f),y=d*d-g*(dg(p,p)-1);if(!(y<0)){var _=eg(y),m=_g(f,(-d-_)/g);if(yg(m,p),m=pg(m),!n)return m;var v,x=t[0],E=e[0],w=t[1],b=e[1];E<x&&(v=x,x=E,E=v);var M=E-x,C=Zd(M-Xd)<Ud;if(!C&&b<w&&(v=w,w=b,b=v),C||M<Ud?C?w+b>0^m[1]<(Zd(m[0]-x)<Ud?w:b):w<=m[1]&&m[1]<=b:M>Xd^(x<=m[0]&&m[0]<=E)){var I=_g(f,(-d+_)/g);return yg(I,p),[m,pg(I)]}}}function a(e,i){var r=n?t:Xd-t,o=0;return e<-r?o|=1:e>r&&(o|=2),i<-r?o|=4:i>r&&(o|=8),o}return Bg(o,(function(t){var e,i,h,l,u;return{lineStart:function(){l=h=!1,u=1},point:function(c,p){var f,d=[c,p],g=o(c,p),y=n?g?0:a(c,p):g?a(c+(c<0?Xd:-Xd),p):0;if(!e&&(l=h=g)&&t.lineStart(),g!==h&&(!(f=s(e,d))||Ig(e,f)||Ig(d,f))&&(d[0]+=Ud,d[1]+=Ud,g=o(d[0],d[1])),g!==h)u=0,g?(t.lineStart(),f=s(d,e),t.point(f[0],f[1])):(f=s(e,d),t.point(f[0],f[1]),t.lineEnd()),e=f;else if(r&&e&&n^g){var _;y&i||!(_=s(d,e,!0))||(u=0,n?(t.lineStart(),t.point(_[0][0],_[0][1]),t.point(_[1][0],_[1][1]),t.lineEnd()):(t.point(_[1][0],_[1][1]),t.lineEnd(),t.lineStart(),t.point(_[0][0],_[0][1])))}!g||e&&Ig(e,d)||t.point(d[0],d[1]),e=d,h=g,i=y},lineEnd:function(){h&&t.lineEnd(),e=null},clean:function(){return u|(l&&h)<<1}}}),(function(i,n,r,o){!function(t,e,i,n,r,o){if(i){var s=$d(e),a=tg(e),h=n*i;null==r?(r=e+n*Wd,o=e-h/2):(r=Mg(s,r),o=Mg(s,o),(n>0?r<o:r>o)&&(r+=n*Wd));for(var l,u=r;n>0?u>o:u<o;u-=h)l=pg([s,-a*$d(u),-a*tg(u)]),t.point(l[0],l[1])}}(o,t,e,r,i,n)}),n?[0,-t]:[-Xd,t-Xd])}function Wg(t){return function(e){var i=new Kg;for(var n in t)i[n]=t[n];return i.stream=e,i}}function Kg(){}function Hg(t,e,i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),function(t,e){t&&hg.hasOwnProperty(t.type)?hg[t.type](t,e):og(t,e)}(i,t.stream(qg));var s=qg.result(),a=Math.min(n/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),h=+e[0][0]+(n-a*(s[1][0]+s[0][0]))/2,l=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([h,l])}Kg.prototype={constructor:Kg,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Zg=$d(30*Hd);function Jg(t,e){return+e?function(t,e){function i(n,r,o,s,a,h,l,u,c,p,f,d,g,y){var _=l-n,m=u-r,v=_*_+m*m;if(v>4*e&&g--){var x=s+p,E=a+f,w=h+d,b=eg(x*x+E*E+w*w),M=ng(w/=b),C=Zd(Zd(w)-1)<Ud||Zd(o-c)<Ud?(o+c)/2:Qd(E,x),I=t(C,M),S=I[0],P=I[1],N=S-n,R=P-r,T=m*N-_*R;(T*T/v>e||Zd((_*N+m*R)/v-.5)>.3||s*p+a*f+h*d<Zg)&&(i(n,r,o,s,a,h,S,P,C,x/=b,E/=b,w,g,y),y.point(S,P),i(S,P,C,x,E,w,l,u,c,p,f,d,g,y))}}return function(e){var n,r,o,s,a,h,l,u,c,p,f,d,g={point:y,lineStart:_,lineEnd:v,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=_}};function y(i,n){i=t(i,n),e.point(i[0],i[1])}function _(){u=NaN,g.point=m,e.lineStart()}function m(n,r){var o=fg([n,r]),s=t(n,r);i(u,c,l,p,f,d,u=s[0],c=s[1],l=n,p=o[0],f=o[1],d=o[2],16,e),e.point(u,c)}function v(){g.point=y,e.lineEnd()}function x(){_(),g.point=E,g.lineEnd=w}function E(t,e){m(n=t,e),r=u,o=c,s=p,a=f,h=d,g.point=m}function w(){i(u,c,l,p,f,d,r,o,n,s,a,h,16,e),g.lineEnd=v,v()}return g}}(t,e):function(t){return Wg({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)}var Qg=Wg({point:function(t,e){this.stream.point(t*Hd,e*Hd)}});function $g(t){return function(t){var e,i,n,r,o,s,a,h,l,u,c=150,p=480,f=250,d=0,g=0,y=0,_=0,m=0,v=null,x=Yg,E=null,w=Fg,b=.5,M=Jg(S,b);function C(t){return[(t=o(t[0]*Hd,t[1]*Hd))[0]*c+i,n-t[1]*c]}function I(t){return(t=o.invert((t[0]-i)/c,(n-t[1])/c))&&[t[0]*Kd,t[1]*Kd]}function S(t,r){return[(t=e(t,r))[0]*c+i,n-t[1]*c]}function P(){o=vg(r=function(t,e,i){return(t%=Wd)?e||i?vg(wg(t),bg(e,i)):wg(t):e||i?bg(e,i):xg}(y,_,m),e);var t=e(d,g);return i=p-t[0]*c,n=f+t[1]*c,N()}function N(){return l=u=null,C}return C.stream=function(t){return l&&u===t?l:l=Qg(x(r,M(w(u=t))))},C.clipAngle=function(t){return arguments.length?(x=+t?Vg(v=t*Hd,6*Hd):(v=null,Yg),N()):v*Kd},C.clipExtent=function(t){return arguments.length?(w=null==t?(E=s=a=h=null,Fg):Ag(E=+t[0][0],s=+t[0][1],a=+t[1][0],h=+t[1][1]),N()):null==E?null:[[E,s],[a,h]]},C.scale=function(t){return arguments.length?(c=+t,P()):c},C.translate=function(t){return arguments.length?(p=+t[0],f=+t[1],P()):[p,f]},C.center=function(t){return arguments.length?(d=t[0]%360*Hd,g=t[1]%360*Hd,P()):[d*Kd,g*Kd]},C.rotate=function(t){return arguments.length?(y=t[0]%360*Hd,_=t[1]%360*Hd,m=t.length>2?t[2]%360*Hd:0,P()):[y*Kd,_*Kd,m*Kd]},C.precision=function(t){return arguments.length?(M=Jg(S,b=t*t),N()):eg(b)},C.fitExtent=function(t,e){return Hg(C,t,e)},C.fitSize=function(t,e){return function(t,e,i){return Hg(t,[[0,0],e],i)}(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&I,P()}}((function(){return t}))()}var ty=function(t){return function(e,i){var n=$d(e),r=$d(i),o=t(n*r);return[o*r*tg(e),o*tg(i)]}}((function(t){return(t=ig(t))&&t/tg(t)}));function ey(){return $g(ty).scale(79.4188).clipAngle(179.999)}function iy(t,i,n,r){var s=t.properties||{},a="Feature"===t.type?t.geometry:t;if("GeometryCollection"===a.type){var h=[];return z(t,(function(t){var e=iy(t,i,n,r);e&&h.push(e)})),f(h)}var l=function(t){var i=vi(t).geometry.coordinates,n=[-i[0],-i[1]];return ey().rotate(n).scale(e)}(a),u={type:a.type,coordinates:ry(a.coordinates,l)},c=(new Mc).read(u),p=v(x(i,n),"meters"),d=mf.bufferOp(c,p,r);if(!ny((d=(new Cc).write(d)).coordinates))return o({type:d.type,coordinates:oy(d.coordinates,l)},s)}function ny(t){return Array.isArray(t[0])?ny(t[0]):isNaN(t[0])}function ry(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return ry(t,e)}))}function oy(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return oy(t,e)}))}function sy(t,e,i){void 0===i&&(i={});var n=nt(t),r=nt(e),o=$h.intersection(n.coordinates,r.coordinates);return 0===o.length?null:1===o.length?l(o[0],i.properties):y(o,i.properties)}function ay(t,e,i){void 0===i&&(i={});var n=JSON.stringify(i.properties||{}),r=t[0],o=t[1],s=t[2],a=t[3],h=(o+a)/2,l=(r+s)/2,u=2*e/ve([r,h],[s,h],i)*(s-r),c=2*e/ve([l,o],[l,a],i)*(a-o),p=u/2,d=2*p,g=Math.sqrt(3)/2*c,y=s-r,_=a-o,m=3/4*d,v=g,x=(y-d)/(d-p/2),E=Math.floor(x),w=(E*m-p/2-y)/2-p/2+m/2,b=Math.floor((_-g)/g),M=(_-b*g)/2,C=b*g-_>g/2;C&&(M-=g/4);for(var I=[],S=[],P=0;P<6;P++){var N=2*Math.PI/6*P;I.push(Math.cos(N)),S.push(Math.sin(N))}for(var R=[],T=0;T<=E;T++)for(var L=0;L<=b;L++){var O=T%2==1;if(!(0===L&&O||0===L&&C)){var A=T*m+r-w,D=L*v+o+M;if(O&&(D-=g/2),!0===i.triangles)ly([A,D],u/2,c/2,JSON.parse(n),I,S).forEach((function(t){i.mask?sy(i.mask,t)&&R.push(t):R.push(t)}));else{var F=hy([A,D],u/2,c/2,JSON.parse(n),I,S);i.mask?sy(i.mask,F)&&R.push(F):R.push(F)}}}return f(R)}function hy(t,e,i,n,r,o){for(var s=[],a=0;a<6;a++){var h=t[0]+e*r[a],u=t[1]+i*o[a];s.push([h,u])}return s.push(s[0].slice()),l([s],n)}function ly(t,e,i,n,r,o){for(var s=[],a=0;a<6;a++){var h=[];h.push(t),h.push([t[0]+e*r[a],t[1]+i*o[a]]),h.push([t[0]+e*r[(a+1)%6],t[1]+i*o[(a+1)%6]]),h.push(t),s.push(l([h],n))}return s}function uy(t){return y(t)}function cy(t){return l(t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]])}function py(t,e,i){return void 0===i&&(i={}),function(t,e,i,n){void 0===n&&(n={});for(var r=[],o=t[0],s=t[1],a=t[2],h=t[3],u=e/ve([o,s],[a,s],n)*(a-o),c=i/ve([o,s],[o,h],n)*(h-s),p=a-o,d=h-s,g=Math.floor(p/u),y=Math.floor(d/c),_=(d-y*c)/2,m=o+(p-g*u)/2,v=0;v<g;v++){for(var x=s+_,E=0;E<y;E++){var w=l([[[m,x],[m,x+c],[m+u,x+c],[m+u,x],[m,x]]],n.properties);n.mask?Ps(n.mask,w)&&r.push(w):r.push(w),x+=c}m+=u}return f(r)}(t,e,e,i)}function fy(t,e,i){void 0===i&&(i={});for(var n=[],r=e/ve([t[0],t[1]],[t[2],t[1]],i)*(t[2]-t[0]),o=e/ve([t[0],t[1]],[t[0],t[3]],i)*(t[3]-t[1]),s=0,a=t[0];a<=t[2];){for(var h=0,u=t[1];u<=t[3];){var c=null,p=null;s%2==0&&h%2==0?(c=l([[[a,u],[a,u+o],[a+r,u],[a,u]]],i.properties),p=l([[[a,u+o],[a+r,u+o],[a+r,u],[a,u+o]]],i.properties)):s%2==0&&h%2==1?(c=l([[[a,u],[a+r,u+o],[a+r,u],[a,u]]],i.properties),p=l([[[a,u],[a,u+o],[a+r,u+o],[a,u]]],i.properties)):h%2==0&&s%2==1?(c=l([[[a,u],[a,u+o],[a+r,u+o],[a,u]]],i.properties),p=l([[[a,u],[a+r,u+o],[a+r,u],[a,u]]],i.properties)):h%2==1&&s%2==1&&(c=l([[[a,u],[a,u+o],[a+r,u],[a,u]]],i.properties),p=l([[[a,u+o],[a+r,u+o],[a+r,u],[a,u+o]]],i.properties)),i.mask?(sy(i.mask,c)&&n.push(c),sy(i.mask,p)&&n.push(p)):(n.push(c),n.push(p)),u+=o,h++}s++,a+=r}return f(n)}ty.invert=function(t){return function(e,i){var n=eg(e*e+i*i),r=t(n),o=tg(r),s=$d(r);return[Qd(e*o,n*s),ng(n&&i*o/n)]}}((function(t){return t})),t.along=function(t,e,i){void 0===i&&(i={});for(var n=nt(t).coordinates,r=0,o=0;o<n.length&&!(e>=r&&o===n.length-1);o++){if(r>=e){var s=e-r;if(s){var h=mi(n[o],n[o-1])-180;return yi(n[o],s,h,i)}return a(n[o])}r+=ve(n[o],n[o+1],i)}return a(n[n.length-1])},t.angle=function(t,e,i,n){if(void 0===n&&(n={}),!P(n))throw new Error("options is invalid");if(!t)throw new Error("startPoint is required");if(!e)throw new Error("midPoint is required");if(!i)throw new Error("endPoint is required");var r=t,o=e,s=i,a=w(!0!==n.mercator?mi(r,o):jr(r,o)),h=w(!0!==n.mercator?mi(s,o):jr(s,o)),l=Math.abs(a-h);return!0===n.explementary?360-l:l},t.applyFilter=hh,t.area=Bn,t.areaFactors=r,t.bbox=Z,t.bboxClip=function(t,e){var i=nt(t),n=i.type,r="Feature"===t.type?t.properties:{},o=i.coordinates;switch(n){case"LineString":case"MultiLineString":var s=[];return"LineString"===n&&(o=[o]),o.forEach((function(t){!function(t,e,i){var n,r,o,s,a,h=t.length,l=Lr(t[0],e),u=[];for(i||(i=[]),n=1;n<h;n++){for(s=t[n-1],r=o=Lr(a=t[n],e);;){if(!(l|r)){u.push(s),r!==o?(u.push(a),n<h-1&&(i.push(u),u=[])):n===h-1&&u.push(a);break}if(l&r)break;l?l=Lr(s=Tr(s,a,l,e),e):r=Lr(a=Tr(s,a,r,e),e)}l=o}u.length&&i.push(u)}(t,e,s)})),1===s.length?c(s[0],r):d(s,r);case"Polygon":return l(Or(o,e),r);case"MultiPolygon":return y(o.map((function(t){return Or(t,e)})),r);default:throw new Error("geometry "+n+" not supported")}},t.bboxPolygon=fi,t.bearing=mi,t.bearingToAngle=w,t.bearingToAzimuth=w,t.bezier=pi,t.bezierSpline=pi,t.booleanClockwise=Vr,t.booleanContains=function(t,e){var i=nt(t),n=nt(e),r=i.type,o=n.type,s=i.coordinates,a=n.coordinates;switch(r){case"Point":if("Point"===o)return _s(s,a);throw new Error("feature2 "+o+" geometry not supported");case"MultiPoint":switch(o){case"Point":return function(t,e){var i,n=!1;for(i=0;i<t.coordinates.length;i++)if(_s(t.coordinates[i],e.coordinates)){n=!0;break}return n}(i,n);case"MultiPoint":return function(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){for(var r=n[i],o=!1,s=0,a=t.coordinates;s<a.length;s++)if(_s(r,a[s])){o=!0;break}if(!o)return!1}return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"Point":return Kn(n,i,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var i=!1,n=0,r=e.coordinates;n<r.length;n++){var o=r[n];if(Kn({type:"Point",coordinates:o},t,{ignoreEndVertices:!0})&&(i=!0),!Kn({type:"Point",coordinates:o},t,{ignoreEndVertices:!1}))return!1}return i}(i,n);case"MultiPoint":return function(t,e){for(var i=!1,n=0,r=e.coordinates;n<r.length;n++){var o=r[n];if(Kn(o,t,{ignoreEndVertices:!0})&&(i=!0),!Kn(o,t))return!1}return!!i}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Point":return ye(n,i,{ignoreBoundary:!0});case"LineString":return function(t,e){var i=!1,n=0;if(!ys(Z(t),Z(e)))return!1;for(;n<e.coordinates.length-1;n++)if(ye({type:"Point",coordinates:ms(e.coordinates[n],e.coordinates[n+1])},t,{ignoreBoundary:!0})){i=!0;break}return i}(i,n);case"Polygon":return function(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;if(!ys(Z(t),Z(e)))return!1;for(var i=0,n=nt(e).coordinates;i<n.length;i++)for(var r=0,o=n[i];r<o.length;r++)if(!ye(o[r],t))return!1;return!0}(i,n);case"MultiPoint":return function(t,e){for(var i=0,n=e.coordinates;i<n.length;i++)if(!ye(n[i],t,{ignoreBoundary:!0}))return!1;return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}},t.booleanCrosses=function(t,e){var i=nt(t),n=nt(e),r=i.type,o=n.type;switch(r){case"MultiPoint":switch(o){case"LineString":return vs(i,n);case"Polygon":return Es(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"MultiPoint":return vs(n,i);case"LineString":return function(t,e){if(Tn(t,e).features.length>0)for(var i=0;i<t.coordinates.length-1;i++)for(var n=0;n<e.coordinates.length-1;n++){var r=!0;if(0!==n&&n!==e.coordinates.length-2||(r=!1),ws(t.coordinates[i],t.coordinates[i+1],e.coordinates[n],r))return!0}return!1}(i,n);case"Polygon":return xs(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"MultiPoint":return Es(n,i);case"LineString":return xs(n,i);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}},t.booleanDisjoint=ps,t.booleanEqual=function(t,e){return nt(t).type===nt(e).type&&new Ss({precision:6}).compare(ti(t),ti(e))},t.booleanIntersects=Ps,t.booleanOverlap=function(t,e){var i=nt(t),n=nt(e),r=i.type,o=n.type;if("MultiPoint"===r&&"MultiPoint"!==o||("LineString"===r||"MultiLineString"===r)&&"LineString"!==o&&"MultiLineString"!==o||("Polygon"===r||"MultiPolygon"===r)&&"Polygon"!==o&&"MultiPolygon"!==o)throw new Error("features must be of the same type");if("Point"===r)throw new Error("Point geometry not supported");if(new Ss({precision:6}).compare(t,e))return!1;var s=0;switch(r){case"MultiPoint":for(var a=0;a<i.coordinates.length;a++)for(var h=0;h<n.coordinates.length;h++){var l=i.coordinates[a],u=n.coordinates[h];if(l[0]===u[0]&&l[1]===u[1])return!0}return!1;case"LineString":case"MultiLineString":U(t,(function(t){U(e,(function(e){kr(t,e).features.length&&s++}))}));break;case"Polygon":case"MultiPolygon":U(t,(function(t){U(e,(function(e){Tn(t,e).features.length&&s++}))}))}return s>0},t.booleanParallel=function(t,e){if(!t)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");if("LineString"!==Us(t,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==Us(e,"line2"))throw new Error("line2 must be a LineString");for(var i=Hi(ti(t)).features,n=Hi(ti(e)).features,r=0;r<i.length;r++){var o=i[r].geometry.coordinates;if(!n[r])break;if(!Bs(o,n[r].geometry.coordinates))return!1}return!0},t.booleanPointInPolygon=ye,t.booleanPointOnLine=Kn,t.booleanWithin=Zn,t.buffer=function(t,e,i){var n=(i=i||{}).units||"kilometers",r=i.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof i)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");var o=[];switch(t.type){case"GeometryCollection":return z(t,(function(t){var i=iy(t,e,n,r);i&&o.push(i)})),f(o);case"FeatureCollection":return F(t,(function(t){var i=iy(t,e,n,r);i&&F(i,(function(t){t&&o.push(t)}))})),f(o)}return iy(t,e,n,r)},t.center=vi,t.centerMean=Fa,t.centerMedian=function(t,e){if(void 0===e&&(e={}),!P(e=e||{}))throw new Error("options is invalid");var i=e.counter||10;if(!S(i))throw new Error("counter must be a number");var n=e.weight,r=Fa(t,{weight:e.weight}),o=f([]);F(t,(function(t){var e;o.features.push(xi(t,{properties:{weight:null===(e=t.properties)||void 0===e?void 0:e[n]}}))}));var s={tolerance:e.tolerance,medianCandidates:[]};return ka(r.geometry.coordinates,[0,0],o,s,i)},t.centerOfMass=function t(e,i){switch(void 0===i&&(i={}),rt(e)){case"Point":return a(J(e),i.properties);case"Polygon":var n=[];L(e,(function(t){n.push(t)}));var r,o,s,h,l,u,c,p,f=xi(e,{properties:i.properties}),d=f.geometry.coordinates,g=0,y=0,_=0,m=n.map((function(t){return[t[0]-d[0],t[1]-d[1]]}));for(r=0;r<n.length-1;r++)h=(o=m[r])[0],u=o[1],l=(s=m[r+1])[0],_+=p=h*(c=s[1])-l*u,g+=(h+l)*p,y+=(u+c)*p;if(0===_)return f;var v=1/(.5*_*6);return a([d[0]+v*g,d[1]+v*y],i.properties);default:var x=ge(e);return x?t(x,{properties:i.properties}):xi(e,{properties:i.properties})}},t.centroid=xi,t.circle=_i,t.cleanCoords=ti,t.clone=Me,t.clusterEach=oh,t.clusterReduce=sh,t.clusters=ch,t.clustersDbscan=function(t,e,i){void 0===i&&(i={}),!0!==i.mutate&&(t=Me(t)),i.minPoints=i.minPoints||3;var n=new Os.DBSCAN,r=n.run(G(t),C(e,i.units),i.minPoints,ve),o=-1;return r.forEach((function(e){o++,e.forEach((function(e){var i=t.features[e];i.properties||(i.properties={}),i.properties.cluster=o,i.properties.dbscan="core"}))})),n.noise.forEach((function(e){var i=t.features[e];i.properties||(i.properties={}),i.properties.cluster?i.properties.dbscan="edge":i.properties.dbscan="noise"})),t},t.clustersKmeans=function(t,e){void 0===e&&(e={});var i=t.features.length;e.numberOfClusters=e.numberOfClusters||Math.round(Math.sqrt(i/2)),e.numberOfClusters>i&&(e.numberOfClusters=i),!0!==e.mutate&&(t=Me(t));var n=G(t),r=n.slice(0,e.numberOfClusters),o=qs(n,e.numberOfClusters,r),s={};return o.centroids.forEach((function(t,e){s[e]=t})),F(t,(function(t,e){var i=o.idxs[e];t.properties.cluster=i,t.properties.centroid=s[i]})),t},t.collect=function(t,e,i,n){var r=Ct(6),o=e.features.map((function(t){var e;return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:null===(e=t.properties)||void 0===e?void 0:e[i]}}));return r.load(o),t.features.forEach((function(t){t.properties||(t.properties={});var e=Z(t),i=r.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}),o=[];i.forEach((function(e){ye([e.minX,e.minY],t)&&o.push(e.property)})),t.properties[n]=o})),t},t.collectionOf=it,t.combine=function(t){var e={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return F(t,(function(t){var i,n,r,o;switch(null===(o=t.geometry)||void 0===o?void 0:o.type){case"Point":e.MultiPoint.coordinates.push(t.geometry.coordinates),e.MultiPoint.properties.push(t.properties);break;case"MultiPoint":(i=e.MultiPoint.coordinates).push.apply(i,t.geometry.coordinates),e.MultiPoint.properties.push(t.properties);break;case"LineString":e.MultiLineString.coordinates.push(t.geometry.coordinates),e.MultiLineString.properties.push(t.properties);break;case"MultiLineString":(n=e.MultiLineString.coordinates).push.apply(n,t.geometry.coordinates),e.MultiLineString.properties.push(t.properties);break;case"Polygon":e.MultiPolygon.coordinates.push(t.geometry.coordinates),e.MultiPolygon.properties.push(t.properties);break;case"MultiPolygon":(r=e.MultiPolygon.coordinates).push.apply(r,t.geometry.coordinates),e.MultiPolygon.properties.push(t.properties)}})),f(Object.keys(e).filter((function(t){return e[t].coordinates.length})).sort().map((function(t){return o({type:t,coordinates:e[t].coordinates},{collectedProperties:e[t].properties})})))},t.concave=function(t,e){void 0===e&&(e={});var i=e.maxEdge||1/0,n=xe(function(t){var e=[],i={};return F(t,(function(t){if(t.geometry){var n=t.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(i,n)||(e.push(t),i[n]=!0)}})),f(e)}(t));if(n.features=n.features.filter((function(t){var n=t.geometry.coordinates[0][0],r=t.geometry.coordinates[0][1],o=t.geometry.coordinates[0][2],s=ve(n,r,e),a=ve(r,o,e),h=ve(n,o,e);return s<=i&&a<=i&&h<=i})),n.features.length<1)return null;var r=$e(n);return 1===r.coordinates.length&&(r.coordinates=r.coordinates[0],r.type="Polygon"),o(r)},t.containsNumber=$,t.convertArea=I,t.convertDistance=C,t.convertLength=C,t.convex=ge,t.coordAll=G,t.coordEach=L,t.coordReduce=O,t.createBins=ah,t.degrees2radians=M,t.degreesToRadians=M,t.destination=yi,t.difference=function(t,e){var i=nt(t),n=nt(e),r=t.properties||{},o=$h.difference(i.coordinates,n.coordinates);return 0===o.length?null:1===o.length?l(o[0],r):y(o,r)},t.dissolve=function(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.propertyName;it(t,"Polygon","dissolve");var n=[];if(!e.propertyName)return ir(y($h.union.apply(null,t.features.map((function(t){return t.geometry.coordinates})))));var r={};F(t,(function(t){Object.prototype.hasOwnProperty.call(r,t.properties[i])||(r[t.properties[i]]=[]),r[t.properties[i]].push(t)}));for(var o=Object.keys(r),s=0;s<o.length;s++){var a=y($h.union.apply(null,r[o[s]].map((function(t){return t.geometry.coordinates}))));a.properties[i]=o[s],n.push(a)}return ir(f(n))},t.distance=ve,t.distanceToDegrees=E,t.distanceToRadians=x,t.distanceWeight=Ba,t.earthRadius=e,t.ellipse=Aa,t.envelope=di,t.explode=Ei,t.factors=i,t.feature=o,t.featureCollection=f,t.featureEach=F,t.featureOf=et,t.featureReduce=k,t.filterProperties=uh,t.findPoint=K,t.findSegment=W,t.flatten=ir,t.flattenEach=q,t.flattenReduce=B,t.flip=function(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.mutate;if(!t)throw new Error("geojson is required");return!1!==i&&void 0!==i||(t=Me(t)),L(t,(function(t){var e=t[0],i=t[1];t[0]=i,t[1]=e})),t},t.geojsonType=tt,t.geomEach=z,t.geomReduce=j,t.geometry=s,t.geometryCollection=_,t.getCluster=rh,t.getCoord=J,t.getCoords=Q,t.getGeom=nt,t.getType=rt,t.greatCircle=function(t,e,i){if("object"!=typeof(i=i||{}))throw new Error("options is invalid");var n=i.properties,r=i.npoints,o=i.offset;return t=J(t),e=J(e),n=n||{},r=r||100,o=o||10,new _r({x:t[0],y:t[1]},{x:e[0],y:e[1]},n).Arc(r,{offset:o}).json()},t.helpers=T,t.hexGrid=ay,t.inside=ye,t.interpolate=function(t,e,i){if("object"!=typeof(i=i||{}))throw new Error("options is invalid");var n=i.gridType,r=i.property,o=i.weight;if(!t)throw new Error("points is required");if(it(t,"Point","input must contain Points"),!e)throw new Error("cellSize is required");if(void 0!==o&&"number"!=typeof o)throw new Error("weight must be a number");r=r||"elevation",n=n||"square",o=o||1;var s,a=Z(t);switch(n){case"point":case"points":s=tr(a,e,i);break;case"square":case"squares":s=py(a,e,i);break;case"hex":case"hexes":s=ay(a,e,i);break;case"triangle":case"triangles":s=fy(a,e,i);break;default:throw new Error("invalid gridType")}var h=[];return F(s,(function(e){var s=0,a=0;F(t,(function(t){var h,l=ve("point"===n?e:xi(e),t,i);if(void 0!==r&&(h=t.properties[r]),void 0===h&&(h=t.geometry.coordinates[2]),void 0===h)throw new Error("zValue is missing");0===l&&(s=h);var u=1/Math.pow(l,o);a+=u,s+=u*h}));var l=Me(e);l.properties[r]=s/a,h.push(l)})),f(h)},t.intersect=sy,t.invariant=ot,t.isNumber=S,t.isObject=P,t.isobands=function(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.zProperty||"elevation",r=i.commonProperties||{},o=i.breaksProperties||[];if(it(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!P(r))throw new Error("commonProperties is not an Object");if(!Array.isArray(o))throw new Error("breaksProperties is not an Array");var s=Zr(t,{zProperty:n,flip:!0}),a=function(t,e,i){for(var n=[],r=1;r<e.length;r++){var o=+e[r-1],s=+e[r],a=Zo(Ho($r(t,o,s-o))),h={};h.groupedRings=a,h[i]=o+"-"+s,n.push(h)}return n}(s,e,n);return f((a=function(t,e,i){var n=Z(i),r=n[2]-n[0],o=n[3]-n[1],s=n[0],a=n[1],h=e[0].length-1,l=e.length-1,u=r/h,c=o/l,p=function(t){t[0]=t[0]*u+s,t[1]=t[1]*c+a};return t.forEach((function(t){t.groupedRings.forEach((function(t){t.forEach((function(t){t.forEach(p)}))}))})),t}(a,s,t)).map((function(t,e){if(o[e]&&!P(o[e]))throw new Error("Each mappedProperty is required to be an Object");var i=ut({},r,o[e]);return i[n]=t[n],y(t.groupedRings,i)})))},t.isolines=function(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.zProperty||"elevation",r=i.commonProperties||{},o=i.breaksProperties||[];if(it(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!P(r))throw new Error("commonProperties must be an Object");if(!Array.isArray(o))throw new Error("breaksProperties must be an Array");var s=mt(t,{zProperty:n,flip:!0});return f(function(t,e,i){var n=Z(i),r=n[2]-n[0],o=n[3]-n[1],s=n[0],a=n[1],h=e[0].length-1,l=e.length-1,u=r/h,c=o/l,p=function(t){t[0]=t[0]*u+s,t[1]=t[1]*c+a};return t.forEach((function(t){L(t,p)})),t}(function(t,e,i,n,r){for(var o=[],s=1;s<e.length;s++){var a=+e[s],h=ut({},n,r[s]);h[i]=a;var l=d(ft(t,a),h);o.push(l)}return o}(s,e,n,r,o),s,t))},t.kinks=function(t){var e,i,n={type:"FeatureCollection",features:[]};if("LineString"===(i="Feature"===t.type?t.geometry:t).type)e=[i.coordinates];else if("MultiLineString"===i.type)e=i.coordinates;else if("MultiPolygon"===i.type)e=[].concat.apply([],i.coordinates);else{if("Polygon"!==i.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=i.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var i=0;i<t.length-1;i++)for(var r=i;r<e.length-1;r++){if(t===e){if(1===Math.abs(i-r))continue;if(0===i&&r===t.length-2&&t[i][0]===t[t.length-1][0]&&t[i][1]===t[t.length-1][1])continue}var o=Gn(t[i][0],t[i][1],t[i+1][0],t[i+1][1],e[r][0],e[r][1],e[r+1][0],e[r+1][1]);o&&n.features.push(a([o[0],o[1]]))}}))})),n},t.length=Vn,t.lengthToDegrees=E,t.lengthToRadians=x,t.lineArc=wr,t.lineChunk=function(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.units,r=i.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var o=[];return q(t,(function(t){r&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,i,n){var r=Vn(t,{units:i});if(r<=e)return n(t);var o=r/e;Number.isInteger(o)||(o=Math.floor(o)+1);for(var s=0;s<o;s++)n(Wn(t,e*s,e*(s+1),{units:i}),s)}(t,e,n,(function(t){o.push(t)}))})),f(o)},t.lineDistance=Vn,t.lineEach=Y,t.lineIntersect=Tn,t.lineOffset=function(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.units;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");var r=rt(t),o=t.properties;switch(r){case"LineString":return os(t,e,n);case"MultiLineString":var s=[];return q(t,(function(t){s.push(os(t,e,n).geometry.coordinates)})),d(s,o);default:throw new Error("geometry "+r+" is not supported")}},t.lineOverlap=kr,t.lineReduce=V,t.lineSegment=Hi,t.lineSlice=function(t,e,i){var n=Q(i);if("LineString"!==rt(i))throw new Error("line must be a LineString");for(var r,o=On(i,t),s=On(i,e),a=[(r=o.properties.index<=s.properties.index?[o,s]:[s,o])[0].geometry.coordinates],h=r[0].properties.index+1;h<r[1].properties.index+1;h++)a.push(n[h]);return a.push(r[1].geometry.coordinates),c(a,i.properties)},t.lineSliceAlong=Wn,t.lineSplit=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var i=rt(t),n=rt(e);if("LineString"!==i)throw new Error("line must be LineString");if("FeatureCollection"===n)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===n)throw new Error("splitter cannot be a GeometryCollection");var r=er(e,{precision:7});switch(n){case"Point":return vr(t,r);case"MultiPoint":return mr(t,r);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return mr(t,Tn(t,r))}},t.lineString=c,t.lineStringToPolygon=Sr,t.lineStrings=p,t.lineToPolygon=Sr,t.mask=function(t,e){var i,n=cy(e);return("FeatureCollection"===t.type?uy(2===(i=t).features.length?$h.union(i.features[0].geometry.coordinates,i.features[1].geometry.coordinates):$h.union.apply($h,i.features.map((function(t){return t.geometry.coordinates})))):uy($h.union(t.geometry.coordinates))).geometry.coordinates.forEach((function(t){n.geometry.coordinates.push(t[0])})),n},t.meta=H,t.midpoint=function(t,e){return yi(t,ve(t,e)/2,mi(t,e))},t.moranIndex=function(t,e){var i=e.inputField,n=e.threshold||1e5,r=e.p||2,o=e.binary||!1,s=Ba(t,{alpha:e.alpha||-1,binary:o,p:r,standardization:e.standardization||!0,threshold:n}),a=[];F(t,(function(t){var e=t.properties||{};a.push(e[i])}));for(var h=Ua(a),l=function(t){for(var e=Ua(t),i=0,n=0,r=t;n<r.length;n++){var o=r[n];i+=Math.pow(o-e,2)}return i/t.length}(a),u=0,c=0,p=0,f=0,d=s.length,g=0;g<d;g++){for(var y=0,_=0;_<d;_++)u+=s[g][_]*(a[g]-h)*(a[_]-h),c+=s[g][_],p+=Math.pow(s[g][_]+s[_][g],2),y+=s[g][_]+s[_][g];f+=Math.pow(y,2)}var m=u/c/l,v=-1/(d-1),x=(d*d*(p*=.5)-d*f+c*c*3)/((d-1)*(d+1)*(c*c))-v*v,E=Math.sqrt(x);return{expectedMoranIndex:v,moranIndex:m,stdNorm:E,zNorm:(m-v)/E}},t.multiLineString=d,t.multiPoint=g,t.multiPolygon=y,t.nearest=Ki,t.nearestPoint=Ki,t.nearestPointOnLine=On,t.nearestPointToLine=function(t,e,i){void 0===i&&(i={});var n=i.units,r=i.properties||{},o=function(t){var e=[];switch(t.geometry?t.geometry.type:t.type){case"GeometryCollection":return z(t,(function(t){"Point"===t.type&&e.push({type:"Feature",properties:{},geometry:t})})),{type:"FeatureCollection",features:e};case"FeatureCollection":return t.features=t.features.filter((function(t){return"Point"===t.geometry.type})),t;default:throw new Error("points must be a Point Collection")}}(t);if(!o.features.length)throw new Error("points must contain features");if(!e)throw new Error("line is required");if("LineString"!==rt(e))throw new Error("line must be a LineString");var s=1/0,a=null;return F(o,(function(t){var i=Dn(t,e,{units:n});i<s&&(s=i,a=t)})),a&&(a.properties=ut({dist:s},a.properties,r)),a},t.planepoint=function(t,e){var i=J(t),n=nt(e).coordinates[0];if(n.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var r=e.properties||{},o=r.a,s=r.b,a=r.c,h=i[0],l=i[1],u=n[0][0],c=n[0][1],p=void 0!==o?o:n[0][2],f=n[1][0],d=n[1][1],g=void 0!==s?s:n[1][2],y=n[2][0],_=n[2][1],m=void 0!==a?a:n[2][2];return(m*(h-u)*(l-d)+p*(h-f)*(l-_)+g*(h-y)*(l-c)-g*(h-u)*(l-_)-m*(h-f)*(l-c)-p*(h-y)*(l-d))/((h-u)*(l-d)+(h-f)*(l-_)+(h-y)*(l-c)-(h-u)*(l-_)-(h-f)*(l-c)-(h-y)*(l-d))},t.point=a,t.pointGrid=tr,t.pointOnFeature=zn,t.pointOnLine=On,t.pointOnSurface=zn,t.pointToLineDistance=Dn,t.points=h,t.pointsWithinPolygon=me,t.polygon=l,t.polygonSmooth=function(t,e){var i=[],n=e.iterations||1;if(!t)throw new Error("inputPolys is required");return z(t,(function(t,e,r){var o,s,a;switch(t.type){case"Polygon":o=[[]];for(var h=0;h<n;h++)a=[[]],s=t,h>0&&(s=l(o).geometry),za(s,a),o=a.slice(0);i.push(l(o,r));break;case"MultiPolygon":o=[[[]]];for(var u=0;u<n;u++)a=[[[]]],s=t,u>0&&(s=y(o).geometry),ja(s,a),o=a.slice(0);i.push(y(o,r));break;default:throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}})),f(i)},t.polygonTangents=function(t,e){var i,n,r,o,s=Q(t),h=Q(e),l=Z(e),u=0,c=null;switch(s[0]>l[0]&&s[0]<l[2]&&s[1]>l[1]&&s[1]<l[3]&&(u=(c=Ki(t,Ei(e))).properties.featureIndex),rt(e)){case"Polygon":i=h[0][u],n=h[0][0],null!==c&&c.geometry.coordinates[1]<s[1]&&(n=h[0][u]),o=Yr(h[0][0],h[0][h[0].length-1],s);var p=Ur(h[0],s,o,r,i,n);i=p[0],n=p[1];break;case"MultiPolygon":for(var d=0,g=0,y=0,_=0;_<h[0].length;_++){d=_;for(var m=!1,v=0;v<h[0][_].length;v++){if(g=v,y===u){m=!0;break}y++}if(m)break}i=h[0][d][g],n=h[0][d][g],o=Yr(h[0][0][0],h[0][0][h[0][0].length-1],s),h.forEach((function(t){var e=Ur(t[0],s,o,r,i,n);i=e[0],n=e[1]}))}return f([a(i),a(n)])},t.polygonToLine=Mr,t.polygonToLineString=Mr,t.polygonize=function(t){var e=cs.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var i=[],n=[];return e.getEdgeRings().filter((function(t){return t.isValid()})).forEach((function(t){t.isHole()?i.push(t):n.push(t)})),i.forEach((function(t){us.findEdgeRingContaining(t,n)&&n.push(t)})),f(n.map((function(t){return t.toPolygon()})))},t.polygons=u,t.projection=Ha,t.propEach=A,t.propReduce=D,t.propertiesContainsFilter=lh,t.radians2degrees=b,t.radiansToDegrees=b,t.radiansToDistance=v,t.radiansToLength=v,t.random=nh,t.randomLineString=th,t.randomPoint=Qa,t.randomPolygon=$a,t.randomPosition=Ja,t.rewind=function(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.reverse||!1,n=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof i)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof n)throw new Error("<mutate> must be a boolean");!1===n&&(t=Me(t));var r=[];switch(t.type){case"GeometryCollection":return z(t,(function(t){Wr(t,i)})),t;case"FeatureCollection":return F(t,(function(t){F(Wr(t,i),(function(t){r.push(t)}))})),f(r)}return Wr(t,i)},t.rhumbBearing=jr,t.rhumbDestination=Br,t.rhumbDistance=An,t.round=m,t.sample=function(t,e){if(!t)throw new Error("featurecollection is required");if(null==e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return f(function(t,e){for(var i,n,r=t.slice(0),o=t.length,s=o-e;o-- >s;)i=r[n=Math.floor((o+1)*Math.random())],r[n]=r[o],r[o]=i;return r.slice(s)}(t.features,e))},t.sector=function(t,e,i,n,r){if(!P(r=r||{}))throw new Error("options is invalid");var o=r.properties;if(!t)throw new Error("center is required");if(null==i)throw new Error("bearing1 is required");if(null==n)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof r)throw new Error("options must be an object");if(zr(i)===zr(n))return _i(t,e,r);var s=Q(t),a=wr(t,e,i,n,r),h=[[s]];return L(a,(function(t){h[0].push(t)})),h[0].push(s),l(h,o)},t.segmentEach=U,t.segmentReduce=X,t.shortestPath=function(t,e,i){if(!P(i=i||{}))throw new Error("options is invalid");var n=i.resolution,r=i.minDistance,s=i.obstacles||f([]);if(!t)throw new Error("start is required");if(!e)throw new Error("end is required");if(n&&!S(n)||n<=0)throw new Error("options.resolution must be a number, greater than 0");if(r)throw new Error("options.minDistance is not yet implemented");var h=J(t),l=J(e);switch(t=a(h),e=a(l),rt(s)){case"FeatureCollection":if(0===s.features.length)return c([h,l]);break;case"Polygon":s=f([o(nt(s))]);break;default:throw new Error("invalid obstacles")}var u=s;u.features.push(t),u.features.push(e);var p=Z(ts(fi(Z(u)),1.15));n||(n=ve([p[0],p[1]],[p[2],p[1]],i)/100),u.features.pop(),u.features.pop();for(var d=p[0],g=p[1],y=p[2],_=p[3],m=n/ve([d,g],[y,g],i)*(y-d),v=n/ve([d,g],[d,_],i)*(_-g),x=y-d,E=_-g,w=Math.floor(x/m),b=Math.floor(E/v),M=(x-w*m)/2,C=[],I=[],N=[],R=[],T=1/0,L=1/0,O=_-(E-b*v)/2,A=0;O>=g;){for(var D=[],F=[],k=d+M,G=0;k<=y;){var z=a([k,O]),j=Hs(z,s);D.push(j?0:1),F.push(k+"|"+O);var q=ve(z,t);!j&&q<T&&(T=q,N={x:G,y:A});var B=ve(z,e);!j&&B<L&&(L=B,R={x:G,y:A}),k+=m,G++}I.push(D),C.push(F),O-=v,A++}var U=new Vs(I,{diagonal:!0}),X=U.grid[N.y][N.x],Y=U.grid[R.y][R.x],V=Ys.search(U,X,Y),W=[h];return V.forEach((function(t){var e=C[t.x][t.y].split("|");W.push([+e[0],+e[1]])})),W.push(l),ti(c(W))},t.simplify=function(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=void 0!==e.tolerance?e.tolerance:1,n=e.highQuality||!1,r=e.mutate||!1;if(!t)throw new Error("geojson is required");if(i&&i<0)throw new Error("invalid tolerance");return!0!==r&&(t=Me(t)),z(t,(function(t){!function(t,e,i){var n=t.type;if("Point"===n||"MultiPoint"===n)return t;ti(t,!0);var r=t.coordinates;switch(n){case"LineString":t.coordinates=hi(r,e,i);break;case"MultiLineString":t.coordinates=r.map((function(t){return hi(t,e,i)}));break;case"Polygon":t.coordinates=li(r,e,i);break;case"MultiPolygon":t.coordinates=r.map((function(t){return li(t,e,i)}))}}(t,i,n)})),t},t.square=gi,t.squareGrid=py,t.standardDeviationalEllipse=function(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.steps||64,n=e.weight,r=e.properties||{};if(!S(i))throw new Error("steps must be a number");if(!P(r))throw new Error("properties must be a number");var o=G(t).length,s=Fa(t,{weight:n}),a=0,h=0,l=0;F(t,(function(t){var e=t.properties[n]||1,i=Ga(Q(t),Q(s));a+=Math.pow(i.x,2)*e,h+=Math.pow(i.y,2)*e,l+=i.x*i.y*e}));var u=a-h,c=Math.sqrt(Math.pow(u,2)+4*Math.pow(l,2)),p=2*l,d=Math.atan((u+c)/p),g=180*d/Math.PI,y=0,_=0,m=0;F(t,(function(t){var e=t.properties[n]||1,i=Ga(Q(t),Q(s));y+=Math.pow(i.x*Math.cos(d)-i.y*Math.sin(d),2)*e,_+=Math.pow(i.x*Math.sin(d)+i.y*Math.cos(d),2)*e,m+=e}));var v=Math.sqrt(2*y/m),x=Math.sqrt(2*_/m),E=Aa(s,v,x,{units:"degrees",angle:g,steps:i,properties:r}),w=me(t,f([E])),b={meanCenterCoordinates:Q(s),semiMajorAxis:v,semiMinorAxis:x,numberOfFeatures:o,angle:g,percentageWithinEllipse:100*G(w).length/o};return E.properties.standardDeviationalEllipse=b,E},t.tag=function(t,e,i,n){return t=Me(t),e=Me(e),F(t,(function(t){t.properties||(t.properties={}),F(e,(function(e){void 0===t.properties[n]&&ye(t,e)&&(t.properties[n]=e.properties[i])}))})),t},t.tesselate=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=Wi(t.geometry.coordinates):t.geometry.coordinates.forEach((function(t){e.features=e.features.concat(Wi(t))})),e},t.tin=xe,t.toMercator=Xa,t.toWgs84=Ya,t.transformRotate=$o,t.transformScale=ts,t.transformTranslate=function(t,e,i,n){if(!P(n=n||{}))throw new Error("options is invalid");var r=n.units,o=n.zTranslation,s=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(o&&"number"!=typeof o&&isNaN(o))throw new Error("zTranslation is not a number");if(o=void 0!==o?o:0,0===e&&0===o)return t;if(null==i||isNaN(i))throw new Error("direction is required");return e<0&&(e=-e,i+=180),!1!==s&&void 0!==s||(t=Me(t)),L(t,(function(t){var n=Q(Br(t,e,i,{units:r}));t[0]=n[0],t[1]=n[1],o&&3===t.length&&(t[2]+=o)})),t},t.triangleGrid=fy,t.truncate=er,t.union=function(t,e,i){void 0===i&&(i={});var n=nt(t),r=nt(e),o=$h.union(n.coordinates,r.coordinates);return 0===o.length?null:1===o.length?l(o[0],i.properties):y(o,i.properties)},t.unitsFactors=n,t.unkinkPolygon=function(t){var e=[];return q(t,(function(t){"Polygon"===t.geometry.type&&F(or(t),(function(i){e.push(l(i.geometry.coordinates,t.properties))}))})),f(e)},t.validateBBox=N,t.validateId=R,t.voronoi=function(t,e){if(!P(e=e||{}))throw new Error("options is invalid");var i=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(i))throw new Error("bbox is invalid");return it(t,"Point","points"),f(function(){var t=Js,e=Qs,i=null;function n(n){return new La(n.map((function(i,r){var o=[Math.round(t(i,r,n)/Na)*Na,Math.round(e(i,r,n)/Na)*Na];return o.index=r,o.data=i,o})),i)}return n.polygons=function(t){return n(t).polygons()},n.links=function(t){return n(t).links()},n.triangles=function(t){return n(t).triangles()},n.x=function(e){return arguments.length?(t="function"==typeof e?e:Zs(+e),n):t},n.y=function(t){return arguments.length?(e="function"==typeof t?t:Zs(+t),n):e},n.extent=function(t){return arguments.length?(i=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],n):i&&[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},n.size=function(t){return arguments.length?(i=null==t?null:[[0,0],[+t[0],+t[1]]],n):i&&[i[1][0]-i[0][0],i[1][1]-i[0][1]]},n}().x((function(t){return t.geometry.coordinates[0]})).y((function(t){return t.geometry.coordinates[1]})).extent([[i[0],i[1]],[i[2],i[3]]]).polygons(t.features).map(Oa))},t.within=me,Object.defineProperty(t,"__esModule",{value:!0})}(n);var y={};(y=v).parse=v,y.stringify=function t(e){"Feature"===e.type&&(e=e.geometry);function i(t){return t.join(" ")}function n(t){return t.map(i).join(", ")}function r(t){return t.map(n).map(o).join(", ")}function o(t){return"("+t+")"}switch(e.type){case"Point":return"POINT ("+i(e.coordinates)+")";case"LineString":return"LINESTRING ("+n(e.coordinates)+")";case"Polygon":return"POLYGON ("+r(e.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+n(e.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+(e.coordinates.map(r).map(o).join(", ")+")");case"MultiLineString":return"MULTILINESTRING ("+r(e.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+e.geometries.map(t).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};var _=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,m=new RegExp("^"+_.source+"(\\s"+_.source+"){1,}");function v(t){var e,i=t.split(";"),n=i.pop(),r=(i.shift()||"").split("=").pop(),o=0;function s(t){var e=n.substring(o).match(t);return e?(o+=e[0].length,e[0]):null}function a(){s(/^\s*/)}function h(){a();for(var t,e=0,i=[],n=[i],r=i;t=s(/^(\()/)||s(/^(\))/)||s(/^(,)/)||s(m);){if("("===t)n.push(r),r=[],n[n.length-1].push(r),e++;else if(")"===t){if(0===r.length)return null;if(!(r=n.pop()))return null;if(0===--e)break}else if(","===t)r=[],n[n.length-1].push(r);else{if(t.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(r,t.split(/\s/g).map(parseFloat))}a()}return 0!==e?null:i}function l(){for(var t,e,i=[];e=s(m)||s(/^(,)/);)","===e?(i.push(t),t=[]):e.split(/\s/g).some(isNaN)||(t||(t=[]),Array.prototype.push.apply(t,e.split(/\s/g).map(parseFloat))),a();return t?(i.push(t),i.length?i:null):null}function u(){return function(){if(!s(/^(point(\sz)?)/i))return null;if(a(),!s(/^(\()/))return null;var t=l();return t?(a(),s(/^(\))/)?{type:"Point",coordinates:t[0]}:null):null}()||function(){if(!s(/^(linestring(\sz)?)/i))return null;if(a(),!s(/^(\()/))return null;var t=l();return t&&s(/^(\))/)?{type:"LineString",coordinates:t}:null}()||function(){if(!s(/^(polygon(\sz)?)/i))return null;a();var t=h();return t?{type:"Polygon",coordinates:t}:null}()||function(){if(!s(/^(multipoint)/i))return null;a();var t=n.substring(n.indexOf("(")+1,n.length-1).replace(/\(/g,"").replace(/\)/g,"");n="MULTIPOINT ("+t+")";var e=h();return e?(a(),{type:"MultiPoint",coordinates:e}):null}()||function(){if(!s(/^(multilinestring)/i))return null;a();var t=h();return t?(a(),{type:"MultiLineString",coordinates:t}):null}()||function(){if(!s(/^(multipolygon)/i))return null;a();var t=h();return t?{type:"MultiPolygon",coordinates:t}:null}()||function(){var t,e=[];if(!s(/^(geometrycollection)/i))return null;if(a(),!s(/^(\()/))return null;for(;t=u();)e.push(t),a(),s(/^(,)/),a();return s(/^(\))/)?{type:"GeometryCollection",geometries:e}:null}()}return(e=u())&&r.match(/\d+/)&&(e.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+r}}),e}var x=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},E={PROPERTYCHANGE:"propertychange"};var w=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function b(t,e,i){let n,r;i=i||M;let o=0,s=t.length,a=!1;for(;o<s;)n=o+(s-o>>1),r=+i(t[n],e),r<0?o=n+1:(s=n,a=!r);return a?o:~o}function M(t,e){return t>e?1:t<e?-1:0}function C(t,e,i){const n=t.length;if(t[0]<=e)return 0;if(e<=t[n-1])return n-1;let r;if(i>0){for(r=1;r<n;++r)if(t[r]<e)return r-1}else if(i<0){for(r=1;r<n;++r)if(t[r]<=e)return r}else for(r=1;r<n;++r){if(t[r]==e)return r;if(t[r]<e)return"function"==typeof i?i(e,t[r-1],t[r])>0?r-1:r:t[r-1]-e<e-t[r]?r-1:r}return n-1}function I(t,e,i){for(;e<i;){const n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function S(t,e){const i=Array.isArray(e)?e:[e],n=i.length;for(let e=0;e<n;e++)t[t.length]=i[e]}function P(t,e){const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function N(t,e,i){const n=e||M;return t.every((function(e,r){if(0===r)return!0;const o=n(t[r-1],e);return!(o>0||i&&0===o)}))}function R(){return!0}function T(){return!1}function L(){}function O(t){let e,i,n,r=!1;return function(){const o=Array.prototype.slice.call(arguments);return r&&this===n&&P(o,i)||(r=!0,n=this,i=o,e=t.apply(this,arguments)),e}}function A(t){for(const e in t)delete t[e]}function D(t){let e;for(e in t)return!1;return!e}var F=class extends w{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e="string"==typeof t,i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const r=e?new x(t):t;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});let a;i in o||(o[i]=0,s[i]=0),++o[i];for(let t=0,e=n.length;t<e;++t)if(a="handleEvent"in n[t]?n[t].handleEvent(r):n[t].call(this,r),!1===a||r.propagationStopped){a=!1;break}if(0==--o[i]){let t=s[i];for(delete s[i];t--;)this.removeEventListener(i,L);delete o[i]}return a}disposeInternal(){this.listeners_&&A(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){const i=this.listeners_&&this.listeners_[t];if(i){const n=i.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=L,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}}},k={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function G(t,e,i,n,r){if(n&&n!==t&&(i=i.bind(n)),r){const n=i;i=function(){t.removeEventListener(e,i),n.apply(this,arguments)}}const o={target:t,type:e,listener:i};return t.addEventListener(e,i),o}function z(t,e,i,n){return G(t,e,i,n,!0)}function j(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),A(t))}class q extends F{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(k.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=G(this,t[r],e);return n}return G(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let r=0;r<n;++r)i[r]=z(this,t[r],e)}else i=z(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)!function(t){if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)j(t[e]);else j(t)}(i);else if(Array.isArray(t))for(let i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}q.prototype.on,q.prototype.once,q.prototype.un;var B=q;function U(){throw new Error("Unimplemented abstract method.")}let X=0;function Y(t){return t.ol_uid||(t.ol_uid=String(++X))}class V extends x{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}var W=class extends B{constructor(t){super(),this.on,this.once,this.un,Y(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new V(i,t,e)),i=E.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new V(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const i=n[t];n[t]=e,i!==e&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],D(this.values_)&&(this.values_=null),e||this.notify(t,i)}}};const K={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class H extends Error{constructor(t){const e=K[t];super(e),this.code=t,this.name="AssertionError",this.message=e}}var Z=H,J={ADD:"add",REMOVE:"remove"};const Q="length";class $ extends x{constructor(t,e,i){super(t),this.element=e,this.index=i}}var tt=class extends W{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Q)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new $(J.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new $(J.REMOVE,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new $(J.REMOVE,i,t)),this.dispatchEvent(new $(J.ADD,e,t))}updateLength_(){this.set(Q,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new Z(58)}};const et="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",it=et.includes("firefox"),nt=(et.includes("safari")&&!et.includes("chrom")&&(et.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(et)),et.includes("webkit")&&!et.includes("edge")),rt=et.includes("macintosh"),ot="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,st="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,at="undefined"!=typeof Image&&Image.prototype.decode,ht=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function lt(t,e){if(!t)throw new Z(e)}new Array(6);function ut(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function ct(t,e){const i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function pt(t,e,i){return ut(t,e,0,0,i,0,0)}function ft(t,e,i,n,r,o,s,a){const h=Math.sin(o),l=Math.cos(o);return t[0]=n*l,t[1]=r*h,t[2]=-n*h,t[3]=r*l,t[4]=s*n*l-a*n*h+e,t[5]=s*r*h+a*r*l+i,t}function dt(t,e){const i=(n=e)[0]*n[3]-n[1]*n[2];var n;lt(0!==i,32);const r=e[0],o=e[1],s=e[2],a=e[3],h=e[4],l=e[5];return t[0]=a/i,t[1]=-o/i,t[2]=-s/i,t[3]=r/i,t[4]=(s*l-a*h)/i,t[5]=-(r*l-o*h)/i,t}let gt;function yt(t){const e="matrix("+t.join(", ")+")";if(st)return e;const i=gt||(gt=document.createElement("div"));return i.style.transform=e,i.style.transform}var _t={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function mt(t){const e=It();for(let i=0,n=t.length;i<n;++i)Ot(e,t[i]);return e}function vt(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function xt(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Et(t,e,i){let n,r;return n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0,n*n+r*r}function wt(t,e){return Mt(t,e[0],e[1])}function bt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Mt(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function Ct(t,e){const i=t[0],n=t[1],r=t[2],o=t[3],s=e[0],a=e[1];let h=_t.UNKNOWN;return s<i?h|=_t.LEFT:s>r&&(h|=_t.RIGHT),a<n?h|=_t.BELOW:a>o&&(h|=_t.ABOVE),h===_t.UNKNOWN&&(h=_t.INTERSECTING),h}function It(){return[1/0,1/0,-1/0,-1/0]}function St(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function Pt(t){return St(1/0,1/0,-1/0,-1/0,t)}function Nt(t,e){const i=t[0],n=t[1];return St(i,n,i,n,e)}function Rt(t,e,i,n,r){return At(Pt(r),t,e,i,n)}function Tt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Lt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Ot(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function At(t,e,i,n,r){for(;i<n;i+=r)Dt(t,e[i],e[i+1]);return t}function Dt(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function Ft(t,e){let i;return i=e(Gt(t)),i||(i=e(zt(t)),i||(i=e(Wt(t)),i||(i=e(Vt(t)),i||!1)))}function kt(t){let e=0;return Zt(t)||(e=Kt(t)*Xt(t)),e}function Gt(t){return[t[0],t[1]]}function zt(t){return[t[2],t[1]]}function jt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function qt(t,e){let i;return"bottom-left"===e?i=Gt(t):"bottom-right"===e?i=zt(t):"top-left"===e?i=Vt(t):"top-right"===e?i=Wt(t):lt(!1,13),i}function Bt(t,e,i,n,r){const[o,s,a,h,l,u,c,p]=Ut(t,e,i,n);return St(Math.min(o,a,l,c),Math.min(s,h,u,p),Math.max(o,a,l,c),Math.max(s,h,u,p),r)}function Ut(t,e,i,n){const r=e*n[0]/2,o=e*n[1]/2,s=Math.cos(i),a=Math.sin(i),h=r*s,l=r*a,u=o*s,c=o*a,p=t[0],f=t[1];return[p-h+c,f-l-u,p-h-c,f-l+u,p+h-c,f+l+u,p+h+c,f+l-u,p-h+c,f-l-u]}function Xt(t){return t[3]-t[1]}function Yt(t,e,i){const n=i||[1/0,1/0,-1/0,-1/0];return Ht(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):Pt(n),n}function Vt(t){return[t[0],t[3]]}function Wt(t){return[t[2],t[3]]}function Kt(t){return t[2]-t[0]}function Ht(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Zt(t){return t[2]<t[0]||t[3]<t[1]}function Jt(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function Qt(t,e,i){let n=!1;const r=Ct(t,e),o=Ct(t,i);if(r===_t.INTERSECTING||o===_t.INTERSECTING)n=!0;else{const s=t[0],a=t[1],h=t[2],l=t[3],u=e[0],c=e[1],p=i[0],f=i[1],d=(f-c)/(p-u);let g,y;o&_t.ABOVE&&!(r&_t.ABOVE)&&(g=p-(f-l)/d,n=g>=s&&g<=h),n||!(o&_t.RIGHT)||r&_t.RIGHT||(y=f-(p-h)*d,n=y>=a&&y<=l),n||!(o&_t.BELOW)||r&_t.BELOW||(g=p-(f-a)/d,n=g>=s&&g<=h),n||!(o&_t.LEFT)||r&_t.LEFT||(y=f-(p-s)*d,n=y>=a&&y<=l)}return n}function $t(t,e,i,n){let r=[];if(n>1){const e=t[2]-t[0],i=t[3]-t[1];for(let o=0;o<n;++o)r.push(t[0]+e*o/n,t[1],t[2],t[1]+i*o/n,t[2]-e*o/n,t[3],t[0],t[3]-i*o/n)}else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);const o=[],s=[];for(let t=0,e=r.length;t<e;t+=2)o.push(r[t]),s.push(r[t+1]);return function(t,e,i){return St(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(o,s,i)}function te(t,e){const i=e.getExtent(),n=jt(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){const e=Kt(i),r=Math.floor((n[0]-i[0])/e)*e;t[0]-=r,t[2]-=r}return t}function ee(t,e){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[i[0],t[1],i[2],t[3]]];te(t,e);const n=Kt(i);if(Kt(t)>n)return[[i[0],t[1],i[2],t[3]]];if(t[0]<i[0])return[[t[0]+n,t[1],i[2],t[3]],[i[0],t[1],t[2],t[3]]];if(t[2]>i[2])return[[t[0],t[1],i[2],t[3]],[i[0],t[1],t[2]-n,t[3]]]}return[t]}function ie(t,e,i){return Math.min(Math.max(t,e),i)}function ne(t,e,i,n,r,o){const s=r-i,a=o-n;if(0!==s||0!==a){const h=((t-i)*s+(e-n)*a)/(s*s+a*a);h>1?(i=r,n=o):h>0&&(i+=s*h,n+=a*h)}return re(t,e,i,n)}function re(t,e,i,n){const r=i-t,o=n-e;return r*r+o*o}function oe(t){const e=t.length;for(let i=0;i<e;i++){let n=i,r=Math.abs(t[i][i]);for(let o=i+1;o<e;o++){const e=Math.abs(t[o][i]);e>r&&(r=e,n=o)}if(0===r)return null;const o=t[n];t[n]=t[i],t[i]=o;for(let n=i+1;n<e;n++){const r=-t[n][i]/t[i][i];for(let o=i;o<e+1;o++)i==o?t[n][o]=0:t[n][o]+=r*t[i][o]}}const i=new Array(e);for(let n=e-1;n>=0;n--){i[n]=t[n][e]/t[n][n];for(let r=n-1;r>=0;r--)t[r][e]-=t[r][n]*i[n]}return i}function se(t){return t*Math.PI/180}function ae(t,e){const i=t%e;return i*e<0?i+e:i}function he(t,e,i){return t+i*(e-t)}function le(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}function ue(t,e){return Math.floor(le(t,e))}function ce(t,e){return Math.ceil(le(t,e))}const pe=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,fe=/^([a-z]*)$|^hsla?\(.*\)$/i;function de(t){return"string"==typeof t?t:ve(t)}function ge(t){const e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);const t=getComputedStyle(e).color;return document.body.removeChild(e),t}return""}const ye=function(){const t={};let e=0;return function(i){let n;if(t.hasOwnProperty(i))n=t[i];else{if(e>=1024){let i=0;for(const n in t)0==(3&i++)&&(delete t[n],--e)}n=function(t){let e,i,n,r,o;fe.exec(t)&&(t=ge(t));if(pe.exec(t)){const s=t.length-1;let a;a=s<=4?1:2;const h=4===s||8===s;e=parseInt(t.substr(1+0*a,a),16),i=parseInt(t.substr(1+1*a,a),16),n=parseInt(t.substr(1+2*a,a),16),r=h?parseInt(t.substr(1+3*a,a),16):255,1==a&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,h&&(r=(r<<4)+r)),o=[e,i,n,r/255]}else t.startsWith("rgba(")?(o=t.slice(5,-1).split(",").map(Number),me(o)):t.startsWith("rgb(")?(o=t.slice(4,-1).split(",").map(Number),o.push(1),me(o)):lt(!1,14);return o}(i),t[i]=n,++e}return n}}();function _e(t){return Array.isArray(t)?t:ye(t)}function me(t){return t[0]=ie(t[0]+.5|0,0,255),t[1]=ie(t[1]+.5|0,0,255),t[2]=ie(t[2]+.5|0,0,255),t[3]=ie(t[3],0,1),t}function ve(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let n=t[2];n!=(0|n)&&(n=n+.5|0);return"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}class xe{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,i){const n=Ee(t,e,i);return n in this.cache_?this.cache_[n]:null}set(t,e,i,n){const r=Ee(t,e,i);this.cache_[r]=n,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function Ee(t,e,i){return e+":"+t+":"+(i?de(i):"null")}const we=new xe;var be={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};var Me=class extends W{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[be.OPACITY]=void 0!==t.opacity?t.opacity:1,lt("number"==typeof e[be.OPACITY],64),e[be.VISIBLE]=void 0===t.visible||t.visible,e[be.Z_INDEX]=t.zIndex,e[be.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,e[be.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,e[be.MIN_ZOOM]=void 0!==t.minZoom?t.minZoom:-1/0,e[be.MAX_ZOOM]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=ie(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return U()}getLayerStatesArray(t){return U()}getExtent(){return this.get(be.EXTENT)}getMaxResolution(){return this.get(be.MAX_RESOLUTION)}getMinResolution(){return this.get(be.MIN_RESOLUTION)}getMinZoom(){return this.get(be.MIN_ZOOM)}getMaxZoom(){return this.get(be.MAX_ZOOM)}getOpacity(){return this.get(be.OPACITY)}getSourceState(){return U()}getVisible(){return this.get(be.VISIBLE)}getZIndex(){return this.get(be.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(be.EXTENT,t)}setMaxResolution(t){this.set(be.MAX_RESOLUTION,t)}setMinResolution(t){this.set(be.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(be.MAX_ZOOM,t)}setMinZoom(t){this.set(be.MIN_ZOOM,t)}setOpacity(t){lt("number"==typeof t,64),this.set(be.OPACITY,t)}setVisible(t){this.set(be.VISIBLE,t)}setZIndex(t){this.set(be.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},Ce={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Ie={ANIMATING:0,INTERACTING:1},Se={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};const Pe=42,Ne=256;const Re={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};var Te=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Re[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const Le=6378137,Oe=Math.PI*Le,Ae=[-Oe,-Oe,Oe,Oe],De=[-180,-85,180,85],Fe=Le*Math.log(Math.tan(Math.PI/2));class ke extends Te{constructor(t){super({code:t,units:"m",extent:Ae,global:!0,worldExtent:De,getPointResolution:function(t,e){return t/Math.cosh(e[1]/Le)}})}}const Ge=[new ke("EPSG:3857"),new ke("EPSG:102100"),new ke("EPSG:102113"),new ke("EPSG:900913"),new ke("http://www.opengis.net/def/crs/EPSG/0/3857"),new ke("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ze(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i){e[r]=Oe*t[r]/180;let i=Le*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));i>Fe?i=Fe:i<-Fe&&(i=-Fe),e[r+1]=i}return e}function je(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i)e[r]=180*t[r]/Oe,e[r+1]=360*Math.atan(Math.exp(t[r+1]/Le))/Math.PI-90;return e}const qe=[-180,-90,180,90],Be=6378137*Math.PI/180;class Ue extends Te{constructor(t,e){super({code:t,units:"degrees",extent:qe,axisOrientation:e,global:!0,metersPerUnit:Be,worldExtent:qe})}}const Xe=[new Ue("CRS:84"),new Ue("EPSG:4326","neu"),new Ue("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ue("urn:ogc:def:crs:OGC:2:84"),new Ue("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ue("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ue("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ye={};function Ve(t,e){Ye[t]=e}let We={};function Ke(t,e,i){const n=t.getCode(),r=e.getCode();n in We||(We[n]={}),We[n][r]=i}function He(t,e){let i;return t in We&&e in We[t]&&(i=We[t][e]),i}function Ze(t,e){let i=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function Je(t,e){const i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,o=t[1]*i+t[0]*n;return t[0]=r,t[1]=o,t}function Qe(t,e){if(e.canWrapX()){const i=Kt(e.getExtent()),n=$e(t,e,i);n&&(t[0]-=n*i)}return t}function $e(t,e,i){const n=e.getExtent();let r=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(i=i||Kt(n),r=Math.floor((t[0]-n[0])/i)),r}const ti=6371008.8;function ei(t,e,i){i=i||ti;const n=se(t[1]),r=se(e[1]),o=(r-n)/2,s=se(e[0]-t[0])/2,a=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(n)*Math.cos(r);return 2*i*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const ii={info:1,warn:2,error:3,none:4};let ni=ii.info;function ri(...t){ni>ii.warn||console.warn(...t)}let oi=!0;function si(t){oi=!(void 0===t||t)}function ai(t,e){if(void 0!==e)for(let i=0,n=t.length;i<n;++i)e[i]=t[i];else e=t.slice();return e}function hi(t,e){if(void 0!==e&&t!==e){for(let i=0,n=t.length;i<n;++i)e[i]=t[i];t=e}return t}function li(t){Ve(t.getCode(),t),Ke(t,t,ai)}function ui(t){return"string"==typeof t?Ye[e=t]||Ye[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function ci(t,e,i,n){let r;const o=(t=ui(t)).getPointResolutionFunc();if(o){if(r=o(e,i),n&&n!==t.getUnits()){const e=t.getMetersPerUnit();e&&(r=r*e/Re[n])}}else{const o=t.getUnits();if("degrees"==o&&!n||"degrees"==n)r=e;else{const s=_i(t,ui("EPSG:4326"));if(s===hi&&"degrees"!==o)r=e*t.getMetersPerUnit();else{let t=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];t=s(t,t,2);r=(ei(t.slice(0,2),t.slice(2,4))+ei(t.slice(4,6),t.slice(6,8)))/2}const a=n?Re[n]:t.getMetersPerUnit();void 0!==a&&(r/=a)}}return r}function pi(t){!function(t){t.forEach(li)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Ke(e,t,ai)}))}))}function fi(t,e){return t?"string"==typeof t?ui(t):t:ui(e)}function di(t){return function(e,i,n){const r=e.length;n=void 0!==n?n:2,i=void 0!==i?i:new Array(r);for(let o=0;o<r;o+=n){const r=t(e.slice(o,o+n)),s=r.length;for(let t=0,a=n;t<a;++t)i[o+t]=t>=s?e[o+t]:r[t]}return i}}function gi(t,e,i,n){const r=ui(t),o=ui(e);Ke(r,o,di(i)),Ke(o,r,di(n))}function yi(t,e){if(t===e)return!0;const i=t.getUnits()===e.getUnits();if(t.getCode()===e.getCode())return i;return _i(t,e)===ai&&i}function _i(t,e){let i=He(t.getCode(),e.getCode());return i||(i=hi),i}function mi(t,e){return _i(ui(t),ui(e))}function vi(t,e,i){return mi(e,i)(t,void 0,t.length)}function xi(t,e,i,n){return $t(t,mi(e,i),void 0,n)}let Ei=null;function wi(){return Ei}function bi(t,e){return Ei?vi(t,e,Ei):t}function Mi(t,e){return Ei?vi(t,Ei,e):(oi&&!Ze(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(oi=!1,ri("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function Ci(t,e){return Ei?xi(t,e,Ei):t}function Ii(t,e){return Ei?xi(t,Ei,e):t}function Si(t,e){if(!Ei)return t;const i=ui(e).getUnits(),n=Ei.getUnits();return i&&n?t*Re[i]/Re[n]:t}function Pi(t,e,i){return function(n){let r,o;if(t.canWrapX()){const e=t.getExtent(),s=Kt(e);o=$e(n=n.slice(0),t,s),o&&(n[0]=n[0]-o*s),n[0]=ie(n[0],e[0],e[2]),n[1]=ie(n[1],e[1],e[3]),r=i(n)}else r=i(n);return o&&e.canWrapX()&&(r[0]+=o*Kt(e.getExtent())),r}}var Ni,Ri,Ti;function Li(t,e,i){return function(n,r,o,s,a){if(!n)return;if(!r&&!e)return n;const h=e?0:o[0]*r,l=e?0:o[1]*r,u=a?a[0]:0,c=a?a[1]:0;let p=t[0]+h/2+u,f=t[2]-h/2+u,d=t[1]+l/2+c,g=t[3]-l/2+c;p>f&&(p=(f+p)/2,f=p),d>g&&(d=(g+d)/2,g=d);let y=ie(n[0],p,f),_=ie(n[1],d,g);if(s&&i&&r){const t=30*r;y+=-t*Math.log(1+Math.max(0,p-n[0])/t)+t*Math.log(1+Math.max(0,n[0]-f)/t),_+=-t*Math.log(1+Math.max(0,d-n[1])/t)+t*Math.log(1+Math.max(0,n[1]-g)/t)}return[y,_]}}function Oi(t){return t}function Ai(t,e,i,n){const r=Kt(e)/i[0],o=Xt(e)/i[1];return n?Math.min(t,Math.max(r,o)):Math.min(t,Math.min(r,o))}function Di(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),ie(n,i/2,2*e)}function Fi(t,e,i,n){return e=void 0===e||e,function(r,o,s,a){if(void 0!==r){const h=t[0],l=t[t.length-1],u=i?Ai(h,i,s,n):h;if(a)return e?Di(r,u,l):ie(r,l,u);const c=Math.min(u,r),p=Math.floor(C(t,c,o));return t[p]>u&&p<t.length-1?t[p+1]:t[p]}}}function ki(t,e,i,n,r,o){return n=void 0===n||n,i=void 0!==i?i:0,function(s,a,h,l){if(void 0!==s){const u=r?Ai(e,r,h,o):e;if(l)return n?Di(s,u,i):ie(s,i,u);const c=1e-9,p=Math.ceil(Math.log(e/u)/Math.log(t)-c),f=-a*(.5-c)+.5,d=Math.min(u,s),g=Math.floor(Math.log(e/d)/Math.log(t)+f),y=Math.max(p,g);return ie(e/Math.pow(t,y),i,u)}}}function Gi(t,e,i,n,r){return i=void 0===i||i,function(o,s,a,h){if(void 0!==o){const s=n?Ai(t,n,a,r):t;return i&&h?Di(o,s,e):ie(o,e,s)}}}function zi(t){if(void 0!==t)return 0}function ji(t){if(void 0!==t)return t}function qi(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}function Bi(t){return t=t||se(5),function(e,i){return i?e:void 0!==e?Math.abs(e)<=t?0:e:void 0}}function Ui(t){return Math.pow(t,3)}function Xi(t){return 1-Ui(1-t)}function Yi(t){return 3*t*t-2*t*t*t}function Vi(t){return t}function Wi(t,e,i,n,r,o){o=o||[];let s=0;for(let a=e;a<i;a+=n){const e=t[a],i=t[a+1];o[s++]=r[0]*e+r[2]*i+r[4],o[s++]=r[1]*e+r[3]*i+r[5]}return o&&o.length!=s&&(o.length=s),o}function Ki(t,e,i,n,r,o,s){s=s||[];const a=Math.cos(r),h=Math.sin(r),l=o[0],u=o[1];let c=0;for(let r=e;r<i;r+=n){const e=t[r]-l,i=t[r+1]-u;s[c++]=l+e*a-i*h,s[c++]=u+e*h+i*a;for(let e=r+2;e<r+n;++e)s[c++]=t[e]}return s&&s.length!=c&&(s.length=c),s}function Hi(t,e,i,n,r,o,s,a){a=a||[];const h=s[0],l=s[1];let u=0;for(let s=e;s<i;s+=n){const e=t[s]-h,i=t[s+1]-l;a[u++]=h+r*e,a[u++]=l+o*i;for(let e=s+2;e<s+n;++e)a[u++]=t[e]}return a&&a.length!=u&&(a.length=u),a}function Zi(t,e,i,n,r,o,s){s=s||[];let a=0;for(let h=e;h<i;h+=n){s[a++]=t[h]+r,s[a++]=t[h+1]+o;for(let e=h+2;e<h+n;++e)s[a++]=t[e]}return s&&s.length!=a&&(s.length=a),s}pi(Ge),pi(Xe),Ni=Ge,Ri=ze,Ti=je,Xe.forEach((function(t){Ni.forEach((function(e){Ke(t,e,Ri),Ke(e,t,Ti)}))}));const Ji=[1,0,0,1,0,0];var Qi=class extends W{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=O((function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return U()}closestPointXY(t,e,i,n){return U()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return U()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Pt(t),this.extentRevision_=this.getRevision()}return Jt(this.extent_,t)}rotate(t,e){U()}scale(t,e,i){U()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return U()}getType(){return U()}applyTransform(t){U()}intersectsExtent(t){return U()}translate(t,e){U()}transform(t,e){const i=ui(t),n="tile-pixels"==i.getUnits()?function(t,n,r){const o=i.getExtent(),s=i.getWorldExtent(),a=Xt(s)/Xt(o);return ft(Ji,s[0],s[3],a,-a,0,0,0),Wi(t,0,t.length,r,Ji,n),mi(i,e)(t,n,r)}:mi(i,e);return this.applyTransform(n),this}};function $i(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}function tn(t,e,i){const n=t.getFlatCoordinates();if(!n)return null;const r=t.getStride();return Wi(n,0,n.length,r,e,i)}var en=class extends Qi{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(t){return Rt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return U()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=$i(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){U()}setLayout(t,e,i){let n;if(t)n=$i(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}n=e.length,t=function(t){let e;2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM");return e}(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Ki(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=jt(this.getExtent()));const n=this.getFlatCoordinates();if(n){const r=this.getStride();Hi(n,0,n.length,r,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Zi(i,0,i.length,n,t,e,i),this.changed()}}};function nn(t,e,i,n,r,o,s){const a=t[e],h=t[e+1],l=t[i]-a,u=t[i+1]-h;let c;if(0===l&&0===u)c=e;else{const p=((r-a)*l+(o-h)*u)/(l*l+u*u);if(p>1)c=i;else{if(p>0){for(let r=0;r<n;++r)s[r]=he(t[e+r],t[i+r],p);return void(s.length=n)}c=e}}for(let e=0;e<n;++e)s[e]=t[c+e];s.length=n}function rn(t,e,i,n,r){let o=t[e],s=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],a=re(o,s,i,n);a>r&&(r=a),o=i,s=n}return r}function on(t,e,i,n,r){for(let o=0,s=i.length;o<s;++o){const s=i[o];r=rn(t,e,s,n,r),e=s}return r}function sn(t,e,i,n,r){for(let o=0,s=i.length;o<s;++o){const s=i[o];r=on(t,e,s,n,r),e=s[s.length-1]}return r}function an(t,e,i,n,r,o,s,a,h,l,u){if(e==i)return l;let c,p;if(0===r){if(p=re(s,a,t[e],t[e+1]),p<l){for(c=0;c<n;++c)h[c]=t[e+c];return h.length=n,p}return l}u=u||[NaN,NaN];let f=e+n;for(;f<i;)if(nn(t,f-n,f,n,s,a,u),p=re(s,a,u[0],u[1]),p<l){for(l=p,c=0;c<n;++c)h[c]=u[c];h.length=n,f+=n}else f+=n*Math.max((Math.sqrt(p)-Math.sqrt(l))/r|0,1);if(o&&(nn(t,i-n,e,n,s,a,u),p=re(s,a,u[0],u[1]),p<l)){for(l=p,c=0;c<n;++c)h[c]=u[c];h.length=n}return l}function hn(t,e,i,n,r,o,s,a,h,l,u){u=u||[NaN,NaN];for(let c=0,p=i.length;c<p;++c){const p=i[c];l=an(t,e,p,n,r,o,s,a,h,l,u),e=p}return l}function ln(t,e,i,n,r,o,s,a,h,l,u){u=u||[NaN,NaN];for(let c=0,p=i.length;c<p;++c){const p=i[c];l=hn(t,e,p,n,r,o,s,a,h,l,u),e=p[p.length-1]}return l}function un(t,e,i,n){for(let n=0,r=i.length;n<r;++n)t[e++]=i[n];return e}function cn(t,e,i,n){for(let r=0,o=i.length;r<o;++r){const o=i[r];for(let i=0;i<n;++i)t[e++]=o[i]}return e}function pn(t,e,i,n,r){r=r||[];let o=0;for(let s=0,a=i.length;s<a;++s){const a=cn(t,e,i[s],n);r[o++]=a,e=a}return r.length=o,r}function fn(t,e,i,n,r){r=r||[];let o=0;for(let s=0,a=i.length;s<a;++s){const a=pn(t,e,i[s],n,r[o]);0===a.length&&(a[0]=e),r[o++]=a,e=a[a.length-1]}return r.length=o,r}function dn(t,e,i,n,r,o,s){const a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}const h=new Array(a);h[0]=1,h[a-1]=1;const l=[e,i-n];let u=0;for(;l.length>0;){const i=l.pop(),o=l.pop();let s=0;const a=t[o],c=t[o+1],p=t[i],f=t[i+1];for(let e=o+n;e<i;e+=n){const i=ne(t[e],t[e+1],a,c,p,f);i>s&&(u=e,s=i)}s>r&&(h[(u-e)/n]=1,o+n<u&&l.push(o,u),u+n<i&&l.push(u,i))}for(let i=0;i<a;++i)h[i]&&(o[s++]=t[e+i*n],o[s++]=t[e+i*n+1]);return s}function gn(t,e,i,n,r,o,s,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];s=dn(t,e,l,n,r,o,s),a.push(s),e=l}return s}function yn(t,e){return e*Math.round(t/e)}function _n(t,e,i,n,r,o,s){if(e==i)return s;let a,h,l=yn(t[e],r),u=yn(t[e+1],r);e+=n,o[s++]=l,o[s++]=u;do{if(a=yn(t[e],r),h=yn(t[e+1],r),(e+=n)==i)return o[s++]=a,o[s++]=h,s}while(a==l&&h==u);for(;e<i;){const i=yn(t[e],r),c=yn(t[e+1],r);if(e+=n,i==a&&c==h)continue;const p=a-l,f=h-u,d=i-l,g=c-u;p*g==f*d&&(p<0&&d<p||p==d||p>0&&d>p)&&(f<0&&g<f||f==g||f>0&&g>f)?(a=i,h=c):(o[s++]=a,o[s++]=h,l=a,u=h,a=i,h=c)}return o[s++]=a,o[s++]=h,s}function mn(t,e,i,n,r,o,s,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];s=_n(t,e,l,n,r,o,s),a.push(s),e=l}return s}function vn(t,e,i,n,r,o,s,a){for(let h=0,l=i.length;h<l;++h){const l=i[h],u=[];s=mn(t,e,l,n,r,o,s,u),a.push(u),e=l[l.length-1]}return s}function xn(t,e,i,n,r){r=void 0!==r?r:[];let o=0;for(let s=e;s<i;s+=n)r[o++]=t.slice(s,s+n);return r.length=o,r}function En(t,e,i,n,r){r=void 0!==r?r:[];let o=0;for(let s=0,a=i.length;s<a;++s){const a=i[s];r[o++]=xn(t,e,a,n,r[o]),e=a}return r.length=o,r}function wn(t,e,i,n,r){r=void 0!==r?r:[];let o=0;for(let s=0,a=i.length;s<a;++s){const a=i[s];r[o++]=1===a.length&&a[0]===e?[]:En(t,e,a,n,r[o]),e=a[a.length-1]}return r.length=o,r}function bn(t,e,i,n){let r=0,o=t[i-n],s=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=s*i-o*n,o=i,s=n}return r/2}function Mn(t,e,i,n){let r=0;for(let o=0,s=i.length;o<s;++o){const s=i[o];r+=bn(t,e,s,n),e=s}return r}function Cn(t,e,i,n){let r=0;for(let o=0,s=i.length;o<s;++o){const s=i[o];r+=Mn(t,e,s,n),e=s[s.length-1]}return r}class In extends en{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new In(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<Et(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),an(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return bn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new In(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cn(this.flatCoordinates,0,t,this.stride),this.changed()}}var Sn=In;class Pn extends en{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Pn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const r=this.flatCoordinates,o=re(t,e,r[0],r[1]);if(o<n){const t=this.stride;for(let e=0;e<t;++e)i[e]=r[e];return i.length=t,o}return n}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(t){return Nt(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Mt(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=un(this.flatCoordinates,0,t,this.stride),this.changed()}}var Nn=Pn;function Rn(t,e,i,n,r){return!Ft(r,(function(r){return!Tn(t,e,i,n,r[0],r[1])}))}function Tn(t,e,i,n,r,o){let s=0,a=t[i-n],h=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];h<=o?n>o&&(i-a)*(o-h)-(r-a)*(n-h)>0&&s++:n<=o&&(i-a)*(o-h)-(r-a)*(n-h)<0&&s--,a=i,h=n}return 0!==s}function Ln(t,e,i,n,r,o){if(0===i.length)return!1;if(!Tn(t,e,i[0],n,r,o))return!1;for(let e=1,s=i.length;e<s;++e)if(Tn(t,i[e-1],i[e],n,r,o))return!1;return!0}function On(t,e,i,n,r,o){if(0===i.length)return!1;for(let s=0,a=i.length;s<a;++s){const a=i[s];if(Ln(t,e,a,n,r,o))return!0;e=a[a.length-1]}return!1}function An(t,e,i,n,r,o,s){let a,h,l,u,c,p,f;const d=r[o+1],g=[];for(let r=0,o=i.length;r<o;++r){const o=i[r];for(u=t[o-n],p=t[o-n+1],a=e;a<o;a+=n)c=t[a],f=t[a+1],(d<=p&&f<=d||p<=d&&d<=f)&&(l=(d-p)/(f-p)*(c-u)+u,g.push(l)),u=c,p=f}let y=NaN,_=-1/0;for(g.sort(M),u=g[0],a=1,h=g.length;a<h;++a){c=g[a];const r=Math.abs(c-u);r>_&&(l=(u+c)/2,Ln(t,e,i,n,l,d)&&(y=l,_=r)),u=c}return isNaN(y)&&(y=r[o]),s?(s.push(y,d,_),s):[y,d,_]}function Dn(t,e,i,n,r){let o=[];for(let s=0,a=i.length;s<a;++s){const a=i[s];o=An(t,e,a,n,r,2*s,o),e=a[a.length-1]}return o}function Fn(t,e,i,n,r){let o;for(e+=n;e<i;e+=n)if(o=r(t.slice(e-n,e),t.slice(e,e+n)),o)return o;return!1}function kn(t,e,i,n,r){const o=At([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!Ht(r,o)&&(!!bt(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||Fn(t,e,i,n,(function(t,e){return Qt(r,t,e)})))))}function Gn(t,e,i,n,r){for(let o=0,s=i.length;o<s;++o){if(kn(t,e,i[o],n,r))return!0;e=i[o]}return!1}function zn(t,e,i,n,r){return!!kn(t,e,i,n,r)||(!!Tn(t,e,i,n,r[0],r[1])||(!!Tn(t,e,i,n,r[0],r[3])||(!!Tn(t,e,i,n,r[2],r[1])||!!Tn(t,e,i,n,r[2],r[3]))))}function jn(t,e,i,n,r){if(!zn(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(let e=1,o=i.length;e<o;++e)if(Rn(t,i[e-1],i[e],n,r)&&!kn(t,i[e-1],i[e],n,r))return!1;return!0}function qn(t,e,i,n,r){for(let o=0,s=i.length;o<s;++o){const s=i[o];if(jn(t,e,s,n,r))return!0;e=s[s.length-1]}return!1}function Bn(t,e,i,n){for(;e<i-n;){for(let r=0;r<n;++r){const o=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=o}e+=n,i-=n}}function Un(t,e,i,n){let r=0,o=t[i-n],s=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=(i-o)*(n+s),o=i,s=n}return 0===r?void 0:r>0}function Xn(t,e,i,n,r){r=void 0!==r&&r;for(let o=0,s=i.length;o<s;++o){const s=i[o],a=Un(t,e,s,n);if(0===o){if(r&&a||!r&&!a)return!1}else if(r&&!a||!r&&a)return!1;e=s}return!0}function Yn(t,e,i,n,r){for(let o=0,s=i.length;o<s;++o){const s=i[o];if(!Xn(t,e,s,n,r))return!1;s.length&&(e=s[s.length-1])}return!0}function Vn(t,e,i,n,r){r=void 0!==r&&r;for(let o=0,s=i.length;o<s;++o){const s=i[o],a=Un(t,e,s,n);(0===o?r&&a||!r&&!a:r&&!a||!r&&a)&&Bn(t,e,s,n),e=s}return e}function Wn(t,e,i,n,r){for(let o=0,s=i.length;o<s;++o)e=Vn(t,e,i[o],n,r);return e}class Kn extends en{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?S(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Kn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Et(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(on(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Ln(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Mn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Vn(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,En(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=jt(this.getExtent());this.flatInteriorPoint_=An(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Nn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Sn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let r=0;for(let o=0,s=i.length;o<s;++o){const s=i[o],a=new Sn(e.slice(r,s),t);n.push(a),r=s}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Xn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Vn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=mn(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Kn(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return jn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=pn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}var Hn=Kn;function Zn(t){const e=t[0],i=t[1],n=t[2],r=t[3],o=[e,i,e,r,n,r,n,i,e,i];return new Kn(o,"XY",[o.length])}function Jn(t,e){setTimeout((function(){t(e)}),0)}function Qn(t){return!(t.sourceCenter&&t.targetCenter&&!Ze(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function $n(t,e,i,n,r){const o=Math.cos(-r);let s=Math.sin(-r),a=t[0]*o-t[1]*s,h=t[1]*o+t[0]*s;a+=(e[0]/2-i[0])*n,h+=(i[1]-e[1]/2)*n,s=-s;return[a*o-h*s,h*o+a*s]}var tr=class extends W{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=fi(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&si(),t.center&&(t.center=Mi(t.center,this.projection_)),t.extent&&(t.extent=Ii(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in Se)delete e[t];this.setProperties(e,!0);const i=function(t){let e,i,n;const r=28,o=2;let s=void 0!==t.minZoom?t.minZoom:0,a=void 0!==t.maxZoom?t.maxZoom:r;const h=void 0!==t.zoomFactor?t.zoomFactor:o,l=void 0!==t.multiWorld&&t.multiWorld,u=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,c=void 0!==t.showFullExtent&&t.showFullExtent,p=fi(t.projection,"EPSG:3857"),f=p.getExtent();let d=t.constrainOnlyCenter,g=t.extent;l||g||!p.isGlobal()||(d=!1,g=f);if(void 0!==t.resolutions){const r=t.resolutions;i=r[s],n=void 0!==r[a]?r[a]:r[r.length-1],e=t.constrainResolution?Fi(r,u,!d&&g,c):Gi(i,n,u,!d&&g,c)}else{const l=(f?Math.max(Kt(f),Xt(f)):360*Re.degrees/p.getMetersPerUnit())/Ne/Math.pow(o,0),y=l/Math.pow(o,r-0);i=t.maxResolution,void 0!==i?s=0:i=l/Math.pow(h,s),n=t.minResolution,void 0===n&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(h,a):l/Math.pow(h,a):y),a=s+Math.floor(Math.log(i/n)/Math.log(h)),n=i/Math.pow(h,a-s),e=t.constrainResolution?ki(h,i,n,u,!d&&g,c):Gi(i,n,u,!d&&g,c)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:s,zoomFactor:h}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Li(t.extent,t.constrainOnlyCenter,e)}const e=fi(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Li(t,!1,!1)}return Oi}(t),r=i.constraint,o=function(t){const e=void 0===t.enableRotation||t.enableRotation;if(e){const e=t.constrainRotation;return void 0===e||!0===e?Bi():!1===e?ji:"number"==typeof e?qi(e):ji}return zi}(t);this.constraints_={center:n,resolution:r,rotation:o},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),o=r/2*(n[3]-e[3]+e[1]-n[1]),s=r/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+o,i[1]-s])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=Object.assign({},i),i.center=Mi(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Mi(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let n=0;for(;n<i&&!this.isDef();++n){const t=arguments[n];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(n===i)return void(e&&Jn(e,!0));let r=Date.now(),o=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_;const h=[];for(;n<i;++n){const t=arguments[n],i={start:r,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||Yi,callback:e};if(t.center&&(i.sourceCenter=o,i.targetCenter=t.center.slice(),o=i.targetCenter),void 0!==t.zoom?(i.sourceResolution=s,i.targetResolution=this.getResolutionForZoom(t.zoom),s=i.targetResolution):t.resolution&&(i.sourceResolution=s,i.targetResolution=t.resolution,s=i.targetResolution),void 0!==t.rotation){i.sourceRotation=a;const e=ae(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;i.targetRotation=a+e,a=i.targetRotation}Qn(i)?i.complete=!0:r+=i.duration,h.push(i)}this.animations_.push(h),this.setHint(Ie.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ie.ANIMATING]>0}getInteracting(){return this.hints_[Ie.INTERACTING]>0}cancelAnimations(){let t;this.setHint(Ie.ANIMATING,-this.hints_[Ie.ANIMATING]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&Jn(i[0].callback,!1),!t)for(let e=0,n=i.length;e<n;++e){const n=i[e];if(!n.complete){t=n.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let r=!0;for(let i=0,o=n.length;i<o;++i){const o=n[i];if(o.complete)continue;const s=t-o.start;let a=o.duration>0?s/o.duration:1;a>=1?(o.complete=!0,a=1):r=!1;const h=o.easing(a);if(o.sourceCenter){const t=o.sourceCenter[0],e=o.sourceCenter[1],i=o.targetCenter[0],n=o.targetCenter[1];this.nextCenter_=o.targetCenter;const r=t+h*(i-t),s=e+h*(n-e);this.targetCenter_=[r,s]}if(o.sourceResolution&&o.targetResolution){const t=1===h?o.targetResolution:o.sourceResolution+h*(o.targetResolution-o.sourceResolution);if(o.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,o.anchor)}this.nextResolution_=o.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==o.sourceRotation&&void 0!==o.targetRotation){const t=1===h?ae(o.targetRotation+Math.PI,2*Math.PI)-Math.PI:o.sourceRotation+h*(o.targetRotation-o.sourceRotation);if(o.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,o.anchor)}this.nextRotation_=o.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!o.complete)break}if(r){this.animations_[i]=null,this.setHint(Ie.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=n[0].callback;t&&Jn(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();var r,o;return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],Je(i,t-this.getRotation()),o=e,(r=i)[0]+=+o[0],r[1]+=+o[1]),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),r=this.getResolution();if(void 0!==n&&void 0!==r){i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?bi(t,this.getProjection()):t}getCenterInternal(){return this.get(Se.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return Ci(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();lt(e,1);const i=this.getResolution();lt(void 0!==i,2);const n=this.getRotation();return lt(void 0!==n,3),Bt(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Se.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Ii(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=Kt(t)/e[0],n=Xt(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(i){return e/Math.pow(t,i*n)}}getRotation(){return this.get(Se.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const r=this.padding_;if(r){const t=this.getViewportSizeMinusPadding_();n=$n(n,this.getViewportSize_(),[t[0]/2+r[3],t[1]/2+r[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;if(this.resolutions_){const r=C(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=ie(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,ie(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(lt(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)){lt(!Zt(t),25);i=Zn(Ii(t,this.getProjection()))}else if("Circle"===t.getType()){const e=Ii(t.getExtent(),this.getProjection());i=Zn(e),i.rotate(this.getRotation(),jt(e))}else{const e=wi();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride();let s=1/0,a=1/0,h=-1/0,l=-1/0;for(let t=0,e=r.length;t<e;t+=o){const e=r[t]*i-r[t+1]*n,o=r[t]*n+r[t+1]*i;s=Math.min(s,e),a=Math.min(a,o),h=Math.max(h,e),l=Math.max(l,o)}return[s,a,h,l]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const n=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;let o;o=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const s=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(s,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);a=isNaN(a)?o:Math.max(a,o),a=this.getConstrainedResolution(a,r?0:1);const h=this.getRotation(),l=Math.sin(h),u=Math.cos(h),c=jt(s);c[0]+=(n[1]-n[3])/2*a,c[1]+=(n[0]-n[2])/2*a;const p=c[0]*u-c[1]*l,f=c[1]*u+c[0]*l,d=this.getConstrainedCenter([p,f],a),g=e.callback?e.callback:L;void 0!==e.duration?this.animateInternal({resolution:a,center:d,duration:e.duration,easing:e.easing},g):(this.targetResolution_=a,this.targetCenter_=d,this.applyTargetState_(!1,!0),Jn(g,!0))}centerOn(t,e,i){this.centerOnInternal(Mi(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal($n(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let r;const o=this.padding_;if(o&&t){const s=this.getViewportSizeMinusPadding_(-i),a=$n(t,n,[s[0]/2+o[3],s[1]/2+o[0]],e,i);r=[t[0]-a[0],t[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=bi(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Mi(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Mi(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?Mi(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,r,i),s=this.constraints_.center(this.targetCenter_,o,r,i,this.calculateCenterShift(this.targetCenter_,o,n,r));this.get(Se.ROTATION)!==n&&this.set(Se.ROTATION,n),this.get(Se.RESOLUTION)!==o&&(this.set(Se.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),s&&this.get(Se.CENTER)&&Ze(this.get(Se.CENTER),s)||this.set(Se.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const n=e||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),s=this.constraints_.resolution(this.targetResolution_,n,o),a=this.constraints_.center(this.targetCenter_,s,o,!1,this.calculateCenterShift(this.targetCenter_,s,r,o));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=s,this.targetRotation_=r,this.targetCenter_=a,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===s&&this.getRotation()===r&&this.getCenterInternal()&&Ze(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:s,duration:t,easing:Xi,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ie.INTERACTING,1)}endInteraction(t,e,i){i=i&&Mi(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(Ie.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function er(t,e){if(!t.visible)return!1;const i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;const n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}var ir=class extends Me{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(be.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(be.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(j(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=G(t,k.CHANGE,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;e=t instanceof tr?{viewState:t.getState(),extent:t.calculateExtent()}:t;const i=this.getExtent();return this.getVisible()&&er(this.getLayerState(),e.viewState)&&(!i||Ht(i,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const i=this.getSource();if(i&&(e=i.getAttributions()),!e)return[];let n=e(t instanceof tr?t.getViewStateAndExtent():t);return Array.isArray(n)||(n=[n]),n}render(t,e){const i=this.getRenderer();if(i.prepareFrame(t))return this.rendered=!0,i.renderFrame(t,e)}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set(be.MAP,t)}getMapInternal(){return this.get(be.MAP)}setMap(t){this.mapPrecomposeKey_&&(j(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(j(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=G(t,Ce.PRECOMPOSE,(function(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);lt(!e.some((function(t){return t.layer===i.layer})),67),e.push(i)}),this),this.mapRenderKey_=G(this,k.CHANGE,t.render,t),this.changed())}setSource(t){this.set(be.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function nr(t,e){we.expire()}var rr=class extends w{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){U()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;ft(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),dt(n,i)}forEachFeatureAtCoordinate(t,e,i,n,r,o,s,a){let h;const l=e.viewState;function u(t,e,i,n){return r.call(o,e,t?i:null,n)}const c=l.projection,p=Qe(t.slice(),c),f=[[0,0]];if(c.canWrapX()&&n){const t=Kt(c.getExtent());f.push([-t,0],[t,0])}const d=e.layerStatesArray,g=d.length,y=[],_=[];for(let n=0;n<f.length;n++)for(let r=g-1;r>=0;--r){const o=d[r],c=o.layer;if(c.hasRenderer()&&er(o,l)&&s.call(a,c)){const r=c.getRenderer(),s=c.getSource();if(r&&s){const a=s.getWrapX()?p:t,l=u.bind(null,o.managed);_[0]=a[0]+f[n][0],_[1]=a[1]+f[n][1],h=r.forEachFeatureAtCoordinate(_,e,i,l,y)}if(h)return h}}if(0===y.length)return;const m=1/y.length;return y.forEach(((t,e)=>t.distanceSq+=e*m)),y.sort(((t,e)=>t.distanceSq-e.distanceSq)),y.some((t=>h=t.callback(t.feature,t.layer,t.geometry))),h}hasFeatureAtCoordinate(t,e,i,n,r,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,R,this,r,o)}getMap(){return this.map_}renderFrame(t){U()}scheduleExpireIconCache(t){we.canExpireCache()&&t.postRenderFunctions.push(nr)}};var or=class extends x{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}};const sr="ol-hidden",ar="ol-unselectable",hr="ol-control",lr="ol-collapsed",ur=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),cr=["style","variant","weight","size","lineHeight","family"],pr=function(t){const e=t.match(ur);if(!e)return null;const i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let t=0,n=cr.length;t<n;++t){const n=e[t+1];void 0!==n&&(i[cr[t]]=n)}return i.families=i.family.split(/,\s?/),i};function fr(t,e,i,n){let r;return r=i&&i.length?i.shift():st?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",n)}function dr(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function gr(t,e){const i=e.parentNode;i&&i.replaceChild(t,e)}function yr(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function _r(t){for(;t.lastChild;)t.removeChild(t.lastChild)}function mr(t,e){const i=t.childNodes;for(let n=0;;++n){const r=i[n],o=e[n];if(!r&&!o)break;r!==o&&(r?o?t.insertBefore(o,r):(t.removeChild(r),--n):t.appendChild(o))}}const vr="10px sans-serif",xr="#000",Er="round",wr=[],br="round",Mr="#000",Cr="center",Ir="middle",Sr=[0,0,0,0],Pr=new W;let Nr,Rr=null;const Tr={},Lr=function(){const t="32px ",e=["monospace","serif"],i=e.length,n="wmytzilWMYTZIL@#/&?$%10";let r,o;function s(r,s,a){let h=!0;for(let l=0;l<i;++l){const i=e[l];if(o=Dr(r+" "+s+" "+t+i,n),a!=i){const e=Dr(r+" "+s+" "+t+a+","+i,n);h=h&&e!=o}}return!!h}function a(){let t=!0;const e=Pr.getKeys();for(let i=0,n=e.length;i<n;++i){const n=e[i];Pr.get(n)<100&&(s.apply(this,n.split("\n"))?(A(Tr),Rr=null,Nr=void 0,Pr.set(n,100)):(Pr.set(n,Pr.get(n)+1,!0),t=!1))}t&&(clearInterval(r),r=void 0)}return function(t){const e=pr(t);if(!e)return;const i=e.families;for(let t=0,n=i.length;t<n;++t){const n=i[t],o=e.style+"\n"+e.weight+"\n"+n;void 0===Pr.get(o)&&(Pr.set(o,100,!0),s(e.style,e.weight,n)||(Pr.set(o,0,!0),void 0===r&&(r=setInterval(a,32))))}}}(),Or=function(){let t;return function(e){let i=Tr[e];if(null==i){if(st){const t=pr(e),n=Ar(e,"Žg");i=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),i=t.offsetHeight,document.body.removeChild(t);Tr[e]=i}return i}}();function Ar(t,e){return Rr||(Rr=fr(1,1)),t!=Nr&&(Rr.font=t,Nr=Rr.font),Rr.measureText(e)}function Dr(t,e){return Ar(t,e).width}function Fr(t,e,i){if(e in i)return i[e];const n=e.split("\n").reduce(((e,i)=>Math.max(e,Dr(t,i))),0);return i[e]=n,n}function kr(t,e){const i=[],n=[],r=[];let o=0,s=0,a=0,h=0;for(let l=0,u=e.length;l<=u;l+=2){const c=e[l];if("\n"===c||l===u){o=Math.max(o,s),r.push(s),s=0,a+=h;continue}const p=e[l+1]||t.font,f=Dr(p,c);i.push(f),s+=f;const d=Or(p);n.push(d),h=Math.max(h,d)}return{width:o,height:a,widths:i,heights:n,lineWidths:r}}function Gr(t,e,i,n,r,o,s,a,h,l,u){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.setTransform.apply(t,e),n.contextInstructions?(t.translate(h,l),t.scale(u[0],u[1]),function(t,e){const i=t.contextInstructions;for(let t=0,n=i.length;t<n;t+=2)Array.isArray(i[t+1])?e[i[t]].apply(e,i[t+1]):e[i[t]]=i[t+1]}(n,t)):u[0]<0||u[1]<0?(t.translate(h,l),t.scale(u[0],u[1]),t.drawImage(n,r,o,s,a,0,0,s,a)):t.drawImage(n,r,o,s,a,h,l,s*u[0],a*u[1]),t.restore()}var zr=class extends rr{constructor(t){super(t),this.fontChangeListenerKey_=G(Pr,E.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=ar+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new or(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){j(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(Ce.PRECOMPOSE,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),i=t.viewState;this.children_.length=0;const n=[];let r=null;for(let o=0,s=e.length;o<s;++o){const s=e[o];t.layerIndex=o;const a=s.layer,h=a.getSourceState();if(!er(s,i)||"ready"!=h&&"undefined"!=h){a.unrender();continue}const l=a.render(t,r);l&&(l!==r&&(this.children_.push(l),r=l),"getDeclutter"in a&&n.push(a))}for(let e=n.length-1;e>=0;--e)n[e].renderDeclutter(t);mr(this.element_,this.children_),this.dispatchRenderEvent(Ce.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}};class jr extends x{constructor(t,e){super(t),this.layer=e}}const qr="layers";class Br extends Me{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(qr,this.handleLayersChanged_),i?Array.isArray(i)?i=new tt(i.slice(),{unique:!0}):lt("function"==typeof i.getArray,43):i=new tt(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(j),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(G(t,J.ADD,this.handleLayersAdd_,this),G(t,J.REMOVE,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(j);A(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.registerLayerListeners_(i),this.dispatchEvent(new jr("addlayer",i))}this.changed()}registerLayerListeners_(t){const e=[G(t,E.PROPERTYCHANGE,this.handleLayerChange_,this),G(t,k.CHANGE,this.handleLayerChange_,this)];t instanceof Br&&e.push(G(t,"addlayer",this.handleLayerGroupAdd_,this),G(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Y(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new jr("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new jr("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new jr("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=Y(e);this.listenerKeys_[i].forEach(j),delete this.listenerKeys_[i],this.dispatchEvent(new jr("removelayer",e)),this.changed()}getLayers(){return this.get(qr)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,i=t.length;e<i;++e)this.dispatchEvent(new jr("removelayer",t[e]))}this.set(qr,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const n=this.getLayerState();let r=n.zIndex;t||void 0!==n.zIndex||(r=0);for(let t=i,o=e.length;t<o;t++){const i=e[t];i.opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),i.minZoom=Math.max(i.minZoom,n.minZoom),i.maxZoom=Math.min(i.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==i.extent?i.extent=Yt(i.extent,n.extent):i.extent=n.extent),void 0===i.zIndex&&(i.zIndex=r)}return e}getSourceState(){return"ready"}}var Ur=Br;var Xr=class extends x{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}};var Yr=class extends Xr{constructor(t,e,i,n,r,o){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},Vr={SINGLECLICK:"singleclick",CLICK:k.CLICK,DBLCLICK:k.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Wr={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Kr=class extends F{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=G(i,Wr.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=G(i,Wr.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(k.TOUCHMOVE,this.boundHandleTouchMove_,!!ht&&{passive:!1})}emulateClick_(t){let e=new Yr(Vr.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Yr(Vr.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new Yr(Vr.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==Vr.POINTERUP||e.type==Vr.POINTERCANCEL){delete this.trackedTouches_[i];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=Vr.POINTERDOWN&&e.type!=Vr.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Yr(Vr.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(j),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new Yr(Vr.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(G(t,Vr.POINTERMOVE,this.handlePointerMove_,this),G(t,Vr.POINTERUP,this.handlePointerUp_,this),G(this.element_,Vr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(G(this.element_.getRootNode(),Vr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Yr(Vr.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Yr(Vr.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(j(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(k.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(j(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(j),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Hr={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Zr={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};const Jr=1/0;var Qr=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,A(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){lt(!(this.keyFunction_(t)in this.queuedElements_),31);const e=this.priorityFunction_(t);return e!=Jr&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],s=t;for(;t<n>>1;){const r=this.getLeftChildIndex_(t),o=this.getRightChildIndex_(t),s=o<n&&i[o]<i[r]?o:r;e[t]=e[s],i[t]=i[s],t=s}e[t]=r,i[t]=o,this.siftDown_(s,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,r=i[e],o=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>o))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=r,n[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const r=e.length;let o,s,a;for(s=0;s<r;++s)o=e[s],a=t(o),a==Jr?delete this.queuedElements_[this.keyFunction_(o)]:(i[n]=a,e[n++]=o);e.length=n,i.length=n,this.heapify_()}},$r={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var to=class extends Qr{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);if(e){t[0].addEventListener(k.CHANGE,this.boundHandleTileChange_)}return e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===$r.LOADED||i===$r.ERROR||i===$r.EMPTY){i!==$r.ERROR&&e.removeEventListener(k.CHANGE,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,n,r,o=0;for(;this.tilesLoading_<t&&o<e&&this.getCount()>0;)n=this.dequeue()[0],r=n.getKey(),i=n.getState(),i!==$r.IDLE||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,n.load())}};function eo(t,e,i,n,r){if(!t||!(i in t.wantedTiles))return Jr;if(!t.wantedTiles[i][e.getKey()])return Jr;const o=t.viewState.center,s=n[0]-o[0],a=n[1]-o[1];return 65536*Math.log(r)+Math.sqrt(s*s+a*a)/r}var io=class extends W{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){yr(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&yr(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)j(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=t,t){(this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==L&&this.listenerKeys.push(G(t,Hr.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}};var no=class extends io{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",n=void 0!==t.expandClassName?t.expandClassName:e+"-expand",r=void 0!==t.collapseLabel?t.collapseLabel:"›",o=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const s=void 0!==t.label?t.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s,this.label_.className=n):this.label_=s;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(k.CLICK,this.handleClick_.bind(this),!1);const h=e+" "+ar+" "+hr+(this.collapsed_&&this.collapsible_?" "+lr:"")+(this.collapsible_?"":" ol-uncollapsible"),l=this.element;l.className=h,l.appendChild(this.toggleButton_),l.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),i=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(i),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!P(e,this.renderedAttributions_)){_r(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(lr),this.collapsed_?gr(this.collapseLabel_,this.label_):gr(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}};var ro=class extends io{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"⇧",n=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const r=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener(k.CLICK,this.handleClick_.bind(this),!1);const s=e+" "+ar+" "+hr,a=this.element;a.className=s,a.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(sr)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Xi}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(sr);t||0!==i?t&&0!==i&&this.element.classList.remove(sr):this.element.classList.add(sr)}this.label_.style.transform=t}this.rotation_=i}};var oo=class extends io{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,n=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",r=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",o=void 0!==t.zoomInLabel?t.zoomInLabel:"+",s=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",h=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",l=document.createElement("button");l.className=n,l.setAttribute("type","button"),l.title=a,l.appendChild("string"==typeof o?document.createTextNode(o):o),l.addEventListener(k.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=h,u.appendChild("string"==typeof s?document.createTextNode(s):s),u.addEventListener(k.CLICK,this.handleClick_.bind(this,-i),!1);const c=e+" "+ar+" "+hr,p=this.element;p.className=c,p.appendChild(l),p.appendChild(u),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:Xi})):e.setZoom(n)}}};function so(t){t=t||{};const e=new tt;(void 0===t.zoom||t.zoom)&&e.push(new oo(t.zoomOptions));(void 0===t.rotate||t.rotate)&&e.push(new ro(t.rotateOptions));return(void 0===t.attribution||t.attribution)&&e.push(new no(t.attributionOptions)),e}var ao={ACTIVE:"active"};function ho(t,e,i){const n=t.getCenterInternal();if(n){const r=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:Vi,center:t.getConstrainedCenter(r)})}}function lo(t,e,i,n){const r=t.getZoom();if(void 0===r)return;const o=t.getConstrainedZoom(r+e),s=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:s,anchor:i,duration:void 0!==n?n:250,easing:Xi})}var uo=class extends W{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(ao.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(ao.ACTIVE,t)}setMap(t){this.map_=t}};var co=class extends uo{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==Vr.DBLCLICK){const i=t.originalEvent,n=t.map,r=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;lo(n.getView(),o,r,this.duration_),i.preventDefault(),e=!0}return!e}};function po(t){const e=t.length;let i=0,n=0;for(let r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return{clientX:i/e,clientY:n/e}}var fo=class extends uo{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Vr.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Vr.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==Vr.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Vr.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function go(t){const e=arguments;return function(t){let i=!0;for(let n=0,r=e.length;n<r&&(i=i&&e[n](t),i);++n);return i}}const yo=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},_o=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(t)},mo=R,vo=function(t){const e=t.originalEvent;return 0==e.button&&!(nt&&rt&&e.ctrlKey)},xo=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Eo=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},wo=function(t){const e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},bo=function(t){const e=t.originalEvent;return lt(void 0!==e,56),"mouse"==e.pointerType},Mo=function(t){const e=t.originalEvent;return lt(void 0!==e,56),e.isPrimary&&0===e.button};var Co=class extends fo{constructor(t){super({stopDown:T}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:go(xo,Mo);this.condition_=t.onFocusOnly?go(_o,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(po(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const e=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();r=e,o=i.getResolution(),r[0]*=o,r[1]*=o,Je(e,i.getRotation()),i.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var r,o;this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),r=i.getCenterInternal(),o=e.getPixelFromCoordinateInternal(r),s=e.getCoordinateFromPixelInternal([o[0]-t*Math.cos(n),o[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(s),duration:500,easing:Xi})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}};var Io=class extends fo{constructor(t){t=t||{},super({stopDown:T}),this.condition_=t.condition?t.condition:yo,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!bo(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===zi)return;const n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){const t=o-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=o}handleUpEvent(t){if(!bo(t))return!0;return t.map.getView().endInteraction(this.duration_),!1}handleDownEvent(t){if(!bo(t))return!1;if(vo(t)&&this.condition_(t)){return t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0}return!1}};var So=class extends w{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Hn([i])}getGeometry(){return this.geometry_}};const Po="boxstart",No="boxdrag",Ro="boxend",To="boxcancel";class Lo extends x{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}var Oo=class extends fo{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new So(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:vo,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Lo(No,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Lo(e?Ro:To,t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Lo(Po,t.coordinate,t)),!0)}onBoxEnd(t){}};var Ao=class extends Oo{constructor(t){super({condition:(t=t||{}).condition?t.condition:Eo,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),n=e.getResolutionForExtentInternal(t),r=e.getResolution()/n;i=i.clone(),i.scale(r*r)}e.fitInternal(i,{duration:this.duration_,easing:Xi})}},Do={LEFT:37,UP:38,RIGHT:39,DOWN:40};var Fo=class extends uo{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return xo(t)&&wo(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==k.KEYDOWN){const i=t.originalEvent,n=i.keyCode;if(this.condition_(t)&&(n==Do.DOWN||n==Do.LEFT||n==Do.RIGHT||n==Do.UP)){const r=t.map.getView(),o=r.getResolution()*this.pixelDelta_;let s=0,a=0;n==Do.DOWN?a=-o:n==Do.LEFT?s=-o:n==Do.RIGHT?s=o:a=o;const h=[s,a];Je(h,r.getRotation()),ho(r,h,this.duration_),i.preventDefault(),e=!0}}return!e}};var ko=class extends uo{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:wo,this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==k.KEYDOWN||t.type==k.KEYPRESS){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&("+"===n||"-"===n)){const r=t.map,o="+"===n?this.delta_:-this.delta_;lo(r.getView(),o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}};var Go=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}};var zo=class extends uo{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:mo;this.condition_=t.onFocusOnly?go(_o,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==k.WHEEL)return!0;const e=t.map,i=t.originalEvent;let n;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==k.WHEEL&&(n=i.deltaY,it&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=ot),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.lastDelta_=n;const r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?"trackpad":"wheel");const o=e.getView();if("trackpad"===this.mode_&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=n;const s=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),s),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-ie(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),lo(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}};var jo=class extends fo{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=T),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=r;const o=t.map,s=o.getView();s.getConstraints().rotation!==zi&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(po(this.targetPointers))),this.rotating_&&(o.render(),s.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){if(this.targetPointers.length<2){return t.map.getView().endInteraction(this.duration_),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};var qo=class extends fo{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=T),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,s=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;const a=t.map,h=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(po(this.targetPointers))),a.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function Bo(t){t=t||{};const e=new tt,i=new Go(-.005,.05,100);(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new Io);(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new co({delta:t.zoomDelta,duration:t.zoomDuration}));(void 0===t.dragPan||t.dragPan)&&e.push(new Co({onFocusOnly:t.onFocusOnly,kinetic:i}));(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new jo);(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new qo({duration:t.zoomDuration}));(void 0===t.keyboard||t.keyboard)&&(e.push(new Fo),e.push(new ko({delta:t.zoomDelta,duration:t.zoomDuration})));(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new zo({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration}));return(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new Ao({duration:t.zoomDuration})),e}function Uo(t){return t[0]>0&&t[1]>0}function Xo(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function Yo(t){t instanceof ir?t.setMapInternal(null):t instanceof Ur&&t.getLayers().forEach(Yo)}function Vo(t,e){if(t instanceof ir)t.setMapInternal(e);else if(t instanceof Ur){const i=t.getLayers().getArray();for(let t=0,n=i.length;t<n;++t)Vo(i[t],e)}}var Wo=class extends W{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const i={},n=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Ur({layers:t.layers});let r,o,s;i[Zr.LAYERGROUP]=n,i[Zr.TARGET]=t.target,i[Zr.VIEW]=t.view instanceof tr?t.view:new tr,void 0!==t.controls&&(Array.isArray(t.controls)?r=new tt(t.controls.slice()):(lt("function"==typeof t.controls.getArray,47),r=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?o=new tt(t.interactions.slice()):(lt("function"==typeof t.interactions.getArray,48),o=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?s=new tt(t.overlays.slice()):(lt("function"==typeof t.overlays.getArray,49),s=t.overlays):s=new tt;return{controls:r,interactions:o,keyboardEventTarget:e,overlays:s,values:i}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:ot,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||so(),this.interactions=e.interactions||Bo({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new to(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Zr.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Zr.VIEW,this.handleViewChanged_),this.addChangeListener(Zr.SIZE,this.handleSizeChanged_),this.addChangeListener(Zr.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const i=this;!t.view||t.view instanceof tr||t.view.then((function(t){i.setView(new tr(t))})),this.controls.addEventListener(J.ADD,(t=>{t.element.setMap(this)})),this.controls.addEventListener(J.REMOVE,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(J.ADD,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(J.REMOVE,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(J.ADD,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(J.REMOVE,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Vo(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,o=void 0!==i.layerFilter?i.layerFilter:R,s=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,s,e,null,o,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i}getAllLayers(){const t=[];return function e(i){i.forEach((function(i){i instanceof Ur?e(i.getLayers()):t.push(i)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:R,r=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,o,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),n=e.width/i[0],r=e.height/i[1],o="changedTouches"in t?t.changedTouches[0]:t;return[(o.clientX-e.left)/n,(o.clientY-e.top)/r]}getTarget(){return this.get(Zr.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return bi(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?ct(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Zr.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof tt)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const r=i.layer.getSource();if(r&&r.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Mi(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?ct(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Zr.SIZE)}getView(){return this.get(Zr.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return eo(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new Yr(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===Wr.POINTERDOWN||i===k.WHEEL||i===k.KEYDOWN){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,n=e.target;if(this.overlayContainerStopEvent_.contains(n)||!(i===t?t.documentElement:i).contains(n))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.getMap()!==this||!n.getActive()||!this.getTargetElement())continue;if(!n.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,n=i;if(t){const e=t.viewHints;if(e[Ie.ANIMATING]||e[Ie.INTERACTING]){const e=Date.now()-t.time>8;i=e?0:8,n=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(Ce.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ce.RENDERCOMPLETE,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new Xr(Hr.LOADEND,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new Xr(Hr.LOADSTART,this,t))));const i=this.postRenderFunctions_;for(let e=0,n=i.length;e<n;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)j(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(k.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(k.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,yr(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new zr(this)),this.mapBrowserEventHandler_=new Kr(this,this.moveTolerance_);for(const t in Vr)this.mapBrowserEventHandler_.addEventListener(Vr[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(k.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(k.WHEEL,this.boundHandleBrowserEvent_,!!ht&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[G(t,k.KEYDOWN,this.handleBrowserEvent,this),G(t,k.KEYPRESS,this.handleBrowserEvent,this)];const i=e.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(j(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(j(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=G(t,E.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=G(t,k.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(j),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new jr("addlayer",t)),this.layerGroupPropertyListenerKeys_=[G(t,E.PROPERTYCHANGE,this.render,this),G(t,k.CHANGE,this.render,this),G(t,"addlayer",this.handleLayerAdd_,this),G(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){Yo(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let r=null;if(void 0!==e&&Uo(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Bt(o.center,o.resolution,o.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:o,viewHints:n,wantedTiles:{},mapId:Y(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const t=isNaN(o.nextRotation)?o.rotation:o.nextRotation;r.nextExtent=Bt(o.nextCenter,o.nextResolution,t,e)}}if(this.frameState_=r,this.renderer_.renderFrame(r),r){if(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),n){(!this.previousExtent_||!Zt(this.previousExtent_)&&!Tt(r.extent,this.previousExtent_))&&(this.dispatchEvent(new Xr(Hr.MOVESTART,this,n)),this.previousExtent_=Pt(this.previousExtent_))}this.previousExtent_&&!r.viewHints[Ie.ANIMATING]&&!r.viewHints[Ie.INTERACTING]&&!Tt(r.extent,this.previousExtent_)&&(this.dispatchEvent(new Xr(Hr.MOVEEND,this,r)),xt(r.extent,this.previousExtent_))}this.dispatchEvent(new Xr(Hr.POSTRENDER,this,r)),this.renderComplete_=this.hasListener(Hr.LOADSTART)||this.hasListener(Hr.LOADEND)||this.hasListener(Ce.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new jr("removelayer",e)),this.set(Zr.LAYERGROUP,t)}setSize(t){this.set(Zr.SIZE,t)}setTarget(t){this.set(Zr.TARGET,t)}setView(t){if(!t||t instanceof tr)return void this.set(Zr.VIEW,t);this.set(Zr.VIEW,new tr);const e=this;t.then((function(t){e.setView(new tr(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const i=getComputedStyle(t),n=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),r=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(n)||isNaN(r)||(e=[n,r],!Uo(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&ri("No map visible because the map container's width or height are 0."))}const i=this.getSize();!e||i&&P(e,i)||(this.setSize(e),this.updateViewportSize_())}updateViewportSize_(){const t=this.getView();if(t){let e;const i=getComputedStyle(this.viewport_);i.width&&i.height&&(e=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(e)}}};var Ko=class extends F{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(k.CHANGE)}release(){this.state===$r.ERROR&&this.setState($r.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let t=this.interimTile;do{if(t.getState()==$r.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){if(!this.interimTile)return;let t=this.interimTile,e=this;do{if(t.getState()==$r.LOADED){t.interimTile=null;break}t.getState()==$r.LOADING?e=t:t.getState()==$r.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==$r.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){U()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const n=e-i+1e3/60;return n>=this.transition_?1:Ui(n/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}};var Ho={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Zo(t,e,i){const n=t;let r=!0,o=!1,s=!1;const a=[z(n,k.LOAD,(function(){s=!0,o||e()}))];return n.src&&at?(o=!0,n.decode().then((function(){r&&e()})).catch((function(t){r&&(s?e():i())}))):a.push(z(n,k.ERROR,i)),function(){r=!1,a.forEach(j)}}var Jo=class extends Ko{constructor(t,e,i,n,r,o){super(t,e,o),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=$r.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=$r.ERROR,this.unlistenImage_(),this.image_=function(){const t=fr(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=$r.LOADED:this.state=$r.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==$r.ERROR&&(this.state=$r.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==$r.IDLE&&(this.state=$r.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Zo(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}};var Qo=class{constructor(t,e,i,n,r,o){this.sourceProj_=t,this.targetProj_=e;let s={};const a=mi(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return s[e]||(s[e]=a(t)),s[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Kt(n)==Kt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Kt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Kt(this.targetProj_.getExtent()):null;const h=Vt(i),l=Wt(i),u=zt(i),c=Gt(i),p=this.transformInv_(h),f=this.transformInv_(l),d=this.transformInv_(u),g=this.transformInv_(c),y=10+(o?Math.max(0,Math.ceil(Math.log2(kt(i)/(o*o*65536)))):0);if(this.addQuad_(h,l,u,c,p,f,d,g,y),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,n){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const n=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-n<this.sourceWorldWidth_/2&&(e.source=i)}}))}s={}}addTriangle_(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})}addQuad_(t,e,i,n,r,o,s,a,h){const l=mt([r,o,s,a]),u=this.sourceWorldWidth_?Kt(l)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&u>.5&&u<1;let f=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){f=Kt(mt([t,e,i,n]))/this.targetWorldWidth_>.25||f}!p&&this.sourceProj_.isGlobal()&&u&&(f=u>.25||f)}if(!f&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!Ht(l,this.maxSourceExtent_))return;let d=0;if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(h>0)f=!0;else if(d=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=d&&2!=d&&4!=d&&8!=d)return;if(h>0){if(!f){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],n=this.transformInv_(e);let o;if(p){o=(ae(r[0],c)+ae(s[0],c))/2-ae(n[0],c)}else o=(r[0]+s[0])/2-n[0];const a=(r[1]+s[1])/2-n[1];f=o*o+a*a>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const l=[(e[0]+i[0])/2,(e[1]+i[1])/2],u=this.transformInv_(l),c=[(n[0]+t[0])/2,(n[1]+t[1])/2],p=this.transformInv_(c);this.addQuad_(t,e,l,c,r,o,u,p,h-1),this.addQuad_(c,l,i,n,p,u,s,a,h-1)}else{const l=[(t[0]+e[0])/2,(t[1]+e[1])/2],u=this.transformInv_(l),c=[(i[0]+n[0])/2,(i[1]+n[1])/2],p=this.transformInv_(c);this.addQuad_(t,l,c,n,r,u,p,a,h-1),this.addQuad_(l,e,i,c,u,o,s,p,h-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&d)&&this.addTriangle_(t,i,n,r,s,a),0==(14&d)&&this.addTriangle_(t,i,e,r,s,o),d&&(0==(13&d)&&this.addTriangle_(e,n,t,o,a,r),0==(7&d)&&this.addTriangle_(e,n,i,o,a,s))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){const r=e.source;Ot(t,r[0]),Ot(t,r[1]),Ot(t,r[2])})),t}getTriangles(){return this.triangles_}};let $o;const ts=[];function es(t,e,i,n,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,r)),t.restore()}function is(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function ns(t,e,i,n){const r=vi(i,e,t);let o=ci(e,n,i);const s=e.getMetersPerUnit();void 0!==s&&(o*=s);const a=t.getMetersPerUnit();void 0!==a&&(o/=a);const h=t.getExtent();if(!h||wt(h,r)){const e=ci(t,o,r)/o;isFinite(e)&&e>0&&(o/=e)}return o}function rs(t,e,i,n){const r=jt(i);let o=ns(t,e,r,n);return(!isFinite(o)||o<=0)&&Ft(i,(function(i){return o=ns(t,e,i,n),isFinite(o)&&o>0})),o}function os(t,e,i,n,r,o,s,a,h,l,u,c){const p=fr(Math.round(i*t),Math.round(i*e),ts);if(c||(p.imageSmoothingEnabled=!1),0===h.length)return p.canvas;function f(t){return Math.round(t*i)/i}p.scale(i,i),p.globalCompositeOperation="lighter";const d=[1/0,1/0,-1/0,-1/0];h.forEach((function(t,e,i){Lt(d,t.extent)}));const g=Kt(d),y=Xt(d),_=fr(Math.round(i*g/n),Math.round(i*y/n),ts);c||(_.imageSmoothingEnabled=!1);const m=i/n;h.forEach((function(t,e,i){const n=t.extent[0]-d[0],r=-(t.extent[3]-d[3]),o=Kt(t.extent),s=Xt(t.extent);t.image.width>0&&t.image.height>0&&_.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,n*m,r*m,o*m,s*m)}));const v=Vt(s);return a.getTriangles().forEach((function(t,e,r){const s=t.source,a=t.target;let h=s[0][0],l=s[0][1],u=s[1][0],g=s[1][1],y=s[2][0],m=s[2][1];const x=f((a[0][0]-v[0])/o),E=f(-(a[0][1]-v[1])/o),w=f((a[1][0]-v[0])/o),b=f(-(a[1][1]-v[1])/o),M=f((a[2][0]-v[0])/o),C=f(-(a[2][1]-v[1])/o),I=h,S=l;h=0,l=0,u-=I,g-=S,y-=I,m-=S;const P=oe([[u,g,0,0,w-x],[y,m,0,0,M-x],[0,0,u,g,b-E],[0,0,y,m,C-E]]);if(P){if(p.save(),p.beginPath(),function(){if(void 0===$o){const t=fr(6,6,ts);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",es(t,4,5,4,0),es(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;$o=is(e,0)||is(e,4)||is(e,8),dr(t),ts.push(t.canvas)}return $o}()||!c){p.moveTo(w,b);const t=4,e=x-w,i=E-b;for(let n=0;n<t;n++)p.lineTo(w+f((n+1)*e/t),b+f(n*i/(t-1))),n!=t-1&&p.lineTo(w+f((n+1)*e/t),b+f((n+1)*i/(t-1)));p.lineTo(M,C)}else p.moveTo(w,b),p.lineTo(x,E),p.lineTo(M,C);p.clip(),p.transform(P[0],P[2],P[1],P[3],x,E),p.translate(d[0]-I,d[3]-S),p.scale(n/i,-n/i),p.drawImage(_.canvas,0,0),p.restore()}})),dr(_),ts.push(_.canvas),u&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,a.getTriangles().forEach((function(t,e,i){const n=t.target,r=(n[0][0]-v[0])/o,s=-(n[0][1]-v[1])/o,a=(n[1][0]-v[0])/o,h=-(n[1][1]-v[1])/o,l=(n[2][0]-v[0])/o,u=-(n[2][1]-v[1])/o;p.beginPath(),p.moveTo(a,h),p.lineTo(r,s),p.lineTo(l,u),p.closePath(),p.stroke()})),p.restore()),p.canvas}var ss=class extends Ko{constructor(t,e,i,n,r,o,s,a,h,l,u,c){super(r,$r.IDLE,{interpolate:!!c}),this.renderEdges_=void 0!==u&&u,this.pixelRatio_=s,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const p=n.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let d=this.sourceTileGrid_.getExtent();const g=f?Yt(p,f):p;if(0===kt(g))return void(this.state=$r.EMPTY);const y=t.getExtent();y&&(d=d?Yt(d,y):y);const _=n.getResolution(this.wrappedTileCoord_[0]),m=rs(t,i,g,_);if(!isFinite(m)||m<=0)return void(this.state=$r.EMPTY);const v=void 0!==l?l:.5;if(this.triangulation_=new Qo(t,i,g,d,m*v,_),0===this.triangulation_.getTriangles().length)return void(this.state=$r.EMPTY);this.sourceZ_=e.getZForResolution(m);let x=this.triangulation_.calculateSourceExtent();if(d&&(t.canWrapX()?(x[1]=ie(x[1],d[1],d[3]),x[3]=ie(x[3],d[1],d[3])):x=Yt(x,d)),kt(x)){const t=e.getTileRangeForExtentAndZ(x,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=h(this.sourceZ_,e,i,s);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=$r.EMPTY)}else this.state=$r.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&e.getState()==$r.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=$r.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=os(n,r,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=$r.LOADED}this.changed()}load(){if(this.state==$r.IDLE){this.state=$r.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(i==$r.IDLE||i==$r.LOADING){t++;const i=G(e,k.CHANGE,(function(n){const r=e.getState();r!=$r.LOADED&&r!=$r.ERROR&&r!=$r.EMPTY||(j(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){t.getState()==$r.IDLE&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(j),this.sourcesListenerKeys_=null}release(){this.canvas_&&(dr(this.canvas_.getContext("2d")),ts.push(this.canvas_),this.canvas_=null),super.release()}};var as=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return lt(void 0!==i,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return lt(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){if(this.containsKey(t))return this.entries_[t].value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){lt(!(t in this.entries_),16);const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function hs(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function ls(t,e,i){return t+"/"+e+"/"+i}function us(t){return ls(t[0],t[1],t[2])}function cs(t){return t.split("/").map(Number)}function ps(t){return(t[1]<<t[0])+t[2]}function fs(t,e){const i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;const o=e.getFullTileRange(i);return!o||o.containsXY(n,r)}var ds=class extends as{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}}pruneExceptNewestZ(){if(0===this.getCount())return;const t=cs(this.peekFirstKey())[0];this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(us(e.tileCoord)),e.release())}))}},gs={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};function ys(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var _s=class extends W{constructor(t){super(),this.projection=ui(t.projection),this.attributions_=ys(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,i){e.viewResolver=t,e.viewRejector=i}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=ys(t),this.changed()}setState(t){this.state_=t,this.changed()}};class ms{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function vs(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new ms(t,e,i,n)}var xs=ms;const Es=[0,0,0];var ws=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,lt(N(this.resolutions_,(function(t,e){return e-t}),!0),17),!t.origins)for(let t=0,i=this.resolutions_.length-1;t<i;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,lt(this.origins_.length==this.resolutions_.length,20));const i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=Vt(i)),lt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,lt(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:Ne,lt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){const n=new xs(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){const t=this.getTileRangeForExtentAndZ(i,e);n.minX=Math.max(t.minX,n.minX),n.maxX=Math.min(t.maxX,n.maxX),n.minY=Math.max(t.minY,n.minY),n.maxY=Math.min(t.maxY,n.maxY)}return n}),this):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let t=n.minX,r=n.maxX;t<=r;++t)for(let r=n.minY,o=n.maxY;r<=o;++r)i([e,t,r])}forEachTileCoordParentTileRange(t,e,i,n){let r,o,s,a=null,h=t[0]-1;for(2===this.zoomFactor_?(o=t[1],s=t[2]):a=this.getTileCoordExtent(t,n);h>=this.minZoom;){if(2===this.zoomFactor_?(o=Math.floor(o/2),s=Math.floor(s/2),r=vs(o,o,s,s,i)):r=this.getTileRangeForExtentAndZ(a,h,i),e(h,r))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],n=2*t[2];return vs(i,i+1,n,n+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],r=t[1],o=t[2];if(e===n)return vs(r,o,r,o,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-n),s=Math.floor(r*t),a=Math.floor(o*t);if(e<n)return vs(s,s,a,a,i);return vs(s,Math.floor(t*(r+1))-1,a,Math.floor(t*(o+1))-1,i)}const s=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,e,i)}getTileRangeExtent(t,e,i){const n=this.getOrigin(t),r=this.getResolution(t),o=Xo(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*o[0]*r,a=n[0]+(e.maxX+1)*o[0]*r;return St(s,n[1]+e.minY*o[1]*r,a,n[1]+(e.maxY+1)*o[1]*r,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Es);const n=Es[1],r=Es[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Es);return vs(n,Es[1],r,Es[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Xo(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=Xo(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,s=i[1]-(t[2]+1)*r[1]*n;return St(o,s,o+r[0]*n,s+r[1]*n,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,r){const o=this.getZForResolution(i),s=i/this.getResolution(o),a=this.getOrigin(o),h=Xo(this.getTileSize(o),this.tmpSize_);let l=s*(t-a[0])/i/h[0],u=s*(a[1]-e)/i/h[1];return n?(l=ce(l,5)-1,u=ce(u,5)-1):(l=ue(l,5),u=ue(u,5)),hs(o,l,u,r)}getTileCoordForXYAndZ_(t,e,i,n,r){const o=this.getOrigin(i),s=this.getResolution(i),a=Xo(this.getTileSize(i),this.tmpSize_);let h=(t-o[0])/s/a[0],l=(o[1]-e)/s/a[1];return n?(h=ce(h,5)-1,l=ce(l,5)-1):(h=ue(h,5),l=ue(l,5)),hs(i,h,l,r)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return ie(C(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return zn(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}};function bs(t){let e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){const r=Is(t);return function(t,e,i,n){n=void 0!==n?n:"top-left";const r=Cs(t,e,i);return new ws({extent:t,origin:qt(t,n),resolutions:r,tileSize:i})}(r,e,i,n)}(t),t.setDefaultTileGrid(e)),e}function Ms(t,e,i){const n=e[0],r=t.getTileCoordCenter(e),o=Is(i);if(!wt(o,r)){const e=Kt(o),i=Math.ceil((o[0]-r[0])/e);return r[0]+=e*i,t.getTileCoordForCoordAndZ(r,n)}return e}function Cs(t,e,i,n){e=void 0!==e?e:Pe,i=Xo(void 0!==i?i:Ne);const r=Xt(t),o=Kt(t);n=n>0?n:Math.max(o/i[0],r/i[1]);const s=e+1,a=new Array(s);for(let t=0;t<s;++t)a[t]=n/Math.pow(2,t);return a}function Is(t){let e=(t=ui(t)).getExtent();if(!e){const i=180*Re.degrees/t.getMetersPerUnit();e=St(-i,-i,i,i)}return e}class Ss extends x{constructor(t,e){super(t),this.tile=e}}var Ps=class extends _s{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&Xo(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new ds(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,n){const r=this.getTileCacheForProjection(t);if(!r)return!1;let o,s,a,h=!0;for(let t=i.minX;t<=i.maxX;++t)for(let l=i.minY;l<=i.maxY;++l)s=ls(e,t,l),a=!1,r.containsKey(s)&&(o=r.get(s),a=o.getState()===$r.LOADED,a&&(a=!1!==n(o))),a||(h=!1);return h}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,r){return U()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:bs(t)}getTileCacheForProjection(t){const e=this.getProjection();return lt(null===e||yi(e,t),68),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),o=Xo(n.getTileSize(t),this.tmpSize);return 1==r?o:(s=o,a=r,void 0===(h=this.tmpSize)&&(h=[0,0]),h[0]=s[0]*a+.5|0,h[1]=s[1]*a+.5|0,h);var s,a,h}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=Ms(i,t,e)),fs(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,n){}};function Ns(t,e){const i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,h){if(s)return t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(r,s[2].toString()).replace(o,(function(){const t=s[0],i=e.getFullTileRange(t);lt(i,55);return(i.getHeight()-s[2]-1).toString()}))}}function Rs(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ns(t[r],e);return Ts(n)}function Ts(t){return 1===t.length?t[0]:function(e,i,n){if(!e)return;const r=ae(ps(e),t.length);return t[r](e,i,n)}}function Ls(t){const e=[];let i=/\{([a-z])-([a-z])\}/.exec(t);if(i){const n=i[1].charCodeAt(0),r=i[2].charCodeAt(0);let o;for(o=n;o<=r;++o)e.push(t.replace(i[0],String.fromCharCode(o)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t),i){const n=parseInt(i[2],10);for(let r=parseInt(i[1],10);r<=n;r++)e.push(t.replace(i[0],r.toString()));return e}return e.push(t),e}class Os extends Ps{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Os.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=Y(e),n=e.getState();let r;n==$r.LOADING?(this.tileLoadingKeys_[i]=!0,r=gs.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=n==$r.ERROR?gs.TILELOADERROR:n==$r.LOADED?gs.TILELOADEND:void 0),null!=r&&this.dispatchEvent(new Ss(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=Ls(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Rs(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const n=ls(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}var As=Os;function Ds(t,e){t.getImage().src=e}var Fs=class extends As{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Ds,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:Jo,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const t in this.tileCacheForProjection){const n=this.tileCacheForProjection[t];n.expireCache(n==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!yi(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!yi(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||yi(e,t)))return this.tileGrid;const i=Y(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=bs(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||yi(e,t))return this.tileCache;const i=Y(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new ds(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,n,r,o){const s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,r),h=a?this.tileUrlFunction(a,n,r):void 0,l=new this.tileClass(s,void 0!==h?$r.IDLE:$r.EMPTY,void 0!==h?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=o,l.addEventListener(k.CHANGE,this.handleTileChange.bind(this)),l}getTile(t,e,i,n,r){const o=this.getProjection();if(!o||!r||yi(o,r))return this.getTileInternal(t,e,i,n,o||r);const s=this.getTileCacheForProjection(r),a=[t,e,i];let h;const l=us(a);s.containsKey(l)&&(h=s.get(l));const u=this.getKey();if(h&&h.key==u)return h;const c=this.getTileGridForProjection(o),p=this.getTileGridForProjection(r),f=this.getTileCoordForTileUrlFunction(a,r),d=new ss(o,c,r,p,a,f,this.getTilePixelRatio(n),this.getGutter(),((t,e,i,n)=>this.getTileInternal(t,e,i,n,o)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return d.key=u,h?(d.interimTile=h,d.refreshInterimChain(),s.replace(l,d)):s.set(l,d),d}getTileInternal(t,e,i,n,r){let o=null;const s=ls(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)){if(o=this.tileCache.get(s),o.key!=a){const h=o;o=this.createTile_(t,e,i,n,r,a),h.getState()==$r.IDLE?o.interimTile=h.interimTile:o.interimTile=h,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,i,n,r,a),this.tileCache.set(s,o);return o}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const i=ui(t);if(i){const t=Y(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}};function ks(t,e){const i=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&i.push(t+"="+encodeURIComponent(e[t]))}));const n=i.join("&");return t=t.replace(/[?&]$/,""),(t+=t.includes("?")?"&":"?")+n}class Gs extends ws{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}}var zs=Gs;var js=class extends Fs{constructor(t){const e=void 0!==t.requestEncoding?t.requestEncoding:"KVP",i=t.tileGrid;let n=t.urls;void 0===n&&void 0!==t.url&&(n=Ls(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:n,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=Ts(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(Ts(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==e&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t="KVP"==e?ks(t,i):t.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t}));const n=this.tileGrid,r=this.dimensions_;return function(i,o,s){if(!i)return;const a={TileMatrix:n.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(a,r);let h=t;return h="KVP"==e?ks(h,a):h.replace(/\{(\w+?)\}/g,(function(t,e){return a[e]})),h}}};var qs={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var Bs=class extends ir{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(qs.PRELOAD)}setPreload(t){this.set(qs.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(qs.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(qs.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}};var Us=class extends B{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return U()}getData(t){return null}prepareFrame(t){return U()}renderFrame(t,e){return U()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return(n,r)=>{const o=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,r,o)}}forEachFeatureAtCoordinate(t,e,i,n,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){t.target.getState()===Ho.LOADED&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=Ho.LOADED&&e!=Ho.ERROR&&t.addEventListener(k.CHANGE,this.boundHandleImageChange_),e==Ho.IDLE&&(t.load(),e=t.getState()),e==Ho.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}};const Xs=[];let Ys=null;var Vs=class extends Us{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let n;Ys||(Ys=fr(1,1,void 0,{willReadFrequently:!0})),Ys.clearRect(0,0,1,1);try{Ys.drawImage(t,e,i,1,1,0,0,1,1),n=Ys.getImageData(0,0,1,1).data}catch(t){return Ys=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let r,o;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&P(_e(t.style.backgroundColor),_e(i)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(o=e.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){r=document.createElement("div"),r.className=n;let t=r.style;t.position="absolute",t.width="100%",t.height="100%",o=fr();const e=o.canvas;r.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=r,this.context=o}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=Vt(i),r=Wt(i),o=zt(i),s=Gt(i);ct(e.coordinateToPixelTransform,n),ct(e.coordinateToPixelTransform,r),ct(e.coordinateToPixelTransform,o),ct(e.coordinateToPixelTransform,s);const a=this.inversePixelTransform;ct(a,n),ct(a,r),ct(a,o),ct(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const r=new or(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_(Ce.PRERENDER,t,e)}postRender(t,e){this.dispatchRenderEvent_(Ce.POSTRENDER,t,e)}getRenderTransform(t,e,i,n,r,o,s){const a=r/2,h=o/2,l=n/e,u=-l,c=-t[0]+s,p=-t[1];return ft(this.tempTransform,a,h,l,u,-i,c,p)}disposeInternal(){delete this.frameState,super.disposeInternal()}};var Ws=class extends Vs{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new xs(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==$r.LOADED||i==$r.EMPTY||i==$r.ERROR&&!n}getTile(t,e,i,n){const r=n.pixelRatio,o=n.viewState.projection,s=this.getLayer();let a=s.getSource().getTile(t,e,i,r,o);return a.getState()==$r.ERROR&&s.getUseInterimTilesOnError()&&s.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=ct(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!wt(r,n))return null;const o=e.pixelRatio,s=e.viewState.projection,a=e.viewState,h=i.getRenderSource(),l=h.getTileGridForProjection(a.projection),u=h.getTilePixelRatio(e.pixelRatio);for(let t=l.getZForResolution(a.resolution);t>=l.getMinZoom();--t){const e=l.getTileCoordForCoordAndZ(n,t),i=h.getTile(t,e[1],e[2],o,s);if(!(i instanceof Jo||i instanceof ss)||i instanceof ss&&i.getState()===$r.EMPTY)return null;if(i.getState()!==$r.LOADED)continue;const r=l.getOrigin(t),c=Xo(l.getTileSize(t)),p=l.getResolution(t),f=Math.floor(u*((n[0]-r[0])/p-e[1]*c[0])),d=Math.floor(u*((r[1]-n[1])/p-e[2]*c[1])),g=Math.round(u*h.getGutterForProjection(a.projection));return this.getImageData(i.getImage(),f+g,d+g)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],n=t.viewState,r=n.projection,o=n.resolution,s=n.center,a=n.rotation,h=t.pixelRatio,l=this.getLayer(),u=l.getSource(),c=u.getRevision(),p=u.getTileGridForProjection(r),f=p.getZForResolution(o,u.zDirection),d=p.getResolution(f);let g=t.extent;const y=t.viewState.resolution,_=u.getTilePixelRatio(h),m=Math.round(Kt(g)/y*h),v=Math.round(Xt(g)/y*h),x=i.extent&&Ii(i.extent,r);x&&(g=Yt(g,Ii(i.extent,r)));const E=d*m/2/_,w=d*v/2/_,b=[s[0]-E,s[1]-w,s[0]+E,s[1]+w],C=p.getTileRangeForExtentAndZ(g,f),I={};I[f]={};const S=this.createLoadedTileFinder(u,r,I),P=this.tmpExtent,N=this.tmpTileRange_;this.newTiles_=!1;const R=a?Ut(n.center,y,a,t.size):void 0;for(let e=C.minX;e<=C.maxX;++e)for(let n=C.minY;n<=C.maxY;++n){if(a&&!p.tileCoordIntersectsViewport([f,e,n],R))continue;const r=this.getTile(f,e,n,t);if(this.isDrawableTile(r)){const e=Y(this);if(r.getState()==$r.LOADED){I[f][r.tileCoord.toString()]=r;let t=r.inTransition(e);t&&1!==i.opacity&&(r.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(r)||(this.newTiles_=!0)}if(1===r.getAlpha(e,t.time))continue}const o=p.getTileCoordChildTileRange(r.tileCoord,N,P);let s=!1;o&&(s=S(f+1,o)),s||p.forEachTileCoordParentTileRange(r.tileCoord,S,N,P)}const T=d/o*h/_;ft(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,a,-m/2,-v/2);const L=yt(this.pixelTransform);this.useContainer(e,L,this.getBackground(t));const O=this.context,A=O.canvas;dt(this.inversePixelTransform,this.pixelTransform),ft(this.tempTransform,m/2,v/2,T,T,0,-m/2,-v/2),A.width!=m||A.height!=v?(A.width=m,A.height=v):this.containerReused||O.clearRect(0,0,m,v),x&&this.clipUnrotated(O,t,x),u.getInterpolate()||(O.imageSmoothingEnabled=!1),this.preRender(O,t),this.renderedTiles.length=0;let D,F,k,G=Object.keys(I).map(Number);G.sort(M),1!==i.opacity||this.containerReused&&!u.getOpaque(t.viewState.projection)?(D=[],F=[]):G=G.reverse();for(let e=G.length-1;e>=0;--e){const i=G[e],n=u.getTilePixelSize(i,h,r),o=p.getResolution(i)/d,s=n[0]*o*T,a=n[1]*o*T,l=p.getTileCoordForCoordAndZ(Vt(b),i),c=p.getTileCoordExtent(l),g=ct(this.tempTransform,[_*(c[0]-b[0])/d,_*(b[3]-c[3])/d]),y=_*u.getGutterForProjection(r),m=I[i];for(const e in m){const n=m[e],r=n.tileCoord,o=l[1]-r[1],h=Math.round(g[0]-(o-1)*s),c=l[2]-r[2],p=Math.round(g[1]-(c-1)*a),d=Math.round(g[0]-o*s),_=Math.round(g[1]-c*a),v=h-d,x=p-_,E=f===i,w=E&&1!==n.getAlpha(Y(this),t.time);let b=!1;if(!w)if(D){k=[d,_,d+v,_,d+v,_+x,d,_+x];for(let t=0,e=D.length;t<e;++t)if(f!==i&&i<F[t]){const e=D[t];Ht([d,_,d+v,_+x],[e[0],e[3],e[4],e[7]])&&(b||(O.save(),b=!0),O.beginPath(),O.moveTo(k[0],k[1]),O.lineTo(k[2],k[3]),O.lineTo(k[4],k[5]),O.lineTo(k[6],k[7]),O.moveTo(e[6],e[7]),O.lineTo(e[4],e[5]),O.lineTo(e[2],e[3]),O.lineTo(e[0],e[1]),O.clip())}D.push(k),F.push(i)}else O.clearRect(d,_,v,x);this.drawTileImage(n,t,d,_,v,x,y,E),D&&!w?(b&&O.restore(),this.renderedTiles.unshift(n)):this.renderedTiles.push(n),this.updateUsedTiles(t.usedTiles,u,n)}}return this.renderedRevision=c,this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!Tt(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=h,this.renderedProjection=r,this.manageTilePyramid(t,u,p,h,r,g,f,l.getPreload()),this.scheduleExpireCache(t,u),this.postRender(O,t),i.extent&&O.restore(),O.imageSmoothingEnabled=!0,L!==A.style.transform&&(A.style.transform=L),this.container}drawTileImage(t,e,i,n,r,o,s,a){const h=this.getTileImage(t);if(!h)return;const l=Y(this),u=e.layerStatesArray[e.layerIndex],c=u.opacity*(a?t.getAlpha(l,e.time):1),p=c!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(h,s,s,h.width-2*s,h.height-2*s,i,n,r,o),p&&this.context.restore(),c!==u.opacity?e.animate=!0:a&&t.endTransition(l)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(t,e,i){const n=Y(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const n=Y(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}manageTilePyramid(t,e,i,n,r,o,s,a,h){const l=Y(e);l in t.wantedTiles||(t.wantedTiles[l]={});const u=t.wantedTiles[l],c=t.tileQueue,p=i.getMinZoom(),f=t.viewState.rotation,d=f?Ut(t.viewState.center,t.viewState.resolution,f,t.size):void 0;let g,y,_,m,v,x,E=0;for(x=p;x<=s;++x)for(y=i.getTileRangeForExtentAndZ(o,x,y),_=i.getResolution(x),m=y.minX;m<=y.maxX;++m)for(v=y.minY;v<=y.maxY;++v)f&&!i.tileCoordIntersectsViewport([x,m,v],d)||(s-x<=a?(++E,g=e.getTile(x,m,v,n,r),g.getState()==$r.IDLE&&(u[g.getKey()]=!0,c.isKeyQueued(g.getKey())||c.enqueue([g,l,i.getTileCoordCenter(g.tileCoord),_])),void 0!==h&&h(g)):e.useTile(x,m,v,r));e.updateCacheSize(E,r)}};var Ks=class extends Bs{constructor(t){super(t)}createRenderer(){return new Ws(this)}};let Hs=null;function Zs(t){Hs=t;const e=Object.keys(t.defs),i=e.length;let n,r;for(n=0;n<i;++n){const i=e[n];if(!ui(i)){const e=t.defs(i);let n=e.units;n||"longlat"!==e.projName||(n="degrees"),li(new Te({code:i,axisOrientation:e.axis,metersPerUnit:e.to_meter,units:n}))}}for(n=0;n<i;++n){const o=e[n],s=ui(o);for(r=0;r<i;++r){const i=e[r],n=ui(i);if(!He(o,i))if(t.defs[o]===t.defs[i])pi([s,n]);else{const e=t(o,i);gi(s,n,Pi(s,n,e.forward),Pi(n,s,e.inverse))}}}}var Js=1,Qs=2,$s=3,ta=5,ea=6378137,ia=6356752.314,na=.0066943799901413165,ra=484813681109536e-20,oa=Math.PI/2,sa=.16666666666666666,aa=.04722222222222222,ha=.022156084656084655,la=1e-10,ua=.017453292519943295,ca=57.29577951308232,pa=Math.PI/4,fa=2*Math.PI,da=3.14159265359,ga={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},ya={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},_a=/[\s_\-\/\(\)]/g;function ma(t,e){if(t[e])return t[e];for(var i,n=Object.keys(t),r=e.toLowerCase().replace(_a,""),o=-1;++o<n.length;)if((i=n[o]).toLowerCase().replace(_a,"")===r)return t[i]}function va(t){var e,i,n,r={},o=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t}),{}),s={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*ua},lat_1:function(t){r.lat1=t*ua},lat_2:function(t){r.lat2=t*ua},lat_ts:function(t){r.lat_ts=t*ua},lon_0:function(t){r.long0=t*ua},lon_1:function(t){r.long1=t*ua},lon_2:function(t){r.long2=t*ua},alpha:function(t){r.alpha=parseFloat(t)*ua},gamma:function(t){r.rectified_grid_angle=parseFloat(t)},lonc:function(t){r.longc=t*ua},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t;var e=ma(ya,t);e&&(r.to_meter=e.to_meter)},from_greenwich:function(t){r.from_greenwich=t*ua},pm:function(t){var e=ma(ga,t);r.from_greenwich=(e||parseFloat(t))*ua},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)},approx:function(){r.approx=!0}};for(e in o)i=o[e],e in s?"function"==typeof(n=s[e])?n(i):r[n]=i:r[e]=i;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}var xa=function(t){return new Sa(t).output()},Ea=1,wa=/\s/,ba=/[A-Za-z]/,Ma=/[A-Za-z84_]/,Ca=/[,\]]/,Ia=/[\d\.E\-\+]/;function Sa(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Ea}function Pa(t,e,i){Array.isArray(e)&&(i.unshift(e),e=null);var n=e?{}:t,r=i.reduce((function(t,e){return Na(e,t),t}),n);e&&(t[e]=r)}function Na(t,e){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(e[i]={},void Na(t[0],e[i])):void(e[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in e||(e[i]=[]),void e[i].push(t);var n;switch(Array.isArray(i)||(e[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&Na(t[2],e[i]));case"SPHEROID":case"ELLIPSOID":return e[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&Na(t[3],e[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void Pa(e,i,t);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return Na(t,e[i]);return Pa(e,i,t)}}else e[i]=t;else e[i]=!0}else e[t]=!0}Sa.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;wa.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case Ea:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},Sa.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(Ca.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},Sa.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Ea)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Ea,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Sa.prototype.number=function(t){if(!Ia.test(t)){if(Ca.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},Sa.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},Sa.prototype.keyword=function(t){if(Ma.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=Ea)}if(!Ca.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},Sa.prototype.neutral=function(t){if(ba.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(Ia.test(t))return this.word=t,void(this.state=3);if(!Ca.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},Sa.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Ra,Ta=.017453292519943295;function La(t){return t*Ta}function Oa(t){var e=xa(t),i=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",i]);var r={};return Na(e,r),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",i=0,n=t.AXIS.length;i<n;++i){var r=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==r[0].indexOf("north")||("y"===r[0]||"lat"===r[0])&&"north"===r[1]?e+="n":-1!==r[0].indexOf("south")||("y"===r[0]||"lat"===r[0])&&"south"===r[1]?e+="s":-1!==r[0].indexOf("east")||("x"===r[0]||"lon"===r[0])&&"east"===r[1]?e+="e":-1===r[0].indexOf("west")&&("x"!==r[0]&&"lon"!==r[0]||"west"!==r[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var o=t.GEOGCS;function s(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(o=t),o&&(o.DATUM?t.datumCode=o.DATUM.name.toLowerCase():t.datumCode=o.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=o.DATUM.SPHEROID.a,t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(t.datum_params=o.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",La],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",La],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",La],["lat0","latitude_of_origin",La],["lat0","standard_parallel_1",La],["lat1","standard_parallel_1",La],["lat2","standard_parallel_2",La],["azimuth","Azimuth"],["alpha","azimuth",La],["srsCode","name"]].forEach((function(e){return i=t,r=(n=e)[0],o=n[1],void(!(r in i)&&o in i&&(i[r]=i[o],3===n.length&&(i[r]=n[2](i[r]))));var i,n,r,o})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=La(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(r),r}function Aa(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?Aa[t]=va(arguments[1]):Aa[t]=Oa(arguments[1]):Aa[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?Aa.apply(e,t):Aa(t)}));if("string"==typeof t){if(t in Aa)return Aa[t]}else"EPSG"in t?Aa["EPSG:"+t.EPSG]=t:"ESRI"in t?Aa["ESRI:"+t.ESRI]=t:"IAU2000"in t?Aa["IAU2000:"+t.IAU2000]=t:console.log(t);return}}(Ra=Aa)("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),Ra("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),Ra("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),Ra.WGS84=Ra["EPSG:4326"],Ra["EPSG:3785"]=Ra["EPSG:3857"],Ra.GOOGLE=Ra["EPSG:3857"],Ra["EPSG:900913"]=Ra["EPSG:3857"],Ra["EPSG:102113"]=Ra["EPSG:3857"];var Da=Aa;var Fa=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var ka=["3857","900913","3785","102113"];var Ga=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in Da}(t))return Da[t];if(function(t){return Fa.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=Oa(t);if(function(t){var e=ma(t,"authority");if(e){var i=ma(e,"epsg");return i&&ka.indexOf(i)>-1}}(e))return Da["EPSG:3857"];var i=function(t){var e=ma(t,"extension");if(e)return ma(e,"proj4")}(e);return i?va(i):e}return function(t){return"+"===t[0]}(t)?va(t):void 0};function za(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t}function ja(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}function qa(t){return t<0?-1:1}function Ba(t){return Math.abs(t)<=da?t:t-qa(t)*fa}function Ua(t,e,i){var n=t*i,r=.5*t;return n=Math.pow((1-n)/(1+n),r),Math.tan(.5*(oa-e))/n}function Xa(t,e){for(var i,n,r=.5*t,o=oa-2*Math.atan(e),s=0;s<=15;s++)if(i=t*Math.sin(o),o+=n=oa-2*Math.atan(e*Math.pow((1-i)/(1+i),r))-o,Math.abs(n)<=1e-10)return o;return-9999}function Ya(t){return t}var Va=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=ja(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,i,n=t.x,r=t.y;if(r*ca>90&&r*ca<-90&&n*ca>180&&n*ca<-180)return null;if(Math.abs(Math.abs(r)-oa)<=la)return null;if(this.sphere)e=this.x0+this.a*this.k0*Ba(n-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(pa+.5*r));else{var o=Math.sin(r),s=Ua(this.e,r,o);e=this.x0+this.a*this.k0*Ba(n-this.long0),i=this.y0-this.a*this.k0*Math.log(s)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n=t.x-this.x0,r=t.y-this.y0;if(this.sphere)i=oa-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if(-9999===(i=Xa(this.e,o)))return null}return e=Ba(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:Ya,inverse:Ya,names:["longlat","identity"]}],Wa={},Ka=[];function Ha(t,e){var i=Ka.length;return t.names?(Ka[i]=t,t.names.forEach((function(t){Wa[t.toLowerCase()]=i})),this):(console.log(e),!0)}var Za={start:function(){Va.forEach(Ha)},add:Ha,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==Wa[e]&&Ka[Wa[e]]?Ka[Wa[e]]:void 0}},Ja={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},Qa=Ja.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};function $a(t,e,i,n,r){if(!t){var o=ma(Ja,n);o||(o=Qa),t=o.a,e=o.b,i=o.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<la)&&(r=!0,e=t),{a:t,b:e,rf:i,sphere:r}}Ja.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var th={};th.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},th.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},th.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},th.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},th.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},th.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},th.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},th.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},th.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},th.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},th.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},th.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},th.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},th.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},th.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},th.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},th.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var eh=function(t,e,i,n,r,o,s){var a={};return a.datum_type=void 0===t||"none"===t?ta:4,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=Js),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=Qs,a.datum_params[3]*=ra,a.datum_params[4]*=ra,a.datum_params[5]*=ra,a.datum_params[6]=a.datum_params[6]/1e6+1))),s&&(a.datum_type=$s,a.grids=s),a.a=i,a.b=n,a.es=r,a.ep2=o,a},ih={};function nh(t){return void 0===t?null:t.split(",").map(rh)}function rh(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:ih[t]||null,isNull:!1}}function oh(t){return t/3600*Math.PI/180}function sh(t,e,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,i)))}function ah(t){return t.map((function(t){return[oh(t.longitudeShift),oh(t.latitudeShift)]}))}function hh(t,e,i){return{name:sh(t,e+8,e+16).trim(),parent:sh(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,i),upperLatitude:t.getFloat64(e+88,i),lowerLongitude:t.getFloat64(e+104,i),upperLongitude:t.getFloat64(e+120,i),latitudeInterval:t.getFloat64(e+136,i),longitudeInterval:t.getFloat64(e+152,i),gridNodeCount:t.getInt32(e+168,i)}}function lh(t,e,i,n){for(var r=e+176,o=[],s=0;s<i.gridNodeCount;s++){var a={latitudeShift:t.getFloat32(r+16*s,n),longitudeShift:t.getFloat32(r+16*s+4,n),latitudeAccuracy:t.getFloat32(r+16*s+8,n),longitudeAccuracy:t.getFloat32(r+16*s+12,n)};o.push(a)}return o}function uh(t,e){if(!(this instanceof uh))return new uh(t);e=e||function(t){if(t)throw t};var i=Ga(t);if("object"==typeof i){var n=uh.projections.get(i.projName);if(n){if(i.datumCode&&"none"!==i.datumCode){var r=ma(th,i.datumCode);r&&(i.datum_params=i.datum_params||(r.towgs84?r.towgs84.split(","):null),i.ellps=r.ellipse,i.datumName=r.datumName?r.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var o,s,a,h,l,u,c,p=$a(i.a,i.b,i.rf,i.ellps,i.sphere),f=(o=p.a,s=p.b,p.rf,a=i.R_A,u=((h=o*o)-(l=s*s))/h,c=0,a?(h=(o*=1-u*(sa+u*(aa+u*ha)))*o,u=0):c=Math.sqrt(u),{es:u,e:c,ep2:(h-l)/l}),d=nh(i.nadgrids),g=i.datum||eh(i.datumCode,i.datum_params,p.a,p.b,f.es,f.ep2,d);za(this,i),za(this,n),this.a=p.a,this.b=p.b,this.rf=p.rf,this.sphere=p.sphere,this.es=f.es,this.e=f.e,this.ep2=f.ep2,this.datum=g,this.init(),e(null,this)}else e(t)}else e(t)}uh.projections=Za,uh.projections.start();var ch=uh;function ph(t,e){return t.datum_type===e.datum_type&&(!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(t.datum_type===Js?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type!==Qs||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]))}function fh(t,e,i){var n,r,o,s,a=t.x,h=t.y,l=t.z?t.z:0;if(h<-oa&&h>-1.001*oa)h=-oa;else if(h>oa&&h<1.001*oa)h=oa;else{if(h<-oa)return{x:-1/0,y:-1/0,z:t.z};if(h>oa)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),r=Math.sin(h),s=Math.cos(h),o=r*r,{x:((n=i/Math.sqrt(1-e*o))+l)*s*Math.cos(a),y:(n+l)*s*Math.sin(a),z:(n*(1-e)+l)*r}}function dh(t,e,i,n){var r,o,s,a,h,l,u,c,p,f,d,g,y,_,m,v=1e-12,x=t.x,E=t.y,w=t.z?t.z:0;if(r=Math.sqrt(x*x+E*E),o=Math.sqrt(x*x+E*E+w*w),r/i<v){if(_=0,o/i<v)return oa,m=-n,{x:t.x,y:t.y,z:t.z}}else _=Math.atan2(E,x);s=w/o,c=(a=r/o)*(1-e)*(h=1/Math.sqrt(1-e*(2-e)*a*a)),p=s*h,y=0;do{y++,l=e*(u=i/Math.sqrt(1-e*p*p))/(u+(m=r*c+w*p-u*(1-e*p*p))),g=(d=s*(h=1/Math.sqrt(1-l*(2-l)*a*a)))*c-(f=a*(1-l)*h)*p,c=f,p=d}while(g*g>1e-24&&y<30);return{x:_,y:Math.atan(d/Math.abs(f)),z:m}}function gh(t,e,i){if(e===Js)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(e===Qs){var n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],h=i[5],l=i[6];return{x:l*(t.x-h*t.y+a*t.z)+n,y:l*(h*t.x+t.y-s*t.z)+r,z:l*(-a*t.x+s*t.y+t.z)+o}}}function yh(t,e,i){if(e===Js)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(e===Qs){var n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],h=i[5],l=i[6],u=(t.x-n)/l,c=(t.y-r)/l,p=(t.z-o)/l;return{x:u+h*c-a*p,y:-h*u+c+s*p,z:a*u-s*c+p}}}function _h(t){return t===Js||t===Qs}function mh(t,e,i){if(ph(t,e))return i;if(t.datum_type===ta||e.datum_type===ta)return i;var n=t.a,r=t.es;if(t.datum_type===$s){if(0!==vh(t,!1,i))return;n=ea,r=na}var o=e.a,s=e.b,a=e.es;if(e.datum_type===$s&&(o=ea,s=ia,a=na),r===a&&n===o&&!_h(t.datum_type)&&!_h(e.datum_type))return i;if((i=fh(i,r,n),_h(t.datum_type)&&(i=gh(i,t.datum_type,t.datum_params)),_h(e.datum_type)&&(i=yh(i,e.datum_type,e.datum_params)),i=dh(i,a,o,s),e.datum_type===$s)&&0!==vh(e,!0,i))return;return i}function vh(t,e,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;for(var n={x:-i.x,y:i.y},r={x:Number.NaN,y:Number.NaN},o=[],s=0;s<t.grids.length;s++){var a=t.grids[s];if(o.push(a.name),a.isNull){r=n;break}if(a.mandatory,null!==a.grid){var h=a.grid.subgrids[0],l=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,u=h.ll[0]-l,c=h.ll[1]-l,p=h.ll[0]+(h.lim[0]-1)*h.del[0]+l,f=h.ll[1]+(h.lim[1]-1)*h.del[1]+l;if(!(c>n.y||u>n.x||f<n.y||p<n.x||(r=xh(n,e,h),isNaN(r.x))))break}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*ca+" "+n.y*ca+" tried: '"+o+"'"),-1):(i.x=-r.x,i.y=r.y,0)}function xh(t,e,i){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return n;var r={x:t.x,y:t.y};r.x-=i.ll[0],r.y-=i.ll[1],r.x=Ba(r.x-Math.PI)+Math.PI;var o=Eh(r,i);if(e){if(isNaN(o.x))return n;o.x=r.x-o.x,o.y=r.y-o.y;var s,a,h=9;do{if(a=Eh(o,i),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}s={x:r.x-(a.x+o.x),y:r.y-(a.y+o.y)},o.x+=s.x,o.y+=s.y}while(h--&&Math.abs(s.x)>1e-12&&Math.abs(s.y)>1e-12);if(h<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=Ba(o.x+i.ll[0]),n.y=o.y+i.ll[1]}else isNaN(o.x)||(n.x=t.x+o.x,n.y=t.y+o.y);return n}function Eh(t,e){var i,n={x:t.x/e.del[0],y:t.y/e.del[1]},r=Math.floor(n.x),o=Math.floor(n.y),s=n.x-1*r,a=n.y-1*o,h={x:Number.NaN,y:Number.NaN};if(r<0||r>=e.lim[0])return h;if(o<0||o>=e.lim[1])return h;i=o*e.lim[0]+r;var l=e.cvs[i][0],u=e.cvs[i][1];i++;var c=e.cvs[i][0],p=e.cvs[i][1];i+=e.lim[0];var f=e.cvs[i][0],d=e.cvs[i][1];i--;var g=e.cvs[i][0],y=e.cvs[i][1],_=s*a,m=s*(1-a),v=(1-s)*(1-a),x=(1-s)*a;return h.x=v*l+m*c+x*g+_*f,h.y=v*u+m*p+x*y+_*d,h}function wh(t,e,i){var n,r,o,s=i.x,a=i.y,h=i.z||0,l={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==i.z)switch(0===o?(n=s,r=-1!=="ew".indexOf(t.axis[o])?"x":"y"):1===o?(n=a,r=-1!=="ns".indexOf(t.axis[o])?"y":"x"):(n=h,r="z"),t.axis[o]){case"e":case"n":l[r]=n;break;case"w":case"s":l[r]=-n;break;case"u":void 0!==i[r]&&(l.z=n);break;case"d":void 0!==i[r]&&(l.z=-n);break;default:return null}return l}function bh(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Mh(t){Ch(t.x),Ch(t.y)}function Ch(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Ih(t,e,i,n){var r,o=void 0!==(i=Array.isArray(i)?bh(i):{x:i.x,y:i.y,z:i.z,m:i.m}).z;if(Mh(i),t.datum&&e.datum&&function(t,e){return(t.datum.datum_type===Js||t.datum.datum_type===Qs||t.datum.datum_type===$s)&&"WGS84"!==e.datumCode||(e.datum.datum_type===Js||e.datum.datum_type===Qs||e.datum.datum_type===$s)&&"WGS84"!==t.datumCode}(t,e)&&(i=Ih(t,r=new ch("WGS84"),i,n),t=r),n&&"enu"!==t.axis&&(i=wh(t,!1,i)),"longlat"===t.projName)i={x:i.x*ua,y:i.y*ua,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),!(i=t.inverse(i)))return;if(t.from_greenwich&&(i.x+=t.from_greenwich),i=mh(t.datum,e.datum,i))return e.from_greenwich&&(i={x:i.x-e.from_greenwich,y:i.y,z:i.z||0}),"longlat"===e.projName?i={x:i.x*ca,y:i.y*ca,z:i.z||0}:(i=e.forward(i),e.to_meter&&(i={x:i.x/e.to_meter,y:i.y/e.to_meter,z:i.z||0})),n&&"enu"!==e.axis?wh(e,!0,i):(o||delete i.z,i)}var Sh=ch("WGS84");function Ph(t,e,i,n){var r,o,s;return Array.isArray(i)?(r=Ih(t,e,i,n)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof r.z?[r.x,r.y,r.z].concat(i.splice(3)):[r.x,r.y,i[2]].concat(i.splice(3)):[r.x,r.y].concat(i.splice(2)):[r.x,r.y]):(o=Ih(t,e,i,n),2===(s=Object.keys(i)).length||s.forEach((function(n){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;o[n]=i[n]})),o)}function Nh(t){return t instanceof ch?t:t.oProj?t.oProj:ch(t)}var Rh=function(t,e,i){t=Nh(t);var n,r=!1;return void 0===e?(e=t,t=Sh,r=!0):(void 0!==e.x||Array.isArray(e))&&(i=e,e=t,t=Sh,r=!0),e=Nh(e),i?Ph(t,e,i):(n={forward:function(i,n){return Ph(t,e,i,n)},inverse:function(i,n){return Ph(e,t,i,n)}},r&&(n.oProj=e),n)},Th=6,Lh="AJSAJS",Oh="AFAFAF",Ah=65,Dh=73,Fh=79,kh=86,Gh=90,zh={forward:jh,inverse:function(t){var e=Xh(Wh(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:qh};function jh(t,e){return e=e||5,function(t,e){var i="00000"+t.easting,n="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(f=t.easting,d=t.northing,g=t.zoneNumber,y=Vh(g),_=Math.floor(f/1e5),m=Math.floor(d/1e5)%20,r=_,o=m,s=y,a=s-1,h=Lh.charCodeAt(a),l=Oh.charCodeAt(a),u=h+r-1,c=l+o,p=!1,u>Gh&&(u=u-Gh+Ah-1,p=!0),(u===Dh||h<Dh&&u>Dh||(u>Dh||h<Dh)&&p)&&u++,(u===Fh||h<Fh&&u>Fh||(u>Fh||h<Fh)&&p)&&++u===Dh&&u++,u>Gh&&(u=u-Gh+Ah-1),c>kh?(c=c-kh+Ah-1,p=!0):p=!1,(c===Dh||l<Dh&&c>Dh||(c>Dh||l<Dh)&&p)&&c++,(c===Fh||l<Fh&&c>Fh||(c>Fh||l<Fh)&&p)&&++c===Dh&&c++,c>kh&&(c=c-kh+Ah-1),String.fromCharCode(u)+String.fromCharCode(c))+i.substr(i.length-5,e)+n.substr(n.length-5,e);var r,o,s,a,h,l,u,c,p;var f,d,g,y,_,m}(function(t){var e,i,n,r,o,s,a,h,l=t.lat,u=t.lon,c=6378137,p=.00669438,f=.9996,d=Bh(l),g=Bh(u);h=Math.floor((u+180)/6)+1,180===u&&(h=60);l>=56&&l<64&&u>=3&&u<12&&(h=32);l>=72&&l<84&&(u>=0&&u<9?h=31:u>=9&&u<21?h=33:u>=21&&u<33?h=35:u>=33&&u<42&&(h=37));a=Bh(6*(h-1)-180+3),e=p/(1-p),i=c/Math.sqrt(1-p*Math.sin(d)*Math.sin(d)),n=Math.tan(d)*Math.tan(d),r=e*Math.cos(d)*Math.cos(d),o=Math.cos(d)*(g-a),s=c*((1-p/4-3*p*p/64-5*p*p*p/256)*d-(3*p/8+3*p*p/32+45*p*p*p/1024)*Math.sin(2*d)+(15*p*p/256+45*p*p*p/1024)*Math.sin(4*d)-35*p*p*p/3072*Math.sin(6*d));var y=f*i*(o+(1-n+r)*o*o*o/6+(5-18*n+n*n+72*r-58*e)*o*o*o*o*o/120)+5e5,_=f*(s+i*Math.tan(d)*(o*o/2+(5-n+9*r+4*r*r)*o*o*o*o/24+(61-58*n+n*n+600*r-330*e)*o*o*o*o*o*o/720));l<0&&(_+=1e7);return{northing:Math.round(_),easting:Math.round(y),zoneNumber:h,zoneLetter:Yh(l)}}({lat:t[1],lon:t[0]}),e)}function qh(t){var e=Xh(Wh(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Bh(t){return t*(Math.PI/180)}function Uh(t){return t/Math.PI*180}function Xh(t){var e=t.northing,i=t.easting,n=t.zoneLetter,r=t.zoneNumber;if(r<0||r>60)return null;var o,s,a,h,l,u,c,p,f,d=.9996,g=6378137,y=.00669438,_=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),m=i-5e5,v=e;n<"N"&&(v-=1e7),c=6*(r-1)-180+3,o=.006739496752268451,f=(p=v/d/6367449.145945056)+(3*_/2-27*_*_*_/32)*Math.sin(2*p)+(21*_*_/16-55*_*_*_*_/32)*Math.sin(4*p)+151*_*_*_/96*Math.sin(6*p),s=g/Math.sqrt(1-y*Math.sin(f)*Math.sin(f)),a=Math.tan(f)*Math.tan(f),h=o*Math.cos(f)*Math.cos(f),l=.99330562*g/Math.pow(1-y*Math.sin(f)*Math.sin(f),1.5),u=m/(s*d);var x=f-s*Math.tan(f)/l*(u*u/2-(5+3*a+10*h-4*h*h-9*o)*u*u*u*u/24+(61+90*a+298*h+45*a*a-1.6983531815716497-3*h*h)*u*u*u*u*u*u/720);x=Uh(x);var E,w=(u-(1+2*a+h)*u*u*u/6+(5-2*h+28*a-3*h*h+8*o+24*a*a)*u*u*u*u*u/120)/Math.cos(f);if(w=c+Uh(w),t.accuracy){var b=Xh({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});E={top:b.lat,right:b.lon,bottom:x,left:w}}else E={lat:x,lon:w};return E}function Yh(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Vh(t){var e=t%Th;return 0===e&&(e=Th),e}function Wh(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,r="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+t;r+=e,o++}var s=parseInt(r,10);if(0===o||o+3>i)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(o++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(o,o+=2);for(var h=Vh(s),l=function(t,e){var i=Lh.charCodeAt(e-1),n=1e5,r=!1;for(;i!==t.charCodeAt(0);){if(++i===Dh&&i++,i===Fh&&i++,i>Gh){if(r)throw"Bad character: "+t;i=Ah,r=!0}n+=1e5}return n}(n.charAt(0),h),u=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var i=Oh.charCodeAt(e-1),n=0,r=!1;for(;i!==t.charCodeAt(0);){if(++i===Dh&&i++,i===Fh&&i++,i>kh){if(r)throw"Bad character: "+t;i=Ah,r=!0}n+=1e5}return n}(n.charAt(1),h);u<Kh(a);)u+=2e6;var c=i-o;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var p,f,d,g=c/2,y=0,_=0;return g>0&&(p=1e5/Math.pow(10,g),f=t.substring(o,o+g),y=parseFloat(f)*p,d=t.substring(o+g),_=parseFloat(d)*p),{easting:y+l,northing:_+u,zoneLetter:a,zoneNumber:s,accuracy:p}}function Kh(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Hh(t,e,i){if(!(this instanceof Hh))return new Hh(t,e,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Hh.fromMGRS=function(t){return new Hh(qh(t))},Hh.prototype.toMGRS=function(t){return jh([this.x,this.y],t)};var Zh=Hh,Jh=1,Qh=.25,$h=.046875,tl=.01953125,el=.01068115234375,il=.75,nl=.46875,rl=.013020833333333334,ol=.007120768229166667,sl=.3645833333333333,al=.005696614583333333,hl=.3076171875;function ll(t){var e=[];e[0]=Jh-t*(Qh+t*($h+t*(tl+t*el))),e[1]=t*(il-t*($h+t*(tl+t*el)));var i=t*t;return e[2]=i*(nl-t*(rl+t*ol)),i*=t,e[3]=i*(sl-t*al),e[4]=i*t*hl,e}function ul(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}var cl=20;function pl(t,e,i){for(var n=1/(1-e),r=t,o=cl;o;--o){var s=Math.sin(r),a=1-e*s*s;if(r-=a=(ul(r,s,Math.cos(r),i)-t)*(a*Math.sqrt(a))*n,Math.abs(a)<la)return r}return r}var fl={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=ll(this.es),this.ml0=ul(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,n,r=t.x,o=t.y,s=Ba(r-this.long0),a=Math.sin(o),h=Math.cos(o);if(this.es){var l=h*s,u=Math.pow(l,2),c=this.ep2*Math.pow(h,2),p=Math.pow(c,2),f=Math.abs(h)>la?Math.tan(o):0,d=Math.pow(f,2),g=Math.pow(d,2);e=1-this.es*Math.pow(a,2),l/=Math.sqrt(e);var y=ul(o,a,h,this.en);i=this.a*(this.k0*l*(1+u/6*(1-d+c+u/20*(5-18*d+g+14*c-58*d*c+u/42*(61+179*g-g*d-479*d)))))+this.x0,n=this.a*(this.k0*(y-this.ml0+a*s*l/2*(1+u/12*(5-d+9*c+4*p+u/30*(61+g-58*d+270*c-330*d*c+u/56*(1385+543*g-g*d-3111*d))))))+this.y0}else{var _=h*Math.sin(s);if(Math.abs(Math.abs(_)-1)<la)return 93;if(i=.5*this.a*this.k0*Math.log((1+_)/(1-_))+this.x0,n=h*Math.cos(s)/Math.sqrt(1-Math.pow(_,2)),(_=Math.abs(n))>=1){if(_-1>la)return 93;n=0}else n=Math.acos(n);o<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=i,t.y=n,t},inverse:function(t){var e,i,n,r,o=(t.x-this.x0)*(1/this.a),s=(t.y-this.y0)*(1/this.a);if(this.es)if(i=pl(e=this.ml0+s/this.k0,this.es,this.en),Math.abs(i)<oa){var a=Math.sin(i),h=Math.cos(i),l=Math.abs(h)>la?Math.tan(i):0,u=this.ep2*Math.pow(h,2),c=Math.pow(u,2),p=Math.pow(l,2),f=Math.pow(p,2);e=1-this.es*Math.pow(a,2);var d=o*Math.sqrt(e)/this.k0,g=Math.pow(d,2);n=i-(e*=l)*g/(1-this.es)*.5*(1-g/12*(5+3*p-9*u*p+u-4*c-g/30*(61+90*p-252*u*p+45*f+46*u-g/56*(1385+3633*p+4095*f+1574*f*p)))),r=Ba(this.long0+d*(1-g/6*(1+2*p+u-g/20*(5+28*p+24*f+8*u*p+6*u-g/42*(61+662*p+1320*f+720*f*p))))/h)}else n=oa*qa(s),r=0;else{var y=Math.exp(o/this.k0),_=.5*(y-1/y),m=this.lat0+s/this.k0,v=Math.cos(m);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(_,2))),n=Math.asin(e),s<0&&(n=-n),r=0===_&&0===v?0:Ba(Math.atan2(_,v)+this.long0)}return t.x=r,t.y=n,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function dl(t){var e=Math.exp(t);return e=(e-1/e)/2}function gl(t,e){t=Math.abs(t),e=Math.abs(e);var i=Math.max(t,e),n=Math.min(t,e)/(i||1);return i*Math.sqrt(1+Math.pow(n,2))}function yl(t){var e=1+t,i=e-1;return 0===i?t:t*Math.log(e)/i}function _l(t){var e=Math.abs(t);return e=yl(e*(1+e/(gl(1,e)+1))),t<0?-e:e}function ml(t,e){for(var i,n=2*Math.cos(2*e),r=t.length-1,o=t[r],s=0;--r>=0;)i=n*o-s+t[r],s=o,o=i;return e+i*Math.sin(2*e)}function vl(t,e){for(var i,n=2*Math.cos(e),r=t.length-1,o=t[r],s=0;--r>=0;)i=n*o-s+t[r],s=o,o=i;return Math.sin(e)*i}function xl(t){var e=Math.exp(t);return e=(e+1/e)/2}function El(t,e,i){for(var n,r,o=Math.sin(e),s=Math.cos(e),a=dl(i),h=xl(i),l=2*s*h,u=-2*o*a,c=t.length-1,p=t[c],f=0,d=0,g=0;--c>=0;)n=d,r=f,p=l*(d=p)-n-u*(f=g)+t[c],g=u*d-r+l*f;return[(l=o*h)*p-(u=s*a)*g,l*g+u*p]}var wl={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(fl.init.apply(this),this.forward=fl.forward,this.inverse=fl.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),i*=e,this.cgb[1]=i*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),i*=e,this.cgb[2]=i*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),i*=e,this.cgb[3]=i*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),i*=e,this.cgb[4]=i*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),i*=e,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),i*=e,this.utg[2]=i*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),i*=e,this.utg[3]=i*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),i*=e,this.utg[4]=i*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),i*=e,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var n=ml(this.cbg,this.lat0);this.Zb=-this.Qn*(n+vl(this.gtu,2*n))},forward:function(t){var e=Ba(t.x-this.long0),i=t.y;i=ml(this.cbg,i);var n=Math.sin(i),r=Math.cos(i),o=Math.sin(e),s=Math.cos(e);i=Math.atan2(n,s*r),e=Math.atan2(o*r,gl(n,r*s)),e=_l(Math.tan(e));var a,h,l=El(this.gtu,2*i,2*e);return i+=l[0],e+=l[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*i+this.Zb)+this.y0):(a=1/0,h=1/0),t.x=a,t.y=h,t},inverse:function(t){var e,i,n=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(r=(r-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var o=El(this.utg,2*r,2*n);r+=o[0],n+=o[1],n=Math.atan(dl(n));var s=Math.sin(r),a=Math.cos(r),h=Math.sin(n),l=Math.cos(n);r=Math.atan2(s*l,gl(h,l*a)),e=Ba((n=Math.atan2(h,l*a))+this.long0),i=ml(this.cgb,r)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]};function bl(t,e){if(void 0===t){if((t=Math.floor(30*(Ba(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}var Ml={init:function(){var t=bl(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*ua,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,wl.init.apply(this),this.forward=wl.forward,this.inverse=wl.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function Cl(t,e){return Math.pow((1-t)/(1+t),e)}var Il={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+pa)/(Math.pow(Math.tan(.5*this.lat0+pa),this.C)*Cl(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+pa),this.C)*Cl(this.e*Math.sin(i),this.ratexp))-oa,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+pa)/this.K,1/this.C),r=20;r>0&&(i=2*Math.atan(n*Cl(this.e*Math.sin(t.y),-.5*this.e))-oa,!(Math.abs(i-t.y)<1e-14));--r)t.y=i;return r?(t.x=e,t.y=i,t):null},names:["gauss"]};var Sl={init:function(){Il.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,n,r;return t.x=Ba(t.x-this.long0),Il.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),n=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*n),t.x=r*i*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*i*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,n,r,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var s=2*Math.atan2(o,this.R2);e=Math.sin(s),i=Math.cos(s),r=Math.asin(i*this.sinc0+t.y*e*this.cosc0/o),n=Math.atan2(t.x*e,o*this.cosc0*i-t.y*this.sinc0*e)}else r=this.phic0,n=0;return t.x=n,t.y=r,Il.inverse.apply(this,[t]),t.x=Ba(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var Pl={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=la&&(this.k0=.5*(1+qa(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=la&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=la&&(this.k0=.5*this.cons*ja(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Ua(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=ja(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-oa,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,n,r,o,s,a=t.x,h=t.y,l=Math.sin(h),u=Math.cos(h),c=Ba(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=la&&Math.abs(h+this.lat0)<=la?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*l+this.coslat0*u*Math.cos(c)),t.x=this.a*e*u*Math.sin(c)+this.x0,t.y=this.a*e*(this.coslat0*l-this.sinlat0*u*Math.cos(c))+this.y0,t):(i=2*Math.atan(this.ssfn_(h,l,this.e))-oa,r=Math.cos(i),n=Math.sin(i),Math.abs(this.coslat0)<=la?(o=Ua(this.e,h*this.con,this.con*l),s=2*this.a*this.k0*o/this.cons,t.x=this.x0+s*Math.sin(a-this.long0),t.y=this.y0-this.con*s*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<la?(e=2*this.a*this.k0/(1+r*Math.cos(c)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*r*Math.cos(c))),t.y=e*(this.cosX0*n-this.sinX0*r*Math.cos(c))+this.y0),t.x=e*r*Math.sin(c)+this.x0,t))},inverse:function(t){var e,i,n,r,o;t.x-=this.x0,t.y-=this.y0;var s=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(s/(2*this.a*this.k0));return e=this.long0,i=this.lat0,s<=la?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/s),e=Math.abs(this.coslat0)<la?this.lat0>0?Ba(this.long0+Math.atan2(t.x,-1*t.y)):Ba(this.long0+Math.atan2(t.x,t.y)):Ba(this.long0+Math.atan2(t.x*Math.sin(a),s*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=la){if(s<=la)return i=this.lat0,e=this.long0,t.x=e,t.y=i,t;t.x*=this.con,t.y*=this.con,n=s*this.cons/(2*this.a*this.k0),i=this.con*Xa(this.e,n),e=this.con*Ba(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=la?o=this.X0:(o=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/s),e=Ba(this.long0+Math.atan2(t.x*Math.sin(r),s*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),i=-1*Xa(this.e,Math.tan(.5*(oa+o)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(oa+t))*Math.pow((1-e)/(1+e),.5*i)}};var Nl={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=1/this.rf,r=2*n-Math.pow(n,2),o=this.e=Math.sqrt(r);this.R=this.k0*i*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),h=Math.log((1+o*e)/(1-o*e));this.K=s-this.alpha*a+this.alpha*o/2*h},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,r=2*(Math.atan(Math.exp(n))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*s+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,r=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(n)),s=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+s/this.alpha,h=0,l=o,u=-1e3,c=0;Math.abs(l-u)>1e-7;){if(++c>20)return;h=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(h))-Math.PI/2}return t.x=a,t.y=l,t},names:["somerc"]},Rl=1e-7;var Tl={init:function(){var t,e,i,n,r,o,s,a,h,l,u,c,p,f=0,d=0,g=0,y=0,_=0,m=0,v=0;this.no_off=(p="object"==typeof(c=this).PROJECTION?Object.keys(c.PROJECTION)[0]:c.PROJECTION,"no_uoff"in c||"no_off"in c||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(p)),this.no_rot="no_rot"in this;var x=!1;"alpha"in this&&(x=!0);var E=!1;if("rectified_grid_angle"in this&&(E=!0),x&&(v=this.alpha),E&&(f=this.rectified_grid_angle*ua),x||E)d=this.longc;else if(g=this.long1,_=this.lat1,y=this.long2,m=this.lat2,Math.abs(_-m)<=Rl||(t=Math.abs(_))<=Rl||Math.abs(t-oa)<=Rl||Math.abs(Math.abs(this.lat0)-oa)<=Rl||Math.abs(Math.abs(m)-oa)<=Rl)throw new Error;var w=1-this.es;e=Math.sqrt(w),Math.abs(this.lat0)>la?(a=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*a*a,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/w),this.A=this.B*this.k0*e/t,(r=(n=this.B*e/(i*Math.sqrt(t)))*n-1)<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=n,this.E*=Math.pow(Ua(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=n=r=1),x||E?(x?(u=Math.asin(Math.sin(v)/n),E||(f=v)):(u=f,v=Math.asin(n*Math.sin(u))),this.lam0=d-Math.asin(.5*(r-1/r)*Math.tan(u))/this.B):(o=Math.pow(Ua(this.e,_,Math.sin(_)),this.B),s=Math.pow(Ua(this.e,m,Math.sin(m)),this.B),r=this.E/o,h=(s-o)/(s+o),l=((l=this.E*this.E)-s*o)/(l+s*o),(t=g-y)<-Math.pi?y-=fa:t>Math.pi&&(y+=fa),this.lam0=Ba(.5*(g+y)-Math.atan(l*Math.tan(.5*this.B*(g-y))/h)/this.B),u=Math.atan(2*Math.sin(this.B*Ba(g-this.lam0))/(r-1/r)),f=v=Math.asin(n*Math.sin(u))),this.singam=Math.sin(u),this.cosgam=Math.cos(u),this.sinrot=Math.sin(f),this.cosrot=Math.cos(f),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(v))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*u,this.v_pole_n=this.ArB*Math.log(Math.tan(pa-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(pa+r))},forward:function(t){var e,i,n,r,o,s,a,h,l={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-oa)>la){if(e=.5*((o=this.E/Math.pow(Ua(this.e,t.y,Math.sin(t.y)),this.B))-(s=1/o)),i=.5*(o+s),r=Math.sin(this.B*t.x),n=(e*this.singam-r*this.cosgam)/i,Math.abs(Math.abs(n)-1)<la)throw new Error;h=.5*this.ArB*Math.log((1-n)/(1+n)),s=Math.cos(this.B*t.x),a=Math.abs(s)<Rl?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+r*this.singam,s)}else h=t.y>0?this.v_pole_n:this.v_pole_s,a=this.ArB*t.y;return this.no_rot?(l.x=a,l.y=h):(a-=this.u_0,l.x=h*this.cosrot+a*this.sinrot,l.y=a*this.cosrot-h*this.sinrot),l.x=this.a*l.x+this.x0,l.y=this.a*l.y+this.y0,l},inverse:function(t){var e,i,n,r,o,s,a,h={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=.5*((n=Math.exp(-this.BrA*i))-1/n),o=.5*(n+1/n),a=((s=Math.sin(this.BrA*e))*this.cosgam+r*this.singam)/o,Math.abs(Math.abs(a)-1)<la)h.x=0,h.y=a<0?-oa:oa;else{if(h.y=this.E/Math.sqrt((1+a)/(1-a)),h.y=Xa(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(r*this.cosgam-s*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]};var Ll={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<la)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),n=ja(this.e,e,i),r=Ua(this.e,this.lat1,e),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=ja(this.e,o,s),h=Ua(this.e,this.lat2,o),l=Ua(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>la?this.ns=Math.log(n/a)/Math.log(r/h):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=la&&(i=qa(i)*(oa-2*la));var n,r,o=Math.abs(Math.abs(i)-oa);if(o>la)n=Ua(this.e,i,Math.sin(i)),r=this.a*this.f0*Math.pow(n,this.ns);else{if((o=i*this.ns)<=0)return null;r=0}var s=this.ns*Ba(e-this.long0);return t.x=this.k0*(r*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(s))+this.y0,t},inverse:function(t){var e,i,n,r,o,s=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+a*a),i=1):(e=-Math.sqrt(s*s+a*a),i=-1);var h=0;if(0!==e&&(h=Math.atan2(i*s,i*a)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),-9999===(r=Xa(this.e,n)))return null}else r=-oa;return o=Ba(h/this.ns+this.long0),t.x=o,t.y=r,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]};var Ol={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,n,r,o,s,a,h=t.x,l=t.y,u=Ba(h-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),n=-u*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),o=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(r)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=a*Math.cos(s)/1,t.x=a*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,n,r,o,s,a,h=t.x;t.x=t.y,t.y=h,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),i=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(e)),t.x=this.long0-i/this.alfa,s=e,a=0;var l=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(a=1),s=t.y,l+=1}while(0===a&&l<15);return l>=15?null:t},names:["Krovak","krovak"]};function Al(t,e,i,n,r){return t*r-e*Math.sin(2*r)+i*Math.sin(4*r)-n*Math.sin(6*r)}function Dl(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function Fl(t){return.375*t*(1+.25*t*(1+.46875*t))}function kl(t){return.05859375*t*t*(1+.75*t)}function Gl(t){return t*t*t*(35/3072)}function zl(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}function jl(t){return Math.abs(t)<oa?t:t-qa(t)*Math.PI}function ql(t,e,i,n,r){var o,s;o=t/e;for(var a=0;a<15;a++)if(o+=s=(t-(e*o-i*Math.sin(2*o)+n*Math.sin(4*o)-r*Math.sin(6*o)))/(e-2*i*Math.cos(2*o)+4*n*Math.cos(4*o)-6*r*Math.cos(6*o)),Math.abs(s)<=1e-10)return o;return NaN}var Bl={init:function(){this.sphere||(this.e0=Dl(this.es),this.e1=Fl(this.es),this.e2=kl(this.es),this.e3=Gl(this.es),this.ml0=this.a*Al(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,n=t.x,r=t.y;if(n=Ba(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(n)),i=this.a*(Math.atan2(Math.tan(r),Math.cos(n))-this.lat0);else{var o=Math.sin(r),s=Math.cos(r),a=zl(this.a,this.e,o),h=Math.tan(r)*Math.tan(r),l=n*Math.cos(r),u=l*l,c=this.es*s*s/(1-this.es);e=a*l*(1-u*h*(1/6-(8-h+8*c)*u/120)),i=this.a*Al(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+a*o/s*u*(.5+(5-h+6*c)*u/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,r=t.y/this.a;if(this.sphere){var o=r+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(o))}else{var s=ql(this.ml0/this.a+r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-oa)<=la)return t.x=this.long0,t.y=oa,r<0&&(t.y*=-1),t;var a=zl(this.a,this.e,Math.sin(s)),h=a*a*a/this.a/this.a*(1-this.es),l=Math.pow(Math.tan(s),2),u=n*this.a/a,c=u*u;e=s-a*Math.tan(s)/h*u*u*(.5-(1+3*l)*u*u/24),i=u*(1-c*(l/3+(1+3*l)*l*c/15))/Math.cos(s)}return t.x=Ba(i+this.long0),t.y=jl(e),t},names:["Cassini","Cassini_Soldner","cass"]};function Ul(t,e){var i;return t>1e-7?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e}var Xl=.3333333333333333,Yl=.17222222222222222,Vl=.10257936507936508,Wl=.06388888888888888,Kl=.0664021164021164,Hl=.016415012942191543;var Zl={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-oa)<la?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<la?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Ul(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,i=[];return i[0]=t*Xl,e=t*t,i[0]+=e*Yl,i[1]=e*Wl,e*=t,i[0]+=e*Vl,i[1]+=e*Kl,i[2]=e*Hl,i}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Ul(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,n,r,o,s,a,h,l,u,c=t.x,p=t.y;if(c=Ba(c-this.long0),this.sphere){if(o=Math.sin(p),u=Math.cos(p),n=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+u*n:1+this.sinph0*o+this.cosph0*u*n)<=la)return null;e=(i=Math.sqrt(2/i))*u*Math.sin(c),i*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*u*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(p+this.lat0)<la)return null;i=pa-.5*p,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(c),i*=n}}else{switch(a=0,h=0,l=0,n=Math.cos(c),r=Math.sin(c),o=Math.sin(p),s=Ul(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,h=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:l=1+this.sinb1*a+this.cosb1*h*n;break;case this.EQUIT:l=1+h*n;break;case this.N_POLE:l=oa+p,s=this.qp-s;break;case this.S_POLE:l=p-oa,s=this.qp+s}if(Math.abs(l)<la)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),i=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*a-this.sinb1*h*n):(l=Math.sqrt(2/(1+h*n)))*a*this.ymf,e=this.xmf*l*h*r;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(l=Math.sqrt(s))*r,i=n*(this.mode===this.S_POLE?l:-l)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,r,o,s,a,h,l,u,c=t.x/this.a,p=t.y/this.a;if(this.sphere){var f,d=0,g=0;if((i=.5*(f=Math.sqrt(c*c+p*p)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(g=Math.sin(i),d=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(f)<=la?0:Math.asin(p*g/f),c*=g,p=d*f;break;case this.OBLIQ:i=Math.abs(f)<=la?this.lat0:Math.asin(d*this.sinph0+p*g*this.cosph0/f),c*=g*this.cosph0,p=(d-Math.sin(i)*this.sinph0)*f;break;case this.N_POLE:p=-p,i=oa-i;break;case this.S_POLE:i-=oa}e=0!==p||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,p):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,p*=this.dd,(s=Math.sqrt(c*c+p*p))<la)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*s/this.rq),n=Math.cos(r),c*=r=Math.sin(r),this.mode===this.OBLIQ?(a=n*this.sinb1+p*r*this.cosb1/s,o=this.qp*a,p=s*this.cosb1*n-p*this.sinb1*r):(a=p*r/s,o=this.qp*a,p=s*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(p=-p),!(o=c*c+p*p))return t.x=this.long0,t.y=this.lat0,t;a=1-o/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(c,p),h=Math.asin(a),l=this.apa,u=h+h,i=h+l[0]*Math.sin(u)+l[1]*Math.sin(u+u)+l[2]*Math.sin(u+u+u)}return t.x=Ba(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Jl(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}var Ql={init:function(){Math.abs(this.lat1+this.lat2)<la||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=ja(this.e3,this.sin_po,this.cos_po),this.qs1=Ul(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=ja(this.e3,this.sin_po,this.cos_po),this.qs2=Ul(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ul(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>la?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=Ul(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,o=this.ns0*Ba(e-this.long0),s=r*Math.sin(o)+this.x0,a=this.rh-r*Math.cos(o)+this.y0;return t.x=s,t.y=a,t},inverse:function(t){var e,i,n,r,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),r=0,0!==e&&(r=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,s=this.phi1z(this.e3,i)),o=Ba(r/this.ns0+this.long0),t.x=o,t.y=s,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,n,r,o,s=Jl(.5*e);if(t<la)return s;for(var a=t*t,h=1;h<=25;h++)if(s+=o=.5*(r=1-(n=t*(i=Math.sin(s)))*n)*r/Math.cos(s)*(e/(1-a)-i/r+.5/t*Math.log((1-n)/(1+n))),Math.abs(o)<=1e-7)return s;return null}};var $l={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,n,r,o,s,a,h=t.x,l=t.y;return n=Ba(h-this.long0),e=Math.sin(l),i=Math.cos(l),r=Math.cos(n),1,(o=this.sin_p14*e+this.cos_p14*i*r)>0||Math.abs(o)<=la?(s=this.x0+1*this.a*i*Math.sin(n)/o,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*r)/o):(s=this.x0+this.infinity_dist*i*Math.sin(n),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*r)),t.x=s,t.y=a,t},inverse:function(t){var e,i,n,r,o,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),i=Math.sin(r),s=Jl((n=Math.cos(r))*this.sin_p14+t.y*i*this.cos_p14/e),o=Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i),o=Ba(this.long0+o)):(s=this.phic0,o=0),t.x=o,t.y=s,t},names:["gnom"]};function tu(t,e){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-i)<1e-6)return e<0?-1*oa:oa;for(var n,r,o,s,a=Math.asin(.5*e),h=0;h<30;h++)if(r=Math.sin(a),o=Math.cos(a),s=t*r,a+=n=Math.pow(1-s*s,2)/(2*o)*(e/(1-t*t)-r/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),Math.abs(n)<=1e-10)return a;return NaN}var eu={init:function(){this.sphere||(this.k0=ja(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,n=t.x,r=t.y,o=Ba(n-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var s=Ul(this.e,Math.sin(r));e=this.x0+this.a*this.k0*o,i=this.y0+this.a*s*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Ba(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=tu(this.e,2*t.y*this.k0/this.a),e=Ba(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]};var iu={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,i=t.y,n=Ba(e-this.long0),r=jl(i-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.x,i=t.y;return t.x=Ba(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=jl(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};var nu={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Dl(this.es),this.e1=Fl(this.es),this.e2=kl(this.es),this.e3=Gl(this.es),this.ml0=this.a*Al(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,n,r=t.x,o=t.y,s=Ba(r-this.long0);if(n=s*Math.sin(o),this.sphere)Math.abs(o)<=la?(e=this.a*s,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(o),i=this.a*(jl(o-this.lat0)+(1-Math.cos(n))/Math.tan(o)));else if(Math.abs(o)<=la)e=this.a*s,i=-1*this.ml0;else{var a=zl(this.a,this.e,Math.sin(o))/Math.tan(o);e=a*Math.sin(n),i=this.a*Al(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+a*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,n,r,o,s,a,h,l;if(n=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=la)e=Ba(n/this.a+this.long0),i=0;else{var u;for(s=this.lat0+r/this.a,a=n*n/this.a/this.a+s*s,h=s,o=20;o;--o)if(h+=l=-1*(s*(h*(u=Math.tan(h))+1)-h-.5*(h*h+a)*u)/((h-s)/u-1),Math.abs(l)<=la){i=h;break}e=Ba(this.long0+Math.asin(n*Math.tan(h)/this.a)/Math.sin(i))}else if(Math.abs(r+this.ml0)<=la)i=0,e=Ba(this.long0+n/this.a);else{var c,p,f,d,g;for(s=(this.ml0+r)/this.a,a=n*n/this.a/this.a+s*s,h=s,o=20;o;--o)if(g=this.e*Math.sin(h),c=Math.sqrt(1-g*g)*Math.tan(h),p=this.a*Al(this.e0,this.e1,this.e2,this.e3,h),f=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),h-=l=(s*(c*(d=p/this.a)+1)-d-.5*c*(d*d+a))/(this.es*Math.sin(2*h)*(d*d+a-2*s*d)/(4*c)+(s-d)*(c*f-2/Math.sin(2*h))-f),Math.abs(l)<=la){i=h;break}c=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=Ba(this.long0+Math.asin(n*c/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]};var ru={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=t.x,n=t.y-this.lat0,r=i-this.long0,o=n/ra*1e-5,s=r,a=1,h=0;for(e=1;e<=10;e++)a*=o,h+=this.A[e]*a;var l,u=h,c=s,p=1,f=0,d=0,g=0;for(e=1;e<=6;e++)l=f*u+p*c,p=p*u-f*c,f=l,d=d+this.B_re[e]*p-this.B_im[e]*f,g=g+this.B_im[e]*p+this.B_re[e]*f;return t.x=g*this.a+this.x0,t.y=d*this.a+this.y0,t},inverse:function(t){var e,i,n=t.x,r=t.y,o=n-this.x0,s=(r-this.y0)/this.a,a=o/this.a,h=1,l=0,u=0,c=0;for(e=1;e<=6;e++)i=l*s+h*a,h=h*s-l*a,l=i,u=u+this.C_re[e]*h-this.C_im[e]*l,c=c+this.C_im[e]*h+this.C_re[e]*l;for(var p=0;p<this.iterations;p++){var f,d=u,g=c,y=s,_=a;for(e=2;e<=6;e++)f=g*u+d*c,d=d*u-g*c,g=f,y+=(e-1)*(this.B_re[e]*d-this.B_im[e]*g),_+=(e-1)*(this.B_im[e]*d+this.B_re[e]*g);d=1,g=0;var m=this.B_re[1],v=this.B_im[1];for(e=2;e<=6;e++)f=g*u+d*c,d=d*u-g*c,g=f,m+=e*(this.B_re[e]*d-this.B_im[e]*g),v+=e*(this.B_im[e]*d+this.B_re[e]*g);var x=m*m+v*v;u=(y*m+_*v)/x,c=(_*m-y*v)/x}var E=u,w=c,b=1,M=0;for(e=1;e<=9;e++)b*=E,M+=this.D[e]*b;var C=this.lat0+M*ra*1e5,I=this.long0+w;return t.x=I,t.y=C,t},names:["New_Zealand_Map_Grid","nzmg"]};var ou={init:function(){},forward:function(t){var e=t.x,i=t.y,n=Ba(e-this.long0),r=this.x0+this.a*n,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=r,t.y=o,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Ba(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]};var su={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ll(this.es)},forward:function(t){var e,i,n=t.x,r=t.y;if(n=Ba(n-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(r),s=20;s;--s){var a=(this.m*r+Math.sin(r)-o)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<la)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*n*(this.m+Math.cos(r)),i=this.a*this.C_y*r}else{var h=Math.sin(r),l=Math.cos(r);i=this.a*ul(r,h,l,this.en),e=this.a*n*l/Math.sqrt(1-this.es*h*h)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Jl((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Jl(Math.sin(e)/this.n)),i=Ba(i+this.long0),e=jl(e)):(e=pl(t.y/this.a,this.es,this.en),(n=Math.abs(e))<oa?(n=Math.sin(e),i=Ba(this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)))):n-la<oa&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]};var au={init:function(){},forward:function(t){for(var e=t.x,i=t.y,n=Ba(e-this.long0),r=i,o=Math.PI*Math.sin(i);;){var s=-(r+Math.sin(r)-o)/(1+Math.cos(r));if(r+=s,Math.abs(s)<la)break}r/=2,Math.PI/2-Math.abs(i)<la&&(n=0);var a=.900316316158*this.a*n*Math.cos(r)+this.x0,h=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=a,t.y=h,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var n=Ba(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var r=Math.asin(i);return t.x=n,t.y=r,t},names:["Mollweide","moll"]};var hu={init:function(){Math.abs(this.lat1+this.lat2)<la||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Dl(this.es),this.e1=Fl(this.es),this.e2=kl(this.es),this.e3=Gl(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=ja(this.e,this.sinphi,this.cosphi),this.ml1=Al(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<la?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=ja(this.e,this.sinphi,this.cosphi),this.ml2=Al(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Al(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var r=Al(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-r)}var o=this.ns*Ba(i-this.long0),s=this.x0+e*Math.sin(o),a=this.y0+this.rh-e*Math.cos(o);return t.x=s,t.y=a,t},inverse:function(t){var e,i,n,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;return 0!==i&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere?(r=Ba(this.long0+o/this.ns),n=jl(this.g-i/this.a),t.x=r,t.y=n,t):(n=ql(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),r=Ba(this.long0+o/this.ns),t.x=r,t.y=n,t)},names:["Equidistant_Conic","eqdc"]};var lu={init:function(){this.R=this.a},forward:function(t){var e,i,n=t.x,r=t.y,o=Ba(n-this.long0);Math.abs(r)<=la&&(e=this.x0+this.R*o,i=this.y0);var s=Jl(2*Math.abs(r/Math.PI));(Math.abs(o)<=la||Math.abs(Math.abs(r)-oa)<=la)&&(e=this.x0,i=r>=0?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/o-o/Math.PI),h=a*a,l=Math.sin(s),u=Math.cos(s),c=u/(l+u-1),p=c*c,f=c*(2/l-1),d=f*f,g=Math.PI*this.R*(a*(c-d)+Math.sqrt(h*(c-d)*(c-d)-(d+h)*(p-d)))/(d+h);o<0&&(g=-g),e=this.x0+g;var y=h+c;return g=Math.PI*this.R*(f*y-a*Math.sqrt((d+h)*(h+1)-y*y))/(d+h),i=r>=0?this.y0+g:this.y0-g,t.x=e,t.y=i,t},inverse:function(t){var e,i,n,r,o,s,a,h,l,u,c,p;return t.x-=this.x0,t.y-=this.y0,c=Math.PI*this.R,o=(n=t.x/c)*n+(r=t.y/c)*r,c=3*(r*r/(h=-2*(s=-Math.abs(r)*(1+o))+1+2*r*r+o*o)+(2*(a=s-2*r*r+n*n)*a*a/h/h/h-9*s*a/h/h)/27)/(l=(s-a*a/3/h)/h)/(u=2*Math.sqrt(-l/3)),Math.abs(c)>1&&(c=c>=0?1:-1),p=Math.acos(c)/3,i=t.y>=0?(-u*Math.cos(p+Math.PI/3)-a/3/h)*Math.PI:-(-u*Math.cos(p+Math.PI/3)-a/3/h)*Math.PI,e=Math.abs(n)<la?this.long0:Ba(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(n*n-r*r)+o*o))/2/n),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var uu={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,n,r,o,s,a,h,l,u,c,p,f,d,g,y,_,m,v,x,E,w,b=t.x,M=t.y,C=Math.sin(t.y),I=Math.cos(t.y),S=Ba(b-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=la?(t.x=this.x0+this.a*(oa-M)*Math.sin(S),t.y=this.y0-this.a*(oa-M)*Math.cos(S),t):Math.abs(this.sin_p12+1)<=la?(t.x=this.x0+this.a*(oa+M)*Math.sin(S),t.y=this.y0+this.a*(oa+M)*Math.cos(S),t):(m=this.sin_p12*C+this.cos_p12*I*Math.cos(S),_=(y=Math.acos(m))?y/Math.sin(y):1,t.x=this.x0+this.a*_*I*Math.sin(S),t.y=this.y0+this.a*_*(this.cos_p12*C-this.sin_p12*I*Math.cos(S)),t):(e=Dl(this.es),i=Fl(this.es),n=kl(this.es),r=Gl(this.es),Math.abs(this.sin_p12-1)<=la?(o=this.a*Al(e,i,n,r,oa),s=this.a*Al(e,i,n,r,M),t.x=this.x0+(o-s)*Math.sin(S),t.y=this.y0-(o-s)*Math.cos(S),t):Math.abs(this.sin_p12+1)<=la?(o=this.a*Al(e,i,n,r,oa),s=this.a*Al(e,i,n,r,M),t.x=this.x0+(o+s)*Math.sin(S),t.y=this.y0+(o+s)*Math.cos(S),t):(a=C/I,h=zl(this.a,this.e,this.sin_p12),l=zl(this.a,this.e,C),u=Math.atan((1-this.es)*a+this.es*h*this.sin_p12/(l*I)),v=0===(c=Math.atan2(Math.sin(S),this.cos_p12*Math.tan(u)-this.sin_p12*Math.cos(S)))?Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.abs(Math.abs(c)-Math.PI)<=la?-Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.asin(Math.sin(S)*Math.cos(u)/Math.sin(c)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),y=h*v*(1-(x=v*v)*(g=(f=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es))*f)*(1-g)/6+(E=x*v)/8*(d=p*f)*(1-2*g)+(w=E*v)/120*(g*(4-7*g)-3*p*p*(1-7*g))-w*v/48*d),t.x=this.x0+y*Math.sin(c),t.y=this.y0+y*Math.cos(c),t))},inverse:function(t){var e,i,n,r,o,s,a,h,l,u,c,p,f,d,g,y,_,m,v,x,E,w,b;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*oa*this.a)return;return i=e/this.a,n=Math.sin(i),r=Math.cos(i),o=this.long0,Math.abs(e)<=la?s=this.lat0:(s=Jl(r*this.sin_p12+t.y*n*this.cos_p12/e),a=Math.abs(this.lat0)-oa,o=Math.abs(a)<=la?this.lat0>=0?Ba(this.long0+Math.atan2(t.x,-t.y)):Ba(this.long0-Math.atan2(-t.x,t.y)):Ba(this.long0+Math.atan2(t.x*n,e*this.cos_p12*r-t.y*this.sin_p12*n))),t.x=o,t.y=s,t}return h=Dl(this.es),l=Fl(this.es),u=kl(this.es),c=Gl(this.es),Math.abs(this.sin_p12-1)<=la?(s=ql(((p=this.a*Al(h,l,u,c,oa))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,h,l,u,c),o=Ba(this.long0+Math.atan2(t.x,-1*t.y)),t.x=o,t.y=s,t):Math.abs(this.sin_p12+1)<=la?(p=this.a*Al(h,l,u,c,oa),s=ql(((e=Math.sqrt(t.x*t.x+t.y*t.y))-p)/this.a,h,l,u,c),o=Ba(this.long0+Math.atan2(t.x,t.y)),t.x=o,t.y=s,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),g=Math.atan2(t.x,t.y),f=zl(this.a,this.e,this.sin_p12),y=Math.cos(g),m=-(_=this.e*this.cos_p12*y)*_/(1-this.es),v=3*this.es*(1-m)*this.sin_p12*this.cos_p12*y/(1-this.es),w=1-m*(E=(x=e/f)-m*(1+m)*Math.pow(x,3)/6-v*(1+3*m)*Math.pow(x,4)/24)*E/2-x*E*E*E/6,d=Math.asin(this.sin_p12*Math.cos(E)+this.cos_p12*Math.sin(E)*y),o=Ba(this.long0+Math.asin(Math.sin(g)*Math.sin(E)/Math.cos(d))),b=Math.sin(d),s=Math.atan2((b-this.es*w*this.sin_p12)*Math.tan(d),b*(1-this.es)),t.x=o,t.y=s,t)},names:["Azimuthal_Equidistant","aeqd"]};var cu={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,n,r,o,s,a,h=t.x,l=t.y;return n=Ba(h-this.long0),e=Math.sin(l),i=Math.cos(l),r=Math.cos(n),1,((o=this.sin_p14*e+this.cos_p14*i*r)>0||Math.abs(o)<=la)&&(s=1*this.a*i*Math.sin(n),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*r)),t.x=s,t.y=a,t},inverse:function(t){var e,i,n,r,o,s,a;return t.x-=this.x0,t.y-=this.y0,i=Jl((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),n=Math.sin(i),r=Math.cos(i),s=this.long0,Math.abs(e)<=la?(a=this.lat0,t.x=s,t.y=a,t):(a=Jl(r*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.abs(this.lat0)-oa,Math.abs(o)<=la?(s=this.lat0>=0?Ba(this.long0+Math.atan2(t.x,-t.y)):Ba(this.long0-Math.atan2(-t.x,t.y)),t.x=s,t.y=a,t):(s=Ba(this.long0+Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n)),t.x=s,t.y=a,t))},names:["ortho"]},pu=1,fu=2,du=3,gu=4,yu=5,_u=6,mu={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function vu(t,e,i,n){var r;return t<la?(n.value=mu.AREA_0,r=0):(r=Math.atan2(e,i),Math.abs(r)<=pa?n.value=mu.AREA_0:r>pa&&r<=oa+pa?(n.value=mu.AREA_1,r-=oa):r>oa+pa||r<=-(oa+pa)?(n.value=mu.AREA_2,r=r>=0?r-da:r+da):(n.value=mu.AREA_3,r+=oa)),r}function xu(t,e){var i=t+e;return i<-da?i+=fa:i>+da&&(i-=fa),i}var Eu={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=oa-pa/2?this.face=yu:this.lat0<=-(oa-pa/2)?this.face=_u:Math.abs(this.long0)<=pa?this.face=pu:Math.abs(this.long0)<=oa+pa?this.face=this.long0>0?fu:gu:this.face=du,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,n,r,o,s,a={x:0,y:0},h={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,this.face===yu)r=oa-e,i>=pa&&i<=oa+pa?(h.value=mu.AREA_0,n=i-oa):i>oa+pa||i<=-(oa+pa)?(h.value=mu.AREA_1,n=i>0?i-da:i+da):i>-(oa+pa)&&i<=-pa?(h.value=mu.AREA_2,n=i+oa):(h.value=mu.AREA_3,n=i);else if(this.face===_u)r=oa+e,i>=pa&&i<=oa+pa?(h.value=mu.AREA_0,n=-i+oa):i<pa&&i>=-pa?(h.value=mu.AREA_1,n=-i):i<-pa&&i>=-(oa+pa)?(h.value=mu.AREA_2,n=-i-oa):(h.value=mu.AREA_3,n=i>0?-i+da:-i-da);else{var l,u,c,p,f,d;this.face===fu?i=xu(i,+oa):this.face===du?i=xu(i,+da):this.face===gu&&(i=xu(i,-oa)),p=Math.sin(e),f=Math.cos(e),d=Math.sin(i),l=f*Math.cos(i),u=f*d,c=p,this.face===pu?n=vu(r=Math.acos(l),c,u,h):this.face===fu?n=vu(r=Math.acos(u),c,-l,h):this.face===du?n=vu(r=Math.acos(-l),c,-u,h):this.face===gu?n=vu(r=Math.acos(-u),c,l,h):(r=n=0,h.value=mu.AREA_0)}return s=Math.atan(12/da*(n+Math.acos(Math.sin(n)*Math.cos(pa))-oa)),o=Math.sqrt((1-Math.cos(r))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(n))))),h.value===mu.AREA_1?s+=oa:h.value===mu.AREA_2?s+=da:h.value===mu.AREA_3&&(s+=1.5*da),a.x=o*Math.cos(s),a.y=o*Math.sin(s),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,i,n,r,o,s,a,h,l,u,c,p,f={lam:0,phi:0},d={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?d.value=mu.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(d.value=mu.AREA_1,e-=oa):t.x<0&&-t.x>=Math.abs(t.y)?(d.value=mu.AREA_2,e=e<0?e+da:e-da):(d.value=mu.AREA_3,e+=oa),l=da/12*Math.tan(e),o=Math.sin(l)/(Math.cos(l)-1/Math.sqrt(2)),s=Math.atan(o),(a=1-(n=Math.cos(e))*n*(r=Math.tan(i))*r*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?a=-1:a>1&&(a=1),this.face===yu)h=Math.acos(a),f.phi=oa-h,d.value===mu.AREA_0?f.lam=s+oa:d.value===mu.AREA_1?f.lam=s<0?s+da:s-da:d.value===mu.AREA_2?f.lam=s-oa:f.lam=s;else if(this.face===_u)h=Math.acos(a),f.phi=h-oa,d.value===mu.AREA_0?f.lam=-s+oa:d.value===mu.AREA_1?f.lam=-s:d.value===mu.AREA_2?f.lam=-s-oa:f.lam=s<0?-s-da:-s+da;else{var g,y,_;l=(g=a)*g,y=(l+=(_=l>=1?0:Math.sqrt(1-l)*Math.sin(s))*_)>=1?0:Math.sqrt(1-l),d.value===mu.AREA_1?(l=y,y=-_,_=l):d.value===mu.AREA_2?(y=-y,_=-_):d.value===mu.AREA_3&&(l=y,y=_,_=-l),this.face===fu?(l=g,g=-y,y=l):this.face===du?(g=-g,y=-y):this.face===gu&&(l=g,g=y,y=-l),f.phi=Math.acos(-_)-oa,f.lam=Math.atan2(y,g),this.face===fu?f.lam=xu(f.lam,-oa):this.face===du?f.lam=xu(f.lam,-da):this.face===gu&&(f.lam=xu(f.lam,+oa))}return 0!==this.es&&(u=f.phi<0?1:0,c=Math.tan(f.phi),p=this.b/Math.sqrt(c*c+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),u&&(f.phi=-f.phi)),f.lam+=this.long0,t.x=f.lam,t.y=f.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},wu=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],bu=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Mu=.8487,Cu=1.3523,Iu=ca/5,Su=1/Iu,Pu=18,Nu=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};var Ru={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Ba(t.x-this.long0),i=Math.abs(t.y),n=Math.floor(i*Iu);n<0?n=0:n>=Pu&&(n=17);var r={x:Nu(wu[n],i=ca*(i-Su*n))*e,y:Nu(bu[n],i)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*Mu+this.x0,r.y=r.y*this.a*Cu+this.y0,r},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*Mu),y:Math.abs(t.y-this.y0)/(this.a*Cu)};if(e.y>=1)e.x/=wu[18][0],e.y=t.y<0?-oa:oa;else{var i=Math.floor(e.y*Pu);for(i<0?i=0:i>=Pu&&(i=17);;)if(bu[i][0]>e.y)--i;else{if(!(bu[i+1][0]<=e.y))break;++i}var n=bu[i],r=5*(e.y-n[0])/(bu[i+1][0]-n[0]);r=function(t,e,i,n){for(var r=e;n;--n){var o=t(r);if(r-=o,Math.abs(o)<i)break}return r}((function(t){return(Nu(n,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(n,t)}),r,la,100),e.x/=Nu(wu[i],r),e.y=(5*i+r)*ua,t.y<0&&(e.y=-e.y)}return e.x=Ba(e.x+this.long0),e},names:["Robinson","robin"]};var Tu={init:function(){this.name="geocent"},forward:function(t){return fh(t,this.es,this.a)},inverse:function(t){return dh(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},Lu=0,Ou=1,Au=2,Du=3,Fu={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};var ku={init:function(){if(Object.keys(Fu).forEach(function(t){if(void 0===this[t])this[t]=Fu[t].def;else{if(Fu[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Fu[t].num&&(this[t]=parseFloat(this[t]))}Fu[t].degrees&&(this[t]=this[t]*ua)}.bind(this)),Math.abs(Math.abs(this.lat0)-oa)<la?this.mode=this.lat0<0?Ou:Lu:Math.abs(this.lat0)<la?this.mode=Au:(this.mode=Du,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,n,r,o=Math.sin(t.y),s=Math.cos(t.y),a=Math.cos(t.x);switch(this.mode){case Du:i=this.sinph0*o+this.cosph0*s*a;break;case Au:i=s*a;break;case Ou:i=-o;break;case Lu:i=o}switch(e=(i=this.pn1/(this.p-i))*s*Math.sin(t.x),this.mode){case Du:i*=this.cosph0*o-this.sinph0*s*a;break;case Au:i*=o;break;case Lu:i*=-s*a;break;case Ou:i*=s*a}return r=1/((n=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-i*this.sg)*this.cw*r,i=n*r,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,n,r={x:t.x,y:t.y};n=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*n,i=this.pn1*t.y*this.cw*n,t.x=e*this.cg+i*this.sg,t.y=i*this.cg-e*this.sg;var o=gl(t.x,t.y);if(Math.abs(o)<la)r.x=0,r.y=t.y;else{var s,a;switch(a=1-o*o*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/o+o/this.pn1),s=Math.sqrt(1-a*a),this.mode){case Du:r.y=Math.asin(s*this.sinph0+t.y*a*this.cosph0/o),t.y=(s-this.sinph0*Math.sin(r.y))*o,t.x*=a*this.cosph0;break;case Au:r.y=Math.asin(t.y*a/o),t.y=s*o,t.x*=a;break;case Lu:r.y=Math.asin(s),t.y=-t.y;break;case Ou:r.y=-Math.asin(s)}r.x=Math.atan2(t.x,t.y)}return t.x=r.x+this.long0,t.y=r.y,t},names:["Tilted_Perspective","tpers"]};var Gu,zu={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,i,n,r,o=t.x,s=t.y;if(o-=this.long0,"ellipse"===this.shape){s=Math.atan(this.radius_p2*Math.tan(s));var a=this.radius_p/gl(this.radius_p*Math.cos(s),Math.sin(s));if(i=a*Math.cos(o)*Math.cos(s),n=a*Math.sin(o)*Math.cos(s),r=a*Math.sin(s),(this.radius_g-i)*i-n*n-r*r*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/gl(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(r/gl(n,e)))}else"sphere"===this.shape&&(e=Math.cos(s),i=Math.cos(o)*e,n=Math.sin(o)*e,r=Math.sin(s),e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/gl(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(r/gl(n,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,i,n,r,o=-1,s=0,a=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),s=Math.tan(t.x/this.radius_g_1)*gl(1,a)):(s=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*gl(1,s));var h=a/this.radius_p;if(e=s*s+h*h+o*o,(n=(i=2*this.radius_g*o)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-i-Math.sqrt(n))/(2*e),o=this.radius_g+r*o,s*=r,a*=r,t.x=Math.atan2(s,o),t.y=Math.atan(a*Math.cos(t.x)/o),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),s=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+a*a)):(s=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+s*s)),e=s*s+a*a+o*o,(n=(i=2*this.radius_g*o)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-i-Math.sqrt(n))/(2*e),o=this.radius_g+r*o,s*=r,a*=r,t.x=Math.atan2(s,o),t.y=Math.atan(a*Math.cos(t.x)/o)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};Rh.defaultDatum="WGS84",Rh.Proj=ch,Rh.WGS84=new Rh.Proj("WGS84"),Rh.Point=Zh,Rh.toPoint=bh,Rh.defs=Da,Rh.nadgrid=function(t,e){var i=new DataView(e),n=function(t){var e=t.getInt32(8,!1);if(11===e)return!1;e=t.getInt32(8,!0),11!==e&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian");return!0}(i),r=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:sh(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(i,n);r.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var o=function(t,e,i){for(var n=176,r=[],o=0;o<e.nSubgrids;o++){var s=hh(t,n,i),a=lh(t,n,s,i),h=Math.round(1+(s.upperLongitude-s.lowerLongitude)/s.longitudeInterval),l=Math.round(1+(s.upperLatitude-s.lowerLatitude)/s.latitudeInterval);r.push({ll:[oh(s.lowerLongitude),oh(s.lowerLatitude)],del:[oh(s.longitudeInterval),oh(s.latitudeInterval)],lim:[h,l],count:s.gridNodeCount,cvs:ah(a)})}return r}(i,r,n),s={header:r,subgrids:o};return ih[t]=s,s},Rh.transform=Ih,Rh.mgrs=zh,Rh.version="__VERSION__",(Gu=Rh).Proj.projections.add(fl),Gu.Proj.projections.add(wl),Gu.Proj.projections.add(Ml),Gu.Proj.projections.add(Sl),Gu.Proj.projections.add(Pl),Gu.Proj.projections.add(Nl),Gu.Proj.projections.add(Tl),Gu.Proj.projections.add(Ll),Gu.Proj.projections.add(Ol),Gu.Proj.projections.add(Bl),Gu.Proj.projections.add(Zl),Gu.Proj.projections.add(Ql),Gu.Proj.projections.add($l),Gu.Proj.projections.add(eu),Gu.Proj.projections.add(iu),Gu.Proj.projections.add(nu),Gu.Proj.projections.add(ru),Gu.Proj.projections.add(ou),Gu.Proj.projections.add(su),Gu.Proj.projections.add(au),Gu.Proj.projections.add(hu),Gu.Proj.projections.add(lu),Gu.Proj.projections.add(uu),Gu.Proj.projections.add(cu),Gu.Proj.projections.add(Eu),Gu.Proj.projections.add(Ru),Gu.Proj.projections.add(Tu),Gu.Proj.projections.add(ku),Gu.Proj.projections.add(zu);var ju=Rh;class qu extends W{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new qu(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(j(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=G(t,k.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;if(Array.isArray(t))e=t;else{lt("function"==typeof t.getZIndex,41);e=[t]}return function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}var Bu=qu;class Uu extends Qi{constructor(t){super(),this.geometries_=t||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(j),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(G(this.geometries_[t],k.CHANGE,this.changed,this))}clone(){const t=new Uu(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Et(this.getExtent(),t,e))return n;const r=this.geometries_;for(let o=0,s=r.length;o<s;++o)n=r[o].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){Pt(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)Lt(t,e[i].getExtent());return t}getGeometries(){return Xu(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let r=0,o=i.length;r<o;++r){const o=i[r],s=o.getSimplifiedGeometry(t);e.push(s),s!==o&&(n=!0)}if(n){const t=new Uu(null);return t.setGeometriesArray(e),t}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=jt(this.getExtent()));const n=this.geometries_;for(let r=0,o=n.length;r<o;++r)n[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(Xu(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Xu(t){const e=[];for(let i=0,n=t.length;i<n;++i)e.push(t[i].clone());return e}var Yu=Uu;function Vu(t,e,i,n,r,o,s){let a,h;const l=(i-e)/n;if(1===l)a=e;else if(2===l)a=e,h=r;else if(0!==l){let o=t[e],s=t[e+1],l=0;const u=[0];for(let r=e+n;r<i;r+=n){const e=t[r],i=t[r+1];l+=Math.sqrt((e-o)*(e-o)+(i-s)*(i-s)),u.push(l),o=e,s=i}const c=r*l,p=b(u,c);p<0?(h=(c-u[-p-2])/(u[-p-1]-u[-p-2]),a=e+(-p-2)*n):a=e+p*n}s=s>1?s:2,o=o||new Array(s);for(let e=0;e<s;++e)o[e]=void 0===a?NaN:void 0===h?t[a+e]:he(t[a+e],t[a+n+e],h);return o}function Wu(t,e,i,n,r,o){if(i==e)return null;let s;if(r<t[e+n-1])return o?(s=t.slice(e,e+n),s[n-1]=r,s):null;if(t[i-1]<r)return o?(s=t.slice(i-n,i),s[n-1]=r,s):null;if(r==t[e+n-1])return t.slice(e,e+n);let a=e/n,h=i/n;for(;a<h;){const e=a+h>>1;r<t[(e+1)*n-1]?h=e:a=e+1}const l=t[a*n-1];if(r==l)return t.slice((a-1)*n,(a-1)*n+n);const u=(r-l)/(t[(a+1)*n-1]-l);s=[];for(let e=0;e<n-1;++e)s.push(he(t[(a-1)*n+e],t[a*n+e],u));return s.push(r),s}function Ku(t,e,i,n,r,o,s){if(s)return Wu(t,e,i[i.length-1],n,r,o);let a;if(r<t[n-1])return o?(a=t.slice(0,n),a[n-1]=r,a):null;if(t[t.length-1]<r)return o?(a=t.slice(t.length-n),a[n-1]=r,a):null;for(let o=0,s=i.length;o<s;++o){const s=i[o];if(e!=s){if(r<t[e+n-1])return null;if(r<=t[s-1])return Wu(t,e,s,n,r,!1);e=s}}return null}function Hu(t,e,i,n){let r=t[e],o=t[e+1],s=0;for(let a=e+n;a<i;a+=n){const e=t[a],i=t[a+1];s+=Math.sqrt((e-r)*(e-r)+(i-o)*(i-o)),r=e,o=i}return s}class Zu extends en{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){this.flatCoordinates?S(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}clone(){const t=new Zu(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Et(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(rn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),an(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return Fn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,Wu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Vu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Hu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Zu(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return kn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cn(this.flatCoordinates,0,t,this.stride),this.changed()}}var Ju=Zu;class Qu extends en{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{let e=this.getLayout();const i=t,n=[],r=[];for(let t=0,o=i.length;t<o;++t){const o=i[t];0===t&&(e=o.getLayout()),S(n,o.getFlatCoordinates()),r.push(n.length)}this.setFlatCoordinates(e,n),this.ends_=r}}appendLineString(t){this.flatCoordinates?S(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Qu(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Et(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(on(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,i=void 0!==i&&i,Ku(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return En(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new Ju(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let r=0;for(let o=0,s=e.length;o<s;++o){const s=e[o],a=new Ju(t.slice(r,s),i);n.push(a),r=s}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let o=0,s=n.length;o<s;++o){const s=n[o];S(t,Vu(e,i,s,r,.5)),i=s}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=gn(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Qu(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return Gn(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=pn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}var $u=Qu;class tc extends en{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){this.flatCoordinates?S(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()}clone(){const t=new tc(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Et(this.getExtent(),t,e))return n;const r=this.flatCoordinates,o=this.stride;for(let s=0,a=r.length;s<a;s+=o){const a=re(t,e,r[s],r[s+1]);if(a<n){n=a;for(let t=0;t<o;++t)i[t]=r[s+t];i.length=o}}return n}getCoordinates(){return xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new Nn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let r=0,o=t.length;r<o;r+=i){const o=new Nn(t.slice(r,r+i),e);n.push(o)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,r=e.length;n<r;n+=i){if(Mt(t,e[n],e[n+1]))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cn(this.flatCoordinates,0,t,this.stride),this.changed()}}var ec=tc;function ic(t,e,i,n){const r=[];let o=[1/0,1/0,-1/0,-1/0];for(let s=0,a=i.length;s<a;++s){const a=i[s];o=Rt(t,e,a[0],n),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=a[a.length-1]}return r}class nc extends en{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){let n=this.getLayout();const r=t,o=[],s=[];for(let t=0,e=r.length;t<e;++t){const e=r[t];0===t&&(n=e.getLayout());const i=o.length,a=e.getEnds();for(let t=0,e=a.length;t<e;++t)a[t]+=i;S(o,e.getFlatCoordinates()),s.push(a)}e=n,t=o,i=s}void 0!==e&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;S(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,n=e.length;t<n;++t)e[t]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let i=0;i<t;++i)e[i]=this.endss_[i].slice();const i=new nc(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<Et(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(sn(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ln(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return On(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return Cn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Wn(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,wn(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=ic(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Dn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ec(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Yn(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Wn(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=vn(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new nc(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const i=this.endss_[t-1];e=i[i.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(0!==e)for(let t=0,n=i.length;t<n;++t)i[t]-=e;return new Hn(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let o=0,s=i.length;o<s;++o){const s=i[o].slice(),a=s[s.length-1];if(0!==r)for(let t=0,e=s.length;t<e;++t)s[t]-=r;const h=new Hn(e.slice(r,a),t,s);n.push(h),r=a}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return qn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=fn(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{const t=i[i.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}var rc=nc;var oc=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?ui(e.dataProjection):this.readProjection(t);e.extent&&i&&"tile-pixels"===i.getUnits()&&(i=ui(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)}getType(){return U()}readFeature(t,e){return U()}readFeatures(t,e){return U()}readGeometry(t,e){return U()}readProjection(t){return U()}writeFeature(t,e){return U()}writeFeatures(t,e){return U()}writeGeometry(t,e){return U()}};function sc(t,e,i){const n=i?ui(i.featureProjection):null,r=i?ui(i.dataProjection):null;let o;if(o=n&&r&&!yi(n,r)?(e?t.clone():t).transform(e?n:r,e?r:n):t,e&&i&&void 0!==i.decimals){const e=Math.pow(10,i.decimals),n=function(t){for(let i=0,n=t.length;i<n;++i)t[i]=Math.round(t[i]*e)/e;return t};o===t&&(o=t.clone()),o.applyTransform(n)}return o}function ac(t){return"string"==typeof t?t:""}var hc=class extends oc{constructor(){super()}getType(){return"text"}readFeature(t,e){return this.readFeatureFromText(ac(t),this.adaptOptions(e))}readFeatureFromText(t,e){return U()}readFeatures(t,e){return this.readFeaturesFromText(ac(t),this.adaptOptions(e))}readFeaturesFromText(t,e){return U()}readGeometry(t,e){return this.readGeometryFromText(ac(t),this.adaptOptions(e))}readGeometryFromText(t,e){return U()}readProjection(t){return this.readProjectionFromText(ac(t))}readProjectionFromText(t){return this.dataProjection}writeFeature(t,e){return this.writeFeatureText(t,this.adaptOptions(e))}writeFeatureText(t,e){return U()}writeFeatures(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))}writeFeaturesText(t,e){return U()}writeGeometry(t,e){return this.writeGeometryText(t,this.adaptOptions(e))}writeGeometryText(t,e){return U()}};const lc={POINT:Nn,LINESTRING:Ju,POLYGON:Hn,MULTIPOINT:ec,MULTILINESTRING:$u,MULTIPOLYGON:rc},uc="EMPTY",cc="Z",pc="M",fc=0,dc=1,gc=2,yc=3,_c=4,mc=5,vc=6,xc={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"};class Ec{constructor(t){this.wkt=t,this.index_=-1}isAlpha_(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}isNumeric_(t,e){return e=void 0!==e&&e,t>="0"&&t<="9"||"."==t&&!e}isWhiteSpace_(t){return" "==t||"\t"==t||"\r"==t||"\n"==t}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const t=this.nextChar_(),e=this.index_;let i,n=t;if("("==t)i=gc;else if(","==t)i=mc;else if(")"==t)i=yc;else if(this.isNumeric_(t)||"-"==t)i=_c,n=this.readNumber_();else if(this.isAlpha_(t))i=dc,n=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(""!==t)throw new Error("Unexpected character: "+t);i=vc}return{position:e,value:n,type:i}}readNumber_(){let t;const e=this.index_;let i=!1,n=!1;do{"."==t?i=!0:"e"!=t&&"E"!=t||(n=!0),t=this.nextChar_()}while(this.isNumeric_(t,i)||!n&&("e"==t||"E"==t)||n&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(e,this.index_--))}readText_(){let t;const e=this.index_;do{t=this.nextChar_()}while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()}}class wc{constructor(t){this.lexer_=t,this.token_={position:0,type:fc},this.layout_="XY"}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(t){return this.token_.type==t}match(t){const e=this.isTokenType(t);return e&&this.consume_(),e}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let t="XY";const e=this.token_;if(this.isTokenType(dc)){const i=e.value;i===cc?t="XYZ":i===pc?t="XYM":"ZM"===i&&(t="XYZM"),"XY"!==t&&this.consume_()}return t}parseGeometryCollectionText_(){if(this.match(gc)){const t=[];do{t.push(this.parseGeometry_())}while(this.match(mc));if(this.match(yc))return t}throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(gc)){const t=this.parsePoint_();if(this.match(yc))return t}throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(gc)){const t=this.parsePointList_();if(this.match(yc))return t}throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(gc)){const t=this.parseLineStringTextList_();if(this.match(yc))return t}throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(gc)){let t;if(t=this.token_.type==gc?this.parsePointTextList_():this.parsePointList_(),this.match(yc))return t}throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(gc)){const t=this.parseLineStringTextList_();if(this.match(yc))return t}throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(gc)){const t=this.parsePolygonTextList_();if(this.match(yc))return t}throw new Error(this.formatErrorMessage_())}parsePoint_(){const t=[],e=this.layout_.length;for(let i=0;i<e;++i){const e=this.token_;if(!this.match(_c))break;t.push(e.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())}parsePointList_(){const t=[this.parsePoint_()];for(;this.match(mc);)t.push(this.parsePoint_());return t}parsePointTextList_(){const t=[this.parsePointText_()];for(;this.match(mc);)t.push(this.parsePointText_());return t}parseLineStringTextList_(){const t=[this.parseLineStringText_()];for(;this.match(mc);)t.push(this.parseLineStringText_());return t}parsePolygonTextList_(){const t=[this.parsePolygonText_()];for(;this.match(mc);)t.push(this.parsePolygonText_());return t}isEmptyGeometry_(){const t=this.isTokenType(dc)&&this.token_.value==uc;return t&&this.consume_(),t}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const t=this.token_;if(this.match(dc)){const e=t.value;this.layout_=this.parseGeometryLayout_();const i=this.isEmptyGeometry_();if("GEOMETRYCOLLECTION"==e){if(i)return new Yu([]);const t=this.parseGeometryCollectionText_();return new Yu(t)}const n=lc[e];if(!n)throw new Error("Invalid geometry type: "+e);let r;if(i)r="POINT"==e?[NaN,NaN]:[];else switch(e){case"POINT":r=this.parsePointText_();break;case"LINESTRING":r=this.parseLineStringText_();break;case"POLYGON":r=this.parsePolygonText_();break;case"MULTIPOINT":r=this.parseMultiPointText_();break;case"MULTILINESTRING":r=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":r=this.parseMultiPolygonText_()}return new n(r,this.layout_)}throw new Error(this.formatErrorMessage_())}}function bc(t){const e=t.getCoordinates();return 0===e.length?"":e.join(" ")}function Mc(t){const e=t.getCoordinates(),i=[];for(let t=0,n=e.length;t<n;++t)i.push(e[t].join(" "));return i.join(",")}function Cc(t){const e=[],i=t.getLinearRings();for(let t=0,n=i.length;t<n;++t)e.push("("+Mc(i[t])+")");return e.join(",")}const Ic={Point:bc,LineString:Mc,Polygon:Cc,MultiPoint:function(t){const e=[],i=t.getPoints();for(let t=0,n=i.length;t<n;++t)e.push("("+bc(i[t])+")");return e.join(",")},MultiLineString:function(t){const e=[],i=t.getLineStrings();for(let t=0,n=i.length;t<n;++t)e.push("("+Mc(i[t])+")");return e.join(",")},MultiPolygon:function(t){const e=[],i=t.getPolygons();for(let t=0,n=i.length;t<n;++t)e.push("("+Cc(i[t])+")");return e.join(",")},GeometryCollection:function(t){const e=[],i=t.getGeometries();for(let t=0,n=i.length;t<n;++t)e.push(Sc(i[t]));return e.join(",")}};function Sc(t){const e=t.getType(),i=(0,Ic[e])(t);let n=xc[e];if("function"==typeof t.getFlatCoordinates){const e=function(t){const e=t.getLayout();let i="";return"XYZ"!==e&&"XYZM"!==e||(i+=cc),"XYM"!==e&&"XYZM"!==e||(i+=pc),i}(t);e.length>0&&(n+=" "+e)}return 0===i.length?n+" "+uc:n+"("+i+")"}var Pc=class extends hc{constructor(t){super(),t=t||{},this.splitCollection_=void 0!==t.splitCollection&&t.splitCollection}parse_(t){const e=new Ec(t);return new wc(e).parse()}readFeatureFromText(t,e){const i=this.readGeometryFromText(t,e),n=new Bu;return n.setGeometry(i),n}readFeaturesFromText(t,e){let i=[];const n=this.readGeometryFromText(t,e);i=this.splitCollection_&&"GeometryCollection"==n.getType()?n.getGeometriesArray():[n];const r=[];for(let t=0,e=i.length;t<e;++t){const e=new Bu;e.setGeometry(i[t]),r.push(e)}return r}readGeometryFromText(t,e){return sc(this.parse_(t),!1,e)}writeFeatureText(t,e){const i=t.getGeometry();return i?this.writeGeometryText(i,e):""}writeFeaturesText(t,e){if(1==t.length)return this.writeFeatureText(t[0],e);const i=[];for(let e=0,n=t.length;e<n;++e)i.push(t[e].getGeometry());const n=new Yu(i);return this.writeGeometryText(n,e)}writeGeometryText(t,e){return Sc(sc(t,!0,e))}};function Nc(t){if("string"==typeof t){const e=JSON.parse(t);return e||null}return null!==t?t:null}var Rc=class extends oc{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Nc(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Nc(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return U()}readFeaturesFromObject(t,e){return U()}readGeometry(t,e){return this.readGeometryFromObject(Nc(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return U()}readProjection(t){return this.readProjectionFromObject(Nc(t))}readProjectionFromObject(t){return U()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return U()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return U()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return U()}};function Tc(t,e){if(!t)return null;let i;switch(t.type){case"Point":i=function(t){return new Nn(t.coordinates)}(t);break;case"LineString":i=function(t){return new Ju(t.coordinates)}(t);break;case"Polygon":i=function(t){return new Hn(t.coordinates)}(t);break;case"MultiPoint":i=function(t){return new ec(t.coordinates)}(t);break;case"MultiLineString":i=function(t){return new $u(t.coordinates)}(t);break;case"MultiPolygon":i=function(t){return new rc(t.coordinates)}(t);break;case"GeometryCollection":i=function(t,e){const i=t.geometries.map((function(t){return Tc(t,e)}));return new Yu(i)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return sc(i,!1,e)}function Lc(t,e){const i=(t=sc(t,!0,e)).getType();let n;switch(i){case"Point":n=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":n=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":n=function(t,e){let i;e&&(i=e.rightHanded);return{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"MultiPoint":n=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":n=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":n=function(t,e){let i;e&&(i=e.rightHanded);return{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"GeometryCollection":n=function(t,e){e=Object.assign({},e),delete e.featureProjection;const i=t.getGeometriesArray().map((function(t){return Lc(t,e)}));return{type:"GeometryCollection",geometries:i}}(t,e);break;case"Circle":n={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+i)}return n}var Oc=class extends Rc{constructor(t){t=t||{},super(),this.dataProjection=ui(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=ui(t.featureProjection)),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const n=Tc(i.geometry,e),r=new Bu;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.setGeometryName(i.geometry_name),r.setGeometry(n),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){let i=null;if("FeatureCollection"===t.type){i=[];const n=t.features;for(let t=0,r=n.length;t<r;++t)i.push(this.readFeatureFromObject(n[t],e))}else i=[this.readFeatureFromObject(t,e)];return i}readGeometryFromObject(t,e){return Tc(t,e)}readProjectionFromObject(t){const e=t.crs;let i;return e?"name"==e.type?i=ui(e.properties.name):"EPSG"===e.type?i=ui("EPSG:"+e.properties.code):lt(!1,36):i=this.dataProjection,i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(i.id=n),!t.hasProperties())return i;const r=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=Lc(o,e),delete r[t.getGeometryName()]),D(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return Lc(t,this.adaptOptions(e))}},Ac={};Ac=function(){function t(t,n,r,o,s){!function t(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,h=n-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(h-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-h*u/a+c)),Math.min(o,Math.floor(n+(a-h)*u/a+c)),s)}var p=i[n],f=r,d=o;for(e(i,r,n),s(i[o],p)>0&&e(i,r,o);f<d;){for(e(i,f,d),f++,d--;s(i[f],p)<0;)f++;for(;s(i[d],p)>0;)d--}0===s(i[r],p)?e(i,r,d):e(i,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}(t,n,r||0,o||t.length-1,s||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,r){r||(r=d(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o=e;o<i;o++){var s=t.children[o];a(r,t.leaf?n(s):s)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,i,n,r,o){for(var s=[i,n];s.length;)if(!((n=s.pop())-(i=s.pop())<=r)){var a=i+Math.ceil((n-i)/r/2)*r;t(e,a,i,n,o),s.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!f(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;f(t,a)&&(e.leaf?i.push(s):p(t,a)?this._all(s,i):r.push(s))}e=r.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],o=e.leaf?this.toBBox(r):r;if(f(t,o)){if(e.leaf||p(t,o))return!0;i.push(r)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=d([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,o,s=this.data,a=this.toBBox(t),h=[],l=[];s||h.length;){if(s||(s=h.pop(),n=h[h.length-1],i=l.pop(),o=!0),s.leaf){var u=r(t,s.children,e);if(-1!==u)return s.children.splice(u,1),h.push(s),this._condense(h),this}o||s.leaf||!p(s,a)?n?(i++,s=n.children[i],o=!1):s=null:(h.push(s),l.push(i),i=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var r,s=i-e+1,a=this._maxEntries;if(s<=a)return o(r=d(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(r=d([])).leaf=!1,r.height=n;var h=Math.ceil(s/a),l=h*Math.ceil(Math.sqrt(a));g(t,e,i,l,this.compareMinX);for(var u=e;u<=i;u+=l){var c=Math.min(u+l-1,i);g(t,u,c,h,this.compareMinY);for(var p=u;p<=c;p+=h){var f=Math.min(p+h-1,c);r.children.push(this._build(t,p,f,n-1))}}return o(r,this.toBBox),r},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var h=e.children[a],l=u(h),c=(p=t,f=h,(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-l);c<o?(o=c,r=l<r?l:r,s=h):c===o&&l<r&&(r=l,s=h)}e=s||e.children[0]}var p,f;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],o=this._chooseSubtree(n,this.data,e,r);for(o.children.push(t),a(o,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var s=this._chooseSplitIndex(i,r,n),a=d(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,o(i,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,o,a,h,l,c,p=1/0,f=1/0,d=e;d<=i-e;d++){var g=s(t,0,d,this.toBBox),y=s(t,d,i,this.toBBox),_=(r=g,o=y,a=void 0,h=void 0,l=void 0,c=void 0,a=Math.max(r.minX,o.minX),h=Math.max(r.minY,o.minY),l=Math.min(r.maxX,o.maxX),c=Math.min(r.maxY,o.maxY),Math.max(0,l-a)*Math.max(0,c-h)),m=u(g)+u(y);_<p?(p=_,n=d,f=m<f?m:f):_===p&&m<f&&(f=m,n=d)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:h,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,o=s(t,0,e,r),h=s(t,i-e,i,r),l=c(o)+c(h),u=e;u<i-e;u++){var p=t.children[u];a(o,t.leaf?r(p):p),l+=c(o)}for(var f=i-e-1;f>=e;f--){var d=t.children[f];a(h,t.leaf?r(d):d),l+=c(h)}return l},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}();var Dc=class{constructor(e){this.rbush_=new(t(Ac))(e),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Y(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const r=t[n],o=e[n],s={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:o};i[n]=s,this.items_[Y(o)]=s}this.rbush_.load(i)}remove(t){const e=Y(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[Y(e)];Tt([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return D(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return St(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}},Fc={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function kc(t,e){return[[-1/0,-1/0,1/0,1/0]]}let Gc=!1;function zc(t,e){return function(i,n,r,o,s){const a=this;!function(t,e,i,n,r,o,s){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(i,n,r):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=Gc,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();let n;"json"==t||"text"==t?n=a.responseText:"xml"==t?(n=a.responseXML,n||(n=(new DOMParser).parseFromString(a.responseText,"application/xml"))):"arraybuffer"==t&&(n=a.response),n?o(e.readFeatures(n,{extent:i,featureProjection:r}),e.readProjection(n)):s()}else s()},a.onerror=s,a.send()}(t,e,i,n,r,(function(t,e){a.addFeatures(t),void 0!==o&&o(t)}),s||L)}}class jc extends x{constructor(t,e,i){super(t),this.feature=e,this.features=i}}var qc=class extends _s{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=L,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(lt(this.format_,7),this.loader_=zc(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:kc;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,n;this.featuresRtree_=e?new Dc:null,this.loadedExtentsRtree_=new Dc,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),e||void 0!==i||(i=new tt(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=Y(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const e=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new jc(Fc.ADDFEATURE,t))}setupChangeEvents_(t,e){this.featureChangeKeys_[t]=[G(e,k.CHANGE,this.handleFeatureChange_,this),G(e,E.PROPERTYCHANGE,this.handleFeatureChange_,this)]}addToIndex_(t,e){let i=!0;const n=e.getId();return void 0!==n&&(n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e),i&&(lt(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let e=0,n=t.length;e<n;e++){const n=t[e],r=Y(n);this.addToIndex_(r,n)&&i.push(n)}for(let t=0,r=i.length;t<r;t++){const r=i[t],o=Y(r);this.setupChangeEvents_(o,r);const s=r.getGeometry();if(s){const t=s.getExtent();e.push(t),n.push(r)}else this.nullGeometryFeatures_[o]=r}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(Fc.ADDFEATURE))for(let t=0,e=i.length;t<e;t++)this.dispatchEvent(new jc(Fc.ADDFEATURE,i[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Fc.ADDFEATURE,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(Fc.REMOVEFEATURE,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(J.ADD,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(J.REMOVE,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_){this.featureChangeKeys_[t].forEach(j)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new jc(Fc.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){if(i.getGeometry().intersectsCoordinate(t))return e(i)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){const t=e(i);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),D(this.nullGeometryFeatures_)||S(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=ee(t,e);return[].concat(...i.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const o=[NaN,NaN];let s=1/0;const a=[-1/0,-1/0,1/0,1/0];return e=e||R,this.featuresRtree_.forEachInExtent(a,(function(t){if(e(t)){const e=t.getGeometry(),h=s;if(s=e.closestPointXY(i,n,o,s),s<h){r=t;const e=Math.sqrt(s);a[0]=i-e,a[1]=n-e,a[2]=i+e,a[3]=n+e}}})),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=Y(e),n=e.getGeometry();if(n){const t=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const r=e.getId();if(void 0!==r){const t=r.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new jc(Fc.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:Y(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&D(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let t=0,o=r.length;t<o;++t){const o=r[t];n.forEachInExtent(o,(function(t){return bt(t.extent,o)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new jc(Fc.FEATURESLOADSTART)),this.loader_.call(this,o,e,i,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new jc(Fc.FEATURESLOADEND,void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new jc(Fc.FEATURESLOADERROR))})),n.insert(o,{extent:o.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,(function(e){if(Tt(e.extent,t))return i=e,!0})),i&&e.remove(i)}removeFeature(t){if(!t)return;const e=Y(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=Y(t),i=this.featureChangeKeys_[e];if(!i)return;i.forEach(j),delete this.featureChangeKeys_[e];const n=t.getId();return void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new jc(Fc.REMOVEFEATURE,t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e}setLoader(t){this.loader_=t}setUrl(t){lt(this.format_,7),this.url_=t,this.setLoader(zc(t,this.format_))}};class Bc{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Xo(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Bc({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return U()}getImage(t){return U()}getHitDetectionImage(){return U()}getPixelRatio(t){return 1}getImageState(){return U()}getImageSize(){return U()}getOrigin(){return U()}getSize(){return U()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Xo(t)}listenImageChange(t){U()}load(){U()}unlistenImageChange(t){U()}}var Uc=Bc;function Xc(t){return Array.isArray(t)?ve(t):t}class Yc extends Uc{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvas_=void 0,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_=null,this.renderOptions_=null,this.render()}clone(){const t=this.getScale(),e=new Yc({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_;if(!t)return null;const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}getImage(t){let e=this.canvas_[t];if(!e){const i=this.renderOptions_,n=fr(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvas_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return Ho.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let n=this.radius_,r=void 0===this.radius2_?n:this.radius2_;if(n<r){const t=n;n=r,r=t}const o=void 0===this.radius2_?this.points_:2*this.points_,s=2*Math.PI/o,a=r*Math.sin(s),h=n-Math.sqrt(r*r-a*a),l=Math.sqrt(a*a+h*h),u=l/a;if("miter"===t&&u<=i)return u*e;const c=e/2/u,p=e/2*(h/l),f=Math.sqrt((n+c)*(n+c)+p*p)-n;if(void 0===this.radius2_||"bevel"===t)return 2*f;const d=n*Math.sin(s),g=r-Math.sqrt(n*n-d*d),y=Math.sqrt(d*d+g*g)/d;if(y<=i){const t=y*e/2-r-n;return 2*Math.max(f,t)}return 2*f}createRenderOptions(){let t,e=br,i=0,n=null,r=0,o=0;this.stroke_&&(t=this.stroke_.getColor(),null===t&&(t=Mr),t=Xc(t),o=this.stroke_.getWidth(),void 0===o&&(o=1),n=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset(),e=this.stroke_.getLineJoin(),void 0===e&&(e=br),i=this.stroke_.getMiterLimit(),void 0===i&&(i=10));const s=this.calculateLineJoinSize_(e,o,i),a=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*a+s),lineDash:n,lineDashOffset:r,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=xr),e.fillStyle=Xc(t),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){if(this.fill_){let e=this.fill_.getColor(),i=0;if("string"==typeof e&&(e=_e(e)),null===e?i=1:Array.isArray(e)&&(i=4===e.length?e[3]:1),0===i){const e=fr(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let s=0;s<e;s++){const e=r+s*o,a=s%2==0?i:n;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=xr,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}var Vc=Yc;class Wc extends Vc{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Wc({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}var Kc=Wc;class Hc{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null}clone(){const t=this.getColor();return new Hc({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}var Zc=Hc;class Jc{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Jc({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}var Qc=Jc;class $c{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=np,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new $c({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=np,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function tp(t){let e;if("function"==typeof t)e=t;else{let i;if(Array.isArray(t))i=t;else{lt("function"==typeof t.getZIndex,41);i=[t]}e=function(){return i}}return e}let ep=null;function ip(t,e){if(!ep){const t=new Zc({color:"rgba(255,255,255,0.4)"}),e=new Qc({color:"#3399CC",width:1.25});ep=[new $c({image:new Kc({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return ep}function np(t){return t.getGeometry()}var rp=$c;let op=null;class sp extends F{constructor(t,e,i,n,r,o){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=o,this.unlisten_=null,this.imageState_=r,this.size_=i,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&this.imageState_===Ho.LOADED){op||(op=fr(1,1,void 0,{willReadFrequently:!0})),op.drawImage(this.image_,0,0);try{op.getImageData(0,0,1,1),this.tainted_=!1}catch(t){op=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(k.CHANGE)}handleImageError_(){this.imageState_=Ho.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ho.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=fr(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ho.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ho.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=Zo(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==Ho.LOADED)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=de(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function ap(t,e,i,n,r,o){let s=we.get(e,n,o);return s||(s=new sp(t,e,i,n,r,o),we.set(e,n,o,s)),s}class hp extends Uc{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,r=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:i,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const o=void 0!==t.img?t.img:null;this.imgSize_=t.imgSize;let s=t.src;lt(!(void 0!==s&&o),4),lt(!o||o&&this.imgSize_,5),void 0!==s&&0!==s.length||!o||(s=o.src||Y(o)),lt(void 0!==s&&s.length>0,6),lt(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),69);const a=void 0!==t.src?Ho.IDLE:Ho.LOADED;if(this.color_=void 0!==t.color?_e(t.color):null,this.iconImage_=ap(o,s,void 0!==this.imgSize_?this.imgSize_:null,this.crossOrigin_,a,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,this.width_=t.width,this.height_=t.height,void 0!==this.width_||void 0!==this.height_){const t=this.getImage(1),e=()=>{this.updateScaleFromWidthAndHeight(this.width_,this.height_)};t.width>0?this.updateScaleFromWidthAndHeight(this.width_,this.height_):t.addEventListener("load",e)}}clone(){let t=this.getScale();return t=Array.isArray(t)?t.slice():t,void 0===this.width_&&void 0===this.height_||(t=void 0),new hp({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode(),width:this.width_,height:this.height_})}updateScaleFromWidthAndHeight(t,e){const i=this.getImage(1);void 0!==t&&void 0!==e?super.setScale([t/i.width,e/i.height]):void 0!==t?super.setScale([t/i.width,t/i.width]):void 0!==e?super.setScale([e/i.height,e/i.height]):super.setScale([1,1])}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){return this.width_}getHeight(){return this.height_}setWidth(t){this.width_=t,this.updateScaleFromWidthAndHeight(t,this.height_)}setHeight(t){this.height_=t,this.updateScaleFromWidthAndHeight(this.width_,t)}setScale(t){super.setScale(t);const e=this.getImage(1);if(e){const i=Array.isArray(t)?t[0]:t;void 0!==i&&(this.width_=i*e.width);const n=Array.isArray(t)?t[1]:t;void 0!==n&&(this.height_=n*e.height)}}listenImageChange(t){this.iconImage_.addEventListener(k.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(k.CHANGE,t)}}var lp=hp;class up{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Xo(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new Zc({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}clone(){const t=this.getScale();return new up({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Xo(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}var cp=up;function pp(t){return new rp({fill:fp(t,""),stroke:dp(t,""),text:gp(t),image:yp(t)})}function fp(t,e){const i=t[e+"fill-color"];if(i)return new Zc({color:i})}function dp(t,e){const i=t[e+"stroke-width"],n=t[e+"stroke-color"];if(i||n)return new Qc({width:i,color:n,lineCap:t[e+"stroke-line-cap"],lineJoin:t[e+"stroke-line-join"],lineDash:t[e+"stroke-line-dash"],lineDashOffset:t[e+"stroke-line-dash-offset"],miterLimit:t[e+"stroke-miter-limit"]})}function gp(t){const e=t["text-value"];if(!e)return;return new cp({text:e,font:t["text-font"],maxAngle:t["text-max-angle"],offsetX:t["text-offset-x"],offsetY:t["text-offset-y"],overflow:t["text-overflow"],placement:t["text-placement"],repeat:t["text-repeat"],scale:t["text-scale"],rotateWithView:t["text-rotate-with-view"],rotation:t["text-rotation"],textAlign:t["text-align"],justify:t["text-justify"],textBaseline:t["text-baseline"],padding:t["text-padding"],fill:fp(t,"text-"),backgroundFill:fp(t,"text-background-"),stroke:dp(t,"text-"),backgroundStroke:dp(t,"text-background-")})}function yp(t){const e=t["icon-src"],i=t["icon-img"];if(e||i){return new lp({src:e,img:i,imgSize:t["icon-img-size"],anchor:t["icon-anchor"],anchorOrigin:t["icon-anchor-origin"],anchorXUnits:t["icon-anchor-x-units"],anchorYUnits:t["icon-anchor-y-units"],color:t["icon-color"],crossOrigin:t["icon-cross-origin"],offset:t["icon-offset"],displacement:t["icon-displacement"],opacity:t["icon-opacity"],scale:t["icon-scale"],rotation:t["icon-rotation"],rotateWithView:t["icon-rotate-with-view"],size:t["icon-size"],declutterMode:t["icon-declutter-mode"]})}const n=t["shape-points"];if(n){const e="shape-";return new Vc({points:n,fill:fp(t,e),stroke:dp(t,e),radius:t["shape-radius"],radius1:t["shape-radius1"],radius2:t["shape-radius2"],angle:t["shape-angle"],displacement:t["shape-displacement"],rotation:t["shape-rotation"],rotateWithView:t["shape-rotate-with-view"],scale:t["shape-scale"],declutterMode:t["shape-declutter-mode"]})}const r=t["circle-radius"];if(r){const e="circle-";return new Kc({radius:r,fill:fp(t,e),stroke:dp(t,e),displacement:t["circle-displacement"],scale:t["circle-scale"],rotation:t["circle-rotation"],rotateWithView:t["circle-rotate-with-view"],declutterMode:t["circle-declutter-mode"]})}}const _p="renderOrder";var mp=class extends ir{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(_p)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e){e.declutterTree||(e.declutterTree=new(t(Ac))(9)),this.getRenderer().renderDeclutter(e)}setRenderOrder(t){this.set(_p,t)}setStyle(t){let e;if(void 0===t)e=ip;else if(null===t)e=null;else if("function"==typeof t)e=t;else if(t instanceof rp)e=t;else if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let e=0;e<i;++e){const i=t[e];n[e]=i instanceof rp?i:pp(i)}e=n}else e=pp(t);this.style_=e,this.styleFunction_=null===t?void 0:tp(this.style_),this.changed()}};const vp={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},xp=[vp.FILL],Ep=[vp.STROKE],wp=[vp.BEGIN_PATH],bp=[vp.CLOSE_PATH];var Mp=vp;var Cp=class{drawCustom(t,e,i,n){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}};var Ip=class extends Cp{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let s=0,a=t.length;s<a;s+=e)n[0]=t[s],n[1]=t[s+1],wt(i,n)&&(r[o++]=n[0],r[o++]=n[1]);return o}appendFlatLineCoordinates(t,e,i,n,r,o){const s=this.coordinates;let a=s.length;const h=this.getBufferedMaxExtent();o&&(e+=n);let l=t[e],u=t[e+1];const c=this.tmpCoordinate_;let p,f,d,g=!0;for(p=e+n;p<i;p+=n)c[0]=t[p],c[1]=t[p+1],d=Ct(h,c),d!==f?(g&&(s[a++]=l,s[a++]=u,g=!1),s[a++]=c[0],s[a++]=c[1]):d===_t.INTERSECTING?(s[a++]=c[0],s[a++]=c[1],g=!1):g=!0,l=c[0],u=c[1],f=d;return(r&&g||p===e+n)&&(s[a++]=l,s[a++]=u),a}drawCustomCoordinates_(t,e,i,n,r){for(let o=0,s=i.length;o<s;++o){const s=i[o],a=this.appendFlatLineCoordinates(t,e,s,n,!1,!1);r.push(a),e=s}return e}drawCustom(t,e,i,n){this.beginGeometry(t,e);const r=t.getType(),o=t.getStride(),s=this.coordinates.length;let a,h,l,u,c;switch(r){case"MultiPolygon":a=t.getOrientedFlatCoordinates(),u=[];const e=t.getEndss();c=0;for(let t=0,i=e.length;t<i;++t){const i=[];c=this.drawCustomCoordinates_(a,c,e[t],o,i),u.push(i)}this.instructions.push([Mp.CUSTOM,s,u,t,i,wn]),this.hitDetectionInstructions.push([Mp.CUSTOM,s,u,t,n||i,wn]);break;case"Polygon":case"MultiLineString":l=[],a="Polygon"==r?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),c=this.drawCustomCoordinates_(a,0,t.getEnds(),o,l),this.instructions.push([Mp.CUSTOM,s,l,t,i,En]),this.hitDetectionInstructions.push([Mp.CUSTOM,s,l,t,n||i,En]);break;case"LineString":case"Circle":a=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(a,0,a.length,o,!1,!1),this.instructions.push([Mp.CUSTOM,s,h,t,i,xn]),this.hitDetectionInstructions.push([Mp.CUSTOM,s,h,t,n||i,xn]);break;case"MultiPoint":a=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(a,o),h>s&&(this.instructions.push([Mp.CUSTOM,s,h,t,i,xn]),this.hitDetectionInstructions.push([Mp.CUSTOM,s,h,t,n||i,xn]));break;case"Point":a=t.getFlatCoordinates(),this.coordinates.push(a[0],a[1]),h=this.coordinates.length,this.instructions.push([Mp.CUSTOM,s,h,t,i]),this.hitDetectionInstructions.push([Mp.CUSTOM,s,h,t,n||i])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[Mp.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Mp.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,r,o=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==Mp.END_GEOMETRY?o=e:r==Mp.BEGIN_GEOMETRY&&(n[2]=e,I(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=Xc(e||xr)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=Xc(t||Mr);const n=e.getLineCap();i.lineCap=void 0!==n?n:Er;const r=e.getLineDash();i.lineDash=r?r.slice():wr;const o=e.getLineDashOffset();i.lineDashOffset=o||0;const s=e.getLineJoin();i.lineJoin=void 0!==s?s:br;const a=e.getWidth();i.lineWidth=void 0!==a?a:1;const h=e.getMiterLimit();i.miterLimit=void 0!==h?h:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[Mp.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Mp.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!P(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Mp.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=xt(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;vt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}};var Sp=class extends Ip{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(i,n);this.instructions.push([Mp.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Mp.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(i,n);this.instructions.push([Mp.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Mp.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}};var Pp=class extends Ip{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),s=[Mp.MOVE_TO_LINE_TO,r,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i}drawLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Mp.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,wr,0],wp);const o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push(Ep),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Mp.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],wp);const o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride();let h=0;for(let t=0,e=o.length;t<e;++t)h=this.drawFlatCoordinates_(s,h,o[t],a);this.hitDetectionInstructions.push(Ep),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Ep),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Ep),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(wp)}};var Np=class extends Ip{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,o=void 0!==r.fillStyle,s=void 0!==r.strokeStyle,a=i.length;this.instructions.push(wp),this.hitDetectionInstructions.push(wp);for(let r=0;r<a;++r){const o=i[r],a=this.coordinates.length,h=this.appendFlatLineCoordinates(t,e,o,n,!0,!s),l=[Mp.MOVE_TO_LINE_TO,a,h];this.instructions.push(l),this.hitDetectionInstructions.push(l),s&&(this.instructions.push(bp),this.hitDetectionInstructions.push(bp)),e=o}return o&&(this.instructions.push(xp),this.hitDetectionInstructions.push(xp)),s&&(this.instructions.push(Ep),this.hitDetectionInstructions.push(Ep)),e}drawCircle(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Mp.SET_FILL_STYLE,xr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Mp.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,s,!1,!1);const h=[Mp.CIRCLE,a];this.instructions.push(wp,h),this.hitDetectionInstructions.push(wp,h),void 0!==i.fillStyle&&(this.instructions.push(xp),this.hitDetectionInstructions.push(xp)),void 0!==i.strokeStyle&&(this.instructions.push(Ep),this.hitDetectionInstructions.push(Ep)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Mp.SET_FILL_STYLE,xr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Mp.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Mp.SET_FILL_STYLE,xr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Mp.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);const o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride();let h=0;for(let t=0,e=o.length;t<e;++t)h=this.drawFlatCoordinatess_(s,h,o[t],a);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=yn(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function Rp(t,e,i,n,r){const o=[];let s=i,a=0,h=e.slice(i,2);for(;a<t&&s+r<n;){const[i,n]=h.slice(-2),l=e[s+r],u=e[s+r+1],c=Math.sqrt((l-i)*(l-i)+(u-n)*(u-n));if(a+=c,a>=t){const e=(t-a+c)/c,p=he(i,l,e),f=he(n,u,e);h.push(p,f),o.push(h),h=[p,f],a==t&&(s+=r),a=0}else if(a<t)h.push(e[s+r],e[s+r+1]),s+=r;else{const t=c-a,e=he(i,l,t/c),p=he(n,u,t/c);h.push(e,p),o.push(h),h=[e,p],a=0,s+=r}}return a>0&&o.push(h),o}function Tp(t,e,i,n,r){let o,s,a,h,l,u,c,p,f,d,g=i,y=i,_=0,m=0,v=i;for(s=i;s<n;s+=r){const i=e[s],n=e[s+1];void 0!==l&&(f=i-l,d=n-u,h=Math.sqrt(f*f+d*d),void 0!==c&&(m+=a,o=Math.acos((c*f+p*d)/(a*h)),o>t&&(m>_&&(_=m,g=v,y=s),m=0,v=s-r)),a=h,c=f,p=d),l=i,u=n}return m+=h,m>_?[v,s]:[g,y]}const Lp={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};const Op={Circle:Np,Default:Ip,Image:Sp,LineString:Pp,Polygon:Np,Text:class extends Ip{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!i&&!n)return;const o=this.coordinates;let s=o.length;const a=t.getType();let h=null,l=t.getStride();if("line"!==r.placement||"LineString"!=a&&"MultiLineString"!=a&&"Polygon"!=a&&"MultiPolygon"!=a){let i=r.overflow?null:[];switch(a){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),l=2;break;case"Polygon":h=t.getFlatInteriorPoint(),r.overflow||i.push(h[2]/this.resolution),l=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();h=[];for(let t=0,n=e.length;t<n;t+=3)r.overflow||i.push(e[t+2]/this.resolution),h.push(e[t],e[t+1]);if(0===h.length)return;l=2}const n=this.appendFlatPointCoordinates(h,l);if(n===s)return;if(i&&(n-s)/2!=h.length/l){let t=s/2;i=i.filter(((e,i)=>{const n=o[2*(t+i)]===h[i*l]&&o[2*(t+i)+1]===h[i*l+1];return n||--t,n}))}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let u=r.padding;if(u!=Sr&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],i=r.padding[2],n=r.padding[3];r.scale[0]<0&&(e=-e,n=-n),r.scale[1]<0&&(t=-t,i=-i),u=[t,e,i,n]}const c=this.pixelRatio;this.instructions.push([Mp.DRAW_IMAGE,s,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,u==Sr?Sr:u.map((function(t){return t*c})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);const p=1/c;this.hitDetectionInstructions.push([Mp.DRAW_IMAGE,s,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[p,p],NaN,void 0,this.declutterImageWithText_,u,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),this.endGeometry(e)}else{if(!Ht(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(h=t.getFlatCoordinates(),"LineString"==a)i=[h.length];else if("MultiLineString"==a)i=t.getEnds();else if("Polygon"==a)i=t.getEnds().slice(0,1);else if("MultiPolygon"==a){const e=t.getEndss();i=[];for(let t=0,n=e.length;t<n;++t)i.push(e[t][0])}this.beginGeometry(t,e);const n=r.repeat,u=n?void 0:r.textAlign;let c=0;for(let t=0,e=i.length;t<e;++t){let e;e=n?Rp(n*this.resolution,h,c,i[t],l):[h.slice(c,i[t])];for(let n=0,a=e.length;n<a;++n){const a=e[n];let h=0,p=a.length;if(null==u){const t=Tp(r.maxAngle,a,0,a.length,2);h=t[0],p=t[1]}for(let t=h;t<p;t+=l)o.push(a[t],a[t+1]);const f=o.length;c=i[t],this.drawChars_(s,f),s=f}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||Cr,justify:e.justify,textBaseline:e.textBaseline||Ir,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,o=this.textKey_,s=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,h=Lp[n.textBaseline],l=this.textOffsetY_*a,u=this.text_,c=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([Mp.DRAW_CHARS,t,e,h,n.overflow,s,n.maxAngle,a,l,r,c*a,u,o,1]),this.hitDetectionInstructions.push([Mp.DRAW_CHARS,t,e,h,n.overflow,s,n.maxAngle,1,l,r,c,u,o,1/a])}setTextStyle(t,e){let i,n,r;if(t){const e=t.getFill();e?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=Xc(e.getColor()||xr)):(n=null,this.textFillState_=n);const o=t.getStroke();if(o){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const t=o.getLineDash(),e=o.getLineDashOffset(),i=o.getWidth(),n=o.getMiterLimit();r.lineCap=o.getLineCap()||Er,r.lineDash=t?t.slice():wr,r.lineDashOffset=void 0===e?0:e,r.lineJoin=o.getLineJoin()||br,r.lineWidth=void 0===i?1:i,r.miterLimit=void 0===n?10:n,r.strokeStyle=Xc(o.getColor()||Mr)}else r=null,this.textStrokeState_=r;i=this.textState_;const s=t.getFont()||vr;Lr(s);const a=t.getScaleArray();i.overflow=t.getOverflow(),i.font=s,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||Ir,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Sr,i.scale=void 0===a?[1,1]:a;const h=t.getOffsetX(),l=t.getOffsetY(),u=t.getRotateWithView(),c=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===h?0:h,this.textOffsetY_=void 0===l?0:l,this.textRotateWithView_=void 0!==u&&u,this.textRotation_=void 0===c?0:c,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:Y(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+Y(n.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}};var Ap=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];if(void 0===r){r=new(0,Op[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r}return r}};function Dp(t,e,i,n,r,o,s,a,h,l,u,c){let p=t[e],f=t[e+1],d=0,g=0,y=0,_=0;function m(){d=p,g=f,p=t[e+=n],f=t[e+1],_+=y,y=Math.sqrt((p-d)*(p-d)+(f-g)*(f-g))}do{m()}while(e<i-n&&_+y<o);let v=0===y?0:(o-_)/y;const x=he(d,p,v),E=he(g,f,v),w=e-n,b=_,M=o+a*h(l,r,u);for(;e<i-n&&_+y<M;)m();v=0===y?0:(M-_)/y;const C=he(d,p,v),I=he(g,f,v);let S;if(c){const t=[x,E,C,I];Ki(t,0,4,2,c,t,t),S=t[0]>t[2]}else S=x>C;const P=Math.PI,N=[],R=w+n===e;let T;if(y=0,_=b,p=t[e=w],f=t[e+1],R){m(),T=Math.atan2(f-g,p-d),S&&(T+=T>0?-P:P);const t=(C+x)/2,e=(I+E)/2;return N[0]=[t,e,(M-o)/2,T,r],N}for(let t=0,c=(r=r.replace(/\n/g," ")).length;t<c;){m();let x=Math.atan2(f-g,p-d);if(S&&(x+=x>0?-P:P),void 0!==T){let t=x-T;if(t+=t>P?-2*P:t<-P?2*P:0,Math.abs(t)>s)return null}T=x;const E=t;let w=0;for(;t<c;++t){const s=a*h(l,r[S?c-t-1:t],u);if(e+n<i&&_+y<o+w+s/2)break;w+=s}if(t===E)continue;const b=S?r.substring(c-E,c-t):r.substring(E,t);v=0===y?0:(o+w/2-_)/y;const M=he(d,p,v),C=he(g,f,v);N.push([M,C,w/2,x,b]),o+=w}return N}const Fp=[1/0,1/0,-1/0,-1/0],kp=[],Gp=[],zp=[],jp=[];function qp(t){return t[3].declutterBox}const Bp=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Up(t,e){return"start"!==e&&"end"!==e||Bp.test(t)||(e="start"===e?"left":"right"),Lp[e]}function Xp(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}var Yp=class{constructor(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const o=n?this.strokeStates[n]:null,s=i?this.fillStates[i]:null,a=this.textStates[e],h=this.pixelRatio,l=[a.scale[0]*h,a.scale[1]*h],u=Array.isArray(t),c=a.justify?Lp[a.justify]:Up(Array.isArray(t)?t[0]:t,a.textAlign||Cr),p=n&&o.lineWidth?o.lineWidth:0,f=u?t:t.split("\n").reduce(Xp,[]),{width:d,height:g,widths:y,heights:_,lineWidths:m}=kr(a,f),v=d+p,x=[],E=(v+2)*l[0],w=(g+p)*l[1],b={width:E<0?Math.floor(E):Math.ceil(E),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:x};1==l[0]&&1==l[1]||x.push("scale",l),n&&(x.push("strokeStyle",o.strokeStyle),x.push("lineWidth",p),x.push("lineCap",o.lineCap),x.push("lineJoin",o.lineJoin),x.push("miterLimit",o.miterLimit),x.push("setLineDash",[o.lineDash]),x.push("lineDashOffset",o.lineDashOffset)),i&&x.push("fillStyle",s.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");const M=.5-c;let C=c*v+M*p;const I=[],S=[];let P,N=0,R=0,T=0,L=0;for(let t=0,e=f.length;t<e;t+=2){const e=f[t];if("\n"===e){R+=N,N=0,C=c*v+M*p,++L;continue}const r=f[t+1]||a.font;r!==P&&(n&&I.push("font",r),i&&S.push("font",r),P=r),N=Math.max(N,_[T]);const o=[e,C+M*y[T]+c*(y[T]-m[L]),.5*(p+N)+R];C+=y[T],n&&I.push("strokeText",o),i&&S.push("fillText",o),++T}return Array.prototype.push.apply(x,I),Array.prototype.push.apply(x,S),this.labels_[r]=b,b}replayTextBackground_(t,e,i,n,r,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,o,s,a,h,l,u,c,p,f,d,g){let y=i-(s*=c[0]),_=n-(a*=c[1]);const m=r+h>t?t-h:r,v=o+l>e?e-l:o,x=f[3]+m*c[0]+f[1],E=f[0]+v*c[1]+f[2],w=y-f[3],b=_-f[0];let M;return(d||0!==u)&&(kp[0]=w,jp[0]=w,kp[1]=b,Gp[1]=b,Gp[0]=w+x,zp[0]=Gp[0],zp[1]=b+E,jp[1]=zp[1]),0!==u?(M=ft([1,0,0,1,0,0],i,n,1,1,u,-i,-n),ct(M,kp),ct(M,Gp),ct(M,zp),ct(M,jp),St(Math.min(kp[0],Gp[0],zp[0],jp[0]),Math.min(kp[1],Gp[1],zp[1],jp[1]),Math.max(kp[0],Gp[0],zp[0],jp[0]),Math.max(kp[1],Gp[1],zp[1],jp[1]),Fp)):St(Math.min(w,w+x),Math.min(b,b+E),Math.max(w,w+x),Math.max(b,b+E),Fp),p&&(y=Math.round(y),_=Math.round(_)),{drawImageX:y,drawImageY:_,drawImageW:m,drawImageH:v,originX:h,originY:l,declutterBox:{minX:Fp[0],minY:Fp[1],maxX:Fp[2],maxY:Fp[3],value:g},canvasTransform:M,scale:c}}replayImageOrLabel_(t,e,i,n,r,o,s){const a=!(!o&&!s),h=n.declutterBox,l=t.canvas,u=s?s[2]*n.scale[0]/2:0;return h.minX-u<=l.width/e&&h.maxX+u>=0&&h.minY-u<=l.height/e&&h.maxY+u>=0&&(a&&this.replayTextBackground_(t,kp,Gp,zp,jp,o,s),Gr(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){if(this.alignFill_){const e=ct(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],o=this.createLabel(t,e,n,i),s=this.strokeStates[i],a=this.pixelRatio,h=Up(Array.isArray(t)?t[0]:t,r.textAlign||Cr),l=Lp[r.textBaseline||Ir],u=s&&s.lineWidth?s.lineWidth:0;return{label:o,anchorX:h*(o.width/a-2*r.scale[0])+2*(.5-h)*u,anchorY:l*o.height/a+2*(.5-l)*u}}execute_(t,e,i,n,r,o,s,a){let h;var l,u;this.pixelCoordinates_&&P(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=Wi(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),l=this.renderedTransform_,u=i,l[0]=u[0],l[1]=u[1],l[2]=u[2],l[3]=u[3],l[4]=u[4],l[5]=u[5]);let c=0;const p=n.length;let f,d,g,y,_,m,v,x,E,w,b,M,C=0,I=0,S=0,N=null,R=null;const T=this.coordinateCache_,L=this.viewRotation_,O=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,A={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:L},D=this.instructions!=n||this.overlaps?0:200;let F,k,G,z;for(;c<p;){const i=n[c];switch(i[0]){case Mp.BEGIN_GEOMETRY:F=i[1],z=i[3],F.getGeometry()?void 0===s||Ht(s,z.getExtent())?++c:c=i[2]+1:c=i[2];break;case Mp.BEGIN_PATH:I>D&&(this.fill_(t),I=0),S>D&&(t.stroke(),S=0),I||S||(t.beginPath(),y=NaN,_=NaN),++c;break;case Mp.CIRCLE:C=i[1];const n=h[C],l=h[C+1],u=h[C+2]-n,p=h[C+3]-l,P=Math.sqrt(u*u+p*p);t.moveTo(n+P,l),t.arc(n,l,P,0,2*Math.PI,!0),++c;break;case Mp.CLOSE_PATH:t.closePath(),++c;break;case Mp.CUSTOM:C=i[1],f=i[2];const j=i[3],q=i[4],B=6==i.length?i[5]:void 0;A.geometry=j,A.feature=F,c in T||(T[c]=[]);const U=T[c];B?B(h,C,f,2,U):(U[0]=h[C],U[1]=h[C+1],U.length=2),q(U,A),++c;break;case Mp.DRAW_IMAGE:C=i[1],f=i[2],x=i[3],d=i[4],g=i[5];let X=i[6];const Y=i[7],V=i[8],W=i[9],K=i[10];let H=i[11];const Z=i[12];let J=i[13];const Q=i[14],$=i[15];if(!x&&i.length>=20){E=i[19],w=i[20],b=i[21],M=i[22];const t=this.drawLabelWithPointPlacement_(E,w,b,M);x=t.label,i[3]=x;const e=i[23];d=(t.anchorX-e)*this.pixelRatio,i[4]=d;const n=i[24];g=(t.anchorY-n)*this.pixelRatio,i[5]=g,X=x.height,i[6]=X,J=x.width,i[13]=J}let tt,et,it,nt;i.length>25&&(tt=i[25]),i.length>17?(et=i[16],it=i[17],nt=i[18]):(et=Sr,it=!1,nt=!1),K&&O?H+=L:K||O||(H-=L);let rt=0;for(;C<f;C+=2){if(tt&&tt[rt++]<J/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(x.width,x.height,h[C],h[C+1],J,X,d,g,V,W,H,Z,r,et,it||nt,F),n=[t,e,x,i,Y,it?N:null,nt?R:null];if(a){if("none"===Q)continue;if("obstacle"===Q){a.insert(i.declutterBox);continue}{let t,e;if($){const i=f-C;if(!$[i]){$[i]=n;continue}if(t=$[i],delete $[i],e=qp(t),a.collides(e))continue}if(a.collides(i.declutterBox))continue;t&&(a.insert(e),this.replayImageOrLabel_.apply(this,t)),a.insert(i.declutterBox)}}this.replayImageOrLabel_.apply(this,n)}++c;break;case Mp.DRAW_CHARS:const ot=i[1],st=i[2],at=i[3],ht=i[4];M=i[5];const lt=i[6],ut=i[7],ct=i[8];b=i[9];const pt=i[10];E=i[11],w=i[12];const ft=[i[13],i[13]],dt=this.textStates[w],gt=dt.font,yt=[dt.scale[0]*ut,dt.scale[1]*ut];let _t;gt in this.widths_?_t=this.widths_[gt]:(_t={},this.widths_[gt]=_t);const mt=Hu(h,ot,st,2),vt=Math.abs(yt[0])*Fr(gt,E,_t);if(ht||vt<=mt){const i=this.textStates[w].textAlign,n=Dp(h,ot,st,2,E,(mt-vt)*Lp[i],lt,Math.abs(yt[0]),Fr,gt,_t,O?0:this.viewRotation_);t:if(n){const i=[];let r,o,s,h,l;if(b)for(r=0,o=n.length;r<o;++r){l=n[r],s=l[4],h=this.createLabel(s,w,"",b),d=l[2]+(yt[0]<0?-pt:pt),g=at*h.height+2*(.5-at)*pt*yt[1]/yt[0]-ct;const o=this.calculateImageOrLabelDimensions_(h.width,h.height,l[0],l[1],h.width,h.height,d,g,0,0,l[3],ft,!1,Sr,!1,F);if(a&&a.collides(o.declutterBox))break t;i.push([t,e,h,o,1,null,null])}if(M)for(r=0,o=n.length;r<o;++r){l=n[r],s=l[4],h=this.createLabel(s,w,M,""),d=l[2],g=at*h.height-ct;const o=this.calculateImageOrLabelDimensions_(h.width,h.height,l[0],l[1],h.width,h.height,d,g,0,0,l[3],ft,!1,Sr,!1,F);if(a&&a.collides(o.declutterBox))break t;i.push([t,e,h,o,1,null,null])}a&&a.load(i.map(qp));for(let t=0,e=i.length;t<e;++t)this.replayImageOrLabel_.apply(this,i[t])}}++c;break;case Mp.END_GEOMETRY:if(void 0!==o){F=i[1];const t=o(F,z);if(t)return t}++c;break;case Mp.FILL:D?I++:this.fill_(t),++c;break;case Mp.MOVE_TO_LINE_TO:for(C=i[1],f=i[2],k=h[C],G=h[C+1],m=k+.5|0,v=G+.5|0,m===y&&v===_||(t.moveTo(k,G),y=m,_=v),C+=2;C<f;C+=2)k=h[C],G=h[C+1],m=k+.5|0,v=G+.5|0,C!=f-2&&m===y&&v===_||(t.lineTo(k,G),y=m,_=v);++c;break;case Mp.SET_FILL_STYLE:N=i,this.alignFill_=i[2],I&&(this.fill_(t),I=0,S&&(t.stroke(),S=0)),t.fillStyle=i[1],++c;break;case Mp.SET_STROKE_STYLE:R=i,S&&(t.stroke(),S=0),this.setStrokeStyle_(t,i),++c;break;case Mp.STROKE:D?S++:t.stroke(),++c;break;default:++c}}I&&this.fill_(t),S&&t.stroke()}execute(t,e,i,n,r,o){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,o)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,r)}};const Vp=["Polygon","Circle","LineString","Image","Text","Default"];const Wp={};var Kp=class{constructor(t,e,i,n,r,o){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(r)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);const n=t[e];for(const t in n){const e=n[t];i[t]=new Yp(this.resolution_,this.pixelRatio_,this.overlaps_,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,n=t.length;e<n;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,o){const s=2*(n=Math.round(n))+1,a=ft(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=fr(s,s,void 0,{willReadFrequently:!0}));const l=this.hitDetectionContext_;let u;l.canvas.width!==s||l.canvas.height!==s?(l.canvas.width=s,l.canvas.height=s):h||l.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(u=[1/0,1/0,-1/0,-1/0],Ot(u,t),vt(u,e*(this.renderBuffer_+n),u));const c=function(t){if(void 0!==Wp[t])return Wp[t];const e=2*t+1,i=t*t,n=new Array(i+1);for(let r=0;r<=t;++r)for(let o=0;o<=t;++o){const s=r*r+o*o;if(s>i)break;let a=n[s];a||(a=[],n[s]=a),a.push(4*((t+r)*e+(t+o))+3),r>0&&a.push(4*((t-r)*e+(t+o))+3),o>0&&(a.push(4*((t+r)*e+(t-o))+3),r>0&&a.push(4*((t-r)*e+(t-o))+3))}const r=[];for(let t=0,e=n.length;t<e;++t)n[t]&&r.push(...n[t]);return Wp[t]=r,r}(n);let p;function f(t,e){const i=l.getImageData(0,0,s,s).data;for(let a=0,h=c.length;a<h;a++)if(i[c[a]]>0){if(!o||"Image"!==p&&"Text"!==p||o.includes(t)){const i=(c[a]-3)/4,o=n-i%s,h=n-(i/s|0),l=r(t,e,o*o+h*h);if(l)return l}l.clearRect(0,0,s,s);break}}const d=Object.keys(this.executorsByZIndex_).map(Number);let g,y,_,m,v;for(d.sort(M),g=d.length-1;g>=0;--g){const t=d[g].toString();for(_=this.executorsByZIndex_[t],y=Vp.length-1;y>=0;--y)if(p=Vp[y],m=_[p],void 0!==m&&(v=m.executeHitDetection(l,a,i,f,u),v))return v}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],o=e[3],s=[i,n,i,o,r,o,r,n];return Wi(s,0,8,2,t,s),s}isEmpty(){return D(this.executorsByZIndex_)}execute(t,e,i,n,r,o,s){const a=Object.keys(this.executorsByZIndex_).map(Number);let h,l,u,c,p,f;for(a.sort(M),this.maxExtent_&&(t.save(),this.clip(t,i)),o=o||Vp,s&&a.reverse(),h=0,l=a.length;h<l;++h){const l=a[h].toString();for(p=this.executorsByZIndex_[l],u=0,c=o.length;u<c;++u){f=p[o[u]],void 0!==f&&f.execute(t,e,i,n,r,s)}}this.maxExtent_&&t.restore()}};var Hp=class extends Cp{constructor(t,e,i,n,r,o,s){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?le(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=s,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,n){if(!this.image_)return;const r=Wi(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);let h=this.imageRotation_;0===this.transformRotation_&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let t=0,e=r.length;t<e;t+=2){const e=r[t]-this.imageAnchorX_,i=r[t+1]-this.imageAnchorY_;if(0!==h||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,n=i+this.imageAnchorY_;ft(s,t,n,1,1,h,-t,-n),o.setTransform.apply(o,s),o.translate(t,n),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=a)}drawText_(t,e,i,n){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=Wi(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let s=this.textRotation_;for(0===this.transformRotation_&&(s-=this.viewRotation_),this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){const t=r[e]+this.textOffsetX_,i=r[e+1]+this.textOffsetY_;0!==s||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.translate(t-this.textOffsetX_,i-this.textOffsetY_),o.rotate(s),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&o.strokeText(this.text_,t,i),this.textFillState_&&o.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,n,r){const o=this.context_,s=Wi(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);let a=s.length;r&&(a-=2);for(let t=2;t<a;t+=2)o.lineTo(s[t],s[t+1]);return r&&o.closePath(),i}drawRings_(t,e,i,n){for(let r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(Ht(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=tn(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&Ht(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Ht(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(Ht(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let n=0;const r=t.getEnds(),o=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t)n=this.moveToLineTo_(i,n,r[t],o,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Ht(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Ht(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),o=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t){const e=r[t];n=this.drawRings_(i,n,e,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),P(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Cr;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:Xc(e||xr)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),n=e.getLineDash(),r=e.getLineDashOffset(),o=e.getLineJoin(),s=e.getWidth(),a=e.getMiterLimit(),h=n||wr;this.strokeState_={lineCap:void 0!==i?i:Er,lineDash:1===this.pixelRatio_?h:h.map((t=>t*this.pixelRatio_)),lineDashOffset:(r||0)*this.pixelRatio_,lineJoin:void 0!==o?o:br,lineWidth:(void 0!==s?s:1)*this.pixelRatio_,miterLimit:void 0!==a?a:10,strokeStyle:Xc(t||Mr)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:Xc(t||xr)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),n=i.getLineDash(),r=i.getLineDashOffset(),o=i.getLineJoin(),s=i.getWidth(),a=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:Er,lineDash:n||wr,lineDashOffset:r||0,lineJoin:void 0!==o?o:br,lineWidth:void 0!==s?s:1,miterLimit:void 0!==a?a:10,strokeStyle:Xc(t||Mr)}}else this.textStrokeState_=null;const n=t.getFont(),r=t.getOffsetX(),o=t.getOffsetY(),s=t.getRotateWithView(),a=t.getRotation(),h=t.getScaleArray(),l=t.getText(),u=t.getTextAlign(),c=t.getTextBaseline();this.textState_={font:void 0!==n?n:vr,textAlign:void 0!==u?u:Cr,textBaseline:void 0!==c?c:Ir},this.text_=void 0!==l?Array.isArray(l)?l.reduce(((t,e,i)=>t+(i%2?" ":e)),""):l:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==o?this.pixelRatio_*o:0,this.textRotateWithView_=void 0!==s&&s,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}else this.text_=""}};const Zp=.5;function Jp(t,e,i,n,r,o,s){const a=fr(t[0]*Zp,t[1]*Zp);a.imageSmoothingEnabled=!1;const h=a.canvas,l=new Hp(a,Zp,r,null,s),u=i.length,c=Math.floor(16777215/u),p={};for(let t=1;t<=u;++t){const e=i[t-1],s=e.getStyleFunction()||n;if(!n)continue;let a=s(e,o);if(!a)continue;Array.isArray(a)||(a=[a]);const h=(t*c).toString(16).padStart(7,"#00000");for(let t=0,i=a.length;t<i;++t){const i=a[t],n=i.getGeometryFunction()(e);if(!n||!Ht(r,n.getExtent()))continue;const o=i.clone(),s=o.getFill();s&&s.setColor(h);const l=o.getStroke();l&&(l.setColor(h),l.setLineDash(null)),o.setText(void 0);const u=i.getImage();if(u&&0!==u.getOpacity()){const t=u.getImageSize();if(!t)continue;const e=fr(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=h,e.fillRect(0,0,i.width,i.height),o.setImage(new lp({img:i,imgSize:t,anchor:u.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:u.getOrigin(),opacity:1,size:u.getSize(),scale:u.getScale(),rotation:u.getRotation(),rotateWithView:u.getRotateWithView()}))}const c=o.getZIndex()||0;let f=p[c];f||(f={},p[c]=f,f.Polygon=[],f.Circle=[],f.LineString=[],f.Point=[]);const d=n.getType();if("GeometryCollection"===d){const t=n.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];f[i.getType().replace("Multi","")].push(i,o)}}else f[d.replace("Multi","")].push(n,o)}}const f=Object.keys(p).map(Number).sort(M);for(let t=0,i=f.length;t<i;++t){const i=p[f[t]];for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t+=2){l.setStyle(n[t+1]);for(let i=0,r=e.length;i<r;++i)l.setTransform(e[i]),l.drawGeometry(n[t])}}}return a.getImageData(0,0,h.width,h.height)}function Qp(t,e,i){const n=[];if(i){const r=Math.floor(Math.round(t[0])*Zp),o=Math.floor(Math.round(t[1])*Zp),s=4*(ie(r,0,i.width-1)+ie(o,0,i.height-1)*i.width),a=i.data[s],h=i.data[s+1],l=i.data[s+2]+256*(h+256*a),u=Math.floor(16777215/e.length);l&&l%u==0&&n.push(e[l/u-1])}return n}const $p=.5,tf={Point:function(t,e,i,n,r){const o=i.getImage(),s=i.getText();let a;if(o){if(o.getImageState()!=Ho.LOADED)return;let h=t;if(r){const l=o.getDeclutterMode();if("none"!==l)if(h=r,"obstacle"===l){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(o,a),r.drawPoint(e,n)}else s&&s.getText()&&(a={})}const l=h.getBuilder(i.getZIndex(),"Image");l.setImageStyle(o,a),l.drawPoint(e,n)}if(s&&s.getText()){let o=t;r&&(o=r);const h=o.getBuilder(i.getZIndex(),"Text");h.setTextStyle(s,a),h.drawText(e,n)}},LineString:function(t,e,i,n,r){const o=i.getStroke();if(o){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,o),r.drawLineString(e,n)}const s=i.getText();if(s&&s.getText()){const o=(r||t).getBuilder(i.getZIndex(),"Text");o.setTextStyle(s),o.drawText(e,n)}},Polygon:function(t,e,i,n,r){const o=i.getFill(),s=i.getStroke();if(o||s){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(o,s),r.drawPolygon(e,n)}const a=i.getText();if(a&&a.getText()){const o=(r||t).getBuilder(i.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,n)}},MultiPoint:function(t,e,i,n,r){const o=i.getImage(),s=i.getText();let a;if(o){if(o.getImageState()!=Ho.LOADED)return;let h=t;if(r){const l=o.getDeclutterMode();if("none"!==l)if(h=r,"obstacle"===l){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(o,a),r.drawMultiPoint(e,n)}else s&&s.getText()&&(a={})}const l=h.getBuilder(i.getZIndex(),"Image");l.setImageStyle(o,a),l.drawMultiPoint(e,n)}if(s&&s.getText()){let o=t;r&&(o=r);const h=o.getBuilder(i.getZIndex(),"Text");h.setTextStyle(s,a),h.drawText(e,n)}},MultiLineString:function(t,e,i,n,r){const o=i.getStroke();if(o){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,o),r.drawMultiLineString(e,n)}const s=i.getText();if(s&&s.getText()){const o=(r||t).getBuilder(i.getZIndex(),"Text");o.setTextStyle(s),o.drawText(e,n)}},MultiPolygon:function(t,e,i,n,r){const o=i.getFill(),s=i.getStroke();if(s||o){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(o,s),r.drawMultiPolygon(e,n)}const a=i.getText();if(a&&a.getText()){const o=(r||t).getBuilder(i.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,n)}},GeometryCollection:function(t,e,i,n,r){const o=e.getGeometriesArray();let s,a;for(s=0,a=o.length;s<a;++s){(0,tf[o[s].getType()])(t,o[s],i,n,r)}},Circle:function(t,e,i,n,r){const o=i.getFill(),s=i.getStroke();if(o||s){const r=t.getBuilder(i.getZIndex(),"Circle");r.setFillStrokeStyle(o,s),r.drawCircle(e,n)}const a=i.getText();if(a&&a.getText()){const o=(r||t).getBuilder(i.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,n)}}};function ef(t,e){return parseInt(Y(t),10)-parseInt(Y(e),10)}function nf(t,e){const i=rf(t,e);return i*i}function rf(t,e){return $p*t/e}function of(t,e,i,n,r,o,s){let a=!1;const h=i.getImage();if(h){const t=h.getImageState();t==Ho.LOADED||t==Ho.ERROR?h.unlistenImageChange(r):(t==Ho.IDLE&&h.load(),h.listenImageChange(r),a=!0)}return function(t,e,i,n,r,o){const s=i.getGeometryFunction()(e);if(!s)return;const a=s.simplifyTransformed(n,r),h=i.getRenderer();if(h)sf(t,a,i,e);else{(0,tf[a.getType()])(t,a,i,e,o)}}(t,e,i,n,o,s),a}function sf(t,e,i,n){if("GeometryCollection"==e.getType()){const r=e.getGeometries();for(let e=0,o=r.length;e<o;++e)sf(t,r[e],i,n);return}t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer())}var af=class extends Vs{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,o=r.center,s=r.resolution,a=r.projection,h=r.rotation,l=a.getExtent(),u=this.getLayer().getSource(),c=e.pixelRatio,p=e.viewHints,f=!(p[Ie.ANIMATING]||p[Ie.INTERACTING]),d=this.compositionContext_,g=Math.round(e.size[0]*c),y=Math.round(e.size[1]*c),_=u.getWrapX()&&a.canWrapX(),m=_?Kt(l):null,v=_?Math.ceil((n[2]-l[2])/m)+1:1;let x=_?Math.floor((n[0]-l[0])/m):0;do{const e=this.getRenderTransform(o,s,h,c,g,y,x*m);t.execute(d,1,e,h,f,void 0,i)}while(++x<v)}setupCompositionContext_(){if(1!==this.opacity_){const t=fr(this.context.canvas.width,this.context.canvas.height,Xs);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,dr(this.compositionContext_),Xs.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];pt(this.pixelTransform,1/i,1/i),dt(this.inversePixelTransform,this.pixelTransform);const r=yt(this.pixelTransform);this.useContainer(e,r,this.getBackground(t));const o=this.context,s=o.canvas,a=this.replayGroup_,h=this.declutterExecutorGroup;if((!a||a.isEmpty())&&(!h||h.isEmpty()))return null;const l=Math.round(t.size[0]*i),u=Math.round(t.size[1]*i);s.width!=l||s.height!=u?(s.width=l,s.height=u,s.style.transform!==r&&(s.style.transform=r)):this.containerReused||o.clearRect(0,0,l,u),this.preRender(o,t);const c=t.viewState,p=c.projection;this.opacity_=n.opacity,this.setupCompositionContext_();let f=!1,d=!0;if(n.extent&&this.clipping){const e=Ii(n.extent,p);d=Ht(e,t.extent),f=d&&!bt(e,t.extent),f&&this.clipUnrotated(this.compositionContext_,t,e)}return d&&this.renderWorlds(a,t),f&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,t),this.renderedRotation_!==c.rotation&&(this.renderedRotation_=c.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise((e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=[this.context.canvas.width,this.context.canvas.height];ct(this.pixelTransform,t);const e=this.renderedCenter_,i=this.renderedResolution_,n=this.renderedRotation_,r=this.renderedProjection_,o=this.wrappedRenderedExtent_,s=this.getLayer(),a=[],h=t[0]*Zp,l=t[1]*Zp;a.push(this.getRenderTransform(e,i,n,Zp,h,l,0).slice());const u=s.getSource(),c=r.getExtent();if(u.getWrapX()&&r.canWrapX()&&!bt(c,o)){let t=o[0];const r=Kt(c);let s,u=0;for(;t<c[0];)--u,s=r*u,a.push(this.getRenderTransform(e,i,n,Zp,h,l,s).slice()),t+=r;for(u=0,t=o[2];t>c[2];)++u,s=r*u,a.push(this.getRenderTransform(e,i,n,Zp,h,l,s).slice()),t-=r}this.hitDetectionImageData_=Jp(t,a,this.renderedFeatures_,s.getStyleFunction(),o,i,n)}e(Qp(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const o=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),h={},l=function(t,e,i){const o=Y(t),s=h[o];if(s){if(!0!==s&&i<s.distanceSq){if(0===i)return h[o]=!0,r.splice(r.lastIndexOf(s),1),n(t,a,e);s.geometry=e,s.distanceSq=i}}else{if(0===i)return h[o]=!0,n(t,a,e);r.push(h[o]={feature:t,layer:a,geometry:e,distanceSq:i,callback:n})}};let u;const c=[this.replayGroup_];return this.declutterExecutorGroup&&c.push(this.declutterExecutorGroup),c.some((n=>u=n.forEachFeatureAtCoordinate(t,o,s,i,l,n===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((t=>t.value)):null))),u}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[Ie.ANIMATING],r=t.viewHints[Ie.INTERACTING],o=e.getUpdateWhileAnimating(),s=e.getUpdateWhileInteracting();if(this.ready&&!o&&n||!s&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=t.extent,h=t.viewState,l=h.projection,u=h.resolution,c=t.pixelRatio,p=e.getRevision(),f=e.getRenderBuffer();let d=e.getRenderOrder();void 0===d&&(d=ef);const g=h.center.slice(),y=vt(a,f*u),_=y.slice(),m=[y.slice()],v=l.getExtent();if(i.getWrapX()&&l.canWrapX()&&!bt(v,t.extent)){const t=Kt(v),e=Math.max(Kt(y)/2,t);y[0]=v[0]-e,y[2]=v[2]+e,Qe(g,l);const i=te(m[0],l);i[0]<v[0]&&i[2]<v[2]?m.push([i[0]+t,i[1],i[2]+t,i[3]]):i[0]>v[0]&&i[2]>v[2]&&m.push([i[0]-t,i[1],i[2]-t,i[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==p&&this.renderedRenderOrder_==d&&bt(this.wrappedRenderedExtent_,y))return P(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const x=new Ap(rf(u,c),y,u,c);let E;this.getLayer().getDeclutter()&&(E=new Ap(rf(u,c),y,u,c));const w=wi();let b;if(w){for(let t=0,e=m.length;t<e;++t){const e=Ci(m[t],l);i.loadFeatures(e,Si(u,l),w)}b=_i(w,l)}else for(let t=0,e=m.length;t<e;++t)i.loadFeatures(m[t],u,l);const M=nf(u,c);let C=!0;const I=t=>{let i;const n=t.getStyleFunction()||e.getStyleFunction();if(n&&(i=n(t,u)),i){const e=this.renderFeature(t,M,i,x,b,E);C=C&&!e}},S=Ci(y,l),N=i.getFeaturesInExtent(S);d&&N.sort(d);for(let t=0,e=N.length;t<e;++t)I(N[t]);this.renderedFeatures_=N,this.ready=C;const R=x.finish(),T=new Kp(y,u,c,i.getOverlaps(),R,e.getRenderBuffer());return E&&(this.declutterExecutorGroup=new Kp(y,u,c,i.getOverlaps(),E.finish(),e.getRenderBuffer())),this.renderedResolution_=u,this.renderedRevision_=p,this.renderedRenderOrder_=d,this.renderedExtent_=_,this.wrappedRenderedExtent_=y,this.renderedCenter_=g,this.renderedProjection_=l,this.replayGroup_=T,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,o){if(!i)return!1;let s=!1;if(Array.isArray(i))for(let a=0,h=i.length;a<h;++a)s=of(n,t,i[a],e,this.boundHandleStyleImageChange_,r,o)||s;else s=of(n,t,i,e,this.boundHandleStyleImageChange_,r,o);return s}};var hf=class extends mp{constructor(t){super(t)}createRenderer(){return new af(this)}};ju.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs"),Zs(ju);const lf=new Te({code:"EPSG:28992",extent:[-285401.92,22598.08,595401.92,903401.92]}),uf=[3440.64,1720.32,860.16,430.08,215.04,107.52,53.76,26.88,13.44,6.72,3.36,1.68,.84,.42,.21],cf=new Array(15);for(var pf=0;pf<15;++pf)cf[pf]=pf;var ff;const df=new Wo({layers:[new Ks({type:"base",title:`${ff="grijs"} WMTS`,extent:lf.extent,source:new js({url:"https://service.pdok.nl/brt/achtergrondkaart/wmts/v2_0",crossOrigin:"Anonymous",layer:ff,matrixSet:"EPSG:28992",format:"image/png",attributions:'Kaartgegevens: © <a href="http://www.cbs.nl">CBS</a>, <a href="http://www.kadaster.nl">Kadaster</a>, <a href="http://openstreetmap.org">OpenStreetMap</a><span class="printhide">-auteurs (<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>).</span>',projection:lf,tileGrid:new zs({origin:Vt(lf.getExtent()),resolutions:uf,matrixIds:cf}),style:"default"})})],target:"map",view:new tr({center:(gf=[5.43,52.18],si(),vi(gf,"EPSG:4326",void 0!==yf?yf:"EPSG:3857")),zoom:8})});var gf,yf;var _f=new qc({}),mf=new hf({source:_f}),vf=new qc({}),xf=new hf({source:vf,style:new rp({stroke:new Qc({color:"rgba(255, 0, 0, 1)",lineDash:[4],width:1}),fill:new Zc({color:"rgba(0, 255, 98, 0.5)"})})});df.addLayer(xf),df.addLayer(mf);const Ef="https://api.pdok.nl/bzk/locatieserver/search/v3_1";let wf="";function bf(t){const e=new qc({features:(new Oc).readFeatures(t,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"})}),i=new hf({source:e,style:new rp({stroke:new Qc({color:"rgba(210,210,210,0.8)",lineDash:[4],width:1})})});df.addLayer(i),document.getElementById("lsInput").addEventListener("input",(e=>{if("insertReplacementText"===e.inputType||void 0===e.inputType){const i=document.getElementById("locatie-auto-complete").querySelectorAll("option");let r="";for(let t of i)t.value===e.target.value&&(r=t.id,wf=t.value);fetch(`${Ef}/lookup?id=${r}&fl=id,geometrie_ll,geometrie_rd`).then((t=>t.json())).then((e=>{_f.clear(),vf.clear();const i=e.response.docs[0].geometrie_ll,r=(new Pc).readFeature(i,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),o=r.getGeometry().getExtent();df.getView().fit(o,{maxZoom:18,padding:[20,20,20,20]}),_f.addFeature(r);const s=function(t,e){const i=y.parse(t),r=[];for(let t=0;t<e.length;t++){const o=e[t];null!==n.intersect(i,o)&&r.push(o)}return r}(e.response.docs[0].geometrie_rd,t.features);let a=s.map((t=>(new Oc).readFeature(t,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"})));vf.addFeatures(a);let h=xf.getSource().getFeatures().length,l=0;xf.getSource().forEachFeature((function(t){l+=parseInt(t.getProperties().length)})),document.getElementById("info").innerHTML=`${h} kaartbladen<br/>${function(t,e=!1,i=1){const n=e?1e3:1024;if(Math.abs(t)<n)return t+" B";const r=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let o=-1;const s=10**i;do{t/=n,++o}while(Math.round(Math.abs(t)*s)/s>=n&&o<r.length-1);return t.toFixed(i)+" "+r[o]}(l,!0)}`,document.getElementById("locatie-auto-complete").innerHTML="",document.getElementById("lsInput").blur(),document.getElementById("buttons").classList.remove("hidden"),setTimeout((()=>{df.getView().fit(xf.getSource().getExtent(),{maxZoom:18,padding:[20,20,20,20]})}),100)}))}}))}document.getElementById("lsInput").addEventListener("keyup",(t=>{wf!==t.target.value&&(wf=t.target.value,fetch(`${Ef}/suggest?q=${wf}&fq=type:(gemeente OR woonplaats OR provincie)`).then((t=>t.json())).then((t=>{if(t.response.docs.length>0){let e=t.response.docs.map((t=>`<option value="${t.weergavenaam}" id="${t.id}">`)).join("");document.getElementById("locatie-auto-complete").innerHTML=e,document.getElementById("buttons").classList.add("hidden")}})))})),document.getElementById("copy").addEventListener("click",(()=>{let t="";xf.getSource().forEachFeature((function(e){let i=e.getProperties().url;t+=`${i}\n`})),navigator.clipboard.writeText(t)})),document.getElementById("download").addEventListener("click",(()=>{xf.getSource().forEachFeature((function(t){!function(t){const e=document.createElement("a");let i=t.split("/").reverse()[0];e.style.display="none",e.id=i,e.href=t,e.download=i,e.setAttribute("target","_blank"),document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)}(t.getProperties().url),setTimeout((function(){}),10)}))})),fetch("https://service.pdok.nl/rws/ahn/atom/preprod/downloads/dtm_05m/kaartbladindex.json").then((t=>t.json())).then((t=>{bf(t)}));
//# sourceMappingURL=index.9602b1a7.js.map
